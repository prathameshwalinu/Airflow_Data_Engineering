[0m01:39:57.167838 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff9c222250>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff9afdd450>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff9ec947d0>]}


============================== 01:39:57.174619 | 7a8c47f9-39ac-412e-959f-61ae9834efbd ==============================
[0m01:39:57.174619 [info ] [MainThread]: Running with dbt=1.5.9
[0m01:39:57.175782 [debug] [MainThread]: running dbt with arguments {'warn_error': 'None', 'partial_parse': 'True', 'log_cache_events': 'False', 'indirect_selection': 'eager', 'static_parser': 'True', 'profiles_dir': '/usr/local/airflow/include/dbt', 'use_experimental_parser': 'False', 'write_json': 'True', 'log_format': 'default', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'use_colors': 'True', 'send_anonymous_usage_stats': 'True', 'quiet': 'False', 'introspect': 'True', 'version_check': 'True', 'no_print': 'None', 'log_path': '/usr/local/airflow/include/dbt/logs', 'cache_selected_only': 'False', 'printer_width': '80', 'target_path': 'None', 'debug': 'False', 'fail_fast': 'False'}
[0m01:39:57.259474 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '7a8c47f9-39ac-412e-959f-61ae9834efbd', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff9afd5c50>]}
[0m01:39:57.265436 [debug] [MainThread]: Set downloads directory='/tmp/dbt-downloads-tw0owamm'
[0m01:39:57.266370 [debug] [MainThread]: Making package index registry request: GET https://hub.getdbt.com/api/v1/index.json
[0m01:39:58.136883 [debug] [MainThread]: Response from registry index: GET https://hub.getdbt.com/api/v1/index.json 200
[0m01:39:58.146353 [debug] [MainThread]: Making package registry request: GET https://hub.getdbt.com/api/v1/dbt-labs/dbt_utils.json
[0m01:39:58.390929 [debug] [MainThread]: Response from registry: GET https://hub.getdbt.com/api/v1/dbt-labs/dbt_utils.json 200
[0m01:39:58.435452 [info ] [MainThread]: Installing dbt-labs/dbt_utils
[0m01:39:59.621803 [info ] [MainThread]: Installed from version 1.1.1
[0m01:39:59.629142 [info ] [MainThread]: Up to date!
[0m01:39:59.632154 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'package', 'label': '7a8c47f9-39ac-412e-959f-61ae9834efbd', 'property_': 'install', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff9aa41210>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff9a82bcd0>]}
[0m01:39:59.639312 [debug] [MainThread]: Command `dbt deps` succeeded at 01:39:59.636610 after 2.48 seconds
[0m01:39:59.644897 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff9ec87950>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff9eaee1d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff9eaee250>]}
[0m01:39:59.646590 [debug] [MainThread]: Flushing usage events
[0m01:41:27.869402 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffb3d55f50>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffb3cb1550>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffb3d73110>]}


============================== 01:41:27.874333 | 211f7100-c126-45e5-8ca6-0925f7b924ee ==============================
[0m01:41:27.874333 [info ] [MainThread]: Running with dbt=1.5.9
[0m01:41:27.875219 [debug] [MainThread]: running dbt with arguments {'static_parser': 'True', 'profiles_dir': '/usr/local/airflow/include/dbt/', 'no_print': 'None', 'log_path': '/usr/local/airflow/include/dbt/logs', 'send_anonymous_usage_stats': 'True', 'quiet': 'False', 'debug': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'version_check': 'True', 'warn_error': 'None', 'target_path': 'None', 'log_cache_events': 'False', 'printer_width': '80', 'use_colors': 'True', 'indirect_selection': 'eager', 'introspect': 'True', 'log_format': 'default', 'fail_fast': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'use_experimental_parser': 'False', 'write_json': 'True'}
[0m01:41:27.877517 [error] [MainThread]: Encountered an error:
Runtime Error
  
  dbt encountered an error while trying to read your profiles.yml file.
  
  The profiles.yml file at /usr/local/airflow/include/dbt/profiles.yml is empty
  
[0m01:41:27.878549 [debug] [MainThread]: Command `dbt run` failed at 01:41:27.878386 after 0.01 seconds
[0m01:41:27.878998 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffb7c60450>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffb3d714d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffb3d48e10>]}
[0m01:41:27.879453 [debug] [MainThread]: Flushing usage events
[0m01:41:51.346108 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff8c361ad0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff8c627b90>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff8c663450>]}


============================== 01:41:51.351479 | 27cb2fb8-f39b-4ab1-93cd-3845cc7ada2e ==============================
[0m01:41:51.351479 [info ] [MainThread]: Running with dbt=1.5.9
[0m01:41:51.352335 [debug] [MainThread]: running dbt with arguments {'log_cache_events': 'False', 'no_print': 'None', 'indirect_selection': 'eager', 'log_format': 'default', 'version_check': 'True', 'debug': 'False', 'profiles_dir': '/usr/local/airflow/include/dbt/', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'warn_error': 'None', 'write_json': 'True', 'static_parser': 'True', 'cache_selected_only': 'False', 'fail_fast': 'False', 'target_path': 'None', 'printer_width': '80', 'use_colors': 'True', 'use_experimental_parser': 'False', 'log_path': '/usr/local/airflow/include/dbt/logs', 'partial_parse': 'True', 'send_anonymous_usage_stats': 'True', 'quiet': 'False', 'introspect': 'True'}
[0m01:41:51.829519 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '27cb2fb8-f39b-4ab1-93cd-3845cc7ada2e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff8a2d88d0>]}
[0m01:41:51.841102 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '27cb2fb8-f39b-4ab1-93cd-3845cc7ada2e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff8a2d9590>]}
[0m01:41:51.842294 [info ] [MainThread]: Registered adapter: bigquery=1.5.3
[0m01:41:51.857977 [debug] [MainThread]: checksum: dd837546c89c9d03f3c2cb0ca6165266a30da6076d5d44e9991f7c5a8e5f5831, vars: {}, profile: , target: , version: 1.5.9
[0m01:41:51.859575 [info ] [MainThread]: Unable to do partial parsing because saved manifest not found. Starting full parse.
[0m01:41:51.860217 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'partial_parser', 'label': '27cb2fb8-f39b-4ab1-93cd-3845cc7ada2e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff8a2cea10>]}
[0m01:41:52.542245 [debug] [MainThread]: 1699: static parser successfully parsed transform/passenger_count_dim.sql
[0m01:41:52.554152 [debug] [MainThread]: 1699: static parser successfully parsed transform/datetime_dim.sql
[0m01:41:52.613852 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '27cb2fb8-f39b-4ab1-93cd-3845cc7ada2e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff8a08f490>]}
[0m01:41:52.625965 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '27cb2fb8-f39b-4ab1-93cd-3845cc7ada2e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff8a12b690>]}
[0m01:41:52.626585 [info ] [MainThread]: Found 2 models, 0 tests, 0 snapshots, 0 analyses, 474 macros, 0 operations, 0 seed files, 1 source, 0 exposures, 0 metrics, 0 groups
[0m01:41:52.627215 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '27cb2fb8-f39b-4ab1-93cd-3845cc7ada2e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff8a15ded0>]}
[0m01:41:52.628543 [info ] [MainThread]: 
[0m01:41:52.629778 [debug] [MainThread]: Acquiring new bigquery connection 'master'
[0m01:41:52.631078 [debug] [ThreadPool]: Acquiring new bigquery connection 'list_uber-data-engineering-407103'
[0m01:41:52.631602 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m01:41:53.804998 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_uber-data-engineering-407103, now list_uber-data-engineering-407103_uber)
[0m01:41:53.807446 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m01:41:54.283005 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '27cb2fb8-f39b-4ab1-93cd-3845cc7ada2e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff8a1dd850>]}
[0m01:41:54.285294 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m01:41:54.286795 [info ] [MainThread]: 
[0m01:41:54.316691 [debug] [Thread-1 (]: Began running node model.uber.datetime_dim
[0m01:41:54.317912 [info ] [Thread-1 (]: 1 of 1 START sql table model uber.datetime_dim ................................. [RUN]
[0m01:41:54.320432 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_uber-data-engineering-407103_uber, now model.uber.datetime_dim)
[0m01:41:54.321341 [debug] [Thread-1 (]: Began compiling node model.uber.datetime_dim
[0m01:41:54.329272 [debug] [Thread-1 (]: Writing injected SQL for node "model.uber.datetime_dim"
[0m01:41:54.333222 [debug] [Thread-1 (]: Timing info for model.uber.datetime_dim (compile): 01:41:54.321953 => 01:41:54.332906
[0m01:41:54.333908 [debug] [Thread-1 (]: Began executing node model.uber.datetime_dim
[0m01:41:54.369397 [debug] [Thread-1 (]: Writing runtime sql for node "model.uber.datetime_dim"
[0m01:41:54.372854 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m01:41:54.374811 [debug] [Thread-1 (]: On model.uber.datetime_dim: /* {"app": "dbt", "dbt_version": "1.5.9", "profile_name": "uber", "target_name": "dev", "node_id": "model.uber.datetime_dim"} */

  
    

    create or replace table `uber-data-engineering-407103`.`uber`.`datetime_dim`
    
    

    OPTIONS()
    as (
      WITH datetime_cte AS (  
  SELECT DISTINCT
    tpep_pickup_datetime AS datetime_id,
    CASE
      WHEN LENGTH(tpep_pickup_datetime) = 16 THEN
        -- Date format: "DD/MM/YYYY HH:MM"
        PARSE_DATETIME('%m/%d/%Y %H:%M', tpep_pickup_datetime)
      WHEN LENGTH(tpep_pickup_datetime) <= 14 THEN
        -- Date format: "MM/DD/YY HH:MM"
        PARSE_DATETIME('%m/%d/%y %H:%M', tpep_pickup_datetime)
      ELSE
        NULL
    END AS pick_date_part,
    tpep_dropoff_datetime AS drop_datetime_id,
    CASE
      WHEN LENGTH(tpep_dropoff_datetime) = 16 THEN
        -- Date format: "DD/MM/YYYY HH:MM"
        PARSE_DATETIME('%m/%d/%Y %H:%M', tpep_dropoff_datetime)
      WHEN LENGTH(tpep_dropoff_datetime) <= 14 THEN
        -- Date format: "MM/DD/YY HH:MM"
        PARSE_DATETIME('%m/%d/%y %H:%M', tpep_dropoff_datetime)
      ELSE
        NULL
    END AS drop_date_part
  FROM `uber-data-engineering-407103`.`uber`.`uber_tlc_trip_recrord_data`
  WHERE tpep_pickup_datetime IS NOT NULL
    AND tpep_dropoff_datetime IS NOT NULL
)
SELECT
  datetime_id,
  pick_date_part AS tpep_pickup_datetime,
  drop_date_part AS tpep_dropoff_datetime,
  EXTRACT(HOUR FROM pick_date_part) AS pick_hour,
  EXTRACT(DAY FROM pick_date_part) AS pick_day,
  EXTRACT(MONTH FROM pick_date_part) AS pick_month,
  EXTRACT(YEAR FROM pick_date_part) AS pick_year,
  EXTRACT(DAYOFWEEK FROM pick_date_part) AS pick_weekday,
  EXTRACT(HOUR FROM drop_date_part) AS drop_hour,
  EXTRACT(DAY FROM drop_date_part) AS drop_day,
  EXTRACT(MONTH FROM drop_date_part) AS drop_month,
  EXTRACT(YEAR FROM drop_date_part) AS drop_year,
  EXTRACT(DAYOFWEEK FROM drop_date_part) AS drop_weekday
FROM datetime_cte;
    );
  
[0m01:41:54.905434 [debug] [Thread-1 (]: BigQuery adapter: Retry attempt 1 of 1 after error: BadRequest('Syntax error: Expected ")" but got ";" at [54:18]')
[0m01:41:56.133677 [error] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=uber-data-engineering-407103&j=bq:US:21ddd9ca-6153-4f98-860c-e1b38ddfcb7f&page=queryresults
[0m01:41:56.135065 [debug] [Thread-1 (]: Timing info for model.uber.datetime_dim (execute): 01:41:54.334552 => 01:41:56.134856
[0m01:41:56.142668 [debug] [Thread-1 (]: Database Error in model datetime_dim (models/transform/datetime_dim.sql)
  Syntax error: Expected ")" but got ";" at [54:18]
  compiled Code at target/run/uber/models/transform/datetime_dim.sql
[0m01:41:56.143270 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '27cb2fb8-f39b-4ab1-93cd-3845cc7ada2e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff8a04b110>]}
[0m01:41:56.144020 [error] [Thread-1 (]: 1 of 1 ERROR creating sql table model uber.datetime_dim ........................ [[31mERROR[0m in 1.82s]
[0m01:41:56.144809 [debug] [Thread-1 (]: Finished running node model.uber.datetime_dim
[0m01:41:56.146516 [debug] [MainThread]: Connection 'master' was properly closed.
[0m01:41:56.146959 [debug] [MainThread]: Connection 'model.uber.datetime_dim' was properly closed.
[0m01:41:56.147396 [info ] [MainThread]: 
[0m01:41:56.147988 [info ] [MainThread]: Finished running 1 table model in 0 hours 0 minutes and 3.52 seconds (3.52s).
[0m01:41:56.148704 [debug] [MainThread]: Command end result
[0m01:41:56.160279 [info ] [MainThread]: 
[0m01:41:56.161107 [info ] [MainThread]: [31mCompleted with 1 error and 0 warnings:[0m
[0m01:41:56.161708 [info ] [MainThread]: 
[0m01:41:56.162428 [error] [MainThread]: [33mDatabase Error in model datetime_dim (models/transform/datetime_dim.sql)[0m
[0m01:41:56.163066 [error] [MainThread]:   Syntax error: Expected ")" but got ";" at [54:18]
[0m01:41:56.163794 [error] [MainThread]:   compiled Code at target/run/uber/models/transform/datetime_dim.sql
[0m01:41:56.164558 [info ] [MainThread]: 
[0m01:41:56.165304 [info ] [MainThread]: Done. PASS=0 WARN=0 ERROR=1 SKIP=0 TOTAL=1
[0m01:41:56.166293 [debug] [MainThread]: Command `dbt run` failed at 01:41:56.166164 after 4.83 seconds
[0m01:41:56.167003 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff8c660b90>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff8c663450>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff8c673cd0>]}
[0m01:41:56.170157 [debug] [MainThread]: Flushing usage events
[0m01:43:09.438952 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xfffface31cd0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffab9d5550>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffab2c5090>]}


============================== 01:43:09.444233 | fd822285-551f-4fb5-949a-f83433df003d ==============================
[0m01:43:09.444233 [info ] [MainThread]: Running with dbt=1.5.9
[0m01:43:09.445152 [debug] [MainThread]: running dbt with arguments {'quiet': 'False', 'use_experimental_parser': 'False', 'write_json': 'True', 'no_print': 'None', 'version_check': 'True', 'cache_selected_only': 'False', 'introspect': 'True', 'log_cache_events': 'False', 'debug': 'False', 'fail_fast': 'False', 'warn_error': 'None', 'partial_parse': 'True', 'log_path': '/usr/local/airflow/include/dbt/logs', 'target_path': 'None', 'use_colors': 'True', 'printer_width': '80', 'indirect_selection': 'eager', 'log_format': 'default', 'send_anonymous_usage_stats': 'True', 'profiles_dir': '/usr/local/airflow/include/dbt/', 'static_parser': 'True', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])'}
[0m01:43:09.836413 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'fd822285-551f-4fb5-949a-f83433df003d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffa9767450>]}
[0m01:43:09.847895 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'fd822285-551f-4fb5-949a-f83433df003d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffabb2f1d0>]}
[0m01:43:09.849038 [info ] [MainThread]: Registered adapter: bigquery=1.5.3
[0m01:43:09.864585 [debug] [MainThread]: checksum: dd837546c89c9d03f3c2cb0ca6165266a30da6076d5d44e9991f7c5a8e5f5831, vars: {}, profile: , target: , version: 1.5.9
[0m01:43:09.925988 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m01:43:09.926718 [debug] [MainThread]: Partial parsing: updated file: uber://models/transform/datetime_dim.sql
[0m01:43:09.945265 [debug] [MainThread]: 1699: static parser successfully parsed transform/datetime_dim.sql
[0m01:43:09.964221 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'fd822285-551f-4fb5-949a-f83433df003d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffa964efd0>]}
[0m01:43:09.975966 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'fd822285-551f-4fb5-949a-f83433df003d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffa9608990>]}
[0m01:43:09.976573 [info ] [MainThread]: Found 2 models, 0 tests, 0 snapshots, 0 analyses, 474 macros, 0 operations, 0 seed files, 1 source, 0 exposures, 0 metrics, 0 groups
[0m01:43:09.977271 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'fd822285-551f-4fb5-949a-f83433df003d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffae687490>]}
[0m01:43:09.978515 [info ] [MainThread]: 
[0m01:43:09.979501 [debug] [MainThread]: Acquiring new bigquery connection 'master'
[0m01:43:09.980767 [debug] [ThreadPool]: Acquiring new bigquery connection 'list_uber-data-engineering-407103'
[0m01:43:09.981251 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m01:43:10.433044 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_uber-data-engineering-407103, now list_uber-data-engineering-407103_uber)
[0m01:43:10.434317 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m01:43:10.961309 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'fd822285-551f-4fb5-949a-f83433df003d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffab6a4850>]}
[0m01:43:10.964940 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m01:43:10.966854 [info ] [MainThread]: 
[0m01:43:10.996053 [debug] [Thread-1 (]: Began running node model.uber.datetime_dim
[0m01:43:10.997371 [info ] [Thread-1 (]: 1 of 1 START sql table model uber.datetime_dim ................................. [RUN]
[0m01:43:10.998855 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_uber-data-engineering-407103_uber, now model.uber.datetime_dim)
[0m01:43:10.999711 [debug] [Thread-1 (]: Began compiling node model.uber.datetime_dim
[0m01:43:11.008281 [debug] [Thread-1 (]: Writing injected SQL for node "model.uber.datetime_dim"
[0m01:43:11.011036 [debug] [Thread-1 (]: Timing info for model.uber.datetime_dim (compile): 01:43:11.000440 => 01:43:11.010766
[0m01:43:11.011654 [debug] [Thread-1 (]: Began executing node model.uber.datetime_dim
[0m01:43:11.043035 [debug] [Thread-1 (]: Writing runtime sql for node "model.uber.datetime_dim"
[0m01:43:11.045144 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m01:43:11.047069 [debug] [Thread-1 (]: On model.uber.datetime_dim: /* {"app": "dbt", "dbt_version": "1.5.9", "profile_name": "uber", "target_name": "dev", "node_id": "model.uber.datetime_dim"} */

  
    

    create or replace table `uber-data-engineering-407103`.`uber`.`datetime_dim`
    
    

    OPTIONS()
    as (
      WITH datetime_cte AS (  
  SELECT DISTINCT
    tpep_pickup_datetime AS datetime_id,
    CASE
      WHEN LENGTH(tpep_pickup_datetime) = 16 THEN
        -- Date format: "DD/MM/YYYY HH:MM"
        PARSE_DATETIME('%m/%d/%Y %H:%M', tpep_pickup_datetime)
      WHEN LENGTH(tpep_pickup_datetime) <= 14 THEN
        -- Date format: "MM/DD/YY HH:MM"
        PARSE_DATETIME('%m/%d/%y %H:%M', tpep_pickup_datetime)
      ELSE
        NULL
    END AS pick_date_part,
    tpep_dropoff_datetime AS drop_datetime_id,
    CASE
      WHEN LENGTH(tpep_dropoff_datetime) = 16 THEN
        -- Date format: "DD/MM/YYYY HH:MM"
        PARSE_DATETIME('%m/%d/%Y %H:%M', tpep_dropoff_datetime)
      WHEN LENGTH(tpep_dropoff_datetime) <= 14 THEN
        -- Date format: "MM/DD/YY HH:MM"
        PARSE_DATETIME('%m/%d/%y %H:%M', tpep_dropoff_datetime)
      ELSE
        NULL
    END AS drop_date_part
  FROM `uber-data-engineering-407103`.`uber`.`uber_tlc_trip_recrord_data`
  WHERE tpep_pickup_datetime IS NOT NULL
    AND tpep_dropoff_datetime IS NOT NULL
)
SELECT
  datetime_id,
  pick_date_part AS tpep_pickup_datetime,
  drop_date_part AS tpep_dropoff_datetime,
  EXTRACT(HOUR FROM pick_date_part) AS pick_hour,
  EXTRACT(DAY FROM pick_date_part) AS pick_day,
  EXTRACT(MONTH FROM pick_date_part) AS pick_month,
  EXTRACT(YEAR FROM pick_date_part) AS pick_year,
  EXTRACT(DAYOFWEEK FROM pick_date_part) AS pick_weekday,
  EXTRACT(HOUR FROM drop_date_part) AS drop_hour,
  EXTRACT(DAY FROM drop_date_part) AS drop_day,
  EXTRACT(MONTH FROM drop_date_part) AS drop_month,
  EXTRACT(YEAR FROM drop_date_part) AS drop_year,
  EXTRACT(DAYOFWEEK FROM drop_date_part) AS drop_weekday
FROM datetime_cte
    );
  
[0m01:43:15.150823 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=uber-data-engineering-407103&j=bq:US:324e0140-280f-471a-a0d3-d9a07dd58d58&page=queryresults
[0m01:43:15.181326 [debug] [Thread-1 (]: Timing info for model.uber.datetime_dim (execute): 01:43:11.012101 => 01:43:15.180982
[0m01:43:15.183301 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'fd822285-551f-4fb5-949a-f83433df003d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffa9770610>]}
[0m01:43:15.184596 [info ] [Thread-1 (]: 1 of 1 OK created sql table model uber.datetime_dim ............................ [[32mCREATE TABLE (99.9k rows, 4.0 MiB processed)[0m in 4.18s]
[0m01:43:15.186379 [debug] [Thread-1 (]: Finished running node model.uber.datetime_dim
[0m01:43:15.189229 [debug] [MainThread]: Connection 'master' was properly closed.
[0m01:43:15.189986 [debug] [MainThread]: Connection 'model.uber.datetime_dim' was properly closed.
[0m01:43:15.190771 [info ] [MainThread]: 
[0m01:43:15.192039 [info ] [MainThread]: Finished running 1 table model in 0 hours 0 minutes and 5.21 seconds (5.21s).
[0m01:43:15.193327 [debug] [MainThread]: Command end result
[0m01:43:15.207676 [info ] [MainThread]: 
[0m01:43:15.208688 [info ] [MainThread]: [32mCompleted successfully[0m
[0m01:43:15.209940 [info ] [MainThread]: 
[0m01:43:15.211195 [info ] [MainThread]: Done. PASS=1 WARN=0 ERROR=0 SKIP=0 TOTAL=1
[0m01:43:15.212533 [debug] [MainThread]: Command `dbt run` succeeded at 01:43:15.212354 after 5.78 seconds
[0m01:43:15.213258 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffab19e150>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffaf632210>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffab80bad0>]}
[0m01:43:15.213932 [debug] [MainThread]: Flushing usage events
[0m21:07:30.141464 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffb3f89590>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffb3fac290>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffb3faca90>]}


============================== 21:07:30.149075 | f0b021ca-683d-4a59-b0b2-ca1669f02c7b ==============================
[0m21:07:30.149075 [info ] [MainThread]: Running with dbt=1.5.9
[0m21:07:30.150094 [debug] [MainThread]: running dbt with arguments {'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'log_cache_events': 'False', 'write_json': 'True', 'debug': 'False', 'indirect_selection': 'eager', 'fail_fast': 'False', 'version_check': 'True', 'send_anonymous_usage_stats': 'True', 'quiet': 'False', 'printer_width': '80', 'log_format': 'default', 'warn_error': 'None', 'log_path': '/usr/local/airflow/include/dbt/logs', 'target_path': 'None', 'no_print': 'None', 'cache_selected_only': 'False', 'use_colors': 'True', 'introspect': 'True', 'partial_parse': 'True', 'use_experimental_parser': 'False', 'profiles_dir': '/usr/local/airflow/include/dbt/', 'static_parser': 'True'}
[0m21:07:30.967342 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'f0b021ca-683d-4a59-b0b2-ca1669f02c7b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffb1bb7310>]}
[0m21:07:30.979874 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'f0b021ca-683d-4a59-b0b2-ca1669f02c7b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffb3c901d0>]}
[0m21:07:30.980928 [info ] [MainThread]: Registered adapter: bigquery=1.5.3
[0m21:07:31.002438 [debug] [MainThread]: checksum: dd837546c89c9d03f3c2cb0ca6165266a30da6076d5d44e9991f7c5a8e5f5831, vars: {}, profile: , target: , version: 1.5.9
[0m21:07:31.101680 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 5 files added, 1 files changed.
[0m21:07:31.102690 [debug] [MainThread]: Partial parsing: added file: uber://models/transform/trip_distance.sql
[0m21:07:31.103176 [debug] [MainThread]: Partial parsing: added file: uber://models/transform/rate_code_dim.sql
[0m21:07:31.103617 [debug] [MainThread]: Partial parsing: added file: uber://models/transform/pickup_location_dim.sql
[0m21:07:31.104065 [debug] [MainThread]: Partial parsing: added file: uber://models/transform/payment_type_dim.sql
[0m21:07:31.104505 [debug] [MainThread]: Partial parsing: added file: uber://models/transform/dropoff_location_dim.sql
[0m21:07:31.105011 [debug] [MainThread]: Partial parsing: updated file: uber://models/transform/passenger_count_dim.sql
[0m21:07:31.124754 [debug] [MainThread]: 1603: static parser failed on transform/trip_distance.sql
[0m21:07:31.130878 [error] [MainThread]: Encountered an error:
Compilation Error in model trip_distance (models/transform/trip_distance.sql)
  macro 'dbt_macro__generate_series' takes not more than 1 argument(s)
[0m21:07:31.131979 [debug] [MainThread]: Command `dbt run` failed at 21:07:31.131763 after 1.01 seconds
[0m21:07:31.132553 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffb3f3f590>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffb3f9f890>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffb3f9c7d0>]}
[0m21:07:31.133173 [debug] [MainThread]: Flushing usage events
[0m21:08:49.573280 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffa5888350>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffa51de9d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffa5a12090>]}


============================== 21:08:49.578430 | 235ff364-f18c-465d-ae11-479e955a2c16 ==============================
[0m21:08:49.578430 [info ] [MainThread]: Running with dbt=1.5.9
[0m21:08:49.579320 [debug] [MainThread]: running dbt with arguments {'introspect': 'True', 'quiet': 'False', 'log_path': '/usr/local/airflow/include/dbt/logs', 'no_print': 'None', 'version_check': 'True', 'cache_selected_only': 'False', 'printer_width': '80', 'write_json': 'True', 'log_format': 'default', 'use_colors': 'True', 'static_parser': 'True', 'debug': 'False', 'target_path': 'None', 'indirect_selection': 'eager', 'profiles_dir': '/usr/local/airflow/include/dbt/', 'fail_fast': 'False', 'partial_parse': 'True', 'log_cache_events': 'False', 'send_anonymous_usage_stats': 'True', 'warn_error': 'None', 'use_experimental_parser': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])'}
[0m21:08:50.029162 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '235ff364-f18c-465d-ae11-479e955a2c16', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffa380b810>]}
[0m21:08:50.041012 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '235ff364-f18c-465d-ae11-479e955a2c16', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffa46241d0>]}
[0m21:08:50.041615 [info ] [MainThread]: Registered adapter: bigquery=1.5.3
[0m21:08:50.057036 [debug] [MainThread]: checksum: dd837546c89c9d03f3c2cb0ca6165266a30da6076d5d44e9991f7c5a8e5f5831, vars: {}, profile: , target: , version: 1.5.9
[0m21:08:50.130868 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 5 files added, 1 files changed.
[0m21:08:50.131741 [debug] [MainThread]: Partial parsing: added file: uber://models/transform/pickup_location_dim.sql
[0m21:08:50.132231 [debug] [MainThread]: Partial parsing: added file: uber://models/transform/dropoff_location_dim.sql
[0m21:08:50.132705 [debug] [MainThread]: Partial parsing: added file: uber://models/transform/trip_distance.sql
[0m21:08:50.133155 [debug] [MainThread]: Partial parsing: added file: uber://models/transform/rate_code_dim.sql
[0m21:08:50.133555 [debug] [MainThread]: Partial parsing: added file: uber://models/transform/payment_type_dim.sql
[0m21:08:50.133999 [debug] [MainThread]: Partial parsing: updated file: uber://models/transform/passenger_count_dim.sql
[0m21:08:50.152659 [debug] [MainThread]: 1603: static parser failed on transform/pickup_location_dim.sql
[0m21:08:50.159067 [error] [MainThread]: Encountered an error:
Compilation Error in model pickup_location_dim (models/transform/pickup_location_dim.sql)
  macro 'dbt_macro__generate_series' takes not more than 1 argument(s)
[0m21:08:50.160356 [debug] [MainThread]: Command `dbt run` failed at 21:08:50.160173 after 0.60 seconds
[0m21:08:50.161024 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffa56e54d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffa51e8210>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffa56debd0>]}
[0m21:08:50.161644 [debug] [MainThread]: Flushing usage events
[0m21:09:16.847013 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff8b0e1450>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff8b393f50>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff8b3c0d10>]}


============================== 21:09:16.852751 | 8c0e2222-c8f9-44e9-8025-4d831c71142b ==============================
[0m21:09:16.852751 [info ] [MainThread]: Running with dbt=1.5.9
[0m21:09:16.853581 [debug] [MainThread]: running dbt with arguments {'debug': 'False', 'cache_selected_only': 'False', 'partial_parse': 'True', 'log_path': '/usr/local/airflow/include/dbt/logs', 'warn_error': 'None', 'target_path': 'None', 'indirect_selection': 'eager', 'printer_width': '80', 'version_check': 'True', 'quiet': 'False', 'no_print': 'None', 'use_colors': 'True', 'use_experimental_parser': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'fail_fast': 'False', 'profiles_dir': '/usr/local/airflow/include/dbt/', 'static_parser': 'True', 'log_format': 'default', 'log_cache_events': 'False', 'write_json': 'True', 'introspect': 'True', 'send_anonymous_usage_stats': 'True'}
[0m21:09:17.340666 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '8c0e2222-c8f9-44e9-8025-4d831c71142b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff8ab22f50>]}
[0m21:09:17.352418 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '8c0e2222-c8f9-44e9-8025-4d831c71142b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff8ab233d0>]}
[0m21:09:17.353105 [info ] [MainThread]: Registered adapter: bigquery=1.5.3
[0m21:09:17.367894 [debug] [MainThread]: checksum: dd837546c89c9d03f3c2cb0ca6165266a30da6076d5d44e9991f7c5a8e5f5831, vars: {}, profile: , target: , version: 1.5.9
[0m21:09:17.461658 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 5 files added, 1 files changed.
[0m21:09:17.462452 [debug] [MainThread]: Partial parsing: added file: uber://models/transform/rate_code_dim.sql
[0m21:09:17.462952 [debug] [MainThread]: Partial parsing: added file: uber://models/transform/pickup_location_dim.sql
[0m21:09:17.463401 [debug] [MainThread]: Partial parsing: added file: uber://models/transform/payment_type_dim.sql
[0m21:09:17.463850 [debug] [MainThread]: Partial parsing: added file: uber://models/transform/dropoff_location_dim.sql
[0m21:09:17.464286 [debug] [MainThread]: Partial parsing: added file: uber://models/transform/trip_distance.sql
[0m21:09:17.464742 [debug] [MainThread]: Partial parsing: updated file: uber://models/transform/passenger_count_dim.sql
[0m21:09:17.485286 [debug] [MainThread]: 1699: static parser successfully parsed transform/rate_code_dim.sql
[0m21:09:17.496487 [debug] [MainThread]: 1603: static parser failed on transform/pickup_location_dim.sql
[0m21:09:17.500892 [error] [MainThread]: Encountered an error:
Compilation Error in model pickup_location_dim (models/transform/pickup_location_dim.sql)
  macro 'dbt_macro__generate_series' takes not more than 1 argument(s)
[0m21:09:17.501985 [debug] [MainThread]: Command `dbt run` failed at 21:09:17.501839 after 0.66 seconds
[0m21:09:17.502570 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff8b0b94d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff8b0ab2d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff88f22310>]}
[0m21:09:17.503145 [debug] [MainThread]: Flushing usage events
[0m21:10:32.105987 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffba4bb150>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffbb185f50>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffbab34cd0>]}


============================== 21:10:32.112495 | 8945b254-ea8a-4690-8d36-1b27a8fbd011 ==============================
[0m21:10:32.112495 [info ] [MainThread]: Running with dbt=1.5.9
[0m21:10:32.113577 [debug] [MainThread]: running dbt with arguments {'no_print': 'None', 'target_path': 'None', 'write_json': 'True', 'send_anonymous_usage_stats': 'True', 'log_format': 'default', 'version_check': 'True', 'use_experimental_parser': 'False', 'warn_error': 'None', 'static_parser': 'True', 'use_colors': 'True', 'profiles_dir': '/usr/local/airflow/include/dbt/', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'printer_width': '80', 'indirect_selection': 'eager', 'quiet': 'False', 'introspect': 'True', 'fail_fast': 'False', 'log_cache_events': 'False', 'debug': 'False', 'log_path': '/usr/local/airflow/include/dbt/logs', 'cache_selected_only': 'False', 'partial_parse': 'True'}
[0m21:10:32.527960 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '8945b254-ea8a-4690-8d36-1b27a8fbd011', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffbab413d0>]}
[0m21:10:32.542172 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '8945b254-ea8a-4690-8d36-1b27a8fbd011', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffbab63690>]}
[0m21:10:32.543728 [info ] [MainThread]: Registered adapter: bigquery=1.5.3
[0m21:10:32.566607 [debug] [MainThread]: checksum: dd837546c89c9d03f3c2cb0ca6165266a30da6076d5d44e9991f7c5a8e5f5831, vars: {}, profile: , target: , version: 1.5.9
[0m21:10:32.632192 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 5 files added, 1 files changed.
[0m21:10:32.632963 [debug] [MainThread]: Partial parsing: added file: uber://models/transform/pickup_location_dim.sql
[0m21:10:32.633460 [debug] [MainThread]: Partial parsing: added file: uber://models/transform/payment_type_dim.sql
[0m21:10:32.633906 [debug] [MainThread]: Partial parsing: added file: uber://models/transform/rate_code_dim.sql
[0m21:10:32.634304 [debug] [MainThread]: Partial parsing: added file: uber://models/transform/dropoff_location_dim.sql
[0m21:10:32.634753 [debug] [MainThread]: Partial parsing: added file: uber://models/transform/trip_distance.sql
[0m21:10:32.635319 [debug] [MainThread]: Partial parsing: updated file: uber://models/transform/passenger_count_dim.sql
[0m21:10:32.653747 [debug] [MainThread]: 1603: static parser failed on transform/pickup_location_dim.sql
[0m21:10:32.658697 [error] [MainThread]: Encountered an error:
Compilation Error in model pickup_location_dim (models/transform/pickup_location_dim.sql)
  macro 'dbt_macro__generate_series' takes not more than 1 argument(s)
[0m21:10:32.659586 [debug] [MainThread]: Command `dbt run` failed at 21:10:32.659452 after 0.57 seconds
[0m21:10:32.660129 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffba4dab10>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffba4d2390>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffb8aa2810>]}
[0m21:10:32.660643 [debug] [MainThread]: Flushing usage events
[0m21:10:54.141330 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff929055d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff928d7f50>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff92639590>]}


============================== 21:10:54.147707 | cbddf6b8-3210-4490-90a3-e4d78bc967ec ==============================
[0m21:10:54.147707 [info ] [MainThread]: Running with dbt=1.5.9
[0m21:10:54.148948 [debug] [MainThread]: running dbt with arguments {'use_colors': 'True', 'fail_fast': 'False', 'version_check': 'True', 'log_cache_events': 'False', 'log_format': 'default', 'printer_width': '80', 'warn_error': 'None', 'quiet': 'False', 'use_experimental_parser': 'False', 'profiles_dir': '/usr/local/airflow/include/dbt/', 'indirect_selection': 'eager', 'static_parser': 'True', 'write_json': 'True', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'target_path': 'None', 'debug': 'False', 'log_path': '/usr/local/airflow/include/dbt/logs', 'send_anonymous_usage_stats': 'True', 'cache_selected_only': 'False', 'no_print': 'None', 'partial_parse': 'True', 'introspect': 'True'}
[0m21:10:54.591177 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'cbddf6b8-3210-4490-90a3-e4d78bc967ec', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff9056c790>]}
[0m21:10:54.619972 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'cbddf6b8-3210-4490-90a3-e4d78bc967ec', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff92912dd0>]}
[0m21:10:54.621799 [info ] [MainThread]: Registered adapter: bigquery=1.5.3
[0m21:10:54.641572 [debug] [MainThread]: checksum: dd837546c89c9d03f3c2cb0ca6165266a30da6076d5d44e9991f7c5a8e5f5831, vars: {}, profile: , target: , version: 1.5.9
[0m21:10:54.710516 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 5 files added, 1 files changed.
[0m21:10:54.711262 [debug] [MainThread]: Partial parsing: added file: uber://models/transform/payment_type_dim.sql
[0m21:10:54.711750 [debug] [MainThread]: Partial parsing: added file: uber://models/transform/rate_code_dim.sql
[0m21:10:54.712158 [debug] [MainThread]: Partial parsing: added file: uber://models/transform/trip_distance.sql
[0m21:10:54.712593 [debug] [MainThread]: Partial parsing: added file: uber://models/transform/pickup_location_dim.sql
[0m21:10:54.713023 [debug] [MainThread]: Partial parsing: added file: uber://models/transform/dropoff_location_dim.sql
[0m21:10:54.713481 [debug] [MainThread]: Partial parsing: updated file: uber://models/transform/passenger_count_dim.sql
[0m21:10:54.732651 [debug] [MainThread]: 1699: static parser successfully parsed transform/payment_type_dim.sql
[0m21:10:54.743694 [debug] [MainThread]: 1699: static parser successfully parsed transform/rate_code_dim.sql
[0m21:10:54.746882 [debug] [MainThread]: 1603: static parser failed on transform/trip_distance.sql
[0m21:10:54.758006 [debug] [MainThread]: 1602: parser fallback to jinja rendering on transform/trip_distance.sql
[0m21:10:54.759905 [debug] [MainThread]: 1603: static parser failed on transform/pickup_location_dim.sql
[0m21:10:54.764477 [debug] [MainThread]: 1602: parser fallback to jinja rendering on transform/pickup_location_dim.sql
[0m21:10:54.766254 [debug] [MainThread]: 1603: static parser failed on transform/dropoff_location_dim.sql
[0m21:10:54.769631 [error] [MainThread]: Encountered an error:
Compilation Error in model dropoff_location_dim (models/transform/dropoff_location_dim.sql)
  macro 'dbt_macro__generate_series' takes not more than 1 argument(s)
[0m21:10:54.770633 [debug] [MainThread]: Command `dbt run` failed at 21:10:54.770502 after 0.64 seconds
[0m21:10:54.771190 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff91f91b90>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff928d78d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff9038b790>]}
[0m21:10:54.771738 [debug] [MainThread]: Flushing usage events
[0m21:11:22.403767 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffba5cfc10>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffb9cc37d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffba423950>]}


============================== 21:11:22.409391 | 2b33a280-6d40-4a19-b127-96813ac19442 ==============================
[0m21:11:22.409391 [info ] [MainThread]: Running with dbt=1.5.9
[0m21:11:22.410353 [debug] [MainThread]: running dbt with arguments {'partial_parse': 'True', 'warn_error': 'None', 'version_check': 'True', 'use_experimental_parser': 'False', 'cache_selected_only': 'False', 'send_anonymous_usage_stats': 'True', 'fail_fast': 'False', 'write_json': 'True', 'introspect': 'True', 'log_cache_events': 'False', 'profiles_dir': '/usr/local/airflow/include/dbt/', 'indirect_selection': 'eager', 'target_path': 'None', 'quiet': 'False', 'no_print': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'debug': 'False', 'use_colors': 'True', 'log_format': 'default', 'static_parser': 'True', 'log_path': '/usr/local/airflow/include/dbt/logs', 'printer_width': '80'}
[0m21:11:22.829081 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '2b33a280-6d40-4a19-b127-96813ac19442', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffb9ae85d0>]}
[0m21:11:22.840562 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '2b33a280-6d40-4a19-b127-96813ac19442', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffb9b083d0>]}
[0m21:11:22.841486 [info ] [MainThread]: Registered adapter: bigquery=1.5.3
[0m21:11:22.857420 [debug] [MainThread]: checksum: dd837546c89c9d03f3c2cb0ca6165266a30da6076d5d44e9991f7c5a8e5f5831, vars: {}, profile: , target: , version: 1.5.9
[0m21:11:22.919461 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 5 files added, 1 files changed.
[0m21:11:22.920230 [debug] [MainThread]: Partial parsing: added file: uber://models/transform/payment_type_dim.sql
[0m21:11:22.920725 [debug] [MainThread]: Partial parsing: added file: uber://models/transform/rate_code_dim.sql
[0m21:11:22.921182 [debug] [MainThread]: Partial parsing: added file: uber://models/transform/dropoff_location_dim.sql
[0m21:11:22.921618 [debug] [MainThread]: Partial parsing: added file: uber://models/transform/trip_distance.sql
[0m21:11:22.922031 [debug] [MainThread]: Partial parsing: added file: uber://models/transform/pickup_location_dim.sql
[0m21:11:22.922521 [debug] [MainThread]: Partial parsing: updated file: uber://models/transform/passenger_count_dim.sql
[0m21:11:22.940376 [debug] [MainThread]: 1603: static parser failed on transform/payment_type_dim.sql
[0m21:11:22.958557 [debug] [MainThread]: 1602: parser fallback to jinja rendering on transform/payment_type_dim.sql
[0m21:11:22.960501 [debug] [MainThread]: 1603: static parser failed on transform/rate_code_dim.sql
[0m21:11:22.964909 [debug] [MainThread]: 1602: parser fallback to jinja rendering on transform/rate_code_dim.sql
[0m21:11:22.966697 [debug] [MainThread]: 1603: static parser failed on transform/dropoff_location_dim.sql
[0m21:11:22.971255 [debug] [MainThread]: 1602: parser fallback to jinja rendering on transform/dropoff_location_dim.sql
[0m21:11:22.973087 [debug] [MainThread]: 1603: static parser failed on transform/trip_distance.sql
[0m21:11:22.978643 [debug] [MainThread]: 1602: parser fallback to jinja rendering on transform/trip_distance.sql
[0m21:11:22.980774 [debug] [MainThread]: 1603: static parser failed on transform/pickup_location_dim.sql
[0m21:11:22.989884 [debug] [MainThread]: 1602: parser fallback to jinja rendering on transform/pickup_location_dim.sql
[0m21:11:22.992398 [debug] [MainThread]: 1603: static parser failed on transform/passenger_count_dim.sql
[0m21:11:23.009393 [debug] [MainThread]: 1602: parser fallback to jinja rendering on transform/passenger_count_dim.sql
[0m21:11:23.022508 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '2b33a280-6d40-4a19-b127-96813ac19442', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffb8091990>]}
[0m21:11:23.039554 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '2b33a280-6d40-4a19-b127-96813ac19442', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffb7d92090>]}
[0m21:11:23.040230 [info ] [MainThread]: Found 7 models, 0 tests, 0 snapshots, 0 analyses, 474 macros, 0 operations, 0 seed files, 1 source, 0 exposures, 0 metrics, 0 groups
[0m21:11:23.040953 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '2b33a280-6d40-4a19-b127-96813ac19442', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffbcfcfa10>]}
[0m21:11:23.042605 [info ] [MainThread]: 
[0m21:11:23.043824 [debug] [MainThread]: Acquiring new bigquery connection 'master'
[0m21:11:23.045735 [debug] [ThreadPool]: Acquiring new bigquery connection 'list_uber-data-engineering-407103'
[0m21:11:23.046272 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m21:11:25.461871 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_uber-data-engineering-407103, now list_uber-data-engineering-407103_uber)
[0m21:11:25.466111 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m21:11:25.975160 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '2b33a280-6d40-4a19-b127-96813ac19442', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffb7ede310>]}
[0m21:11:25.979138 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m21:11:25.981162 [info ] [MainThread]: 
[0m21:11:26.033305 [debug] [Thread-1 (]: Began running node model.uber.datetime_dim
[0m21:11:26.037058 [info ] [Thread-1 (]: 1 of 7 START sql table model uber.datetime_dim ................................. [RUN]
[0m21:11:26.040333 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_uber-data-engineering-407103_uber, now model.uber.datetime_dim)
[0m21:11:26.041531 [debug] [Thread-1 (]: Began compiling node model.uber.datetime_dim
[0m21:11:26.060947 [debug] [Thread-1 (]: Writing injected SQL for node "model.uber.datetime_dim"
[0m21:11:26.064845 [debug] [Thread-1 (]: Timing info for model.uber.datetime_dim (compile): 21:11:26.042443 => 21:11:26.064442
[0m21:11:26.065487 [debug] [Thread-1 (]: Began executing node model.uber.datetime_dim
[0m21:11:26.083209 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m21:11:26.849624 [debug] [Thread-1 (]: Writing runtime sql for node "model.uber.datetime_dim"
[0m21:11:26.853149 [debug] [Thread-1 (]: On model.uber.datetime_dim: /* {"app": "dbt", "dbt_version": "1.5.9", "profile_name": "uber", "target_name": "dev", "node_id": "model.uber.datetime_dim"} */

  
    

    create or replace table `uber-data-engineering-407103`.`uber`.`datetime_dim`
    
    

    OPTIONS()
    as (
      WITH datetime_cte AS (  
  SELECT DISTINCT
    tpep_pickup_datetime AS datetime_id,
    CASE
      WHEN LENGTH(tpep_pickup_datetime) = 16 THEN
        -- Date format: "DD/MM/YYYY HH:MM"
        PARSE_DATETIME('%m/%d/%Y %H:%M', tpep_pickup_datetime)
      WHEN LENGTH(tpep_pickup_datetime) <= 14 THEN
        -- Date format: "MM/DD/YY HH:MM"
        PARSE_DATETIME('%m/%d/%y %H:%M', tpep_pickup_datetime)
      ELSE
        NULL
    END AS pick_date_part,
    tpep_dropoff_datetime AS drop_datetime_id,
    CASE
      WHEN LENGTH(tpep_dropoff_datetime) = 16 THEN
        -- Date format: "DD/MM/YYYY HH:MM"
        PARSE_DATETIME('%m/%d/%Y %H:%M', tpep_dropoff_datetime)
      WHEN LENGTH(tpep_dropoff_datetime) <= 14 THEN
        -- Date format: "MM/DD/YY HH:MM"
        PARSE_DATETIME('%m/%d/%y %H:%M', tpep_dropoff_datetime)
      ELSE
        NULL
    END AS drop_date_part
  FROM `uber-data-engineering-407103`.`uber`.`uber_tlc_trip_recrord_data`
  WHERE tpep_pickup_datetime IS NOT NULL
    AND tpep_dropoff_datetime IS NOT NULL
)
SELECT
  datetime_id,
  pick_date_part AS tpep_pickup_datetime,
  drop_date_part AS tpep_dropoff_datetime,
  EXTRACT(HOUR FROM pick_date_part) AS pick_hour,
  EXTRACT(DAY FROM pick_date_part) AS pick_day,
  EXTRACT(MONTH FROM pick_date_part) AS pick_month,
  EXTRACT(YEAR FROM pick_date_part) AS pick_year,
  EXTRACT(DAYOFWEEK FROM pick_date_part) AS pick_weekday,
  EXTRACT(HOUR FROM drop_date_part) AS drop_hour,
  EXTRACT(DAY FROM drop_date_part) AS drop_day,
  EXTRACT(MONTH FROM drop_date_part) AS drop_month,
  EXTRACT(YEAR FROM drop_date_part) AS drop_year,
  EXTRACT(DAYOFWEEK FROM drop_date_part) AS drop_weekday
FROM datetime_cte
    );
  
[0m21:11:30.377157 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=uber-data-engineering-407103&j=bq:US:3cc8af73-b262-4cb0-ada2-7beccd75ee9a&page=queryresults
[0m21:11:30.426142 [debug] [Thread-1 (]: Timing info for model.uber.datetime_dim (execute): 21:11:26.065971 => 21:11:30.425414
[0m21:11:30.440669 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '2b33a280-6d40-4a19-b127-96813ac19442', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffb7d92b90>]}
[0m21:11:30.447166 [info ] [Thread-1 (]: 1 of 7 OK created sql table model uber.datetime_dim ............................ [[32mCREATE TABLE (99.9k rows, 4.0 MiB processed)[0m in 4.39s]
[0m21:11:30.457345 [debug] [Thread-1 (]: Finished running node model.uber.datetime_dim
[0m21:11:30.460132 [debug] [Thread-1 (]: Began running node model.uber.dropoff_location_dim
[0m21:11:30.462044 [info ] [Thread-1 (]: 2 of 7 START sql table model uber.dropoff_location_dim ......................... [RUN]
[0m21:11:30.463481 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.uber.datetime_dim, now model.uber.dropoff_location_dim)
[0m21:11:30.464340 [debug] [Thread-1 (]: Began compiling node model.uber.dropoff_location_dim
[0m21:11:30.472022 [debug] [Thread-1 (]: Writing injected SQL for node "model.uber.dropoff_location_dim"
[0m21:11:30.477526 [debug] [Thread-1 (]: Timing info for model.uber.dropoff_location_dim (compile): 21:11:30.464868 => 21:11:30.477289
[0m21:11:30.478174 [debug] [Thread-1 (]: Began executing node model.uber.dropoff_location_dim
[0m21:11:30.481827 [debug] [Thread-1 (]: Writing runtime sql for node "model.uber.dropoff_location_dim"
[0m21:11:30.483702 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m21:11:30.490686 [debug] [Thread-1 (]: On model.uber.dropoff_location_dim: /* {"app": "dbt", "dbt_version": "1.5.9", "profile_name": "uber", "target_name": "dev", "node_id": "model.uber.dropoff_location_dim"} */

  
    

    create or replace table `uber-data-engineering-407103`.`uber`.`dropoff_location_dim`
    
    

    OPTIONS()
    as (
      WITH numbered_rows AS (
  SELECT
    

    

    with p as (
        select 0 as generated_number union all select 1
    ), unioned as (

    select

    
    p0.generated_number * power(2, 0)
    
    
    + 1
    as generated_number

    from

    
    p as p0
    
    

    )

    select *
    from unioned
    where generated_number <= 1
    order by generated_number

 as dropoff_location_id,
    dropoff_latitude AS dropoff_latitude,
    dropoff_longitude AS dropoff_longitude,
    ROW_NUMBER() OVER (ORDER BY dropoff_latitude, dropoff_longitude) as row_num
  FROM `uber-data-engineering-407103`.`uber`.`uber_tlc_trip_recrord_data`
)
SELECT
  dropoff_location_id,
  dropoff_latitude,
  dropoff_longitude
FROM numbered_rows
    );
  
[0m21:11:31.572464 [debug] [Thread-1 (]: BigQuery adapter: Retry attempt 1 of 1 after error: BadRequest('Syntax error: Unexpected "(" at [18:15]')
[0m21:11:32.008143 [error] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=uber-data-engineering-407103&j=bq:US:100eb011-59c9-40f1-80df-9a2e6293cdb1&page=queryresults
[0m21:11:32.012807 [debug] [Thread-1 (]: Timing info for model.uber.dropoff_location_dim (execute): 21:11:30.478599 => 21:11:32.011924
[0m21:11:32.043508 [debug] [Thread-1 (]: Database Error in model dropoff_location_dim (models/transform/dropoff_location_dim.sql)
  Syntax error: Unexpected "(" at [18:15]
  compiled Code at target/run/uber/models/transform/dropoff_location_dim.sql
[0m21:11:32.045096 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '2b33a280-6d40-4a19-b127-96813ac19442', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffb7f3d1d0>]}
[0m21:11:32.046818 [error] [Thread-1 (]: 2 of 7 ERROR creating sql table model uber.dropoff_location_dim ................ [[31mERROR[0m in 1.58s]
[0m21:11:32.049111 [debug] [Thread-1 (]: Finished running node model.uber.dropoff_location_dim
[0m21:11:32.050225 [debug] [Thread-1 (]: Began running node model.uber.passenger_count_dim
[0m21:11:32.053537 [info ] [Thread-1 (]: 3 of 7 START sql table model uber.passenger_count_dim .......................... [RUN]
[0m21:11:32.055637 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.uber.dropoff_location_dim, now model.uber.passenger_count_dim)
[0m21:11:32.056511 [debug] [Thread-1 (]: Began compiling node model.uber.passenger_count_dim
[0m21:11:32.067003 [debug] [Thread-1 (]: Writing injected SQL for node "model.uber.passenger_count_dim"
[0m21:11:32.071118 [debug] [Thread-1 (]: Timing info for model.uber.passenger_count_dim (compile): 21:11:32.057128 => 21:11:32.070325
[0m21:11:32.072344 [debug] [Thread-1 (]: Began executing node model.uber.passenger_count_dim
[0m21:11:32.080225 [debug] [Thread-1 (]: Writing runtime sql for node "model.uber.passenger_count_dim"
[0m21:11:32.086915 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m21:11:32.089895 [debug] [Thread-1 (]: On model.uber.passenger_count_dim: /* {"app": "dbt", "dbt_version": "1.5.9", "profile_name": "uber", "target_name": "dev", "node_id": "model.uber.passenger_count_dim"} */

  
    

    create or replace table `uber-data-engineering-407103`.`uber`.`passenger_count_dim`
    
    

    OPTIONS()
    as (
      SELECT DISTINCT
    to_hex(md5(cast(coalesce(cast(VendorID as STRING), '_dbt_utils_surrogate_key_null_') || '-' || coalesce(cast(tpep_pickup_datetime as STRING), '_dbt_utils_surrogate_key_null_') || '-' || coalesce(cast(tpep_dropoff_datetime as STRING), '_dbt_utils_surrogate_key_null_') || '-' || coalesce(cast( passenger_count as STRING), '_dbt_utils_surrogate_key_null_') as STRING))) as passenger_count_id,
		passenger_count AS passenger_count,
FROM `uber-data-engineering-407103`.`uber`.`uber_tlc_trip_recrord_data`
WHERE passenger_count IS NOT NULL
    );
  
[0m21:11:35.751593 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=uber-data-engineering-407103&j=bq:US:03c2d494-b346-43da-9564-dd8e14b1100c&page=queryresults
[0m21:11:35.769307 [debug] [Thread-1 (]: Timing info for model.uber.passenger_count_dim (execute): 21:11:32.073017 => 21:11:35.768363
[0m21:11:35.774188 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '2b33a280-6d40-4a19-b127-96813ac19442', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffb7cba950>]}
[0m21:11:35.777934 [info ] [Thread-1 (]: 3 of 7 OK created sql table model uber.passenger_count_dim ..................... [[32mCREATE TABLE (99.9k rows, 5.5 MiB processed)[0m in 3.72s]
[0m21:11:35.780609 [debug] [Thread-1 (]: Finished running node model.uber.passenger_count_dim
[0m21:11:35.782602 [debug] [Thread-1 (]: Began running node model.uber.payment_type_dim
[0m21:11:35.784916 [info ] [Thread-1 (]: 4 of 7 START sql table model uber.payment_type_dim ............................. [RUN]
[0m21:11:35.787296 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.uber.passenger_count_dim, now model.uber.payment_type_dim)
[0m21:11:35.788419 [debug] [Thread-1 (]: Began compiling node model.uber.payment_type_dim
[0m21:11:35.812049 [debug] [Thread-1 (]: Writing injected SQL for node "model.uber.payment_type_dim"
[0m21:11:35.816128 [debug] [Thread-1 (]: Timing info for model.uber.payment_type_dim (compile): 21:11:35.789133 => 21:11:35.815757
[0m21:11:35.817398 [debug] [Thread-1 (]: Began executing node model.uber.payment_type_dim
[0m21:11:35.825174 [debug] [Thread-1 (]: Writing runtime sql for node "model.uber.payment_type_dim"
[0m21:11:35.829730 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m21:11:35.845903 [debug] [Thread-1 (]: On model.uber.payment_type_dim: /* {"app": "dbt", "dbt_version": "1.5.9", "profile_name": "uber", "target_name": "dev", "node_id": "model.uber.payment_type_dim"} */

  
    

    create or replace table `uber-data-engineering-407103`.`uber`.`payment_type_dim`
    
    

    OPTIONS()
    as (
      WITH numbered_rows AS (
  SELECT
    

    

    with p as (
        select 0 as generated_number union all select 1
    ), unioned as (

    select

    
    p0.generated_number * power(2, 0)
    
    
    + 1
    as generated_number

    from

    
    p as p0
    
    

    )

    select *
    from unioned
    where generated_number <= 1
    order by generated_number

 as payment_type_id,
    payment_type AS payment_type,
    ROW_NUMBER() OVER (ORDER BY payment_type) as row_num
  FROM `uber-data-engineering-407103`.`uber`.`uber_tlc_trip_recrord_data`
  WHERE passenger_count IS NOT NULL
)

SELECT
  payment_type_id,
  payment_type
FROM numbered_rows
    );
  
[0m21:11:36.511822 [debug] [Thread-1 (]: BigQuery adapter: Retry attempt 1 of 1 after error: BadRequest('Syntax error: Unexpected "(" at [18:15]')
[0m21:11:36.726156 [error] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=uber-data-engineering-407103&j=bq:US:5261c89a-1d3e-481e-abbe-5aec420234c3&page=queryresults
[0m21:11:36.729703 [debug] [Thread-1 (]: Timing info for model.uber.payment_type_dim (execute): 21:11:35.818107 => 21:11:36.729193
[0m21:11:36.737707 [debug] [Thread-1 (]: Database Error in model payment_type_dim (models/transform/payment_type_dim.sql)
  Syntax error: Unexpected "(" at [18:15]
  compiled Code at target/run/uber/models/transform/payment_type_dim.sql
[0m21:11:36.739175 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '2b33a280-6d40-4a19-b127-96813ac19442', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffb7d74210>]}
[0m21:11:36.740714 [error] [Thread-1 (]: 4 of 7 ERROR creating sql table model uber.payment_type_dim .................... [[31mERROR[0m in 0.95s]
[0m21:11:36.742320 [debug] [Thread-1 (]: Finished running node model.uber.payment_type_dim
[0m21:11:36.744133 [debug] [Thread-1 (]: Began running node model.uber.pickup_location_dim
[0m21:11:36.745825 [info ] [Thread-1 (]: 5 of 7 START sql table model uber.pickup_location_dim .......................... [RUN]
[0m21:11:36.747382 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.uber.payment_type_dim, now model.uber.pickup_location_dim)
[0m21:11:36.748136 [debug] [Thread-1 (]: Began compiling node model.uber.pickup_location_dim
[0m21:11:36.753492 [debug] [Thread-1 (]: Writing injected SQL for node "model.uber.pickup_location_dim"
[0m21:11:36.757340 [debug] [Thread-1 (]: Timing info for model.uber.pickup_location_dim (compile): 21:11:36.748784 => 21:11:36.756794
[0m21:11:36.758326 [debug] [Thread-1 (]: Began executing node model.uber.pickup_location_dim
[0m21:11:36.761948 [debug] [Thread-1 (]: Writing runtime sql for node "model.uber.pickup_location_dim"
[0m21:11:36.764566 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m21:11:36.769403 [debug] [Thread-1 (]: On model.uber.pickup_location_dim: /* {"app": "dbt", "dbt_version": "1.5.9", "profile_name": "uber", "target_name": "dev", "node_id": "model.uber.pickup_location_dim"} */

  
    

    create or replace table `uber-data-engineering-407103`.`uber`.`pickup_location_dim`
    
    

    OPTIONS()
    as (
      WITH numbered_rows AS (
  SELECT
    

    

    with p as (
        select 0 as generated_number union all select 1
    ), unioned as (

    select

    
    p0.generated_number * power(2, 0)
    
    
    + 1
    as generated_number

    from

    
    p as p0
    
    

    )

    select *
    from unioned
    where generated_number <= 1
    order by generated_number

 as pickup_location_id,
    pickup_latitude AS pickup_latitude,
    pickup_longitude AS pickup_longitude,
    ROW_NUMBER() OVER (ORDER BY pickup_latitude, pickup_longitude) as row_num
  FROM `uber-data-engineering-407103`.`uber`.`uber_tlc_trip_recrord_data`
)
SELECT
  pickup_location_id,
  pickup_latitude,
  pickup_longitude
FROM numbered_rows
    );
  
[0m21:11:37.507486 [debug] [Thread-1 (]: BigQuery adapter: Retry attempt 1 of 1 after error: BadRequest('Syntax error: Unexpected "(" at [18:15]')
[0m21:11:37.934337 [error] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=uber-data-engineering-407103&j=bq:US:85df3e6e-cf7d-436d-84c9-5c5545c20587&page=queryresults
[0m21:11:37.939182 [debug] [Thread-1 (]: Timing info for model.uber.pickup_location_dim (execute): 21:11:36.758835 => 21:11:37.938422
[0m21:11:37.950594 [debug] [Thread-1 (]: Database Error in model pickup_location_dim (models/transform/pickup_location_dim.sql)
  Syntax error: Unexpected "(" at [18:15]
  compiled Code at target/run/uber/models/transform/pickup_location_dim.sql
[0m21:11:37.952710 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '2b33a280-6d40-4a19-b127-96813ac19442', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffb7d76190>]}
[0m21:11:37.954552 [error] [Thread-1 (]: 5 of 7 ERROR creating sql table model uber.pickup_location_dim ................. [[31mERROR[0m in 1.21s]
[0m21:11:37.956358 [debug] [Thread-1 (]: Finished running node model.uber.pickup_location_dim
[0m21:11:37.957892 [debug] [Thread-1 (]: Began running node model.uber.rate_code_dim
[0m21:11:37.959455 [info ] [Thread-1 (]: 6 of 7 START sql table model uber.rate_code_dim ................................ [RUN]
[0m21:11:37.961399 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.uber.pickup_location_dim, now model.uber.rate_code_dim)
[0m21:11:37.962550 [debug] [Thread-1 (]: Began compiling node model.uber.rate_code_dim
[0m21:11:37.969743 [debug] [Thread-1 (]: Writing injected SQL for node "model.uber.rate_code_dim"
[0m21:11:37.973228 [debug] [Thread-1 (]: Timing info for model.uber.rate_code_dim (compile): 21:11:37.963427 => 21:11:37.972780
[0m21:11:37.974097 [debug] [Thread-1 (]: Began executing node model.uber.rate_code_dim
[0m21:11:37.978988 [debug] [Thread-1 (]: Writing runtime sql for node "model.uber.rate_code_dim"
[0m21:11:37.981918 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m21:11:37.987471 [debug] [Thread-1 (]: On model.uber.rate_code_dim: /* {"app": "dbt", "dbt_version": "1.5.9", "profile_name": "uber", "target_name": "dev", "node_id": "model.uber.rate_code_dim"} */

  
    

    create or replace table `uber-data-engineering-407103`.`uber`.`rate_code_dim`
    
    

    OPTIONS()
    as (
      WITH numbered_rows AS (
  SELECT
    

    

    with p as (
        select 0 as generated_number union all select 1
    ), unioned as (

    select

    
    p0.generated_number * power(2, 0)
    
    
    + 1
    as generated_number

    from

    
    p as p0
    
    

    )

    select *
    from unioned
    where generated_number <= 1
    order by generated_number

 as rate_code_id,
    RatecodeID AS RatecodeID,
    ROW_NUMBER() OVER (ORDER BY RatecodeID) as row_num
  FROM `uber-data-engineering-407103`.`uber`.`uber_tlc_trip_recrord_data`
  WHERE RatecodeID IS NOT NULL
)

SELECT
  rate_code_id,
  rate_code
FROM numbered_rows
    );
  
[0m21:11:38.372238 [debug] [Thread-1 (]: BigQuery adapter: Retry attempt 1 of 1 after error: BadRequest('Syntax error: Unexpected "(" at [18:15]')
[0m21:11:38.757449 [error] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=uber-data-engineering-407103&j=bq:US:c9a7ca64-da12-4ceb-979a-2064fe262648&page=queryresults
[0m21:11:38.760927 [debug] [Thread-1 (]: Timing info for model.uber.rate_code_dim (execute): 21:11:37.974731 => 21:11:38.760454
[0m21:11:38.765808 [debug] [Thread-1 (]: Database Error in model rate_code_dim (models/transform/rate_code_dim.sql)
  Syntax error: Unexpected "(" at [18:15]
  compiled Code at target/run/uber/models/transform/rate_code_dim.sql
[0m21:11:38.767053 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '2b33a280-6d40-4a19-b127-96813ac19442', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffb7e33650>]}
[0m21:11:38.768426 [error] [Thread-1 (]: 6 of 7 ERROR creating sql table model uber.rate_code_dim ....................... [[31mERROR[0m in 0.81s]
[0m21:11:38.769391 [debug] [Thread-1 (]: Finished running node model.uber.rate_code_dim
[0m21:11:38.770226 [debug] [Thread-1 (]: Began running node model.uber.trip_distance
[0m21:11:38.771233 [info ] [Thread-1 (]: 7 of 7 START sql table model uber.trip_distance ................................ [RUN]
[0m21:11:38.772287 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.uber.rate_code_dim, now model.uber.trip_distance)
[0m21:11:38.772837 [debug] [Thread-1 (]: Began compiling node model.uber.trip_distance
[0m21:11:38.779294 [debug] [Thread-1 (]: Writing injected SQL for node "model.uber.trip_distance"
[0m21:11:38.781230 [debug] [Thread-1 (]: Timing info for model.uber.trip_distance (compile): 21:11:38.773225 => 21:11:38.780959
[0m21:11:38.781952 [debug] [Thread-1 (]: Began executing node model.uber.trip_distance
[0m21:11:38.785508 [debug] [Thread-1 (]: Writing runtime sql for node "model.uber.trip_distance"
[0m21:11:38.787233 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m21:11:38.789277 [debug] [Thread-1 (]: On model.uber.trip_distance: /* {"app": "dbt", "dbt_version": "1.5.9", "profile_name": "uber", "target_name": "dev", "node_id": "model.uber.trip_distance"} */

  
    

    create or replace table `uber-data-engineering-407103`.`uber`.`trip_distance`
    
    

    OPTIONS()
    as (
      WITH numbered_rows AS (
  SELECT
    

    

    with p as (
        select 0 as generated_number union all select 1
    ), unioned as (

    select

    
    p0.generated_number * power(2, 0)
    
    
    + 1
    as generated_number

    from

    
    p as p0
    
    

    )

    select *
    from unioned
    where generated_number <= 1
    order by generated_number

 as trip_distance_id,
    trip_distance AS trip_distance,
    ROW_NUMBER() OVER (ORDER BY trip_distance) as row_num
  FROM `uber-data-engineering-407103`.`uber`.`uber_tlc_trip_recrord_data`
  WHERE trip_distance IS NOT NULL
)

SELECT
  trip_distance_id,
  trip_distance
FROM numbered_rows
    );
  
[0m21:11:39.298056 [debug] [Thread-1 (]: BigQuery adapter: Retry attempt 1 of 1 after error: BadRequest('Syntax error: Unexpected "(" at [18:15]')
[0m21:11:39.920614 [error] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=uber-data-engineering-407103&j=bq:US:e2eb4807-05ef-4e19-877a-4ac93828d34c&page=queryresults
[0m21:11:39.929866 [debug] [Thread-1 (]: Timing info for model.uber.trip_distance (execute): 21:11:38.782427 => 21:11:39.929522
[0m21:11:39.950933 [debug] [Thread-1 (]: Database Error in model trip_distance (models/transform/trip_distance.sql)
  Syntax error: Unexpected "(" at [18:15]
  compiled Code at target/run/uber/models/transform/trip_distance.sql
[0m21:11:39.956375 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '2b33a280-6d40-4a19-b127-96813ac19442', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffb7cd08d0>]}
[0m21:11:39.958228 [error] [Thread-1 (]: 7 of 7 ERROR creating sql table model uber.trip_distance ....................... [[31mERROR[0m in 1.18s]
[0m21:11:39.960054 [debug] [Thread-1 (]: Finished running node model.uber.trip_distance
[0m21:11:39.985234 [debug] [MainThread]: Connection 'master' was properly closed.
[0m21:11:39.989084 [debug] [MainThread]: Connection 'model.uber.trip_distance' was properly closed.
[0m21:11:39.999632 [info ] [MainThread]: 
[0m21:11:40.002868 [info ] [MainThread]: Finished running 7 table models in 0 hours 0 minutes and 16.95 seconds (16.95s).
[0m21:11:40.011721 [debug] [MainThread]: Command end result
[0m21:11:40.052251 [info ] [MainThread]: 
[0m21:11:40.055380 [info ] [MainThread]: [31mCompleted with 5 errors and 0 warnings:[0m
[0m21:11:40.057868 [info ] [MainThread]: 
[0m21:11:40.060165 [error] [MainThread]: [33mDatabase Error in model dropoff_location_dim (models/transform/dropoff_location_dim.sql)[0m
[0m21:11:40.062244 [error] [MainThread]:   Syntax error: Unexpected "(" at [18:15]
[0m21:11:40.064856 [error] [MainThread]:   compiled Code at target/run/uber/models/transform/dropoff_location_dim.sql
[0m21:11:40.068001 [info ] [MainThread]: 
[0m21:11:40.069390 [error] [MainThread]: [33mDatabase Error in model payment_type_dim (models/transform/payment_type_dim.sql)[0m
[0m21:11:40.071036 [error] [MainThread]:   Syntax error: Unexpected "(" at [18:15]
[0m21:11:40.072698 [error] [MainThread]:   compiled Code at target/run/uber/models/transform/payment_type_dim.sql
[0m21:11:40.074221 [info ] [MainThread]: 
[0m21:11:40.075404 [error] [MainThread]: [33mDatabase Error in model pickup_location_dim (models/transform/pickup_location_dim.sql)[0m
[0m21:11:40.076276 [error] [MainThread]:   Syntax error: Unexpected "(" at [18:15]
[0m21:11:40.077582 [error] [MainThread]:   compiled Code at target/run/uber/models/transform/pickup_location_dim.sql
[0m21:11:40.078848 [info ] [MainThread]: 
[0m21:11:40.080488 [error] [MainThread]: [33mDatabase Error in model rate_code_dim (models/transform/rate_code_dim.sql)[0m
[0m21:11:40.082047 [error] [MainThread]:   Syntax error: Unexpected "(" at [18:15]
[0m21:11:40.085129 [error] [MainThread]:   compiled Code at target/run/uber/models/transform/rate_code_dim.sql
[0m21:11:40.086202 [info ] [MainThread]: 
[0m21:11:40.087187 [error] [MainThread]: [33mDatabase Error in model trip_distance (models/transform/trip_distance.sql)[0m
[0m21:11:40.088340 [error] [MainThread]:   Syntax error: Unexpected "(" at [18:15]
[0m21:11:40.089367 [error] [MainThread]:   compiled Code at target/run/uber/models/transform/trip_distance.sql
[0m21:11:40.090643 [info ] [MainThread]: 
[0m21:11:40.091712 [info ] [MainThread]: Done. PASS=2 WARN=0 ERROR=5 SKIP=0 TOTAL=7
[0m21:11:40.093703 [debug] [MainThread]: Command `dbt run` failed at 21:11:40.093524 after 17.70 seconds
[0m21:11:40.094500 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffb9addad0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffba475810>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffbdf7e3d0>]}
[0m21:11:40.095143 [debug] [MainThread]: Flushing usage events
[0m21:13:32.158420 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffa3b75590>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffa36d5550>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffa33b3d50>]}


============================== 21:13:32.164848 | 67e50a86-422e-4ab6-8959-119074c420fc ==============================
[0m21:13:32.164848 [info ] [MainThread]: Running with dbt=1.5.9
[0m21:13:32.165936 [debug] [MainThread]: running dbt with arguments {'use_colors': 'True', 'log_path': '/usr/local/airflow/include/dbt/logs', 'profiles_dir': '/usr/local/airflow/include/dbt/', 'fail_fast': 'False', 'target_path': 'None', 'use_experimental_parser': 'False', 'write_json': 'True', 'static_parser': 'True', 'log_format': 'default', 'no_print': 'None', 'partial_parse': 'True', 'warn_error': 'None', 'cache_selected_only': 'False', 'send_anonymous_usage_stats': 'True', 'debug': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'quiet': 'False', 'log_cache_events': 'False', 'introspect': 'True', 'version_check': 'True', 'printer_width': '80', 'indirect_selection': 'eager'}
[0m21:13:32.592077 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '67e50a86-422e-4ab6-8959-119074c420fc', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffa3849350>]}
[0m21:13:32.603672 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '67e50a86-422e-4ab6-8959-119074c420fc', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffa32ba110>]}
[0m21:13:32.604428 [info ] [MainThread]: Registered adapter: bigquery=1.5.3
[0m21:13:32.619571 [debug] [MainThread]: checksum: dd837546c89c9d03f3c2cb0ca6165266a30da6076d5d44e9991f7c5a8e5f5831, vars: {}, profile: , target: , version: 1.5.9
[0m21:13:32.694676 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 3 files changed.
[0m21:13:32.696320 [debug] [MainThread]: Partial parsing: updated file: uber://models/transform/trip_distance.sql
[0m21:13:32.696889 [debug] [MainThread]: Partial parsing: updated file: uber://models/transform/payment_type_dim.sql
[0m21:13:32.697407 [debug] [MainThread]: Partial parsing: updated file: uber://models/transform/rate_code_dim.sql
[0m21:13:32.716207 [debug] [MainThread]: 1603: static parser failed on transform/trip_distance.sql
[0m21:13:32.735642 [debug] [MainThread]: 1602: parser fallback to jinja rendering on transform/trip_distance.sql
[0m21:13:32.737757 [debug] [MainThread]: 1603: static parser failed on transform/payment_type_dim.sql
[0m21:13:32.742431 [debug] [MainThread]: 1602: parser fallback to jinja rendering on transform/payment_type_dim.sql
[0m21:13:32.744305 [debug] [MainThread]: 1603: static parser failed on transform/rate_code_dim.sql
[0m21:13:32.751935 [debug] [MainThread]: 1602: parser fallback to jinja rendering on transform/rate_code_dim.sql
[0m21:13:32.764689 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '67e50a86-422e-4ab6-8959-119074c420fc', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffa154ac10>]}
[0m21:13:32.777216 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '67e50a86-422e-4ab6-8959-119074c420fc', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffa168d090>]}
[0m21:13:32.777838 [info ] [MainThread]: Found 7 models, 0 tests, 0 snapshots, 0 analyses, 474 macros, 0 operations, 0 seed files, 1 source, 0 exposures, 0 metrics, 0 groups
[0m21:13:32.778481 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '67e50a86-422e-4ab6-8959-119074c420fc', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffa66bfa10>]}
[0m21:13:32.780270 [info ] [MainThread]: 
[0m21:13:32.781256 [debug] [MainThread]: Acquiring new bigquery connection 'master'
[0m21:13:32.782865 [debug] [ThreadPool]: Acquiring new bigquery connection 'list_uber-data-engineering-407103'
[0m21:13:32.783351 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m21:13:33.560872 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_uber-data-engineering-407103, now list_uber-data-engineering-407103_uber)
[0m21:13:33.564094 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m21:13:34.279509 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '67e50a86-422e-4ab6-8959-119074c420fc', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffa16b1390>]}
[0m21:13:34.282782 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m21:13:34.284421 [info ] [MainThread]: 
[0m21:13:34.311675 [debug] [Thread-1 (]: Began running node model.uber.datetime_dim
[0m21:13:34.313002 [info ] [Thread-1 (]: 1 of 7 START sql table model uber.datetime_dim ................................. [RUN]
[0m21:13:34.314505 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_uber-data-engineering-407103_uber, now model.uber.datetime_dim)
[0m21:13:34.315321 [debug] [Thread-1 (]: Began compiling node model.uber.datetime_dim
[0m21:13:34.322980 [debug] [Thread-1 (]: Writing injected SQL for node "model.uber.datetime_dim"
[0m21:13:34.325284 [debug] [Thread-1 (]: Timing info for model.uber.datetime_dim (compile): 21:13:34.315827 => 21:13:34.325002
[0m21:13:34.325842 [debug] [Thread-1 (]: Began executing node model.uber.datetime_dim
[0m21:13:34.339490 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m21:13:35.594654 [debug] [Thread-1 (]: Writing runtime sql for node "model.uber.datetime_dim"
[0m21:13:35.600659 [debug] [Thread-1 (]: On model.uber.datetime_dim: /* {"app": "dbt", "dbt_version": "1.5.9", "profile_name": "uber", "target_name": "dev", "node_id": "model.uber.datetime_dim"} */

  
    

    create or replace table `uber-data-engineering-407103`.`uber`.`datetime_dim`
    
    

    OPTIONS()
    as (
      WITH datetime_cte AS (  
  SELECT DISTINCT
    tpep_pickup_datetime AS datetime_id,
    CASE
      WHEN LENGTH(tpep_pickup_datetime) = 16 THEN
        -- Date format: "DD/MM/YYYY HH:MM"
        PARSE_DATETIME('%m/%d/%Y %H:%M', tpep_pickup_datetime)
      WHEN LENGTH(tpep_pickup_datetime) <= 14 THEN
        -- Date format: "MM/DD/YY HH:MM"
        PARSE_DATETIME('%m/%d/%y %H:%M', tpep_pickup_datetime)
      ELSE
        NULL
    END AS pick_date_part,
    tpep_dropoff_datetime AS drop_datetime_id,
    CASE
      WHEN LENGTH(tpep_dropoff_datetime) = 16 THEN
        -- Date format: "DD/MM/YYYY HH:MM"
        PARSE_DATETIME('%m/%d/%Y %H:%M', tpep_dropoff_datetime)
      WHEN LENGTH(tpep_dropoff_datetime) <= 14 THEN
        -- Date format: "MM/DD/YY HH:MM"
        PARSE_DATETIME('%m/%d/%y %H:%M', tpep_dropoff_datetime)
      ELSE
        NULL
    END AS drop_date_part
  FROM `uber-data-engineering-407103`.`uber`.`uber_tlc_trip_recrord_data`
  WHERE tpep_pickup_datetime IS NOT NULL
    AND tpep_dropoff_datetime IS NOT NULL
)
SELECT
  datetime_id,
  pick_date_part AS tpep_pickup_datetime,
  drop_date_part AS tpep_dropoff_datetime,
  EXTRACT(HOUR FROM pick_date_part) AS pick_hour,
  EXTRACT(DAY FROM pick_date_part) AS pick_day,
  EXTRACT(MONTH FROM pick_date_part) AS pick_month,
  EXTRACT(YEAR FROM pick_date_part) AS pick_year,
  EXTRACT(DAYOFWEEK FROM pick_date_part) AS pick_weekday,
  EXTRACT(HOUR FROM drop_date_part) AS drop_hour,
  EXTRACT(DAY FROM drop_date_part) AS drop_day,
  EXTRACT(MONTH FROM drop_date_part) AS drop_month,
  EXTRACT(YEAR FROM drop_date_part) AS drop_year,
  EXTRACT(DAYOFWEEK FROM drop_date_part) AS drop_weekday
FROM datetime_cte
    );
  
[0m21:13:38.622719 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=uber-data-engineering-407103&j=bq:US:72d528bc-1b83-44fa-9648-31b5ef06789c&page=queryresults
[0m21:13:38.661752 [debug] [Thread-1 (]: Timing info for model.uber.datetime_dim (execute): 21:13:34.326280 => 21:13:38.661231
[0m21:13:38.663968 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '67e50a86-422e-4ab6-8959-119074c420fc', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffa1659dd0>]}
[0m21:13:38.665739 [info ] [Thread-1 (]: 1 of 7 OK created sql table model uber.datetime_dim ............................ [[32mCREATE TABLE (99.9k rows, 4.0 MiB processed)[0m in 4.35s]
[0m21:13:38.667549 [debug] [Thread-1 (]: Finished running node model.uber.datetime_dim
[0m21:13:38.668698 [debug] [Thread-1 (]: Began running node model.uber.dropoff_location_dim
[0m21:13:38.669943 [info ] [Thread-1 (]: 2 of 7 START sql table model uber.dropoff_location_dim ......................... [RUN]
[0m21:13:38.671194 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.uber.datetime_dim, now model.uber.dropoff_location_dim)
[0m21:13:38.671870 [debug] [Thread-1 (]: Began compiling node model.uber.dropoff_location_dim
[0m21:13:38.677970 [debug] [Thread-1 (]: Writing injected SQL for node "model.uber.dropoff_location_dim"
[0m21:13:38.680543 [debug] [Thread-1 (]: Timing info for model.uber.dropoff_location_dim (compile): 21:13:38.672429 => 21:13:38.680366
[0m21:13:38.681043 [debug] [Thread-1 (]: Began executing node model.uber.dropoff_location_dim
[0m21:13:38.684331 [debug] [Thread-1 (]: Writing runtime sql for node "model.uber.dropoff_location_dim"
[0m21:13:38.687279 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m21:13:38.691286 [debug] [Thread-1 (]: On model.uber.dropoff_location_dim: /* {"app": "dbt", "dbt_version": "1.5.9", "profile_name": "uber", "target_name": "dev", "node_id": "model.uber.dropoff_location_dim"} */

  
    

    create or replace table `uber-data-engineering-407103`.`uber`.`dropoff_location_dim`
    
    

    OPTIONS()
    as (
      WITH numbered_rows AS (
  SELECT
    

    

    with p as (
        select 0 as generated_number union all select 1
    ), unioned as (

    select

    
    p0.generated_number * power(2, 0)
    
    
    + 1
    as generated_number

    from

    
    p as p0
    
    

    )

    select *
    from unioned
    where generated_number <= 1
    order by generated_number

 as dropoff_location_id,
    dropoff_latitude AS dropoff_latitude,
    dropoff_longitude AS dropoff_longitude,
    ROW_NUMBER() OVER (ORDER BY dropoff_latitude, dropoff_longitude) as row_num
  FROM `uber-data-engineering-407103`.`uber`.`uber_tlc_trip_recrord_data`
)
SELECT
  dropoff_location_id,
  dropoff_latitude,
  dropoff_longitude
FROM numbered_rows
    );
  
[0m21:13:39.633569 [debug] [Thread-1 (]: BigQuery adapter: Retry attempt 1 of 1 after error: BadRequest('Syntax error: Unexpected "(" at [18:15]')
[0m21:13:40.899358 [error] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=uber-data-engineering-407103&j=bq:US:46c1d6da-94c7-497f-8de1-9ea8c4bc4aca&page=queryresults
[0m21:13:40.902371 [debug] [Thread-1 (]: Timing info for model.uber.dropoff_location_dim (execute): 21:13:38.681523 => 21:13:40.902081
[0m21:13:40.913486 [debug] [Thread-1 (]: Database Error in model dropoff_location_dim (models/transform/dropoff_location_dim.sql)
  Syntax error: Unexpected "(" at [18:15]
  compiled Code at target/run/uber/models/transform/dropoff_location_dim.sql
[0m21:13:40.914525 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '67e50a86-422e-4ab6-8959-119074c420fc', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffa16ee9d0>]}
[0m21:13:40.915639 [error] [Thread-1 (]: 2 of 7 ERROR creating sql table model uber.dropoff_location_dim ................ [[31mERROR[0m in 2.24s]
[0m21:13:40.916430 [debug] [Thread-1 (]: Finished running node model.uber.dropoff_location_dim
[0m21:13:40.917206 [debug] [Thread-1 (]: Began running node model.uber.passenger_count_dim
[0m21:13:40.918212 [info ] [Thread-1 (]: 3 of 7 START sql table model uber.passenger_count_dim .......................... [RUN]
[0m21:13:40.919517 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.uber.dropoff_location_dim, now model.uber.passenger_count_dim)
[0m21:13:40.920105 [debug] [Thread-1 (]: Began compiling node model.uber.passenger_count_dim
[0m21:13:40.940942 [debug] [Thread-1 (]: Writing injected SQL for node "model.uber.passenger_count_dim"
[0m21:13:40.943770 [debug] [Thread-1 (]: Timing info for model.uber.passenger_count_dim (compile): 21:13:40.924091 => 21:13:40.943569
[0m21:13:40.944333 [debug] [Thread-1 (]: Began executing node model.uber.passenger_count_dim
[0m21:13:40.948031 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m21:13:41.599543 [debug] [Thread-1 (]: Writing runtime sql for node "model.uber.passenger_count_dim"
[0m21:13:41.606421 [debug] [Thread-1 (]: On model.uber.passenger_count_dim: /* {"app": "dbt", "dbt_version": "1.5.9", "profile_name": "uber", "target_name": "dev", "node_id": "model.uber.passenger_count_dim"} */

  
    

    create or replace table `uber-data-engineering-407103`.`uber`.`passenger_count_dim`
    
    

    OPTIONS()
    as (
      SELECT DISTINCT
    to_hex(md5(cast(coalesce(cast(VendorID as STRING), '_dbt_utils_surrogate_key_null_') || '-' || coalesce(cast(tpep_pickup_datetime as STRING), '_dbt_utils_surrogate_key_null_') || '-' || coalesce(cast(tpep_dropoff_datetime as STRING), '_dbt_utils_surrogate_key_null_') || '-' || coalesce(cast( passenger_count as STRING), '_dbt_utils_surrogate_key_null_') as STRING))) as passenger_count_id,
		passenger_count AS passenger_count,
FROM `uber-data-engineering-407103`.`uber`.`uber_tlc_trip_recrord_data`
WHERE passenger_count IS NOT NULL
    );
  
[0m21:13:44.643577 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=uber-data-engineering-407103&j=bq:US:226cc851-9273-4599-864a-9d71e7fec397&page=queryresults
[0m21:13:44.659084 [debug] [Thread-1 (]: Timing info for model.uber.passenger_count_dim (execute): 21:13:40.944816 => 21:13:44.657915
[0m21:13:44.662931 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '67e50a86-422e-4ab6-8959-119074c420fc', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffa1556510>]}
[0m21:13:44.665684 [info ] [Thread-1 (]: 3 of 7 OK created sql table model uber.passenger_count_dim ..................... [[32mCREATE TABLE (99.9k rows, 5.5 MiB processed)[0m in 3.74s]
[0m21:13:44.668355 [debug] [Thread-1 (]: Finished running node model.uber.passenger_count_dim
[0m21:13:44.670260 [debug] [Thread-1 (]: Began running node model.uber.payment_type_dim
[0m21:13:44.672296 [info ] [Thread-1 (]: 4 of 7 START sql table model uber.payment_type_dim ............................. [RUN]
[0m21:13:44.674061 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.uber.passenger_count_dim, now model.uber.payment_type_dim)
[0m21:13:44.675064 [debug] [Thread-1 (]: Began compiling node model.uber.payment_type_dim
[0m21:13:44.697713 [debug] [Thread-1 (]: Writing injected SQL for node "model.uber.payment_type_dim"
[0m21:13:44.703307 [debug] [Thread-1 (]: Timing info for model.uber.payment_type_dim (compile): 21:13:44.675899 => 21:13:44.702875
[0m21:13:44.704397 [debug] [Thread-1 (]: Began executing node model.uber.payment_type_dim
[0m21:13:44.709116 [debug] [Thread-1 (]: Writing runtime sql for node "model.uber.payment_type_dim"
[0m21:13:44.717773 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m21:13:44.733929 [debug] [Thread-1 (]: On model.uber.payment_type_dim: /* {"app": "dbt", "dbt_version": "1.5.9", "profile_name": "uber", "target_name": "dev", "node_id": "model.uber.payment_type_dim"} */

  
    

    create or replace table `uber-data-engineering-407103`.`uber`.`payment_type_dim`
    
    

    OPTIONS()
    as (
      WITH numbered_rows AS (
  SELECT
    

    

    with p as (
        select 0 as generated_number union all select 1
    ), unioned as (

    select

    
    p0.generated_number * power(2, 0)
    
    
    + 1
    as generated_number

    from

    
    p as p0
    
    

    )

    select *
    from unioned
    where generated_number <= 1
    order by generated_number

 as payment_type_id,
    payment_type AS payment_type,
    ROW_NUMBER() OVER (ORDER BY payment_type) as row_num
  FROM `uber-data-engineering-407103`.`uber`.`uber_tlc_trip_recrord_data`
  WHERE payment_type IS NOT NULL
)
SELECT
  payment_type_id,
  payment_type
FROM numbered_rows
    );
  
[0m21:13:45.114185 [debug] [Thread-1 (]: BigQuery adapter: Retry attempt 1 of 1 after error: BadRequest('Syntax error: Unexpected "(" at [18:15]')
[0m21:13:45.843716 [error] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=uber-data-engineering-407103&j=bq:US:8ba26c91-39f6-4638-b6df-46aeb0325298&page=queryresults
[0m21:13:45.848470 [debug] [Thread-1 (]: Timing info for model.uber.payment_type_dim (execute): 21:13:44.705179 => 21:13:45.847915
[0m21:13:45.860855 [debug] [Thread-1 (]: Database Error in model payment_type_dim (models/transform/payment_type_dim.sql)
  Syntax error: Unexpected "(" at [18:15]
  compiled Code at target/run/uber/models/transform/payment_type_dim.sql
[0m21:13:45.862978 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '67e50a86-422e-4ab6-8959-119074c420fc', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffa15eaa50>]}
[0m21:13:45.865266 [error] [Thread-1 (]: 4 of 7 ERROR creating sql table model uber.payment_type_dim .................... [[31mERROR[0m in 1.19s]
[0m21:13:45.867323 [debug] [Thread-1 (]: Finished running node model.uber.payment_type_dim
[0m21:13:45.869390 [debug] [Thread-1 (]: Began running node model.uber.pickup_location_dim
[0m21:13:45.871625 [info ] [Thread-1 (]: 5 of 7 START sql table model uber.pickup_location_dim .......................... [RUN]
[0m21:13:45.873698 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.uber.payment_type_dim, now model.uber.pickup_location_dim)
[0m21:13:45.874830 [debug] [Thread-1 (]: Began compiling node model.uber.pickup_location_dim
[0m21:13:45.883106 [debug] [Thread-1 (]: Writing injected SQL for node "model.uber.pickup_location_dim"
[0m21:13:45.886827 [debug] [Thread-1 (]: Timing info for model.uber.pickup_location_dim (compile): 21:13:45.875640 => 21:13:45.886422
[0m21:13:45.887691 [debug] [Thread-1 (]: Began executing node model.uber.pickup_location_dim
[0m21:13:45.897857 [debug] [Thread-1 (]: Writing runtime sql for node "model.uber.pickup_location_dim"
[0m21:13:45.907446 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m21:13:45.915278 [debug] [Thread-1 (]: On model.uber.pickup_location_dim: /* {"app": "dbt", "dbt_version": "1.5.9", "profile_name": "uber", "target_name": "dev", "node_id": "model.uber.pickup_location_dim"} */

  
    

    create or replace table `uber-data-engineering-407103`.`uber`.`pickup_location_dim`
    
    

    OPTIONS()
    as (
      WITH numbered_rows AS (
  SELECT
    

    

    with p as (
        select 0 as generated_number union all select 1
    ), unioned as (

    select

    
    p0.generated_number * power(2, 0)
    
    
    + 1
    as generated_number

    from

    
    p as p0
    
    

    )

    select *
    from unioned
    where generated_number <= 1
    order by generated_number

 as pickup_location_id,
    pickup_latitude AS pickup_latitude,
    pickup_longitude AS pickup_longitude,
    ROW_NUMBER() OVER (ORDER BY pickup_latitude, pickup_longitude) as row_num
  FROM `uber-data-engineering-407103`.`uber`.`uber_tlc_trip_recrord_data`
)
SELECT
  pickup_location_id,
  pickup_latitude,
  pickup_longitude
FROM numbered_rows
    );
  
[0m21:13:46.333125 [debug] [Thread-1 (]: BigQuery adapter: Retry attempt 1 of 1 after error: BadRequest('Syntax error: Unexpected "(" at [18:15]')
[0m21:13:47.431107 [error] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=uber-data-engineering-407103&j=bq:US:d7ab06c7-5338-44a5-a4c0-8050083a25a3&page=queryresults
[0m21:13:47.440356 [debug] [Thread-1 (]: Timing info for model.uber.pickup_location_dim (execute): 21:13:45.888304 => 21:13:47.436925
[0m21:13:47.452370 [debug] [Thread-1 (]: Database Error in model pickup_location_dim (models/transform/pickup_location_dim.sql)
  Syntax error: Unexpected "(" at [18:15]
  compiled Code at target/run/uber/models/transform/pickup_location_dim.sql
[0m21:13:47.455702 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '67e50a86-422e-4ab6-8959-119074c420fc', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffa13816d0>]}
[0m21:13:47.459283 [error] [Thread-1 (]: 5 of 7 ERROR creating sql table model uber.pickup_location_dim ................. [[31mERROR[0m in 1.58s]
[0m21:13:47.461797 [debug] [Thread-1 (]: Finished running node model.uber.pickup_location_dim
[0m21:13:47.463903 [debug] [Thread-1 (]: Began running node model.uber.rate_code_dim
[0m21:13:47.466532 [info ] [Thread-1 (]: 6 of 7 START sql table model uber.rate_code_dim ................................ [RUN]
[0m21:13:47.471032 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.uber.pickup_location_dim, now model.uber.rate_code_dim)
[0m21:13:47.473586 [debug] [Thread-1 (]: Began compiling node model.uber.rate_code_dim
[0m21:13:47.493071 [debug] [Thread-1 (]: Writing injected SQL for node "model.uber.rate_code_dim"
[0m21:13:47.496503 [debug] [Thread-1 (]: Timing info for model.uber.rate_code_dim (compile): 21:13:47.474966 => 21:13:47.496122
[0m21:13:47.497528 [debug] [Thread-1 (]: Began executing node model.uber.rate_code_dim
[0m21:13:47.501340 [debug] [Thread-1 (]: Writing runtime sql for node "model.uber.rate_code_dim"
[0m21:13:47.503525 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m21:13:47.506864 [debug] [Thread-1 (]: On model.uber.rate_code_dim: /* {"app": "dbt", "dbt_version": "1.5.9", "profile_name": "uber", "target_name": "dev", "node_id": "model.uber.rate_code_dim"} */

  
    

    create or replace table `uber-data-engineering-407103`.`uber`.`rate_code_dim`
    
    

    OPTIONS()
    as (
      WITH numbered_rows AS (
  SELECT
    

    

    with p as (
        select 0 as generated_number union all select 1
    ), unioned as (

    select

    
    p0.generated_number * power(2, 0)
    
    
    + 1
    as generated_number

    from

    
    p as p0
    
    

    )

    select *
    from unioned
    where generated_number <= 1
    order by generated_number

 as rate_code_id,
    RatecodeID AS RatecodeID,
    ROW_NUMBER() OVER (ORDER BY RatecodeID) as row_num
  FROM `uber-data-engineering-407103`.`uber`.`uber_tlc_trip_recrord_data`
  WHERE RatecodeID IS NOT NULL
)
SELECT
  rate_code_id,
  rate_code
FROM numbered_rows
    );
  
[0m21:13:48.115405 [debug] [Thread-1 (]: BigQuery adapter: Retry attempt 1 of 1 after error: BadRequest('Syntax error: Unexpected "(" at [18:15]')
[0m21:13:48.689895 [error] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=uber-data-engineering-407103&j=bq:US:029ce766-e68a-47e1-bb2d-4caf61388649&page=queryresults
[0m21:13:48.694915 [debug] [Thread-1 (]: Timing info for model.uber.rate_code_dim (execute): 21:13:47.497976 => 21:13:48.694078
[0m21:13:48.705482 [debug] [Thread-1 (]: Database Error in model rate_code_dim (models/transform/rate_code_dim.sql)
  Syntax error: Unexpected "(" at [18:15]
  compiled Code at target/run/uber/models/transform/rate_code_dim.sql
[0m21:13:48.707618 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '67e50a86-422e-4ab6-8959-119074c420fc', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffa14cd590>]}
[0m21:13:48.709387 [error] [Thread-1 (]: 6 of 7 ERROR creating sql table model uber.rate_code_dim ....................... [[31mERROR[0m in 1.24s]
[0m21:13:48.710683 [debug] [Thread-1 (]: Finished running node model.uber.rate_code_dim
[0m21:13:48.712359 [debug] [Thread-1 (]: Began running node model.uber.trip_distance
[0m21:13:48.714632 [info ] [Thread-1 (]: 7 of 7 START sql table model uber.trip_distance ................................ [RUN]
[0m21:13:48.716766 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.uber.rate_code_dim, now model.uber.trip_distance)
[0m21:13:48.717790 [debug] [Thread-1 (]: Began compiling node model.uber.trip_distance
[0m21:13:48.727589 [debug] [Thread-1 (]: Writing injected SQL for node "model.uber.trip_distance"
[0m21:13:48.730983 [debug] [Thread-1 (]: Timing info for model.uber.trip_distance (compile): 21:13:48.718608 => 21:13:48.730669
[0m21:13:48.731897 [debug] [Thread-1 (]: Began executing node model.uber.trip_distance
[0m21:13:48.736915 [debug] [Thread-1 (]: Writing runtime sql for node "model.uber.trip_distance"
[0m21:13:48.739668 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m21:13:48.743522 [debug] [Thread-1 (]: On model.uber.trip_distance: /* {"app": "dbt", "dbt_version": "1.5.9", "profile_name": "uber", "target_name": "dev", "node_id": "model.uber.trip_distance"} */

  
    

    create or replace table `uber-data-engineering-407103`.`uber`.`trip_distance`
    
    

    OPTIONS()
    as (
      WITH numbered_rows AS (
  SELECT
    

    

    with p as (
        select 0 as generated_number union all select 1
    ), unioned as (

    select

    
    p0.generated_number * power(2, 0)
    
    
    + 1
    as generated_number

    from

    
    p as p0
    
    

    )

    select *
    from unioned
    where generated_number <= 1
    order by generated_number

 as trip_distance_id,
    trip_distance AS trip_distance,
    ROW_NUMBER() OVER (ORDER BY trip_distance) as row_num
  FROM `uber-data-engineering-407103`.`uber`.`uber_tlc_trip_recrord_data`
  WHERE trip_distance IS NOT NULL
)
SELECT
  trip_distance_id,
  trip_distance
FROM numbered_rows
    );
  
[0m21:13:49.149858 [debug] [Thread-1 (]: BigQuery adapter: Retry attempt 1 of 1 after error: BadRequest('Syntax error: Unexpected "(" at [18:15]')
[0m21:13:50.271904 [error] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=uber-data-engineering-407103&j=bq:US:481eaad4-607f-46ff-821f-3388ad3e96a4&page=queryresults
[0m21:13:50.274557 [debug] [Thread-1 (]: Timing info for model.uber.trip_distance (execute): 21:13:48.732669 => 21:13:50.274111
[0m21:13:50.279749 [debug] [Thread-1 (]: Database Error in model trip_distance (models/transform/trip_distance.sql)
  Syntax error: Unexpected "(" at [18:15]
  compiled Code at target/run/uber/models/transform/trip_distance.sql
[0m21:13:50.281101 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '67e50a86-422e-4ab6-8959-119074c420fc', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffa1556150>]}
[0m21:13:50.282434 [error] [Thread-1 (]: 7 of 7 ERROR creating sql table model uber.trip_distance ....................... [[31mERROR[0m in 1.56s]
[0m21:13:50.283842 [debug] [Thread-1 (]: Finished running node model.uber.trip_distance
[0m21:13:50.290252 [debug] [MainThread]: Connection 'master' was properly closed.
[0m21:13:50.291339 [debug] [MainThread]: Connection 'model.uber.trip_distance' was properly closed.
[0m21:13:50.292426 [info ] [MainThread]: 
[0m21:13:50.293810 [info ] [MainThread]: Finished running 7 table models in 0 hours 0 minutes and 17.51 seconds (17.51s).
[0m21:13:50.297112 [debug] [MainThread]: Command end result
[0m21:13:50.341935 [info ] [MainThread]: 
[0m21:13:50.343700 [info ] [MainThread]: [31mCompleted with 5 errors and 0 warnings:[0m
[0m21:13:50.344762 [info ] [MainThread]: 
[0m21:13:50.347048 [error] [MainThread]: [33mDatabase Error in model dropoff_location_dim (models/transform/dropoff_location_dim.sql)[0m
[0m21:13:50.349021 [error] [MainThread]:   Syntax error: Unexpected "(" at [18:15]
[0m21:13:50.350787 [error] [MainThread]:   compiled Code at target/run/uber/models/transform/dropoff_location_dim.sql
[0m21:13:50.351972 [info ] [MainThread]: 
[0m21:13:50.353023 [error] [MainThread]: [33mDatabase Error in model payment_type_dim (models/transform/payment_type_dim.sql)[0m
[0m21:13:50.353879 [error] [MainThread]:   Syntax error: Unexpected "(" at [18:15]
[0m21:13:50.354644 [error] [MainThread]:   compiled Code at target/run/uber/models/transform/payment_type_dim.sql
[0m21:13:50.355386 [info ] [MainThread]: 
[0m21:13:50.356194 [error] [MainThread]: [33mDatabase Error in model pickup_location_dim (models/transform/pickup_location_dim.sql)[0m
[0m21:13:50.356937 [error] [MainThread]:   Syntax error: Unexpected "(" at [18:15]
[0m21:13:50.357721 [error] [MainThread]:   compiled Code at target/run/uber/models/transform/pickup_location_dim.sql
[0m21:13:50.358373 [info ] [MainThread]: 
[0m21:13:50.358955 [error] [MainThread]: [33mDatabase Error in model rate_code_dim (models/transform/rate_code_dim.sql)[0m
[0m21:13:50.359600 [error] [MainThread]:   Syntax error: Unexpected "(" at [18:15]
[0m21:13:50.360175 [error] [MainThread]:   compiled Code at target/run/uber/models/transform/rate_code_dim.sql
[0m21:13:50.360755 [info ] [MainThread]: 
[0m21:13:50.361399 [error] [MainThread]: [33mDatabase Error in model trip_distance (models/transform/trip_distance.sql)[0m
[0m21:13:50.362066 [error] [MainThread]:   Syntax error: Unexpected "(" at [18:15]
[0m21:13:50.362917 [error] [MainThread]:   compiled Code at target/run/uber/models/transform/trip_distance.sql
[0m21:13:50.363703 [info ] [MainThread]: 
[0m21:13:50.364484 [info ] [MainThread]: Done. PASS=2 WARN=0 ERROR=5 SKIP=0 TOTAL=7
[0m21:13:50.365948 [debug] [MainThread]: Command `dbt run` failed at 21:13:50.365735 after 18.22 seconds
[0m21:13:50.367122 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffa3a020d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffa383b450>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffa3d28f10>]}
[0m21:13:50.367858 [debug] [MainThread]: Flushing usage events
[0m21:16:45.038006 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffa90171d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffa8e35550>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffa92b5690>]}


============================== 21:16:45.043238 | 0758f3ed-dc8c-499d-8598-8f8c93cb810c ==============================
[0m21:16:45.043238 [info ] [MainThread]: Running with dbt=1.5.9
[0m21:16:45.044102 [debug] [MainThread]: running dbt with arguments {'partial_parse': 'True', 'log_format': 'default', 'quiet': 'False', 'no_print': 'None', 'version_check': 'True', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'use_experimental_parser': 'False', 'send_anonymous_usage_stats': 'True', 'static_parser': 'True', 'printer_width': '80', 'write_json': 'True', 'debug': 'False', 'log_cache_events': 'False', 'cache_selected_only': 'False', 'warn_error': 'None', 'target_path': 'None', 'fail_fast': 'False', 'log_path': '/usr/local/airflow/include/dbt/logs', 'profiles_dir': '/usr/local/airflow/include/dbt/', 'indirect_selection': 'eager', 'introspect': 'True', 'use_colors': 'True'}
[0m21:16:45.442964 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '0758f3ed-dc8c-499d-8598-8f8c93cb810c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffa87d0790>]}
[0m21:16:45.454555 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '0758f3ed-dc8c-499d-8598-8f8c93cb810c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffa6df2b50>]}
[0m21:16:45.455377 [info ] [MainThread]: Registered adapter: bigquery=1.5.3
[0m21:16:45.471016 [debug] [MainThread]: checksum: dd837546c89c9d03f3c2cb0ca6165266a30da6076d5d44e9991f7c5a8e5f5831, vars: {}, profile: , target: , version: 1.5.9
[0m21:16:45.534366 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m21:16:45.535530 [debug] [MainThread]: Partial parsing: updated file: uber://models/transform/trip_distance.sql
[0m21:16:45.557032 [debug] [MainThread]: 1603: static parser failed on transform/trip_distance.sql
[0m21:16:45.562086 [error] [MainThread]: Encountered an error:
Compilation Error in model trip_distance (models/transform/trip_distance.sql)
  macro 'dbt_macro__generate_series' takes not more than 1 argument(s)
[0m21:16:45.563349 [debug] [MainThread]: Command `dbt run` failed at 21:16:45.563207 after 0.53 seconds
[0m21:16:45.563941 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffa9001290>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffa6c51010>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffa6bfcf90>]}
[0m21:16:45.564539 [debug] [MainThread]: Flushing usage events
[0m21:49:54.892139 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffb9bc6150>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffb9c257d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffb9e93410>]}


============================== 21:49:54.901305 | 4691e881-1698-4dee-b639-746c82fe90b7 ==============================
[0m21:49:54.901305 [info ] [MainThread]: Running with dbt=1.5.9
[0m21:49:54.903432 [debug] [MainThread]: running dbt with arguments {'log_path': '/usr/local/airflow/include/dbt/logs', 'use_experimental_parser': 'False', 'indirect_selection': 'eager', 'no_print': 'None', 'target_path': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'log_cache_events': 'False', 'warn_error': 'None', 'introspect': 'True', 'use_colors': 'True', 'static_parser': 'True', 'write_json': 'True', 'partial_parse': 'True', 'send_anonymous_usage_stats': 'True', 'profiles_dir': '/usr/local/airflow/include/dbt/', 'cache_selected_only': 'False', 'debug': 'False', 'quiet': 'False', 'printer_width': '80', 'version_check': 'True', 'log_format': 'default', 'fail_fast': 'False'}
[0m21:49:55.681931 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '4691e881-1698-4dee-b639-746c82fe90b7', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffb7b4c310>]}
[0m21:49:55.695311 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '4691e881-1698-4dee-b639-746c82fe90b7', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffb9e93810>]}
[0m21:49:55.696419 [info ] [MainThread]: Registered adapter: bigquery=1.5.3
[0m21:49:55.718597 [debug] [MainThread]: checksum: dd837546c89c9d03f3c2cb0ca6165266a30da6076d5d44e9991f7c5a8e5f5831, vars: {}, profile: , target: , version: 1.5.9
[0m21:49:55.904336 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 3 files changed.
[0m21:49:55.916294 [debug] [MainThread]: Partial parsing: updated file: uber://models/transform/dropoff_location_dim.sql
[0m21:49:55.921368 [debug] [MainThread]: Partial parsing: updated file: uber://models/transform/trip_distance.sql
[0m21:49:55.924858 [debug] [MainThread]: Partial parsing: updated file: uber://models/transform/passenger_count_dim.sql
[0m21:49:55.987186 [debug] [MainThread]: 1603: static parser failed on transform/dropoff_location_dim.sql
[0m21:49:56.079730 [debug] [MainThread]: 1602: parser fallback to jinja rendering on transform/dropoff_location_dim.sql
[0m21:49:56.084121 [debug] [MainThread]: 1603: static parser failed on transform/trip_distance.sql
[0m21:49:56.095007 [error] [MainThread]: Encountered an error:
Compilation Error in model trip_distance (models/transform/trip_distance.sql)
  macro 'dbt_macro__generate_series' takes not more than 1 argument(s)
[0m21:49:56.098387 [debug] [MainThread]: Command `dbt run` failed at 21:49:56.097848 after 1.22 seconds
[0m21:49:56.099931 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffb9d7df90>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffb9a40f90>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffb7a63090>]}
[0m21:49:56.101316 [debug] [MainThread]: Flushing usage events
[0m21:50:46.564685 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff85bb3ed0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff85bb1350>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff85349350>]}


============================== 21:50:46.571073 | 737de5ae-b0a3-40bb-95b7-f095afb24ff0 ==============================
[0m21:50:46.571073 [info ] [MainThread]: Running with dbt=1.5.9
[0m21:50:46.572509 [debug] [MainThread]: running dbt with arguments {'send_anonymous_usage_stats': 'True', 'target_path': 'None', 'quiet': 'False', 'indirect_selection': 'eager', 'printer_width': '80', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'use_experimental_parser': 'False', 'introspect': 'True', 'log_format': 'default', 'no_print': 'None', 'static_parser': 'True', 'warn_error': 'None', 'cache_selected_only': 'False', 'profiles_dir': '/usr/local/airflow/include/dbt/', 'version_check': 'True', 'write_json': 'True', 'debug': 'False', 'partial_parse': 'True', 'log_path': '/usr/local/airflow/include/dbt/logs', 'use_colors': 'True', 'log_cache_events': 'False', 'fail_fast': 'False'}
[0m21:50:47.136608 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '737de5ae-b0a3-40bb-95b7-f095afb24ff0', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff83829010>]}
[0m21:50:47.154178 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '737de5ae-b0a3-40bb-95b7-f095afb24ff0', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff83829290>]}
[0m21:50:47.156807 [info ] [MainThread]: Registered adapter: bigquery=1.5.3
[0m21:50:47.194343 [debug] [MainThread]: checksum: dd837546c89c9d03f3c2cb0ca6165266a30da6076d5d44e9991f7c5a8e5f5831, vars: {}, profile: , target: , version: 1.5.9
[0m21:50:47.314072 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 3 files changed.
[0m21:50:47.316085 [debug] [MainThread]: Partial parsing: updated file: uber://models/transform/trip_distance.sql
[0m21:50:47.317729 [debug] [MainThread]: Partial parsing: updated file: uber://models/transform/dropoff_location_dim.sql
[0m21:50:47.319180 [debug] [MainThread]: Partial parsing: updated file: uber://models/transform/passenger_count_dim.sql
[0m21:50:47.362814 [debug] [MainThread]: 1603: static parser failed on transform/trip_distance.sql
[0m21:50:47.368447 [error] [MainThread]: Encountered an error:
Compilation Error in model trip_distance (models/transform/trip_distance.sql)
  unexpected '}'
    line 3
      {{ dbt_utils.generate_surrogate_key([])} as trip_distance_id,
[0m21:50:47.370819 [debug] [MainThread]: Command `dbt run` failed at 21:50:47.370398 after 0.82 seconds
[0m21:50:47.371883 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff8577f890>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff8541a190>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff85771a90>]}
[0m21:50:47.372810 [debug] [MainThread]: Flushing usage events
[0m21:51:02.566898 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff7bbfdc10>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff7bdb9ad0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff7bbeb390>]}


============================== 21:51:02.574954 | 3f8fca31-a929-4cda-a0e2-776cf63e3adc ==============================
[0m21:51:02.574954 [info ] [MainThread]: Running with dbt=1.5.9
[0m21:51:02.576815 [debug] [MainThread]: running dbt with arguments {'quiet': 'False', 'profiles_dir': '/usr/local/airflow/include/dbt/', 'cache_selected_only': 'False', 'fail_fast': 'False', 'send_anonymous_usage_stats': 'True', 'introspect': 'True', 'warn_error': 'None', 'use_experimental_parser': 'False', 'use_colors': 'True', 'log_format': 'default', 'partial_parse': 'True', 'no_print': 'None', 'debug': 'False', 'printer_width': '80', 'target_path': 'None', 'version_check': 'True', 'log_cache_events': 'False', 'log_path': '/usr/local/airflow/include/dbt/logs', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'static_parser': 'True', 'indirect_selection': 'eager', 'write_json': 'True'}
[0m21:51:03.075392 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '3f8fca31-a929-4cda-a0e2-776cf63e3adc', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff79b88290>]}
[0m21:51:03.087759 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '3f8fca31-a929-4cda-a0e2-776cf63e3adc', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff79b88110>]}
[0m21:51:03.088802 [info ] [MainThread]: Registered adapter: bigquery=1.5.3
[0m21:51:03.104303 [debug] [MainThread]: checksum: dd837546c89c9d03f3c2cb0ca6165266a30da6076d5d44e9991f7c5a8e5f5831, vars: {}, profile: , target: , version: 1.5.9
[0m21:51:03.182689 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 3 files changed.
[0m21:51:03.183600 [debug] [MainThread]: Partial parsing: updated file: uber://models/transform/dropoff_location_dim.sql
[0m21:51:03.184238 [debug] [MainThread]: Partial parsing: updated file: uber://models/transform/passenger_count_dim.sql
[0m21:51:03.184832 [debug] [MainThread]: Partial parsing: updated file: uber://models/transform/trip_distance.sql
[0m21:51:03.204550 [debug] [MainThread]: 1603: static parser failed on transform/dropoff_location_dim.sql
[0m21:51:03.228836 [debug] [MainThread]: 1602: parser fallback to jinja rendering on transform/dropoff_location_dim.sql
[0m21:51:03.231326 [debug] [MainThread]: 1603: static parser failed on transform/passenger_count_dim.sql
[0m21:51:03.236557 [debug] [MainThread]: 1602: parser fallback to jinja rendering on transform/passenger_count_dim.sql
[0m21:51:03.238460 [debug] [MainThread]: 1603: static parser failed on transform/trip_distance.sql
[0m21:51:03.243896 [debug] [MainThread]: 1602: parser fallback to jinja rendering on transform/trip_distance.sql
[0m21:51:03.258604 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '3f8fca31-a929-4cda-a0e2-776cf63e3adc', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff799f8c50>]}
[0m21:51:03.273268 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '3f8fca31-a929-4cda-a0e2-776cf63e3adc', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff79a34210>]}
[0m21:51:03.274047 [info ] [MainThread]: Found 7 models, 0 tests, 0 snapshots, 0 analyses, 474 macros, 0 operations, 0 seed files, 1 source, 0 exposures, 0 metrics, 0 groups
[0m21:51:03.275115 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '3f8fca31-a929-4cda-a0e2-776cf63e3adc', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff7ea9f6d0>]}
[0m21:51:03.277052 [info ] [MainThread]: 
[0m21:51:03.278995 [debug] [MainThread]: Acquiring new bigquery connection 'master'
[0m21:51:03.282947 [debug] [ThreadPool]: Acquiring new bigquery connection 'list_uber-data-engineering-407103'
[0m21:51:03.284061 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m21:51:05.929395 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_uber-data-engineering-407103, now list_uber-data-engineering-407103_uber)
[0m21:51:05.933773 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m21:51:07.560711 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '3f8fca31-a929-4cda-a0e2-776cf63e3adc', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff7bf1a190>]}
[0m21:51:07.565895 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m21:51:07.569494 [info ] [MainThread]: 
[0m21:51:07.616997 [debug] [Thread-1 (]: Began running node model.uber.datetime_dim
[0m21:51:07.618924 [info ] [Thread-1 (]: 1 of 7 START sql table model uber.datetime_dim ................................. [RUN]
[0m21:51:07.621085 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_uber-data-engineering-407103_uber, now model.uber.datetime_dim)
[0m21:51:07.623027 [debug] [Thread-1 (]: Began compiling node model.uber.datetime_dim
[0m21:51:07.637102 [debug] [Thread-1 (]: Writing injected SQL for node "model.uber.datetime_dim"
[0m21:51:07.641509 [debug] [Thread-1 (]: Timing info for model.uber.datetime_dim (compile): 21:51:07.623857 => 21:51:07.641065
[0m21:51:07.642299 [debug] [Thread-1 (]: Began executing node model.uber.datetime_dim
[0m21:51:07.660796 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m21:51:08.481322 [debug] [Thread-1 (]: Writing runtime sql for node "model.uber.datetime_dim"
[0m21:51:08.485677 [debug] [Thread-1 (]: On model.uber.datetime_dim: /* {"app": "dbt", "dbt_version": "1.5.9", "profile_name": "uber", "target_name": "dev", "node_id": "model.uber.datetime_dim"} */

  
    

    create or replace table `uber-data-engineering-407103`.`uber`.`datetime_dim`
    
    

    OPTIONS()
    as (
      WITH datetime_cte AS (  
  SELECT DISTINCT
    tpep_pickup_datetime AS datetime_id,
    CASE
      WHEN LENGTH(tpep_pickup_datetime) = 16 THEN
        -- Date format: "DD/MM/YYYY HH:MM"
        PARSE_DATETIME('%m/%d/%Y %H:%M', tpep_pickup_datetime)
      WHEN LENGTH(tpep_pickup_datetime) <= 14 THEN
        -- Date format: "MM/DD/YY HH:MM"
        PARSE_DATETIME('%m/%d/%y %H:%M', tpep_pickup_datetime)
      ELSE
        NULL
    END AS pick_date_part,
    tpep_dropoff_datetime AS drop_datetime_id,
    CASE
      WHEN LENGTH(tpep_dropoff_datetime) = 16 THEN
        -- Date format: "DD/MM/YYYY HH:MM"
        PARSE_DATETIME('%m/%d/%Y %H:%M', tpep_dropoff_datetime)
      WHEN LENGTH(tpep_dropoff_datetime) <= 14 THEN
        -- Date format: "MM/DD/YY HH:MM"
        PARSE_DATETIME('%m/%d/%y %H:%M', tpep_dropoff_datetime)
      ELSE
        NULL
    END AS drop_date_part
  FROM `uber-data-engineering-407103`.`uber`.`uber_tlc_trip_recrord_data`
  WHERE tpep_pickup_datetime IS NOT NULL
    AND tpep_dropoff_datetime IS NOT NULL
)
SELECT
  datetime_id,
  pick_date_part AS tpep_pickup_datetime,
  drop_date_part AS tpep_dropoff_datetime,
  EXTRACT(HOUR FROM pick_date_part) AS pick_hour,
  EXTRACT(DAY FROM pick_date_part) AS pick_day,
  EXTRACT(MONTH FROM pick_date_part) AS pick_month,
  EXTRACT(YEAR FROM pick_date_part) AS pick_year,
  EXTRACT(DAYOFWEEK FROM pick_date_part) AS pick_weekday,
  EXTRACT(HOUR FROM drop_date_part) AS drop_hour,
  EXTRACT(DAY FROM drop_date_part) AS drop_day,
  EXTRACT(MONTH FROM drop_date_part) AS drop_month,
  EXTRACT(YEAR FROM drop_date_part) AS drop_year,
  EXTRACT(DAYOFWEEK FROM drop_date_part) AS drop_weekday
FROM datetime_cte
    );
  
[0m21:51:11.437866 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=uber-data-engineering-407103&j=bq:US:c6d438f1-f808-442e-9da3-9d224fff55df&page=queryresults
[0m21:51:11.463658 [debug] [Thread-1 (]: Timing info for model.uber.datetime_dim (execute): 21:51:07.642765 => 21:51:11.463178
[0m21:51:11.465823 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '3f8fca31-a929-4cda-a0e2-776cf63e3adc', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff799fdcd0>]}
[0m21:51:11.467503 [info ] [Thread-1 (]: 1 of 7 OK created sql table model uber.datetime_dim ............................ [[32mCREATE TABLE (99.9k rows, 4.0 MiB processed)[0m in 3.84s]
[0m21:51:11.469231 [debug] [Thread-1 (]: Finished running node model.uber.datetime_dim
[0m21:51:11.470331 [debug] [Thread-1 (]: Began running node model.uber.dropoff_location_dim
[0m21:51:11.471929 [info ] [Thread-1 (]: 2 of 7 START sql table model uber.dropoff_location_dim ......................... [RUN]
[0m21:51:11.473514 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.uber.datetime_dim, now model.uber.dropoff_location_dim)
[0m21:51:11.474367 [debug] [Thread-1 (]: Began compiling node model.uber.dropoff_location_dim
[0m21:51:11.482398 [debug] [Thread-1 (]: Writing injected SQL for node "model.uber.dropoff_location_dim"
[0m21:51:11.486660 [debug] [Thread-1 (]: Timing info for model.uber.dropoff_location_dim (compile): 21:51:11.474927 => 21:51:11.486433
[0m21:51:11.487384 [debug] [Thread-1 (]: Began executing node model.uber.dropoff_location_dim
[0m21:51:11.491447 [debug] [Thread-1 (]: Writing runtime sql for node "model.uber.dropoff_location_dim"
[0m21:51:11.494165 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m21:51:11.499129 [debug] [Thread-1 (]: On model.uber.dropoff_location_dim: /* {"app": "dbt", "dbt_version": "1.5.9", "profile_name": "uber", "target_name": "dev", "node_id": "model.uber.dropoff_location_dim"} */

  
    

    create or replace table `uber-data-engineering-407103`.`uber`.`dropoff_location_dim`
    
    

    OPTIONS()
    as (
      WITH numbered_rows AS (
  SELECT
    to_hex(md5(cast( as STRING))) as dropoff_location_id,
    dropoff_latitude AS dropoff_latitude,
    dropoff_longitude AS dropoff_longitude,
    ROW_NUMBER() OVER (ORDER BY dropoff_latitude, dropoff_longitude) as row_num
  FROM `uber-data-engineering-407103`.`uber`.`uber_tlc_trip_recrord_data`
)
SELECT
  dropoff_location_id,
  dropoff_latitude,
  dropoff_longitude
FROM numbered_rows
    );
  
[0m21:51:12.130536 [debug] [Thread-1 (]: BigQuery adapter: Retry attempt 1 of 1 after error: BadRequest('Syntax error: Unexpected keyword AS at [14:22]')
[0m21:51:13.120219 [error] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=uber-data-engineering-407103&j=bq:US:0e3ea67c-c01c-4c72-8c25-af02f3c69e42&page=queryresults
[0m21:51:13.123864 [debug] [Thread-1 (]: Timing info for model.uber.dropoff_location_dim (execute): 21:51:11.487786 => 21:51:13.123355
[0m21:51:13.143392 [debug] [Thread-1 (]: Database Error in model dropoff_location_dim (models/transform/dropoff_location_dim.sql)
  Syntax error: Unexpected keyword AS at [14:22]
  compiled Code at target/run/uber/models/transform/dropoff_location_dim.sql
[0m21:51:13.144849 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '3f8fca31-a929-4cda-a0e2-776cf63e3adc', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff799aa450>]}
[0m21:51:13.146941 [error] [Thread-1 (]: 2 of 7 ERROR creating sql table model uber.dropoff_location_dim ................ [[31mERROR[0m in 1.67s]
[0m21:51:13.148175 [debug] [Thread-1 (]: Finished running node model.uber.dropoff_location_dim
[0m21:51:13.148848 [debug] [Thread-1 (]: Began running node model.uber.passenger_count_dim
[0m21:51:13.149828 [info ] [Thread-1 (]: 3 of 7 START sql table model uber.passenger_count_dim .......................... [RUN]
[0m21:51:13.151349 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.uber.dropoff_location_dim, now model.uber.passenger_count_dim)
[0m21:51:13.152021 [debug] [Thread-1 (]: Began compiling node model.uber.passenger_count_dim
[0m21:51:13.156429 [debug] [Thread-1 (]: Writing injected SQL for node "model.uber.passenger_count_dim"
[0m21:51:13.161339 [debug] [Thread-1 (]: Timing info for model.uber.passenger_count_dim (compile): 21:51:13.152469 => 21:51:13.160555
[0m21:51:13.162176 [debug] [Thread-1 (]: Began executing node model.uber.passenger_count_dim
[0m21:51:13.165786 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m21:51:13.690615 [debug] [Thread-1 (]: Writing runtime sql for node "model.uber.passenger_count_dim"
[0m21:51:13.694907 [debug] [Thread-1 (]: On model.uber.passenger_count_dim: /* {"app": "dbt", "dbt_version": "1.5.9", "profile_name": "uber", "target_name": "dev", "node_id": "model.uber.passenger_count_dim"} */

  
    

    create or replace table `uber-data-engineering-407103`.`uber`.`passenger_count_dim`
    
    

    OPTIONS()
    as (
      SELECT DISTINCT
    to_hex(md5(cast( as STRING))) as passenger_count_id,
		passenger_count AS passenger_count,
FROM `uber-data-engineering-407103`.`uber`.`uber_tlc_trip_recrord_data`
WHERE passenger_count IS NOT NULL
    );
  
[0m21:51:13.867773 [debug] [Thread-1 (]: BigQuery adapter: Retry attempt 1 of 1 after error: BadRequest('Syntax error: Unexpected keyword AS at [13:22]')
[0m21:51:14.180616 [error] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=uber-data-engineering-407103&j=bq:US:52662204-6aa3-453b-a95f-793ccda08996&page=queryresults
[0m21:51:14.182811 [debug] [Thread-1 (]: Timing info for model.uber.passenger_count_dim (execute): 21:51:13.162576 => 21:51:14.182396
[0m21:51:14.190430 [debug] [Thread-1 (]: Database Error in model passenger_count_dim (models/transform/passenger_count_dim.sql)
  Syntax error: Unexpected keyword AS at [13:22]
  compiled Code at target/run/uber/models/transform/passenger_count_dim.sql
[0m21:51:14.191758 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '3f8fca31-a929-4cda-a0e2-776cf63e3adc', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff79a68890>]}
[0m21:51:14.193459 [error] [Thread-1 (]: 3 of 7 ERROR creating sql table model uber.passenger_count_dim ................. [[31mERROR[0m in 1.04s]
[0m21:51:14.195430 [debug] [Thread-1 (]: Finished running node model.uber.passenger_count_dim
[0m21:51:14.196898 [debug] [Thread-1 (]: Began running node model.uber.payment_type_dim
[0m21:51:14.198669 [info ] [Thread-1 (]: 4 of 7 START sql table model uber.payment_type_dim ............................. [RUN]
[0m21:51:14.203670 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.uber.passenger_count_dim, now model.uber.payment_type_dim)
[0m21:51:14.205754 [debug] [Thread-1 (]: Began compiling node model.uber.payment_type_dim
[0m21:51:14.229149 [debug] [Thread-1 (]: Writing injected SQL for node "model.uber.payment_type_dim"
[0m21:51:14.234343 [debug] [Thread-1 (]: Timing info for model.uber.payment_type_dim (compile): 21:51:14.207272 => 21:51:14.233435
[0m21:51:14.235951 [debug] [Thread-1 (]: Began executing node model.uber.payment_type_dim
[0m21:51:14.246095 [debug] [Thread-1 (]: Writing runtime sql for node "model.uber.payment_type_dim"
[0m21:51:14.251461 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m21:51:14.256544 [debug] [Thread-1 (]: On model.uber.payment_type_dim: /* {"app": "dbt", "dbt_version": "1.5.9", "profile_name": "uber", "target_name": "dev", "node_id": "model.uber.payment_type_dim"} */

  
    

    create or replace table `uber-data-engineering-407103`.`uber`.`payment_type_dim`
    
    

    OPTIONS()
    as (
      WITH numbered_rows AS (
  SELECT
    

    

    with p as (
        select 0 as generated_number union all select 1
    ), unioned as (

    select

    
    p0.generated_number * power(2, 0)
    
    
    + 1
    as generated_number

    from

    
    p as p0
    
    

    )

    select *
    from unioned
    where generated_number <= 1
    order by generated_number

 as payment_type_id,
    payment_type AS payment_type,
    ROW_NUMBER() OVER (ORDER BY payment_type) as row_num
  FROM `uber-data-engineering-407103`.`uber`.`uber_tlc_trip_recrord_data`
  WHERE payment_type IS NOT NULL
)
SELECT
  payment_type_id,
  payment_type
FROM numbered_rows
    );
  
[0m21:51:15.217993 [debug] [Thread-1 (]: BigQuery adapter: Retry attempt 1 of 1 after error: BadRequest('Syntax error: Unexpected "(" at [18:15]')
[0m21:51:15.727636 [error] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=uber-data-engineering-407103&j=bq:US:d60bd39b-fd85-450e-b6b7-a00f68091413&page=queryresults
[0m21:51:15.729793 [debug] [Thread-1 (]: Timing info for model.uber.payment_type_dim (execute): 21:51:14.237050 => 21:51:15.729386
[0m21:51:15.736361 [debug] [Thread-1 (]: Database Error in model payment_type_dim (models/transform/payment_type_dim.sql)
  Syntax error: Unexpected "(" at [18:15]
  compiled Code at target/run/uber/models/transform/payment_type_dim.sql
[0m21:51:15.737995 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '3f8fca31-a929-4cda-a0e2-776cf63e3adc', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff78717a90>]}
[0m21:51:15.739983 [error] [Thread-1 (]: 4 of 7 ERROR creating sql table model uber.payment_type_dim .................... [[31mERROR[0m in 1.53s]
[0m21:51:15.741156 [debug] [Thread-1 (]: Finished running node model.uber.payment_type_dim
[0m21:51:15.742144 [debug] [Thread-1 (]: Began running node model.uber.pickup_location_dim
[0m21:51:15.743715 [info ] [Thread-1 (]: 5 of 7 START sql table model uber.pickup_location_dim .......................... [RUN]
[0m21:51:15.744913 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.uber.payment_type_dim, now model.uber.pickup_location_dim)
[0m21:51:15.745516 [debug] [Thread-1 (]: Began compiling node model.uber.pickup_location_dim
[0m21:51:15.755695 [debug] [Thread-1 (]: Writing injected SQL for node "model.uber.pickup_location_dim"
[0m21:51:15.758518 [debug] [Thread-1 (]: Timing info for model.uber.pickup_location_dim (compile): 21:51:15.746004 => 21:51:15.758288
[0m21:51:15.759122 [debug] [Thread-1 (]: Began executing node model.uber.pickup_location_dim
[0m21:51:15.772528 [debug] [Thread-1 (]: Writing runtime sql for node "model.uber.pickup_location_dim"
[0m21:51:15.776179 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m21:51:15.778877 [debug] [Thread-1 (]: On model.uber.pickup_location_dim: /* {"app": "dbt", "dbt_version": "1.5.9", "profile_name": "uber", "target_name": "dev", "node_id": "model.uber.pickup_location_dim"} */

  
    

    create or replace table `uber-data-engineering-407103`.`uber`.`pickup_location_dim`
    
    

    OPTIONS()
    as (
      WITH numbered_rows AS (
  SELECT
    

    

    with p as (
        select 0 as generated_number union all select 1
    ), unioned as (

    select

    
    p0.generated_number * power(2, 0)
    
    
    + 1
    as generated_number

    from

    
    p as p0
    
    

    )

    select *
    from unioned
    where generated_number <= 1
    order by generated_number

 as pickup_location_id,
    pickup_latitude AS pickup_latitude,
    pickup_longitude AS pickup_longitude,
    ROW_NUMBER() OVER (ORDER BY pickup_latitude, pickup_longitude) as row_num
  FROM `uber-data-engineering-407103`.`uber`.`uber_tlc_trip_recrord_data`
)
SELECT
  pickup_location_id,
  pickup_latitude,
  pickup_longitude
FROM numbered_rows
    );
  
[0m21:51:16.300273 [debug] [Thread-1 (]: BigQuery adapter: Retry attempt 1 of 1 after error: BadRequest('Syntax error: Unexpected "(" at [18:15]')
[0m21:51:16.815538 [error] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=uber-data-engineering-407103&j=bq:US:559690d7-34e1-4273-a53f-330395982049&page=queryresults
[0m21:51:16.818273 [debug] [Thread-1 (]: Timing info for model.uber.pickup_location_dim (execute): 21:51:15.759551 => 21:51:16.817642
[0m21:51:16.825012 [debug] [Thread-1 (]: Database Error in model pickup_location_dim (models/transform/pickup_location_dim.sql)
  Syntax error: Unexpected "(" at [18:15]
  compiled Code at target/run/uber/models/transform/pickup_location_dim.sql
[0m21:51:16.826801 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '3f8fca31-a929-4cda-a0e2-776cf63e3adc', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff7873aa90>]}
[0m21:51:16.828868 [error] [Thread-1 (]: 5 of 7 ERROR creating sql table model uber.pickup_location_dim ................. [[31mERROR[0m in 1.08s]
[0m21:51:16.831170 [debug] [Thread-1 (]: Finished running node model.uber.pickup_location_dim
[0m21:51:16.832619 [debug] [Thread-1 (]: Began running node model.uber.rate_code_dim
[0m21:51:16.833954 [info ] [Thread-1 (]: 6 of 7 START sql table model uber.rate_code_dim ................................ [RUN]
[0m21:51:16.836021 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.uber.pickup_location_dim, now model.uber.rate_code_dim)
[0m21:51:16.837173 [debug] [Thread-1 (]: Began compiling node model.uber.rate_code_dim
[0m21:51:16.847782 [debug] [Thread-1 (]: Writing injected SQL for node "model.uber.rate_code_dim"
[0m21:51:16.851612 [debug] [Thread-1 (]: Timing info for model.uber.rate_code_dim (compile): 21:51:16.837928 => 21:51:16.851099
[0m21:51:16.852590 [debug] [Thread-1 (]: Began executing node model.uber.rate_code_dim
[0m21:51:16.857082 [debug] [Thread-1 (]: Writing runtime sql for node "model.uber.rate_code_dim"
[0m21:51:16.861522 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m21:51:16.866804 [debug] [Thread-1 (]: On model.uber.rate_code_dim: /* {"app": "dbt", "dbt_version": "1.5.9", "profile_name": "uber", "target_name": "dev", "node_id": "model.uber.rate_code_dim"} */

  
    

    create or replace table `uber-data-engineering-407103`.`uber`.`rate_code_dim`
    
    

    OPTIONS()
    as (
      WITH numbered_rows AS (
  SELECT
    

    

    with p as (
        select 0 as generated_number union all select 1
    ), unioned as (

    select

    
    p0.generated_number * power(2, 0)
    
    
    + 1
    as generated_number

    from

    
    p as p0
    
    

    )

    select *
    from unioned
    where generated_number <= 1
    order by generated_number

 as rate_code_id,
    RatecodeID AS RatecodeID,
    ROW_NUMBER() OVER (ORDER BY RatecodeID) as row_num
  FROM `uber-data-engineering-407103`.`uber`.`uber_tlc_trip_recrord_data`
  WHERE RatecodeID IS NOT NULL
)
SELECT
  rate_code_id,
  rate_code
FROM numbered_rows
    );
  
[0m21:51:17.949479 [debug] [Thread-1 (]: BigQuery adapter: Retry attempt 1 of 1 after error: BadRequest('Syntax error: Unexpected "(" at [18:15]')
[0m21:51:18.615586 [error] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=uber-data-engineering-407103&j=bq:US:e9a51961-5bfe-4dd6-b314-8b85a489b3d1&page=queryresults
[0m21:51:18.620826 [debug] [Thread-1 (]: Timing info for model.uber.rate_code_dim (execute): 21:51:16.853299 => 21:51:18.620069
[0m21:51:18.628995 [debug] [Thread-1 (]: Database Error in model rate_code_dim (models/transform/rate_code_dim.sql)
  Syntax error: Unexpected "(" at [18:15]
  compiled Code at target/run/uber/models/transform/rate_code_dim.sql
[0m21:51:18.631132 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '3f8fca31-a929-4cda-a0e2-776cf63e3adc', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff787383d0>]}
[0m21:51:18.635941 [error] [Thread-1 (]: 6 of 7 ERROR creating sql table model uber.rate_code_dim ....................... [[31mERROR[0m in 1.79s]
[0m21:51:18.641199 [debug] [Thread-1 (]: Finished running node model.uber.rate_code_dim
[0m21:51:18.644239 [debug] [Thread-1 (]: Began running node model.uber.trip_distance
[0m21:51:18.648143 [info ] [Thread-1 (]: 7 of 7 START sql table model uber.trip_distance ................................ [RUN]
[0m21:51:18.651157 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.uber.rate_code_dim, now model.uber.trip_distance)
[0m21:51:18.653740 [debug] [Thread-1 (]: Began compiling node model.uber.trip_distance
[0m21:51:18.674325 [debug] [Thread-1 (]: Writing injected SQL for node "model.uber.trip_distance"
[0m21:51:18.680793 [debug] [Thread-1 (]: Timing info for model.uber.trip_distance (compile): 21:51:18.655306 => 21:51:18.680333
[0m21:51:18.681643 [debug] [Thread-1 (]: Began executing node model.uber.trip_distance
[0m21:51:18.686280 [debug] [Thread-1 (]: Writing runtime sql for node "model.uber.trip_distance"
[0m21:51:18.688845 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m21:51:18.692347 [debug] [Thread-1 (]: On model.uber.trip_distance: /* {"app": "dbt", "dbt_version": "1.5.9", "profile_name": "uber", "target_name": "dev", "node_id": "model.uber.trip_distance"} */

  
    

    create or replace table `uber-data-engineering-407103`.`uber`.`trip_distance`
    
    

    OPTIONS()
    as (
      WITH numbered_rows AS (
  SELECT
    to_hex(md5(cast( as STRING))) as trip_distance_id,
    trip_distance AS trip_distance,
    ROW_NUMBER() OVER (ORDER BY trip_distance) as row_num
  FROM `uber-data-engineering-407103`.`uber`.`uber_tlc_trip_recrord_data`
  WHERE trip_distance IS NOT NULL
)
SELECT
  trip_distance_id,
  trip_distance
FROM numbered_rows
    );
  
[0m21:51:19.397547 [debug] [Thread-1 (]: BigQuery adapter: Retry attempt 1 of 1 after error: BadRequest('Syntax error: Unexpected keyword AS at [14:22]')
[0m21:51:20.276984 [error] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=uber-data-engineering-407103&j=bq:US:cd7380bd-36b8-47ca-8d0e-e272fff426fb&page=queryresults
[0m21:51:20.279736 [debug] [Thread-1 (]: Timing info for model.uber.trip_distance (execute): 21:51:18.682231 => 21:51:20.279277
[0m21:51:20.286650 [debug] [Thread-1 (]: Database Error in model trip_distance (models/transform/trip_distance.sql)
  Syntax error: Unexpected keyword AS at [14:22]
  compiled Code at target/run/uber/models/transform/trip_distance.sql
[0m21:51:20.288527 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '3f8fca31-a929-4cda-a0e2-776cf63e3adc', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff79a46150>]}
[0m21:51:20.290207 [error] [Thread-1 (]: 7 of 7 ERROR creating sql table model uber.trip_distance ....................... [[31mERROR[0m in 1.64s]
[0m21:51:20.291498 [debug] [Thread-1 (]: Finished running node model.uber.trip_distance
[0m21:51:20.302241 [debug] [MainThread]: Connection 'master' was properly closed.
[0m21:51:20.303380 [debug] [MainThread]: Connection 'model.uber.trip_distance' was properly closed.
[0m21:51:20.304920 [info ] [MainThread]: 
[0m21:51:20.307399 [info ] [MainThread]: Finished running 7 table models in 0 hours 0 minutes and 17.03 seconds (17.03s).
[0m21:51:20.310661 [debug] [MainThread]: Command end result
[0m21:51:20.335212 [info ] [MainThread]: 
[0m21:51:20.336756 [info ] [MainThread]: [31mCompleted with 6 errors and 0 warnings:[0m
[0m21:51:20.337807 [info ] [MainThread]: 
[0m21:51:20.339304 [error] [MainThread]: [33mDatabase Error in model dropoff_location_dim (models/transform/dropoff_location_dim.sql)[0m
[0m21:51:20.340729 [error] [MainThread]:   Syntax error: Unexpected keyword AS at [14:22]
[0m21:51:20.342207 [error] [MainThread]:   compiled Code at target/run/uber/models/transform/dropoff_location_dim.sql
[0m21:51:20.343186 [info ] [MainThread]: 
[0m21:51:20.343889 [error] [MainThread]: [33mDatabase Error in model passenger_count_dim (models/transform/passenger_count_dim.sql)[0m
[0m21:51:20.344531 [error] [MainThread]:   Syntax error: Unexpected keyword AS at [13:22]
[0m21:51:20.345250 [error] [MainThread]:   compiled Code at target/run/uber/models/transform/passenger_count_dim.sql
[0m21:51:20.345892 [info ] [MainThread]: 
[0m21:51:20.346863 [error] [MainThread]: [33mDatabase Error in model payment_type_dim (models/transform/payment_type_dim.sql)[0m
[0m21:51:20.347548 [error] [MainThread]:   Syntax error: Unexpected "(" at [18:15]
[0m21:51:20.348244 [error] [MainThread]:   compiled Code at target/run/uber/models/transform/payment_type_dim.sql
[0m21:51:20.348945 [info ] [MainThread]: 
[0m21:51:20.349786 [error] [MainThread]: [33mDatabase Error in model pickup_location_dim (models/transform/pickup_location_dim.sql)[0m
[0m21:51:20.350451 [error] [MainThread]:   Syntax error: Unexpected "(" at [18:15]
[0m21:51:20.351056 [error] [MainThread]:   compiled Code at target/run/uber/models/transform/pickup_location_dim.sql
[0m21:51:20.352031 [info ] [MainThread]: 
[0m21:51:20.352914 [error] [MainThread]: [33mDatabase Error in model rate_code_dim (models/transform/rate_code_dim.sql)[0m
[0m21:51:20.353670 [error] [MainThread]:   Syntax error: Unexpected "(" at [18:15]
[0m21:51:20.354324 [error] [MainThread]:   compiled Code at target/run/uber/models/transform/rate_code_dim.sql
[0m21:51:20.354990 [info ] [MainThread]: 
[0m21:51:20.355543 [error] [MainThread]: [33mDatabase Error in model trip_distance (models/transform/trip_distance.sql)[0m
[0m21:51:20.356131 [error] [MainThread]:   Syntax error: Unexpected keyword AS at [14:22]
[0m21:51:20.356765 [error] [MainThread]:   compiled Code at target/run/uber/models/transform/trip_distance.sql
[0m21:51:20.357588 [info ] [MainThread]: 
[0m21:51:20.358585 [info ] [MainThread]: Done. PASS=1 WARN=0 ERROR=6 SKIP=0 TOTAL=7
[0m21:51:20.360263 [debug] [MainThread]: Command `dbt run` failed at 21:51:20.360095 after 17.81 seconds
[0m21:51:20.361107 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff7bf19190>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff7ba7a0d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff7fa4a350>]}
[0m21:51:20.361672 [debug] [MainThread]: Flushing usage events
[0m21:59:00.544050 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff931b3b90>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff92c975d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff957f3690>]}


============================== 21:59:00.549833 | 9a463ef3-919f-4b58-837e-5ca6839de367 ==============================
[0m21:59:00.549833 [info ] [MainThread]: Running with dbt=1.5.9
[0m21:59:00.550831 [debug] [MainThread]: running dbt with arguments {'write_json': 'True', 'quiet': 'False', 'indirect_selection': 'eager', 'cache_selected_only': 'False', 'log_path': '/usr/local/airflow/include/dbt/logs', 'no_print': 'None', 'debug': 'False', 'version_check': 'True', 'warn_error': 'None', 'partial_parse': 'True', 'log_cache_events': 'False', 'log_format': 'default', 'target_path': 'None', 'fail_fast': 'False', 'printer_width': '80', 'use_colors': 'True', 'profiles_dir': '/usr/local/airflow/include/dbt/', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'introspect': 'True', 'static_parser': 'True', 'send_anonymous_usage_stats': 'True', 'use_experimental_parser': 'False'}
[0m21:59:01.288306 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '9a463ef3-919f-4b58-837e-5ca6839de367', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff912939d0>]}
[0m21:59:01.302143 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '9a463ef3-919f-4b58-837e-5ca6839de367', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff9331b950>]}
[0m21:59:01.303320 [info ] [MainThread]: Registered adapter: bigquery=1.5.3
[0m21:59:01.323578 [debug] [MainThread]: checksum: dd837546c89c9d03f3c2cb0ca6165266a30da6076d5d44e9991f7c5a8e5f5831, vars: {}, profile: , target: , version: 1.5.9
[0m21:59:01.428863 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m21:59:01.429790 [debug] [MainThread]: Partial parsing: updated file: uber://models/transform/dropoff_location_dim.sql
[0m21:59:01.452204 [debug] [MainThread]: 1603: static parser failed on transform/dropoff_location_dim.sql
[0m21:59:01.474767 [debug] [MainThread]: 1602: parser fallback to jinja rendering on transform/dropoff_location_dim.sql
[0m21:59:01.491406 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '9a463ef3-919f-4b58-837e-5ca6839de367', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff9107cd10>]}
[0m21:59:01.518443 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '9a463ef3-919f-4b58-837e-5ca6839de367', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff91137050>]}
[0m21:59:01.519722 [info ] [MainThread]: Found 7 models, 0 tests, 0 snapshots, 0 analyses, 474 macros, 0 operations, 0 seed files, 1 source, 0 exposures, 0 metrics, 0 groups
[0m21:59:01.520734 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '9a463ef3-919f-4b58-837e-5ca6839de367', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff96193490>]}
[0m21:59:01.524967 [info ] [MainThread]: 
[0m21:59:01.526327 [debug] [MainThread]: Acquiring new bigquery connection 'master'
[0m21:59:01.528018 [debug] [ThreadPool]: Acquiring new bigquery connection 'list_uber-data-engineering-407103'
[0m21:59:01.528617 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m21:59:02.503740 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_uber-data-engineering-407103, now list_uber-data-engineering-407103_uber)
[0m21:59:02.506871 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m21:59:03.010127 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '9a463ef3-919f-4b58-837e-5ca6839de367', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff9105acd0>]}
[0m21:59:03.026761 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m21:59:03.031029 [info ] [MainThread]: 
[0m21:59:03.061244 [debug] [Thread-1 (]: Began running node model.uber.datetime_dim
[0m21:59:03.062320 [info ] [Thread-1 (]: 1 of 7 START sql table model uber.datetime_dim ................................. [RUN]
[0m21:59:03.063401 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_uber-data-engineering-407103_uber, now model.uber.datetime_dim)
[0m21:59:03.063996 [debug] [Thread-1 (]: Began compiling node model.uber.datetime_dim
[0m21:59:03.073864 [debug] [Thread-1 (]: Writing injected SQL for node "model.uber.datetime_dim"
[0m21:59:03.078215 [debug] [Thread-1 (]: Timing info for model.uber.datetime_dim (compile): 21:59:03.064462 => 21:59:03.077672
[0m21:59:03.079143 [debug] [Thread-1 (]: Began executing node model.uber.datetime_dim
[0m21:59:03.095264 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m21:59:03.623963 [debug] [Thread-1 (]: Writing runtime sql for node "model.uber.datetime_dim"
[0m21:59:03.626935 [debug] [Thread-1 (]: On model.uber.datetime_dim: /* {"app": "dbt", "dbt_version": "1.5.9", "profile_name": "uber", "target_name": "dev", "node_id": "model.uber.datetime_dim"} */

  
    

    create or replace table `uber-data-engineering-407103`.`uber`.`datetime_dim`
    
    

    OPTIONS()
    as (
      WITH datetime_cte AS (  
  SELECT DISTINCT
    tpep_pickup_datetime AS datetime_id,
    CASE
      WHEN LENGTH(tpep_pickup_datetime) = 16 THEN
        -- Date format: "DD/MM/YYYY HH:MM"
        PARSE_DATETIME('%m/%d/%Y %H:%M', tpep_pickup_datetime)
      WHEN LENGTH(tpep_pickup_datetime) <= 14 THEN
        -- Date format: "MM/DD/YY HH:MM"
        PARSE_DATETIME('%m/%d/%y %H:%M', tpep_pickup_datetime)
      ELSE
        NULL
    END AS pick_date_part,
    tpep_dropoff_datetime AS drop_datetime_id,
    CASE
      WHEN LENGTH(tpep_dropoff_datetime) = 16 THEN
        -- Date format: "DD/MM/YYYY HH:MM"
        PARSE_DATETIME('%m/%d/%Y %H:%M', tpep_dropoff_datetime)
      WHEN LENGTH(tpep_dropoff_datetime) <= 14 THEN
        -- Date format: "MM/DD/YY HH:MM"
        PARSE_DATETIME('%m/%d/%y %H:%M', tpep_dropoff_datetime)
      ELSE
        NULL
    END AS drop_date_part
  FROM `uber-data-engineering-407103`.`uber`.`uber_tlc_trip_recrord_data`
  WHERE tpep_pickup_datetime IS NOT NULL
    AND tpep_dropoff_datetime IS NOT NULL
)
SELECT
  datetime_id,
  pick_date_part AS tpep_pickup_datetime,
  drop_date_part AS tpep_dropoff_datetime,
  EXTRACT(HOUR FROM pick_date_part) AS pick_hour,
  EXTRACT(DAY FROM pick_date_part) AS pick_day,
  EXTRACT(MONTH FROM pick_date_part) AS pick_month,
  EXTRACT(YEAR FROM pick_date_part) AS pick_year,
  EXTRACT(DAYOFWEEK FROM pick_date_part) AS pick_weekday,
  EXTRACT(HOUR FROM drop_date_part) AS drop_hour,
  EXTRACT(DAY FROM drop_date_part) AS drop_day,
  EXTRACT(MONTH FROM drop_date_part) AS drop_month,
  EXTRACT(YEAR FROM drop_date_part) AS drop_year,
  EXTRACT(DAYOFWEEK FROM drop_date_part) AS drop_weekday
FROM datetime_cte
    );
  
[0m21:59:06.538016 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=uber-data-engineering-407103&j=bq:US:e0628e14-6b3e-4573-bb21-ad9e0d217c26&page=queryresults
[0m21:59:06.619836 [debug] [Thread-1 (]: Timing info for model.uber.datetime_dim (execute): 21:59:03.079631 => 21:59:06.617398
[0m21:59:06.633103 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '9a463ef3-919f-4b58-837e-5ca6839de367', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff9334c890>]}
[0m21:59:06.639903 [info ] [Thread-1 (]: 1 of 7 OK created sql table model uber.datetime_dim ............................ [[32mCREATE TABLE (99.9k rows, 4.0 MiB processed)[0m in 3.57s]
[0m21:59:06.650908 [debug] [Thread-1 (]: Finished running node model.uber.datetime_dim
[0m21:59:06.653017 [debug] [Thread-1 (]: Began running node model.uber.dropoff_location_dim
[0m21:59:06.654691 [info ] [Thread-1 (]: 2 of 7 START sql table model uber.dropoff_location_dim ......................... [RUN]
[0m21:59:06.656024 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.uber.datetime_dim, now model.uber.dropoff_location_dim)
[0m21:59:06.656742 [debug] [Thread-1 (]: Began compiling node model.uber.dropoff_location_dim
[0m21:59:06.715339 [debug] [Thread-1 (]: Writing injected SQL for node "model.uber.dropoff_location_dim"
[0m21:59:06.741379 [debug] [Thread-1 (]: Timing info for model.uber.dropoff_location_dim (compile): 21:59:06.657235 => 21:59:06.731736
[0m21:59:06.752421 [debug] [Thread-1 (]: Began executing node model.uber.dropoff_location_dim
[0m21:59:06.782409 [debug] [Thread-1 (]: Writing runtime sql for node "model.uber.dropoff_location_dim"
[0m21:59:06.807382 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m21:59:06.818452 [debug] [Thread-1 (]: On model.uber.dropoff_location_dim: /* {"app": "dbt", "dbt_version": "1.5.9", "profile_name": "uber", "target_name": "dev", "node_id": "model.uber.dropoff_location_dim"} */

  
    

    create or replace table `uber-data-engineering-407103`.`uber`.`dropoff_location_dim`
    
    

    OPTIONS()
    as (
      WITH numbered_rows AS (
  SELECT
    

    

    with p as (
        select 0 as generated_number union all select 1
    ), unioned as (

    select

    
    p0.generated_number * power(2, 0)
    
    
    + 1
    as generated_number

    from

    
    p as p0
    
    

    )

    select *
    from unioned
    where generated_number <= 1
    order by generated_number

 as dropoff_location_id,
    dropoff_latitude AS dropoff_latitude,
    dropoff_longitude AS dropoff_longitude,
    ROW_NUMBER() OVER (ORDER BY dropoff_latitude, dropoff_longitude) as row_num
  FROM `uber-data-engineering-407103`.`uber`.`uber_tlc_trip_recrord_data`
)
SELECT
  dropoff_location_id,
  dropoff_latitude,
  dropoff_longitude
FROM numbered_rows
    );
  
[0m21:59:07.582372 [debug] [Thread-1 (]: BigQuery adapter: Retry attempt 1 of 1 after error: BadRequest('Syntax error: Unexpected "(" at [18:15]')
[0m21:59:08.649486 [error] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=uber-data-engineering-407103&j=bq:US:1bb094be-1ca4-4cd7-90c3-05632dc01023&page=queryresults
[0m21:59:08.658389 [debug] [Thread-1 (]: Timing info for model.uber.dropoff_location_dim (execute): 21:59:06.761744 => 21:59:08.655005
[0m21:59:08.679123 [debug] [Thread-1 (]: Database Error in model dropoff_location_dim (models/transform/dropoff_location_dim.sql)
  Syntax error: Unexpected "(" at [18:15]
  compiled Code at target/run/uber/models/transform/dropoff_location_dim.sql
[0m21:59:08.681378 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '9a463ef3-919f-4b58-837e-5ca6839de367', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff912b46d0>]}
[0m21:59:08.684037 [error] [Thread-1 (]: 2 of 7 ERROR creating sql table model uber.dropoff_location_dim ................ [[31mERROR[0m in 2.02s]
[0m21:59:08.687742 [debug] [Thread-1 (]: Finished running node model.uber.dropoff_location_dim
[0m21:59:08.692426 [debug] [Thread-1 (]: Began running node model.uber.passenger_count_dim
[0m21:59:08.698402 [info ] [Thread-1 (]: 3 of 7 START sql table model uber.passenger_count_dim .......................... [RUN]
[0m21:59:08.700382 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.uber.dropoff_location_dim, now model.uber.passenger_count_dim)
[0m21:59:08.701747 [debug] [Thread-1 (]: Began compiling node model.uber.passenger_count_dim
[0m21:59:08.730911 [debug] [Thread-1 (]: Writing injected SQL for node "model.uber.passenger_count_dim"
[0m21:59:08.734103 [debug] [Thread-1 (]: Timing info for model.uber.passenger_count_dim (compile): 21:59:08.702884 => 21:59:08.733880
[0m21:59:08.734846 [debug] [Thread-1 (]: Began executing node model.uber.passenger_count_dim
[0m21:59:08.738867 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m21:59:09.297397 [debug] [Thread-1 (]: Writing runtime sql for node "model.uber.passenger_count_dim"
[0m21:59:09.301990 [debug] [Thread-1 (]: On model.uber.passenger_count_dim: /* {"app": "dbt", "dbt_version": "1.5.9", "profile_name": "uber", "target_name": "dev", "node_id": "model.uber.passenger_count_dim"} */

  
    

    create or replace table `uber-data-engineering-407103`.`uber`.`passenger_count_dim`
    
    

    OPTIONS()
    as (
      SELECT DISTINCT
    to_hex(md5(cast( as STRING))) as passenger_count_id,
		passenger_count AS passenger_count,
FROM `uber-data-engineering-407103`.`uber`.`uber_tlc_trip_recrord_data`
WHERE passenger_count IS NOT NULL
    );
  
[0m21:59:09.480124 [debug] [Thread-1 (]: BigQuery adapter: Retry attempt 1 of 1 after error: BadRequest('Syntax error: Unexpected keyword AS at [13:22]')
[0m21:59:10.512578 [error] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=uber-data-engineering-407103&j=bq:US:ba417011-b75f-491e-bbdc-ccbd509f6625&page=queryresults
[0m21:59:10.519046 [debug] [Thread-1 (]: Timing info for model.uber.passenger_count_dim (execute): 21:59:08.735467 => 21:59:10.517252
[0m21:59:10.539530 [debug] [Thread-1 (]: Database Error in model passenger_count_dim (models/transform/passenger_count_dim.sql)
  Syntax error: Unexpected keyword AS at [13:22]
  compiled Code at target/run/uber/models/transform/passenger_count_dim.sql
[0m21:59:10.541826 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '9a463ef3-919f-4b58-837e-5ca6839de367', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff91082a90>]}
[0m21:59:10.544345 [error] [Thread-1 (]: 3 of 7 ERROR creating sql table model uber.passenger_count_dim ................. [[31mERROR[0m in 1.84s]
[0m21:59:10.546067 [debug] [Thread-1 (]: Finished running node model.uber.passenger_count_dim
[0m21:59:10.547048 [debug] [Thread-1 (]: Began running node model.uber.payment_type_dim
[0m21:59:10.548910 [info ] [Thread-1 (]: 4 of 7 START sql table model uber.payment_type_dim ............................. [RUN]
[0m21:59:10.550948 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.uber.passenger_count_dim, now model.uber.payment_type_dim)
[0m21:59:10.552766 [debug] [Thread-1 (]: Began compiling node model.uber.payment_type_dim
[0m21:59:10.599212 [debug] [Thread-1 (]: Writing injected SQL for node "model.uber.payment_type_dim"
[0m21:59:10.609267 [debug] [Thread-1 (]: Timing info for model.uber.payment_type_dim (compile): 21:59:10.553767 => 21:59:10.608398
[0m21:59:10.611109 [debug] [Thread-1 (]: Began executing node model.uber.payment_type_dim
[0m21:59:10.618970 [debug] [Thread-1 (]: Writing runtime sql for node "model.uber.payment_type_dim"
[0m21:59:10.625692 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m21:59:10.630280 [debug] [Thread-1 (]: On model.uber.payment_type_dim: /* {"app": "dbt", "dbt_version": "1.5.9", "profile_name": "uber", "target_name": "dev", "node_id": "model.uber.payment_type_dim"} */

  
    

    create or replace table `uber-data-engineering-407103`.`uber`.`payment_type_dim`
    
    

    OPTIONS()
    as (
      WITH numbered_rows AS (
  SELECT
    

    

    with p as (
        select 0 as generated_number union all select 1
    ), unioned as (

    select

    
    p0.generated_number * power(2, 0)
    
    
    + 1
    as generated_number

    from

    
    p as p0
    
    

    )

    select *
    from unioned
    where generated_number <= 1
    order by generated_number

 as payment_type_id,
    payment_type AS payment_type,
    ROW_NUMBER() OVER (ORDER BY payment_type) as row_num
  FROM `uber-data-engineering-407103`.`uber`.`uber_tlc_trip_recrord_data`
  WHERE payment_type IS NOT NULL
)
SELECT
  payment_type_id,
  payment_type
FROM numbered_rows
    );
  
[0m21:59:11.687367 [debug] [Thread-1 (]: BigQuery adapter: Retry attempt 1 of 1 after error: BadRequest('Syntax error: Unexpected "(" at [18:15]')
[0m21:59:12.563024 [info ] [MainThread]: [33mThe bigquery adapter does not support query cancellation. Some queries may still be running![0m
[0m21:59:12.975643 [error] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=uber-data-engineering-407103&j=bq:US:30d3efbc-7bc4-4ec0-b837-8cfe4c4375e3&page=queryresults
[0m21:59:12.985150 [debug] [Thread-1 (]: Timing info for model.uber.payment_type_dim (execute): 21:59:10.612123 => 21:59:12.983248
[0m21:59:13.005076 [debug] [Thread-1 (]: Database Error in model payment_type_dim (models/transform/payment_type_dim.sql)
  Syntax error: Unexpected "(" at [18:15]
  compiled Code at target/run/uber/models/transform/payment_type_dim.sql
[0m21:59:13.007488 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '9a463ef3-919f-4b58-837e-5ca6839de367', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff911847d0>]}
[0m21:59:13.010105 [error] [Thread-1 (]: 4 of 7 ERROR creating sql table model uber.payment_type_dim .................... [[31mERROR[0m in 2.46s]
[0m21:59:13.011180 [debug] [Thread-1 (]: Finished running node model.uber.payment_type_dim
[0m21:59:13.012346 [info ] [MainThread]: 
[0m21:59:13.013837 [info ] [MainThread]: [33mExited because of keyboard interrupt[0m
[0m21:59:13.014575 [info ] [MainThread]: 
[0m21:59:13.015353 [error] [MainThread]: [33mDatabase Error in model dropoff_location_dim (models/transform/dropoff_location_dim.sql)[0m
[0m21:59:13.016030 [error] [MainThread]:   Syntax error: Unexpected "(" at [18:15]
[0m21:59:13.016893 [error] [MainThread]:   compiled Code at target/run/uber/models/transform/dropoff_location_dim.sql
[0m21:59:13.017604 [info ] [MainThread]: 
[0m21:59:13.018209 [error] [MainThread]: [33mDatabase Error in model passenger_count_dim (models/transform/passenger_count_dim.sql)[0m
[0m21:59:13.018715 [error] [MainThread]:   Syntax error: Unexpected keyword AS at [13:22]
[0m21:59:13.019245 [error] [MainThread]:   compiled Code at target/run/uber/models/transform/passenger_count_dim.sql
[0m21:59:13.019837 [info ] [MainThread]: 
[0m21:59:13.020690 [info ] [MainThread]: Done. PASS=1 WARN=0 ERROR=2 SKIP=0 TOTAL=3
[0m21:59:13.021602 [debug] [MainThread]: Connection 'master' was properly closed.
[0m21:59:13.022115 [debug] [MainThread]: Connection 'model.uber.payment_type_dim' was properly closed.
[0m21:59:13.022817 [info ] [MainThread]: 
[0m21:59:13.023859 [info ] [MainThread]: Finished running 3 table models in 0 hours 0 minutes and 11.50 seconds (11.50s).
[0m21:59:13.025592 [error] [MainThread]: Encountered an error:

[0m21:59:13.034001 [error] [MainThread]: Traceback (most recent call last):
  File "/usr/local/airflow/dbt_venv/lib/python3.11/site-packages/dbt/cli/requires.py", line 86, in wrapper
    result, success = func(*args, **kwargs)
                      ^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/airflow/dbt_venv/lib/python3.11/site-packages/dbt/cli/requires.py", line 71, in wrapper
    return func(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/airflow/dbt_venv/lib/python3.11/site-packages/dbt/cli/requires.py", line 142, in wrapper
    return func(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/airflow/dbt_venv/lib/python3.11/site-packages/dbt/cli/requires.py", line 168, in wrapper
    return func(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/airflow/dbt_venv/lib/python3.11/site-packages/dbt/cli/requires.py", line 215, in wrapper
    return func(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/airflow/dbt_venv/lib/python3.11/site-packages/dbt/cli/requires.py", line 250, in wrapper
    return func(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/airflow/dbt_venv/lib/python3.11/site-packages/dbt/cli/main.py", line 584, in run
    results = task.run()
              ^^^^^^^^^^
  File "/usr/local/airflow/dbt_venv/lib/python3.11/site-packages/dbt/task/runnable.py", line 448, in run
    result = self.execute_with_hooks(selected_uids)
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/airflow/dbt_venv/lib/python3.11/site-packages/dbt/task/runnable.py", line 406, in execute_with_hooks
    res = self.execute_nodes()
          ^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/airflow/dbt_venv/lib/python3.11/site-packages/dbt/task/runnable.py", line 352, in execute_nodes
    self.run_queue(pool)
  File "/usr/local/airflow/dbt_venv/lib/python3.11/site-packages/dbt/task/runnable.py", line 279, in run_queue
    self.job_queue.join()
  File "/usr/local/airflow/dbt_venv/lib/python3.11/site-packages/dbt/graph/queue.py", line 198, in join
    self.inner.join()
  File "/usr/local/lib/python3.11/queue.py", line 90, in join
    self.all_tasks_done.wait()
  File "/usr/local/lib/python3.11/threading.py", line 327, in wait
    waiter.acquire()
KeyboardInterrupt

[0m21:59:13.036606 [debug] [MainThread]: Command `dbt run` failed at 21:59:13.036207 after 12.51 seconds
[0m21:59:13.038218 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff937a1fd0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff931b3b50>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff972dbc50>]}
[0m21:59:13.039140 [debug] [MainThread]: Flushing usage events
[0m22:01:12.944539 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff993f3650>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff9957e250>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff990ce110>]}


============================== 22:01:12.949644 | 47155f56-4e3a-471e-9f00-d7f555ea1a3a ==============================
[0m22:01:12.949644 [info ] [MainThread]: Running with dbt=1.5.9
[0m22:01:12.951018 [debug] [MainThread]: running dbt with arguments {'warn_error': 'None', 'log_cache_events': 'False', 'introspect': 'True', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'quiet': 'False', 'static_parser': 'True', 'fail_fast': 'False', 'target_path': 'None', 'no_print': 'None', 'use_colors': 'True', 'version_check': 'True', 'indirect_selection': 'eager', 'partial_parse': 'True', 'use_experimental_parser': 'False', 'log_path': '/usr/local/airflow/include/dbt/logs', 'profiles_dir': '/usr/local/airflow/include/dbt/', 'write_json': 'True', 'printer_width': '80', 'debug': 'False', 'log_format': 'default', 'cache_selected_only': 'False', 'send_anonymous_usage_stats': 'True'}
[0m22:01:13.676160 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '47155f56-4e3a-471e-9f00-d7f555ea1a3a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff971cc9d0>]}
[0m22:01:13.878890 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '47155f56-4e3a-471e-9f00-d7f555ea1a3a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff971d4450>]}
[0m22:01:13.883360 [info ] [MainThread]: Registered adapter: bigquery=1.5.3
[0m22:01:13.948634 [debug] [MainThread]: checksum: dd837546c89c9d03f3c2cb0ca6165266a30da6076d5d44e9991f7c5a8e5f5831, vars: {}, profile: , target: , version: 1.5.9
[0m22:01:14.299505 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m22:01:14.302517 [debug] [MainThread]: Partial parsing: updated file: uber://models/transform/datetime_dim.sql
[0m22:01:14.336662 [debug] [MainThread]: 1603: static parser failed on transform/datetime_dim.sql
[0m22:01:14.392183 [debug] [MainThread]: 1602: parser fallback to jinja rendering on transform/datetime_dim.sql
[0m22:01:14.419495 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '47155f56-4e3a-471e-9f00-d7f555ea1a3a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff970eaad0>]}
[0m22:01:14.441608 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '47155f56-4e3a-471e-9f00-d7f555ea1a3a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff97090f50>]}
[0m22:01:14.442521 [info ] [MainThread]: Found 7 models, 0 tests, 0 snapshots, 0 analyses, 474 macros, 0 operations, 0 seed files, 1 source, 0 exposures, 0 metrics, 0 groups
[0m22:01:14.443718 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '47155f56-4e3a-471e-9f00-d7f555ea1a3a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff9c0eb6d0>]}
[0m22:01:14.447583 [info ] [MainThread]: 
[0m22:01:14.449586 [debug] [MainThread]: Acquiring new bigquery connection 'master'
[0m22:01:14.453289 [debug] [ThreadPool]: Acquiring new bigquery connection 'list_uber-data-engineering-407103'
[0m22:01:14.454411 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m22:01:15.825757 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_uber-data-engineering-407103, now list_uber-data-engineering-407103_uber)
[0m22:01:15.835015 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m22:01:16.611348 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '47155f56-4e3a-471e-9f00-d7f555ea1a3a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff97091510>]}
[0m22:01:16.666132 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m22:01:16.676652 [info ] [MainThread]: 
[0m22:01:16.789305 [debug] [Thread-1 (]: Began running node model.uber.datetime_dim
[0m22:01:16.792830 [info ] [Thread-1 (]: 1 of 7 START sql table model uber.datetime_dim ................................. [RUN]
[0m22:01:16.796096 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_uber-data-engineering-407103_uber, now model.uber.datetime_dim)
[0m22:01:16.797989 [debug] [Thread-1 (]: Began compiling node model.uber.datetime_dim
[0m22:01:16.830441 [debug] [Thread-1 (]: Writing injected SQL for node "model.uber.datetime_dim"
[0m22:01:16.845514 [debug] [Thread-1 (]: Timing info for model.uber.datetime_dim (compile): 22:01:16.799763 => 22:01:16.843764
[0m22:01:16.850269 [debug] [Thread-1 (]: Began executing node model.uber.datetime_dim
[0m22:01:16.882194 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m22:01:17.713067 [debug] [Thread-1 (]: Writing runtime sql for node "model.uber.datetime_dim"
[0m22:01:17.715826 [debug] [Thread-1 (]: On model.uber.datetime_dim: /* {"app": "dbt", "dbt_version": "1.5.9", "profile_name": "uber", "target_name": "dev", "node_id": "model.uber.datetime_dim"} */

  
    

    create or replace table `uber-data-engineering-407103`.`uber`.`datetime_dim`
    
    

    OPTIONS()
    as (
      WITH datetime_cte AS (  
  SELECT DISTINCT 
    to_hex(md5(cast(coalesce(cast(tpep_pickup_datetime as STRING), '_dbt_utils_surrogate_key_null_') || '-' || coalesce(cast(tpep_dropoff_datetime as STRING), '_dbt_utils_surrogate_key_null_') as STRING))) AS datetime_id,
    CASE
      WHEN LENGTH(tpep_pickup_datetime) = 16 THEN
        -- Date format: "DD/MM/YYYY HH:MM"
        PARSE_DATETIME('%m/%d/%Y %H:%M', tpep_pickup_datetime)
      WHEN LENGTH(tpep_pickup_datetime) <= 14 THEN
        -- Date format: "MM/DD/YY HH:MM"
        PARSE_DATETIME('%m/%d/%y %H:%M', tpep_pickup_datetime)
      ELSE
        NULL
    END AS pick_date_part,
    tpep_dropoff_datetime AS drop_datetime_id,
    CASE
      WHEN LENGTH(tpep_dropoff_datetime) = 16 THEN
        -- Date format: "DD/MM/YYYY HH:MM"
        PARSE_DATETIME('%m/%d/%Y %H:%M', tpep_dropoff_datetime)
      WHEN LENGTH(tpep_dropoff_datetime) <= 14 THEN
        -- Date format: "MM/DD/YY HH:MM"
        PARSE_DATETIME('%m/%d/%y %H:%M', tpep_dropoff_datetime)
      ELSE
        NULL
    END AS drop_date_part
  FROM `uber-data-engineering-407103`.`uber`.`uber_tlc_trip_recrord_data`
  WHERE tpep_pickup_datetime IS NOT NULL
    AND tpep_dropoff_datetime IS NOT NULL
)
SELECT
  datetime_id,
  pick_date_part AS tpep_pickup_datetime,
  drop_date_part AS tpep_dropoff_datetime,
  EXTRACT(HOUR FROM pick_date_part) AS pick_hour,
  EXTRACT(DAY FROM pick_date_part) AS pick_day,
  EXTRACT(MONTH FROM pick_date_part) AS pick_month,
  EXTRACT(YEAR FROM pick_date_part) AS pick_year,
  EXTRACT(DAYOFWEEK FROM pick_date_part) AS pick_weekday,
  EXTRACT(HOUR FROM drop_date_part) AS drop_hour,
  EXTRACT(DAY FROM drop_date_part) AS drop_day,
  EXTRACT(MONTH FROM drop_date_part) AS drop_month,
  EXTRACT(YEAR FROM drop_date_part) AS drop_year,
  EXTRACT(DAYOFWEEK FROM drop_date_part) AS drop_weekday
FROM datetime_cte
    );
  
[0m22:01:21.032857 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=uber-data-engineering-407103&j=bq:US:af27b24b-0b59-49cb-a9c3-bca86a56bbc0&page=queryresults
[0m22:01:21.088200 [debug] [Thread-1 (]: Timing info for model.uber.datetime_dim (execute): 22:01:16.854327 => 22:01:21.086685
[0m22:01:21.092992 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '47155f56-4e3a-471e-9f00-d7f555ea1a3a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff97077f90>]}
[0m22:01:21.096829 [info ] [Thread-1 (]: 1 of 7 OK created sql table model uber.datetime_dim ............................ [[32mCREATE TABLE (99.9k rows, 4.0 MiB processed)[0m in 4.30s]
[0m22:01:21.100595 [debug] [Thread-1 (]: Finished running node model.uber.datetime_dim
[0m22:01:21.103196 [debug] [Thread-1 (]: Began running node model.uber.dropoff_location_dim
[0m22:01:21.116659 [info ] [Thread-1 (]: 2 of 7 START sql table model uber.dropoff_location_dim ......................... [RUN]
[0m22:01:21.127140 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.uber.datetime_dim, now model.uber.dropoff_location_dim)
[0m22:01:21.136342 [debug] [Thread-1 (]: Began compiling node model.uber.dropoff_location_dim
[0m22:01:21.219405 [debug] [Thread-1 (]: Writing injected SQL for node "model.uber.dropoff_location_dim"
[0m22:01:21.222600 [debug] [Thread-1 (]: Timing info for model.uber.dropoff_location_dim (compile): 22:01:21.142713 => 22:01:21.222272
[0m22:01:21.223346 [debug] [Thread-1 (]: Began executing node model.uber.dropoff_location_dim
[0m22:01:21.240144 [debug] [Thread-1 (]: Writing runtime sql for node "model.uber.dropoff_location_dim"
[0m22:01:21.256844 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m22:01:21.301613 [debug] [Thread-1 (]: On model.uber.dropoff_location_dim: /* {"app": "dbt", "dbt_version": "1.5.9", "profile_name": "uber", "target_name": "dev", "node_id": "model.uber.dropoff_location_dim"} */

  
    

    create or replace table `uber-data-engineering-407103`.`uber`.`dropoff_location_dim`
    
    

    OPTIONS()
    as (
      WITH numbered_rows AS (
  SELECT
    

    

    with p as (
        select 0 as generated_number union all select 1
    ), unioned as (

    select

    
    p0.generated_number * power(2, 0)
    
    
    + 1
    as generated_number

    from

    
    p as p0
    
    

    )

    select *
    from unioned
    where generated_number <= 1
    order by generated_number

 as dropoff_location_id,
    dropoff_latitude AS dropoff_latitude,
    dropoff_longitude AS dropoff_longitude,
    ROW_NUMBER() OVER (ORDER BY dropoff_latitude, dropoff_longitude) as row_num
  FROM `uber-data-engineering-407103`.`uber`.`uber_tlc_trip_recrord_data`
)
SELECT
  dropoff_location_id,
  dropoff_latitude,
  dropoff_longitude
FROM numbered_rows
    );
  
[0m22:01:22.360138 [debug] [Thread-1 (]: BigQuery adapter: Retry attempt 1 of 1 after error: BadRequest('Syntax error: Unexpected "(" at [18:15]')
[0m22:01:23.124132 [error] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=uber-data-engineering-407103&j=bq:US:8b0e32ee-c283-405d-a9a1-c010fe1526cd&page=queryresults
[0m22:01:23.128331 [debug] [Thread-1 (]: Timing info for model.uber.dropoff_location_dim (execute): 22:01:21.223790 => 22:01:23.127370
[0m22:01:23.149271 [debug] [Thread-1 (]: Database Error in model dropoff_location_dim (models/transform/dropoff_location_dim.sql)
  Syntax error: Unexpected "(" at [18:15]
  compiled Code at target/run/uber/models/transform/dropoff_location_dim.sql
[0m22:01:23.153547 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '47155f56-4e3a-471e-9f00-d7f555ea1a3a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff970e1310>]}
[0m22:01:23.162902 [error] [Thread-1 (]: 2 of 7 ERROR creating sql table model uber.dropoff_location_dim ................ [[31mERROR[0m in 2.03s]
[0m22:01:23.165112 [debug] [Thread-1 (]: Finished running node model.uber.dropoff_location_dim
[0m22:01:23.166130 [debug] [Thread-1 (]: Began running node model.uber.passenger_count_dim
[0m22:01:23.167796 [info ] [Thread-1 (]: 3 of 7 START sql table model uber.passenger_count_dim .......................... [RUN]
[0m22:01:23.168933 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.uber.dropoff_location_dim, now model.uber.passenger_count_dim)
[0m22:01:23.169618 [debug] [Thread-1 (]: Began compiling node model.uber.passenger_count_dim
[0m22:01:23.179359 [debug] [Thread-1 (]: Writing injected SQL for node "model.uber.passenger_count_dim"
[0m22:01:23.182902 [debug] [Thread-1 (]: Timing info for model.uber.passenger_count_dim (compile): 22:01:23.170140 => 22:01:23.182502
[0m22:01:23.183645 [debug] [Thread-1 (]: Began executing node model.uber.passenger_count_dim
[0m22:01:23.187329 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m22:01:23.652753 [debug] [Thread-1 (]: Writing runtime sql for node "model.uber.passenger_count_dim"
[0m22:01:23.657706 [debug] [Thread-1 (]: On model.uber.passenger_count_dim: /* {"app": "dbt", "dbt_version": "1.5.9", "profile_name": "uber", "target_name": "dev", "node_id": "model.uber.passenger_count_dim"} */

  
    

    create or replace table `uber-data-engineering-407103`.`uber`.`passenger_count_dim`
    
    

    OPTIONS()
    as (
      SELECT DISTINCT
    to_hex(md5(cast( as STRING))) as passenger_count_id,
		passenger_count AS passenger_count,
FROM `uber-data-engineering-407103`.`uber`.`uber_tlc_trip_recrord_data`
WHERE passenger_count IS NOT NULL
    );
  
[0m22:01:24.695093 [debug] [Thread-1 (]: BigQuery adapter: Retry attempt 1 of 1 after error: BadRequest('Syntax error: Unexpected keyword AS at [13:22]')
[0m22:01:25.374639 [error] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=uber-data-engineering-407103&j=bq:US:83e3e5ce-c7bb-40bf-a93b-4ab68c93ad39&page=queryresults
[0m22:01:25.380141 [debug] [Thread-1 (]: Timing info for model.uber.passenger_count_dim (execute): 22:01:23.184225 => 22:01:25.378846
[0m22:01:25.391341 [debug] [Thread-1 (]: Database Error in model passenger_count_dim (models/transform/passenger_count_dim.sql)
  Syntax error: Unexpected keyword AS at [13:22]
  compiled Code at target/run/uber/models/transform/passenger_count_dim.sql
[0m22:01:25.393821 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '47155f56-4e3a-471e-9f00-d7f555ea1a3a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff94d44850>]}
[0m22:01:25.396370 [error] [Thread-1 (]: 3 of 7 ERROR creating sql table model uber.passenger_count_dim ................. [[31mERROR[0m in 2.22s]
[0m22:01:25.397927 [debug] [Thread-1 (]: Finished running node model.uber.passenger_count_dim
[0m22:01:25.398993 [debug] [Thread-1 (]: Began running node model.uber.payment_type_dim
[0m22:01:25.400340 [info ] [Thread-1 (]: 4 of 7 START sql table model uber.payment_type_dim ............................. [RUN]
[0m22:01:25.401513 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.uber.passenger_count_dim, now model.uber.payment_type_dim)
[0m22:01:25.402123 [debug] [Thread-1 (]: Began compiling node model.uber.payment_type_dim
[0m22:01:25.411738 [debug] [Thread-1 (]: Writing injected SQL for node "model.uber.payment_type_dim"
[0m22:01:25.414696 [debug] [Thread-1 (]: Timing info for model.uber.payment_type_dim (compile): 22:01:25.402547 => 22:01:25.414413
[0m22:01:25.415378 [debug] [Thread-1 (]: Began executing node model.uber.payment_type_dim
[0m22:01:25.420079 [debug] [Thread-1 (]: Writing runtime sql for node "model.uber.payment_type_dim"
[0m22:01:25.422031 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m22:01:25.424467 [debug] [Thread-1 (]: On model.uber.payment_type_dim: /* {"app": "dbt", "dbt_version": "1.5.9", "profile_name": "uber", "target_name": "dev", "node_id": "model.uber.payment_type_dim"} */

  
    

    create or replace table `uber-data-engineering-407103`.`uber`.`payment_type_dim`
    
    

    OPTIONS()
    as (
      WITH numbered_rows AS (
  SELECT
    

    

    with p as (
        select 0 as generated_number union all select 1
    ), unioned as (

    select

    
    p0.generated_number * power(2, 0)
    
    
    + 1
    as generated_number

    from

    
    p as p0
    
    

    )

    select *
    from unioned
    where generated_number <= 1
    order by generated_number

 as payment_type_id,
    payment_type AS payment_type,
    ROW_NUMBER() OVER (ORDER BY payment_type) as row_num
  FROM `uber-data-engineering-407103`.`uber`.`uber_tlc_trip_recrord_data`
  WHERE payment_type IS NOT NULL
)
SELECT
  payment_type_id,
  payment_type
FROM numbered_rows
    );
  
[0m22:01:26.203904 [debug] [Thread-1 (]: BigQuery adapter: Retry attempt 1 of 1 after error: BadRequest('Syntax error: Unexpected "(" at [18:15]')
[0m22:01:26.590719 [error] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=uber-data-engineering-407103&j=bq:US:f06882ff-3605-4da0-8f47-0a4b8f684e2e&page=queryresults
[0m22:01:26.592129 [debug] [Thread-1 (]: Timing info for model.uber.payment_type_dim (execute): 22:01:25.415836 => 22:01:26.591942
[0m22:01:26.595231 [debug] [Thread-1 (]: Database Error in model payment_type_dim (models/transform/payment_type_dim.sql)
  Syntax error: Unexpected "(" at [18:15]
  compiled Code at target/run/uber/models/transform/payment_type_dim.sql
[0m22:01:26.595892 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '47155f56-4e3a-471e-9f00-d7f555ea1a3a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff94d72fd0>]}
[0m22:01:26.596607 [error] [Thread-1 (]: 4 of 7 ERROR creating sql table model uber.payment_type_dim .................... [[31mERROR[0m in 1.19s]
[0m22:01:26.597443 [debug] [Thread-1 (]: Finished running node model.uber.payment_type_dim
[0m22:01:26.598097 [debug] [Thread-1 (]: Began running node model.uber.pickup_location_dim
[0m22:01:26.598927 [info ] [Thread-1 (]: 5 of 7 START sql table model uber.pickup_location_dim .......................... [RUN]
[0m22:01:26.599922 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.uber.payment_type_dim, now model.uber.pickup_location_dim)
[0m22:01:26.600683 [debug] [Thread-1 (]: Began compiling node model.uber.pickup_location_dim
[0m22:01:26.606453 [debug] [Thread-1 (]: Writing injected SQL for node "model.uber.pickup_location_dim"
[0m22:01:26.608562 [debug] [Thread-1 (]: Timing info for model.uber.pickup_location_dim (compile): 22:01:26.601146 => 22:01:26.608382
[0m22:01:26.609109 [debug] [Thread-1 (]: Began executing node model.uber.pickup_location_dim
[0m22:01:26.612461 [debug] [Thread-1 (]: Writing runtime sql for node "model.uber.pickup_location_dim"
[0m22:01:26.614561 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m22:01:26.617036 [debug] [Thread-1 (]: On model.uber.pickup_location_dim: /* {"app": "dbt", "dbt_version": "1.5.9", "profile_name": "uber", "target_name": "dev", "node_id": "model.uber.pickup_location_dim"} */

  
    

    create or replace table `uber-data-engineering-407103`.`uber`.`pickup_location_dim`
    
    

    OPTIONS()
    as (
      WITH numbered_rows AS (
  SELECT
    

    

    with p as (
        select 0 as generated_number union all select 1
    ), unioned as (

    select

    
    p0.generated_number * power(2, 0)
    
    
    + 1
    as generated_number

    from

    
    p as p0
    
    

    )

    select *
    from unioned
    where generated_number <= 1
    order by generated_number

 as pickup_location_id,
    pickup_latitude AS pickup_latitude,
    pickup_longitude AS pickup_longitude,
    ROW_NUMBER() OVER (ORDER BY pickup_latitude, pickup_longitude) as row_num
  FROM `uber-data-engineering-407103`.`uber`.`uber_tlc_trip_recrord_data`
)
SELECT
  pickup_location_id,
  pickup_latitude,
  pickup_longitude
FROM numbered_rows
    );
  
[0m22:01:27.453204 [debug] [Thread-1 (]: BigQuery adapter: Retry attempt 1 of 1 after error: BadRequest('Syntax error: Unexpected "(" at [18:15]')
[0m22:01:28.328103 [error] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=uber-data-engineering-407103&j=bq:US:a20ac84d-e6af-42f9-9e6a-2e7e0754be53&page=queryresults
[0m22:01:28.333606 [debug] [Thread-1 (]: Timing info for model.uber.pickup_location_dim (execute): 22:01:26.609525 => 22:01:28.332770
[0m22:01:28.343263 [debug] [Thread-1 (]: Database Error in model pickup_location_dim (models/transform/pickup_location_dim.sql)
  Syntax error: Unexpected "(" at [18:15]
  compiled Code at target/run/uber/models/transform/pickup_location_dim.sql
[0m22:01:28.344974 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '47155f56-4e3a-471e-9f00-d7f555ea1a3a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff94d74c90>]}
[0m22:01:28.347003 [error] [Thread-1 (]: 5 of 7 ERROR creating sql table model uber.pickup_location_dim ................. [[31mERROR[0m in 1.74s]
[0m22:01:28.348873 [debug] [Thread-1 (]: Finished running node model.uber.pickup_location_dim
[0m22:01:28.350309 [debug] [Thread-1 (]: Began running node model.uber.rate_code_dim
[0m22:01:28.351860 [info ] [Thread-1 (]: 6 of 7 START sql table model uber.rate_code_dim ................................ [RUN]
[0m22:01:28.353585 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.uber.pickup_location_dim, now model.uber.rate_code_dim)
[0m22:01:28.354342 [debug] [Thread-1 (]: Began compiling node model.uber.rate_code_dim
[0m22:01:28.360937 [debug] [Thread-1 (]: Writing injected SQL for node "model.uber.rate_code_dim"
[0m22:01:28.363515 [debug] [Thread-1 (]: Timing info for model.uber.rate_code_dim (compile): 22:01:28.354852 => 22:01:28.363309
[0m22:01:28.364185 [debug] [Thread-1 (]: Began executing node model.uber.rate_code_dim
[0m22:01:28.376609 [debug] [Thread-1 (]: Writing runtime sql for node "model.uber.rate_code_dim"
[0m22:01:28.380608 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m22:01:28.384740 [debug] [Thread-1 (]: On model.uber.rate_code_dim: /* {"app": "dbt", "dbt_version": "1.5.9", "profile_name": "uber", "target_name": "dev", "node_id": "model.uber.rate_code_dim"} */

  
    

    create or replace table `uber-data-engineering-407103`.`uber`.`rate_code_dim`
    
    

    OPTIONS()
    as (
      WITH numbered_rows AS (
  SELECT
    

    

    with p as (
        select 0 as generated_number union all select 1
    ), unioned as (

    select

    
    p0.generated_number * power(2, 0)
    
    
    + 1
    as generated_number

    from

    
    p as p0
    
    

    )

    select *
    from unioned
    where generated_number <= 1
    order by generated_number

 as rate_code_id,
    RatecodeID AS RatecodeID,
    ROW_NUMBER() OVER (ORDER BY RatecodeID) as row_num
  FROM `uber-data-engineering-407103`.`uber`.`uber_tlc_trip_recrord_data`
  WHERE RatecodeID IS NOT NULL
)
SELECT
  rate_code_id,
  rate_code
FROM numbered_rows
    );
  
[0m22:01:29.469080 [debug] [Thread-1 (]: BigQuery adapter: Retry attempt 1 of 1 after error: BadRequest('Syntax error: Unexpected "(" at [18:15]')
[0m22:01:30.724346 [error] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=uber-data-engineering-407103&j=bq:US:c0c697a4-1d3f-4d85-ba9f-892c1f766ec2&page=queryresults
[0m22:01:30.730297 [debug] [Thread-1 (]: Timing info for model.uber.rate_code_dim (execute): 22:01:28.364694 => 22:01:30.729633
[0m22:01:30.739194 [debug] [Thread-1 (]: Database Error in model rate_code_dim (models/transform/rate_code_dim.sql)
  Syntax error: Unexpected "(" at [18:15]
  compiled Code at target/run/uber/models/transform/rate_code_dim.sql
[0m22:01:30.740832 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '47155f56-4e3a-471e-9f00-d7f555ea1a3a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff94da82d0>]}
[0m22:01:30.742962 [error] [Thread-1 (]: 6 of 7 ERROR creating sql table model uber.rate_code_dim ....................... [[31mERROR[0m in 2.39s]
[0m22:01:30.745721 [debug] [Thread-1 (]: Finished running node model.uber.rate_code_dim
[0m22:01:30.747086 [debug] [Thread-1 (]: Began running node model.uber.trip_distance
[0m22:01:30.748002 [info ] [Thread-1 (]: 7 of 7 START sql table model uber.trip_distance ................................ [RUN]
[0m22:01:30.749464 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.uber.rate_code_dim, now model.uber.trip_distance)
[0m22:01:30.750320 [debug] [Thread-1 (]: Began compiling node model.uber.trip_distance
[0m22:01:30.758114 [debug] [Thread-1 (]: Writing injected SQL for node "model.uber.trip_distance"
[0m22:01:30.759952 [debug] [Thread-1 (]: Timing info for model.uber.trip_distance (compile): 22:01:30.750756 => 22:01:30.759742
[0m22:01:30.760432 [debug] [Thread-1 (]: Began executing node model.uber.trip_distance
[0m22:01:30.763650 [debug] [Thread-1 (]: Writing runtime sql for node "model.uber.trip_distance"
[0m22:01:30.764974 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m22:01:30.766847 [debug] [Thread-1 (]: On model.uber.trip_distance: /* {"app": "dbt", "dbt_version": "1.5.9", "profile_name": "uber", "target_name": "dev", "node_id": "model.uber.trip_distance"} */

  
    

    create or replace table `uber-data-engineering-407103`.`uber`.`trip_distance`
    
    

    OPTIONS()
    as (
      WITH numbered_rows AS (
  SELECT
    to_hex(md5(cast( as STRING))) as trip_distance_id,
    trip_distance AS trip_distance,
    ROW_NUMBER() OVER (ORDER BY trip_distance) as row_num
  FROM `uber-data-engineering-407103`.`uber`.`uber_tlc_trip_recrord_data`
  WHERE trip_distance IS NOT NULL
)
SELECT
  trip_distance_id,
  trip_distance
FROM numbered_rows
    );
  
[0m22:01:31.284482 [debug] [Thread-1 (]: BigQuery adapter: Retry attempt 1 of 1 after error: BadRequest('Syntax error: Unexpected keyword AS at [14:22]')
[0m22:01:31.744210 [error] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=uber-data-engineering-407103&j=bq:US:75c96205-78b1-41ba-a820-ebb9132c4e6f&page=queryresults
[0m22:01:31.749696 [debug] [Thread-1 (]: Timing info for model.uber.trip_distance (execute): 22:01:30.760847 => 22:01:31.748877
[0m22:01:31.758849 [debug] [Thread-1 (]: Database Error in model trip_distance (models/transform/trip_distance.sql)
  Syntax error: Unexpected keyword AS at [14:22]
  compiled Code at target/run/uber/models/transform/trip_distance.sql
[0m22:01:31.761879 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '47155f56-4e3a-471e-9f00-d7f555ea1a3a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff94da7790>]}
[0m22:01:31.764738 [error] [Thread-1 (]: 7 of 7 ERROR creating sql table model uber.trip_distance ....................... [[31mERROR[0m in 1.01s]
[0m22:01:31.766809 [debug] [Thread-1 (]: Finished running node model.uber.trip_distance
[0m22:01:31.771644 [debug] [MainThread]: Connection 'master' was properly closed.
[0m22:01:31.772444 [debug] [MainThread]: Connection 'model.uber.trip_distance' was properly closed.
[0m22:01:31.773393 [info ] [MainThread]: 
[0m22:01:31.774759 [info ] [MainThread]: Finished running 7 table models in 0 hours 0 minutes and 17.32 seconds (17.32s).
[0m22:01:31.776959 [debug] [MainThread]: Command end result
[0m22:01:31.795315 [info ] [MainThread]: 
[0m22:01:31.796642 [info ] [MainThread]: [31mCompleted with 6 errors and 0 warnings:[0m
[0m22:01:31.797282 [info ] [MainThread]: 
[0m22:01:31.798101 [error] [MainThread]: [33mDatabase Error in model dropoff_location_dim (models/transform/dropoff_location_dim.sql)[0m
[0m22:01:31.798811 [error] [MainThread]:   Syntax error: Unexpected "(" at [18:15]
[0m22:01:31.799411 [error] [MainThread]:   compiled Code at target/run/uber/models/transform/dropoff_location_dim.sql
[0m22:01:31.799966 [info ] [MainThread]: 
[0m22:01:31.800511 [error] [MainThread]: [33mDatabase Error in model passenger_count_dim (models/transform/passenger_count_dim.sql)[0m
[0m22:01:31.801076 [error] [MainThread]:   Syntax error: Unexpected keyword AS at [13:22]
[0m22:01:31.801630 [error] [MainThread]:   compiled Code at target/run/uber/models/transform/passenger_count_dim.sql
[0m22:01:31.802277 [info ] [MainThread]: 
[0m22:01:31.803604 [error] [MainThread]: [33mDatabase Error in model payment_type_dim (models/transform/payment_type_dim.sql)[0m
[0m22:01:31.804706 [error] [MainThread]:   Syntax error: Unexpected "(" at [18:15]
[0m22:01:31.805503 [error] [MainThread]:   compiled Code at target/run/uber/models/transform/payment_type_dim.sql
[0m22:01:31.806148 [info ] [MainThread]: 
[0m22:01:31.806695 [error] [MainThread]: [33mDatabase Error in model pickup_location_dim (models/transform/pickup_location_dim.sql)[0m
[0m22:01:31.807234 [error] [MainThread]:   Syntax error: Unexpected "(" at [18:15]
[0m22:01:31.807764 [error] [MainThread]:   compiled Code at target/run/uber/models/transform/pickup_location_dim.sql
[0m22:01:31.808283 [info ] [MainThread]: 
[0m22:01:31.808871 [error] [MainThread]: [33mDatabase Error in model rate_code_dim (models/transform/rate_code_dim.sql)[0m
[0m22:01:31.809390 [error] [MainThread]:   Syntax error: Unexpected "(" at [18:15]
[0m22:01:31.810091 [error] [MainThread]:   compiled Code at target/run/uber/models/transform/rate_code_dim.sql
[0m22:01:31.810868 [info ] [MainThread]: 
[0m22:01:31.811695 [error] [MainThread]: [33mDatabase Error in model trip_distance (models/transform/trip_distance.sql)[0m
[0m22:01:31.812461 [error] [MainThread]:   Syntax error: Unexpected keyword AS at [14:22]
[0m22:01:31.813092 [error] [MainThread]:   compiled Code at target/run/uber/models/transform/trip_distance.sql
[0m22:01:31.813930 [info ] [MainThread]: 
[0m22:01:31.814923 [info ] [MainThread]: Done. PASS=1 WARN=0 ERROR=6 SKIP=0 TOTAL=7
[0m22:01:31.816845 [debug] [MainThread]: Command `dbt run` failed at 22:01:31.816640 after 18.88 seconds
[0m22:01:31.817625 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff993f3090>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff99548990>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff990ce550>]}
[0m22:01:31.818512 [debug] [MainThread]: Flushing usage events
[0m22:17:39.608138 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff93997810>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff93957110>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff93fc1c10>]}


============================== 22:17:39.614626 | 0c4f0e59-7607-4343-8136-6edaa34b2fb3 ==============================
[0m22:17:39.614626 [info ] [MainThread]: Running with dbt=1.5.9
[0m22:17:39.615533 [debug] [MainThread]: running dbt with arguments {'cache_selected_only': 'False', 'printer_width': '80', 'write_json': 'True', 'quiet': 'False', 'log_path': '/usr/local/airflow/include/dbt/logs', 'debug': 'False', 'use_colors': 'True', 'version_check': 'True', 'no_print': 'None', 'static_parser': 'True', 'fail_fast': 'False', 'warn_error': 'None', 'partial_parse': 'True', 'send_anonymous_usage_stats': 'True', 'log_cache_events': 'False', 'introspect': 'True', 'use_experimental_parser': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'profiles_dir': '/usr/local/airflow/include/dbt/', 'target_path': 'None', 'indirect_selection': 'eager', 'log_format': 'default'}
[0m22:17:40.267120 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '0c4f0e59-7607-4343-8136-6edaa34b2fb3', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff933176d0>]}
[0m22:17:40.278606 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '0c4f0e59-7607-4343-8136-6edaa34b2fb3', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff9273bbd0>]}
[0m22:17:40.279377 [info ] [MainThread]: Registered adapter: bigquery=1.5.3
[0m22:17:40.295005 [debug] [MainThread]: checksum: dd837546c89c9d03f3c2cb0ca6165266a30da6076d5d44e9991f7c5a8e5f5831, vars: {}, profile: , target: , version: 1.5.9
[0m22:17:40.376154 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m22:17:40.376903 [debug] [MainThread]: Partial parsing: updated file: uber://models/transform/dropoff_location_dim.sql
[0m22:17:40.394806 [debug] [MainThread]: 1603: static parser failed on transform/dropoff_location_dim.sql
[0m22:17:40.406119 [error] [MainThread]: Encountered an error:
Compilation Error in model dropoff_location_dim (models/transform/dropoff_location_dim.sql)
  '<=' not supported between instances of 'list' and 'int'
  
  > in macro get_powers_of_two (macros/sql/generate_series.sql)
  > called by macro default__generate_series (macros/sql/generate_series.sql)
  > called by macro generate_series (macros/sql/generate_series.sql)
  > called by model dropoff_location_dim (models/transform/dropoff_location_dim.sql)
[0m22:17:40.407039 [debug] [MainThread]: Command `dbt run` failed at 22:17:40.406873 after 0.81 seconds
[0m22:17:40.407571 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff9179c4d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff97884450>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff933073d0>]}
[0m22:17:40.408119 [debug] [MainThread]: Flushing usage events
[0m22:20:13.190356 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffb80ab3d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffb837f2d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffb7f8b490>]}


============================== 22:20:13.195810 | 854abc27-a4cf-427e-b361-f419b610a77e ==============================
[0m22:20:13.195810 [info ] [MainThread]: Running with dbt=1.5.9
[0m22:20:13.197419 [debug] [MainThread]: running dbt with arguments {'target_path': 'None', 'write_json': 'True', 'use_colors': 'True', 'log_path': '/usr/local/airflow/include/dbt/logs', 'indirect_selection': 'eager', 'static_parser': 'True', 'partial_parse': 'True', 'version_check': 'True', 'warn_error': 'None', 'log_cache_events': 'False', 'printer_width': '80', 'debug': 'False', 'introspect': 'True', 'quiet': 'False', 'cache_selected_only': 'False', 'no_print': 'None', 'send_anonymous_usage_stats': 'True', 'use_experimental_parser': 'False', 'fail_fast': 'False', 'profiles_dir': '/usr/local/airflow/include/dbt/', 'log_format': 'default', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])'}
[0m22:20:13.923562 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '854abc27-a4cf-427e-b361-f419b610a77e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffb6063a10>]}
[0m22:20:13.954682 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '854abc27-a4cf-427e-b361-f419b610a77e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffb7b27d10>]}
[0m22:20:13.956213 [info ] [MainThread]: Registered adapter: bigquery=1.5.3
[0m22:20:13.977086 [debug] [MainThread]: checksum: dd837546c89c9d03f3c2cb0ca6165266a30da6076d5d44e9991f7c5a8e5f5831, vars: {}, profile: , target: , version: 1.5.9
[0m22:20:14.052803 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m22:20:14.053658 [debug] [MainThread]: Partial parsing: updated file: uber://models/transform/dropoff_location_dim.sql
[0m22:20:14.076609 [debug] [MainThread]: 1603: static parser failed on transform/dropoff_location_dim.sql
[0m22:20:14.088958 [error] [MainThread]: Encountered an error:
Compilation Error in model dropoff_location_dim (models/transform/dropoff_location_dim.sql)
  parameter 'upper_bound' was not provided
  
  > in macro get_powers_of_two (macros/sql/generate_series.sql)
  > called by macro default__generate_series (macros/sql/generate_series.sql)
  > called by macro generate_series (macros/sql/generate_series.sql)
  > called by model dropoff_location_dim (models/transform/dropoff_location_dim.sql)
[0m22:20:14.090192 [debug] [MainThread]: Command `dbt run` failed at 22:20:14.090025 after 0.91 seconds
[0m22:20:14.090783 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffb7f37b50>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffb5ec5010>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffb7f9eb50>]}
[0m22:20:14.091317 [debug] [MainThread]: Flushing usage events
[0m22:22:31.938581 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff9ef837d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff9ef82e50>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffa35b8850>]}


============================== 22:22:31.943892 | d0e5fb09-c566-472d-a99a-721d2cc7a788 ==============================
[0m22:22:31.943892 [info ] [MainThread]: Running with dbt=1.5.9
[0m22:22:31.944915 [debug] [MainThread]: running dbt with arguments {'debug': 'False', 'introspect': 'True', 'write_json': 'True', 'log_cache_events': 'False', 'cache_selected_only': 'False', 'log_format': 'default', 'warn_error': 'None', 'fail_fast': 'False', 'partial_parse': 'True', 'indirect_selection': 'eager', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'static_parser': 'True', 'send_anonymous_usage_stats': 'True', 'profiles_dir': '/usr/local/airflow/include/dbt/', 'use_colors': 'True', 'printer_width': '80', 'quiet': 'False', 'use_experimental_parser': 'False', 'log_path': '/usr/local/airflow/include/dbt/logs', 'target_path': 'None', 'version_check': 'True', 'no_print': 'None'}
[0m22:22:32.392115 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'd0e5fb09-c566-472d-a99a-721d2cc7a788', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff9d567050>]}
[0m22:22:32.403423 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'd0e5fb09-c566-472d-a99a-721d2cc7a788', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff9f9231d0>]}
[0m22:22:32.404174 [info ] [MainThread]: Registered adapter: bigquery=1.5.3
[0m22:22:32.419410 [debug] [MainThread]: checksum: dd837546c89c9d03f3c2cb0ca6165266a30da6076d5d44e9991f7c5a8e5f5831, vars: {}, profile: , target: , version: 1.5.9
[0m22:22:32.484223 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m22:22:32.484974 [debug] [MainThread]: Partial parsing: updated file: uber://models/transform/dropoff_location_dim.sql
[0m22:22:32.506521 [debug] [MainThread]: 1603: static parser failed on transform/dropoff_location_dim.sql
[0m22:22:32.512282 [error] [MainThread]: Encountered an error:
Compilation Error in model dropoff_location_dim (models/transform/dropoff_location_dim.sql)
  expected token ',', got 'COUNT'
    line 3
      {{ dbt_utils.generate_series(upper_bound = SELECT COUNT(*) FROM {{ source('uber', 'uber_tlc_trip_recrord_data') }})}} as dropoff_location_id,
[0m22:22:32.513927 [debug] [MainThread]: Command `dbt run` failed at 22:22:32.513447 after 0.58 seconds
[0m22:22:32.514713 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff9f7b7550>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff9f90f790>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff9f921b90>]}
[0m22:22:32.515412 [debug] [MainThread]: Flushing usage events
[0m22:26:36.637913 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffa78dcbd0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffa7848b10>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffab5a8850>]}


============================== 22:26:36.647133 | c51d7520-6be6-4e04-9e07-ac4a04420c9b ==============================
[0m22:26:36.647133 [info ] [MainThread]: Running with dbt=1.5.9
[0m22:26:36.649514 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'target_path': 'None', 'use_colors': 'True', 'indirect_selection': 'eager', 'no_print': 'None', 'send_anonymous_usage_stats': 'True', 'debug': 'False', 'use_experimental_parser': 'False', 'warn_error': 'None', 'fail_fast': 'False', 'partial_parse': 'True', 'log_format': 'default', 'log_cache_events': 'False', 'profiles_dir': '/usr/local/airflow/include/dbt/', 'cache_selected_only': 'False', 'log_path': '/usr/local/airflow/include/dbt/logs', 'introspect': 'True', 'write_json': 'True', 'quiet': 'False', 'version_check': 'True', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'static_parser': 'True'}
[0m22:26:37.237818 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'c51d7520-6be6-4e04-9e07-ac4a04420c9b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffa6f736d0>]}
[0m22:26:37.249947 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'c51d7520-6be6-4e04-9e07-ac4a04420c9b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffa552fa10>]}
[0m22:26:37.250827 [info ] [MainThread]: Registered adapter: bigquery=1.5.3
[0m22:26:37.266942 [debug] [MainThread]: checksum: dd837546c89c9d03f3c2cb0ca6165266a30da6076d5d44e9991f7c5a8e5f5831, vars: {}, profile: , target: , version: 1.5.9
[0m22:26:37.360111 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m22:26:37.360854 [debug] [MainThread]: Partial parsing: updated file: uber://models/transform/dropoff_location_dim.sql
[0m22:26:37.381280 [debug] [MainThread]: 1699: static parser successfully parsed transform/dropoff_location_dim.sql
[0m22:26:37.401995 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'c51d7520-6be6-4e04-9e07-ac4a04420c9b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffa5572750>]}
[0m22:26:37.421749 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'c51d7520-6be6-4e04-9e07-ac4a04420c9b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffa5409c90>]}
[0m22:26:37.422573 [info ] [MainThread]: Found 7 models, 0 tests, 0 snapshots, 0 analyses, 474 macros, 0 operations, 0 seed files, 1 source, 0 exposures, 0 metrics, 0 groups
[0m22:26:37.424226 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'c51d7520-6be6-4e04-9e07-ac4a04420c9b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffa74738d0>]}
[0m22:26:37.426704 [info ] [MainThread]: 
[0m22:26:37.429023 [debug] [MainThread]: Acquiring new bigquery connection 'master'
[0m22:26:37.431389 [debug] [ThreadPool]: Acquiring new bigquery connection 'list_uber-data-engineering-407103'
[0m22:26:37.431953 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m22:26:38.785554 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_uber-data-engineering-407103, now list_uber-data-engineering-407103_uber)
[0m22:26:38.796669 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m22:26:41.970589 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'c51d7520-6be6-4e04-9e07-ac4a04420c9b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffa555c690>]}
[0m22:26:41.974038 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m22:26:41.975107 [info ] [MainThread]: 
[0m22:26:42.027546 [debug] [Thread-1 (]: Began running node model.uber.datetime_dim
[0m22:26:42.034208 [info ] [Thread-1 (]: 1 of 7 START sql table model uber.datetime_dim ................................. [RUN]
[0m22:26:42.041070 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_uber-data-engineering-407103_uber, now model.uber.datetime_dim)
[0m22:26:42.042352 [debug] [Thread-1 (]: Began compiling node model.uber.datetime_dim
[0m22:26:42.098187 [debug] [Thread-1 (]: Writing injected SQL for node "model.uber.datetime_dim"
[0m22:26:42.101817 [debug] [Thread-1 (]: Timing info for model.uber.datetime_dim (compile): 22:26:42.043027 => 22:26:42.101190
[0m22:26:42.103446 [debug] [Thread-1 (]: Began executing node model.uber.datetime_dim
[0m22:26:42.123497 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m22:26:43.681046 [debug] [Thread-1 (]: Writing runtime sql for node "model.uber.datetime_dim"
[0m22:26:43.683313 [debug] [Thread-1 (]: On model.uber.datetime_dim: /* {"app": "dbt", "dbt_version": "1.5.9", "profile_name": "uber", "target_name": "dev", "node_id": "model.uber.datetime_dim"} */

  
    

    create or replace table `uber-data-engineering-407103`.`uber`.`datetime_dim`
    
    

    OPTIONS()
    as (
      WITH datetime_cte AS (  
  SELECT DISTINCT 
    to_hex(md5(cast(coalesce(cast(tpep_pickup_datetime as STRING), '_dbt_utils_surrogate_key_null_') || '-' || coalesce(cast(tpep_dropoff_datetime as STRING), '_dbt_utils_surrogate_key_null_') as STRING))) AS datetime_id,
    CASE
      WHEN LENGTH(tpep_pickup_datetime) = 16 THEN
        -- Date format: "DD/MM/YYYY HH:MM"
        PARSE_DATETIME('%m/%d/%Y %H:%M', tpep_pickup_datetime)
      WHEN LENGTH(tpep_pickup_datetime) <= 14 THEN
        -- Date format: "MM/DD/YY HH:MM"
        PARSE_DATETIME('%m/%d/%y %H:%M', tpep_pickup_datetime)
      ELSE
        NULL
    END AS pick_date_part,
    tpep_dropoff_datetime AS drop_datetime_id,
    CASE
      WHEN LENGTH(tpep_dropoff_datetime) = 16 THEN
        -- Date format: "DD/MM/YYYY HH:MM"
        PARSE_DATETIME('%m/%d/%Y %H:%M', tpep_dropoff_datetime)
      WHEN LENGTH(tpep_dropoff_datetime) <= 14 THEN
        -- Date format: "MM/DD/YY HH:MM"
        PARSE_DATETIME('%m/%d/%y %H:%M', tpep_dropoff_datetime)
      ELSE
        NULL
    END AS drop_date_part
  FROM `uber-data-engineering-407103`.`uber`.`uber_tlc_trip_recrord_data`
  WHERE tpep_pickup_datetime IS NOT NULL
    AND tpep_dropoff_datetime IS NOT NULL
)
SELECT
  datetime_id,
  pick_date_part AS tpep_pickup_datetime,
  drop_date_part AS tpep_dropoff_datetime,
  EXTRACT(HOUR FROM pick_date_part) AS pick_hour,
  EXTRACT(DAY FROM pick_date_part) AS pick_day,
  EXTRACT(MONTH FROM pick_date_part) AS pick_month,
  EXTRACT(YEAR FROM pick_date_part) AS pick_year,
  EXTRACT(DAYOFWEEK FROM pick_date_part) AS pick_weekday,
  EXTRACT(HOUR FROM drop_date_part) AS drop_hour,
  EXTRACT(DAY FROM drop_date_part) AS drop_day,
  EXTRACT(MONTH FROM drop_date_part) AS drop_month,
  EXTRACT(YEAR FROM drop_date_part) AS drop_year,
  EXTRACT(DAYOFWEEK FROM drop_date_part) AS drop_weekday
FROM datetime_cte
    );
  
[0m22:26:46.984251 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=uber-data-engineering-407103&j=bq:US:fc05b278-a109-4444-824f-d21faa93556d&page=queryresults
[0m22:26:47.039640 [debug] [Thread-1 (]: Timing info for model.uber.datetime_dim (execute): 22:26:42.104251 => 22:26:47.039035
[0m22:26:47.042163 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'c51d7520-6be6-4e04-9e07-ac4a04420c9b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffa55868d0>]}
[0m22:26:47.044161 [info ] [Thread-1 (]: 1 of 7 OK created sql table model uber.datetime_dim ............................ [[32mCREATE TABLE (99.9k rows, 4.0 MiB processed)[0m in 5.00s]
[0m22:26:47.046128 [debug] [Thread-1 (]: Finished running node model.uber.datetime_dim
[0m22:26:47.048621 [debug] [Thread-1 (]: Began running node model.uber.dropoff_location_dim
[0m22:26:47.050407 [info ] [Thread-1 (]: 2 of 7 START sql table model uber.dropoff_location_dim ......................... [RUN]
[0m22:26:47.051781 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.uber.datetime_dim, now model.uber.dropoff_location_dim)
[0m22:26:47.052705 [debug] [Thread-1 (]: Began compiling node model.uber.dropoff_location_dim
[0m22:26:47.059962 [debug] [Thread-1 (]: Writing injected SQL for node "model.uber.dropoff_location_dim"
[0m22:26:47.064608 [debug] [Thread-1 (]: Timing info for model.uber.dropoff_location_dim (compile): 22:26:47.053398 => 22:26:47.064216
[0m22:26:47.065418 [debug] [Thread-1 (]: Began executing node model.uber.dropoff_location_dim
[0m22:26:47.086918 [debug] [Thread-1 (]: Writing runtime sql for node "model.uber.dropoff_location_dim"
[0m22:26:47.091657 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m22:26:47.101826 [debug] [Thread-1 (]: On model.uber.dropoff_location_dim: /* {"app": "dbt", "dbt_version": "1.5.9", "profile_name": "uber", "target_name": "dev", "node_id": "model.uber.dropoff_location_dim"} */

  
    

    create or replace table `uber-data-engineering-407103`.`uber`.`dropoff_location_dim`
    
    

    OPTIONS()
    as (
      WITH numbered_rows AS (
  SELECT
    CAST(ROW_NUMBER() OVER () AS INT64) as dropoff_location_id,
    dropoff_latitude AS dropoff_latitude,
    dropoff_longitude AS dropoff_longitude,
    ROW_NUMBER() OVER (ORDER BY dropoff_latitude, dropoff_longitude) as row_num
  FROM `uber-data-engineering-407103`.`uber`.`uber_tlc_trip_recrord_data`
)
SELECT
  dropoff_location_id,
  dropoff_latitude,
  dropoff_longitude
FROM numbered_rows
    );
  
[0m22:27:25.580201 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=uber-data-engineering-407103&j=bq:US:a4c2b84f-8b1d-4549-8d3c-1a170ed0baea&page=queryresults
[0m22:27:25.602441 [debug] [Thread-1 (]: Timing info for model.uber.dropoff_location_dim (execute): 22:26:47.065961 => 22:27:25.601878
[0m22:27:25.604997 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'c51d7520-6be6-4e04-9e07-ac4a04420c9b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffa5290790>]}
[0m22:27:25.606830 [info ] [Thread-1 (]: 2 of 7 OK created sql table model uber.dropoff_location_dim .................... [[32mCREATE TABLE (100.0k rows, 1.5 MiB processed)[0m in 38.55s]
[0m22:27:25.608505 [debug] [Thread-1 (]: Finished running node model.uber.dropoff_location_dim
[0m22:27:25.610338 [debug] [Thread-1 (]: Began running node model.uber.passenger_count_dim
[0m22:27:25.611542 [info ] [Thread-1 (]: 3 of 7 START sql table model uber.passenger_count_dim .......................... [RUN]
[0m22:27:25.612774 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.uber.dropoff_location_dim, now model.uber.passenger_count_dim)
[0m22:27:25.613536 [debug] [Thread-1 (]: Began compiling node model.uber.passenger_count_dim
[0m22:27:25.622833 [debug] [Thread-1 (]: Writing injected SQL for node "model.uber.passenger_count_dim"
[0m22:27:25.626221 [debug] [Thread-1 (]: Timing info for model.uber.passenger_count_dim (compile): 22:27:25.614043 => 22:27:25.625990
[0m22:27:25.626874 [debug] [Thread-1 (]: Began executing node model.uber.passenger_count_dim
[0m22:27:25.630119 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m22:27:26.456354 [debug] [Thread-1 (]: Writing runtime sql for node "model.uber.passenger_count_dim"
[0m22:27:26.465357 [debug] [Thread-1 (]: On model.uber.passenger_count_dim: /* {"app": "dbt", "dbt_version": "1.5.9", "profile_name": "uber", "target_name": "dev", "node_id": "model.uber.passenger_count_dim"} */

  
    

    create or replace table `uber-data-engineering-407103`.`uber`.`passenger_count_dim`
    
    

    OPTIONS()
    as (
      SELECT DISTINCT
    to_hex(md5(cast( as STRING))) as passenger_count_id,
		passenger_count AS passenger_count,
FROM `uber-data-engineering-407103`.`uber`.`uber_tlc_trip_recrord_data`
WHERE passenger_count IS NOT NULL
    );
  
[0m22:27:26.695259 [debug] [Thread-1 (]: BigQuery adapter: Retry attempt 1 of 1 after error: BadRequest('Syntax error: Unexpected keyword AS at [13:22]')
[0m22:27:26.985686 [error] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=uber-data-engineering-407103&j=bq:US:e42041e4-3d37-48f7-9f67-f4bca3e32c40&page=queryresults
[0m22:27:26.988856 [debug] [Thread-1 (]: Timing info for model.uber.passenger_count_dim (execute): 22:27:25.627340 => 22:27:26.988287
[0m22:27:27.015525 [debug] [Thread-1 (]: Database Error in model passenger_count_dim (models/transform/passenger_count_dim.sql)
  Syntax error: Unexpected keyword AS at [13:22]
  compiled Code at target/run/uber/models/transform/passenger_count_dim.sql
[0m22:27:27.016700 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'c51d7520-6be6-4e04-9e07-ac4a04420c9b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffa53b0cd0>]}
[0m22:27:27.017710 [error] [Thread-1 (]: 3 of 7 ERROR creating sql table model uber.passenger_count_dim ................. [[31mERROR[0m in 1.40s]
[0m22:27:27.018753 [debug] [Thread-1 (]: Finished running node model.uber.passenger_count_dim
[0m22:27:27.019584 [debug] [Thread-1 (]: Began running node model.uber.payment_type_dim
[0m22:27:27.020875 [info ] [Thread-1 (]: 4 of 7 START sql table model uber.payment_type_dim ............................. [RUN]
[0m22:27:27.022633 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.uber.passenger_count_dim, now model.uber.payment_type_dim)
[0m22:27:27.023437 [debug] [Thread-1 (]: Began compiling node model.uber.payment_type_dim
[0m22:27:27.037654 [debug] [Thread-1 (]: Writing injected SQL for node "model.uber.payment_type_dim"
[0m22:27:27.040599 [debug] [Thread-1 (]: Timing info for model.uber.payment_type_dim (compile): 22:27:27.023912 => 22:27:27.040286
[0m22:27:27.041270 [debug] [Thread-1 (]: Began executing node model.uber.payment_type_dim
[0m22:27:27.045402 [debug] [Thread-1 (]: Writing runtime sql for node "model.uber.payment_type_dim"
[0m22:27:27.047072 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m22:27:27.049245 [debug] [Thread-1 (]: On model.uber.payment_type_dim: /* {"app": "dbt", "dbt_version": "1.5.9", "profile_name": "uber", "target_name": "dev", "node_id": "model.uber.payment_type_dim"} */

  
    

    create or replace table `uber-data-engineering-407103`.`uber`.`payment_type_dim`
    
    

    OPTIONS()
    as (
      WITH numbered_rows AS (
  SELECT
    

    

    with p as (
        select 0 as generated_number union all select 1
    ), unioned as (

    select

    
    p0.generated_number * power(2, 0)
    
    
    + 1
    as generated_number

    from

    
    p as p0
    
    

    )

    select *
    from unioned
    where generated_number <= 1
    order by generated_number

 as payment_type_id,
    payment_type AS payment_type,
    ROW_NUMBER() OVER (ORDER BY payment_type) as row_num
  FROM `uber-data-engineering-407103`.`uber`.`uber_tlc_trip_recrord_data`
  WHERE payment_type IS NOT NULL
)
SELECT
  payment_type_id,
  payment_type
FROM numbered_rows
    );
  
[0m22:27:27.556132 [debug] [Thread-1 (]: BigQuery adapter: Retry attempt 1 of 1 after error: BadRequest('Syntax error: Unexpected "(" at [18:15]')
[0m22:27:28.324013 [error] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=uber-data-engineering-407103&j=bq:US:d1c4fdf4-0b75-49a4-94bb-37d24f09f213&page=queryresults
[0m22:27:28.329952 [debug] [Thread-1 (]: Timing info for model.uber.payment_type_dim (execute): 22:27:27.042008 => 22:27:28.329168
[0m22:27:28.338067 [debug] [Thread-1 (]: Database Error in model payment_type_dim (models/transform/payment_type_dim.sql)
  Syntax error: Unexpected "(" at [18:15]
  compiled Code at target/run/uber/models/transform/payment_type_dim.sql
[0m22:27:28.339713 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'c51d7520-6be6-4e04-9e07-ac4a04420c9b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffa418a650>]}
[0m22:27:28.341296 [error] [Thread-1 (]: 4 of 7 ERROR creating sql table model uber.payment_type_dim .................... [[31mERROR[0m in 1.32s]
[0m22:27:28.342792 [debug] [Thread-1 (]: Finished running node model.uber.payment_type_dim
[0m22:27:28.343761 [debug] [Thread-1 (]: Began running node model.uber.pickup_location_dim
[0m22:27:28.344710 [info ] [Thread-1 (]: 5 of 7 START sql table model uber.pickup_location_dim .......................... [RUN]
[0m22:27:28.345952 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.uber.payment_type_dim, now model.uber.pickup_location_dim)
[0m22:27:28.346586 [debug] [Thread-1 (]: Began compiling node model.uber.pickup_location_dim
[0m22:27:28.353237 [debug] [Thread-1 (]: Writing injected SQL for node "model.uber.pickup_location_dim"
[0m22:27:28.355634 [debug] [Thread-1 (]: Timing info for model.uber.pickup_location_dim (compile): 22:27:28.347073 => 22:27:28.355382
[0m22:27:28.356286 [debug] [Thread-1 (]: Began executing node model.uber.pickup_location_dim
[0m22:27:28.359847 [debug] [Thread-1 (]: Writing runtime sql for node "model.uber.pickup_location_dim"
[0m22:27:28.361807 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m22:27:28.363711 [debug] [Thread-1 (]: On model.uber.pickup_location_dim: /* {"app": "dbt", "dbt_version": "1.5.9", "profile_name": "uber", "target_name": "dev", "node_id": "model.uber.pickup_location_dim"} */

  
    

    create or replace table `uber-data-engineering-407103`.`uber`.`pickup_location_dim`
    
    

    OPTIONS()
    as (
      WITH numbered_rows AS (
  SELECT
    

    

    with p as (
        select 0 as generated_number union all select 1
    ), unioned as (

    select

    
    p0.generated_number * power(2, 0)
    
    
    + 1
    as generated_number

    from

    
    p as p0
    
    

    )

    select *
    from unioned
    where generated_number <= 1
    order by generated_number

 as pickup_location_id,
    pickup_latitude AS pickup_latitude,
    pickup_longitude AS pickup_longitude,
    ROW_NUMBER() OVER (ORDER BY pickup_latitude, pickup_longitude) as row_num
  FROM `uber-data-engineering-407103`.`uber`.`uber_tlc_trip_recrord_data`
)
SELECT
  pickup_location_id,
  pickup_latitude,
  pickup_longitude
FROM numbered_rows
    );
  
[0m22:27:28.927703 [debug] [Thread-1 (]: BigQuery adapter: Retry attempt 1 of 1 after error: BadRequest('Syntax error: Unexpected "(" at [18:15]')
[0m22:27:30.023227 [error] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=uber-data-engineering-407103&j=bq:US:d957dd90-79de-4320-85e2-d90dec2ec58c&page=queryresults
[0m22:27:30.028489 [debug] [Thread-1 (]: Timing info for model.uber.pickup_location_dim (execute): 22:27:28.356790 => 22:27:30.027260
[0m22:27:30.037099 [debug] [Thread-1 (]: Database Error in model pickup_location_dim (models/transform/pickup_location_dim.sql)
  Syntax error: Unexpected "(" at [18:15]
  compiled Code at target/run/uber/models/transform/pickup_location_dim.sql
[0m22:27:30.039356 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'c51d7520-6be6-4e04-9e07-ac4a04420c9b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffa409eb50>]}
[0m22:27:30.043451 [error] [Thread-1 (]: 5 of 7 ERROR creating sql table model uber.pickup_location_dim ................. [[31mERROR[0m in 1.69s]
[0m22:27:30.045478 [debug] [Thread-1 (]: Finished running node model.uber.pickup_location_dim
[0m22:27:30.046948 [debug] [Thread-1 (]: Began running node model.uber.rate_code_dim
[0m22:27:30.049274 [info ] [Thread-1 (]: 6 of 7 START sql table model uber.rate_code_dim ................................ [RUN]
[0m22:27:30.051236 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.uber.pickup_location_dim, now model.uber.rate_code_dim)
[0m22:27:30.052418 [debug] [Thread-1 (]: Began compiling node model.uber.rate_code_dim
[0m22:27:30.063262 [debug] [Thread-1 (]: Writing injected SQL for node "model.uber.rate_code_dim"
[0m22:27:30.066060 [debug] [Thread-1 (]: Timing info for model.uber.rate_code_dim (compile): 22:27:30.053176 => 22:27:30.065857
[0m22:27:30.066706 [debug] [Thread-1 (]: Began executing node model.uber.rate_code_dim
[0m22:27:30.070472 [debug] [Thread-1 (]: Writing runtime sql for node "model.uber.rate_code_dim"
[0m22:27:30.072890 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m22:27:30.076100 [debug] [Thread-1 (]: On model.uber.rate_code_dim: /* {"app": "dbt", "dbt_version": "1.5.9", "profile_name": "uber", "target_name": "dev", "node_id": "model.uber.rate_code_dim"} */

  
    

    create or replace table `uber-data-engineering-407103`.`uber`.`rate_code_dim`
    
    

    OPTIONS()
    as (
      WITH numbered_rows AS (
  SELECT
    

    

    with p as (
        select 0 as generated_number union all select 1
    ), unioned as (

    select

    
    p0.generated_number * power(2, 0)
    
    
    + 1
    as generated_number

    from

    
    p as p0
    
    

    )

    select *
    from unioned
    where generated_number <= 1
    order by generated_number

 as rate_code_id,
    RatecodeID AS RatecodeID,
    ROW_NUMBER() OVER (ORDER BY RatecodeID) as row_num
  FROM `uber-data-engineering-407103`.`uber`.`uber_tlc_trip_recrord_data`
  WHERE RatecodeID IS NOT NULL
)
SELECT
  rate_code_id,
  rate_code
FROM numbered_rows
    );
  
[0m22:27:30.599114 [debug] [Thread-1 (]: BigQuery adapter: Retry attempt 1 of 1 after error: BadRequest('Syntax error: Unexpected "(" at [18:15]')
[0m22:27:31.195204 [error] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=uber-data-engineering-407103&j=bq:US:021e3489-f8b3-4eb8-8752-ec1601642c23&page=queryresults
[0m22:27:31.196990 [debug] [Thread-1 (]: Timing info for model.uber.rate_code_dim (execute): 22:27:30.067201 => 22:27:31.196747
[0m22:27:31.201506 [debug] [Thread-1 (]: Database Error in model rate_code_dim (models/transform/rate_code_dim.sql)
  Syntax error: Unexpected "(" at [18:15]
  compiled Code at target/run/uber/models/transform/rate_code_dim.sql
[0m22:27:31.202227 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'c51d7520-6be6-4e04-9e07-ac4a04420c9b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffa40f42d0>]}
[0m22:27:31.203066 [error] [Thread-1 (]: 6 of 7 ERROR creating sql table model uber.rate_code_dim ....................... [[31mERROR[0m in 1.15s]
[0m22:27:31.203907 [debug] [Thread-1 (]: Finished running node model.uber.rate_code_dim
[0m22:27:31.204541 [debug] [Thread-1 (]: Began running node model.uber.trip_distance
[0m22:27:31.205374 [info ] [Thread-1 (]: 7 of 7 START sql table model uber.trip_distance ................................ [RUN]
[0m22:27:31.206522 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.uber.rate_code_dim, now model.uber.trip_distance)
[0m22:27:31.207143 [debug] [Thread-1 (]: Began compiling node model.uber.trip_distance
[0m22:27:31.211630 [debug] [Thread-1 (]: Writing injected SQL for node "model.uber.trip_distance"
[0m22:27:31.213527 [debug] [Thread-1 (]: Timing info for model.uber.trip_distance (compile): 22:27:31.207649 => 22:27:31.213375
[0m22:27:31.214022 [debug] [Thread-1 (]: Began executing node model.uber.trip_distance
[0m22:27:31.216835 [debug] [Thread-1 (]: Writing runtime sql for node "model.uber.trip_distance"
[0m22:27:31.218558 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m22:27:31.220334 [debug] [Thread-1 (]: On model.uber.trip_distance: /* {"app": "dbt", "dbt_version": "1.5.9", "profile_name": "uber", "target_name": "dev", "node_id": "model.uber.trip_distance"} */

  
    

    create or replace table `uber-data-engineering-407103`.`uber`.`trip_distance`
    
    

    OPTIONS()
    as (
      WITH numbered_rows AS (
  SELECT
    to_hex(md5(cast( as STRING))) as trip_distance_id,
    trip_distance AS trip_distance,
    ROW_NUMBER() OVER (ORDER BY trip_distance) as row_num
  FROM `uber-data-engineering-407103`.`uber`.`uber_tlc_trip_recrord_data`
  WHERE trip_distance IS NOT NULL
)
SELECT
  trip_distance_id,
  trip_distance
FROM numbered_rows
    );
  
[0m22:27:31.883012 [debug] [Thread-1 (]: BigQuery adapter: Retry attempt 1 of 1 after error: BadRequest('Syntax error: Unexpected keyword AS at [14:22]')
[0m22:27:32.618235 [error] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=uber-data-engineering-407103&j=bq:US:ae81f617-4434-4340-943f-065adb178bc3&page=queryresults
[0m22:27:32.623513 [debug] [Thread-1 (]: Timing info for model.uber.trip_distance (execute): 22:27:31.214438 => 22:27:32.622642
[0m22:27:32.632707 [debug] [Thread-1 (]: Database Error in model trip_distance (models/transform/trip_distance.sql)
  Syntax error: Unexpected keyword AS at [14:22]
  compiled Code at target/run/uber/models/transform/trip_distance.sql
[0m22:27:32.634794 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'c51d7520-6be6-4e04-9e07-ac4a04420c9b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffa40b9d90>]}
[0m22:27:32.636896 [error] [Thread-1 (]: 7 of 7 ERROR creating sql table model uber.trip_distance ....................... [[31mERROR[0m in 1.43s]
[0m22:27:32.639607 [debug] [Thread-1 (]: Finished running node model.uber.trip_distance
[0m22:27:32.647344 [debug] [MainThread]: Connection 'master' was properly closed.
[0m22:27:32.648537 [debug] [MainThread]: Connection 'model.uber.trip_distance' was properly closed.
[0m22:27:32.649998 [info ] [MainThread]: 
[0m22:27:32.651290 [info ] [MainThread]: Finished running 7 table models in 0 hours 0 minutes and 55.22 seconds (55.22s).
[0m22:27:32.654078 [debug] [MainThread]: Command end result
[0m22:27:32.697398 [info ] [MainThread]: 
[0m22:27:32.700283 [info ] [MainThread]: [31mCompleted with 5 errors and 0 warnings:[0m
[0m22:27:32.701506 [info ] [MainThread]: 
[0m22:27:32.702252 [error] [MainThread]: [33mDatabase Error in model passenger_count_dim (models/transform/passenger_count_dim.sql)[0m
[0m22:27:32.703194 [error] [MainThread]:   Syntax error: Unexpected keyword AS at [13:22]
[0m22:27:32.704239 [error] [MainThread]:   compiled Code at target/run/uber/models/transform/passenger_count_dim.sql
[0m22:27:32.708140 [info ] [MainThread]: 
[0m22:27:32.709451 [error] [MainThread]: [33mDatabase Error in model payment_type_dim (models/transform/payment_type_dim.sql)[0m
[0m22:27:32.710188 [error] [MainThread]:   Syntax error: Unexpected "(" at [18:15]
[0m22:27:32.710961 [error] [MainThread]:   compiled Code at target/run/uber/models/transform/payment_type_dim.sql
[0m22:27:32.711748 [info ] [MainThread]: 
[0m22:27:32.712480 [error] [MainThread]: [33mDatabase Error in model pickup_location_dim (models/transform/pickup_location_dim.sql)[0m
[0m22:27:32.713200 [error] [MainThread]:   Syntax error: Unexpected "(" at [18:15]
[0m22:27:32.713812 [error] [MainThread]:   compiled Code at target/run/uber/models/transform/pickup_location_dim.sql
[0m22:27:32.714434 [info ] [MainThread]: 
[0m22:27:32.715000 [error] [MainThread]: [33mDatabase Error in model rate_code_dim (models/transform/rate_code_dim.sql)[0m
[0m22:27:32.715546 [error] [MainThread]:   Syntax error: Unexpected "(" at [18:15]
[0m22:27:32.716070 [error] [MainThread]:   compiled Code at target/run/uber/models/transform/rate_code_dim.sql
[0m22:27:32.716634 [info ] [MainThread]: 
[0m22:27:32.717137 [error] [MainThread]: [33mDatabase Error in model trip_distance (models/transform/trip_distance.sql)[0m
[0m22:27:32.717675 [error] [MainThread]:   Syntax error: Unexpected keyword AS at [14:22]
[0m22:27:32.718185 [error] [MainThread]:   compiled Code at target/run/uber/models/transform/trip_distance.sql
[0m22:27:32.718740 [info ] [MainThread]: 
[0m22:27:32.719549 [info ] [MainThread]: Done. PASS=2 WARN=0 ERROR=5 SKIP=0 TOTAL=7
[0m22:27:32.722424 [debug] [MainThread]: Command `dbt run` failed at 22:27:32.722153 after 56.10 seconds
[0m22:27:32.724195 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffa872e790>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffa5390b50>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffa77a6710>]}
[0m22:27:32.724937 [debug] [MainThread]: Flushing usage events
[0m00:13:43.550432 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff9964ff10>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff99cff350>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff99957fd0>]}


============================== 00:13:43.561368 | c1f89955-9807-4854-94b9-e0c903688030 ==============================
[0m00:13:43.561368 [info ] [MainThread]: Running with dbt=1.5.9
[0m00:13:43.563035 [debug] [MainThread]: running dbt with arguments {'cache_selected_only': 'False', 'use_colors': 'True', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'use_experimental_parser': 'False', 'fail_fast': 'False', 'introspect': 'True', 'log_format': 'default', 'printer_width': '80', 'profiles_dir': '/usr/local/airflow/include/dbt/', 'indirect_selection': 'eager', 'partial_parse': 'True', 'log_path': '/usr/local/airflow/include/dbt/logs', 'write_json': 'True', 'static_parser': 'True', 'debug': 'False', 'log_cache_events': 'False', 'warn_error': 'None', 'target_path': 'None', 'no_print': 'None', 'quiet': 'False', 'version_check': 'True', 'send_anonymous_usage_stats': 'True'}
[0m00:13:44.667924 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'c1f89955-9807-4854-94b9-e0c903688030', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff99661050>]}
[0m00:13:44.684801 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'c1f89955-9807-4854-94b9-e0c903688030', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff975e7ed0>]}
[0m00:13:44.685895 [info ] [MainThread]: Registered adapter: bigquery=1.5.3
[0m00:13:44.705249 [debug] [MainThread]: checksum: dd837546c89c9d03f3c2cb0ca6165266a30da6076d5d44e9991f7c5a8e5f5831, vars: {}, profile: , target: , version: 1.5.9
[0m00:13:44.796642 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 7 files changed.
[0m00:13:44.797554 [debug] [MainThread]: Partial parsing: updated file: uber://models/transform/payment_type_dim.sql
[0m00:13:44.798163 [debug] [MainThread]: Partial parsing: updated file: uber://models/transform/dropoff_location_dim.sql
[0m00:13:44.798729 [debug] [MainThread]: Partial parsing: updated file: uber://models/transform/passenger_count_dim.sql
[0m00:13:44.799279 [debug] [MainThread]: Partial parsing: updated file: uber://models/transform/pickup_location_dim.sql
[0m00:13:44.799831 [debug] [MainThread]: Partial parsing: updated file: uber://models/transform/datetime_dim.sql
[0m00:13:44.800378 [debug] [MainThread]: Partial parsing: updated file: uber://models/transform/trip_distance.sql
[0m00:13:44.800906 [debug] [MainThread]: Partial parsing: updated file: uber://models/transform/rate_code_dim.sql
[0m00:13:44.825580 [debug] [MainThread]: 1699: static parser successfully parsed transform/payment_type_dim.sql
[0m00:13:44.836659 [debug] [MainThread]: 1603: static parser failed on transform/dropoff_location_dim.sql
[0m00:13:44.855011 [debug] [MainThread]: 1602: parser fallback to jinja rendering on transform/dropoff_location_dim.sql
[0m00:13:44.856886 [debug] [MainThread]: 1699: static parser successfully parsed transform/passenger_count_dim.sql
[0m00:13:44.861351 [debug] [MainThread]: 1603: static parser failed on transform/pickup_location_dim.sql
[0m00:13:44.867540 [debug] [MainThread]: 1602: parser fallback to jinja rendering on transform/pickup_location_dim.sql
[0m00:13:44.869880 [debug] [MainThread]: 1603: static parser failed on transform/datetime_dim.sql
[0m00:13:44.878860 [debug] [MainThread]: 1602: parser fallback to jinja rendering on transform/datetime_dim.sql
[0m00:13:44.880726 [debug] [MainThread]: 1699: static parser successfully parsed transform/trip_distance.sql
[0m00:13:44.885920 [debug] [MainThread]: 1699: static parser successfully parsed transform/rate_code_dim.sql
[0m00:13:44.902608 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'c1f89955-9807-4854-94b9-e0c903688030', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff974f8450>]}
[0m00:13:44.924285 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'c1f89955-9807-4854-94b9-e0c903688030', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff97414350>]}
[0m00:13:44.924959 [info ] [MainThread]: Found 7 models, 0 tests, 0 snapshots, 0 analyses, 474 macros, 0 operations, 0 seed files, 1 source, 0 exposures, 0 metrics, 0 groups
[0m00:13:44.925693 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'c1f89955-9807-4854-94b9-e0c903688030', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff9c4eb6d0>]}
[0m00:13:44.927463 [info ] [MainThread]: 
[0m00:13:44.928380 [debug] [MainThread]: Acquiring new bigquery connection 'master'
[0m00:13:44.930466 [debug] [ThreadPool]: Acquiring new bigquery connection 'list_uber-data-engineering-407103'
[0m00:13:44.931075 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m00:13:45.453171 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_uber-data-engineering-407103, now list_uber-data-engineering-407103_uber)
[0m00:13:45.454153 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m00:13:45.831296 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'c1f89955-9807-4854-94b9-e0c903688030', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff973fcfd0>]}
[0m00:13:45.833787 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m00:13:45.834994 [info ] [MainThread]: 
[0m00:13:45.859301 [debug] [Thread-1 (]: Began running node model.uber.datetime_dim
[0m00:13:45.860154 [info ] [Thread-1 (]: 1 of 7 START sql table model uber.datetime_dim ................................. [RUN]
[0m00:13:45.861230 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_uber-data-engineering-407103_uber, now model.uber.datetime_dim)
[0m00:13:45.861762 [debug] [Thread-1 (]: Began compiling node model.uber.datetime_dim
[0m00:13:45.874174 [debug] [Thread-1 (]: Writing injected SQL for node "model.uber.datetime_dim"
[0m00:13:45.876496 [debug] [Thread-1 (]: Timing info for model.uber.datetime_dim (compile): 00:13:45.862271 => 00:13:45.876296
[0m00:13:45.877059 [debug] [Thread-1 (]: Began executing node model.uber.datetime_dim
[0m00:13:45.890342 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m00:13:46.555789 [debug] [Thread-1 (]: Writing runtime sql for node "model.uber.datetime_dim"
[0m00:13:46.559786 [debug] [Thread-1 (]: On model.uber.datetime_dim: /* {"app": "dbt", "dbt_version": "1.5.9", "profile_name": "uber", "target_name": "dev", "node_id": "model.uber.datetime_dim"} */

  
    

    create or replace table `uber-data-engineering-407103`.`uber`.`datetime_dim`
    
    

    OPTIONS()
    as (
      WITH datetime_cte AS (  
  SELECT DISTINCT 
    to_hex(md5(cast(coalesce(cast(tpep_pickup_datetime as STRING), '_dbt_utils_surrogate_key_null_') || '-' || coalesce(cast(tpep_dropoff_datetime as STRING), '_dbt_utils_surrogate_key_null_') as STRING))) AS datetime_id,
    CASE
      WHEN LENGTH(tpep_pickup_datetime) = 16 THEN
        -- Date format: "DD/MM/YYYY HH:MM"
        PARSE_DATETIME('%m/%d/%Y %H:%M', tpep_pickup_datetime)
      WHEN LENGTH(tpep_pickup_datetime) <= 14 THEN
        -- Date format: "MM/DD/YY HH:MM"
        PARSE_DATETIME('%m/%d/%y %H:%M', tpep_pickup_datetime)
      ELSE
        NULL
    END AS pick_date_part,
    tpep_dropoff_datetime AS drop_datetime_id,
    CASE
      WHEN LENGTH(tpep_dropoff_datetime) = 16 THEN
        -- Date format: "DD/MM/YYYY HH:MM"
        PARSE_DATETIME('%m/%d/%Y %H:%M', tpep_dropoff_datetime)
      WHEN LENGTH(tpep_dropoff_datetime) <= 14 THEN
        -- Date format: "MM/DD/YY HH:MM"
        PARSE_DATETIME('%m/%d/%y %H:%M', tpep_dropoff_datetime)
      ELSE
        NULL
    END AS drop_date_part
  FROM `uber-data-engineering-407103`.`uber`.`uber_tlc_trip_recrord_data`
  WHERE tpep_pickup_datetime IS NOT NULL
    AND tpep_dropoff_datetime IS NOT NULL
)
SELECT
  datetime_id,
  pick_date_part AS tpep_pickup_datetime,
  drop_date_part AS tpep_dropoff_datetime,
  EXTRACT(HOUR FROM pick_date_part) AS pick_hour,
  EXTRACT(DAY FROM pick_date_part) AS pick_day,
  EXTRACT(MONTH FROM pick_date_part) AS pick_month,
  EXTRACT(YEAR FROM pick_date_part) AS pick_year,
  EXTRACT(DAYOFWEEK FROM pick_date_part) AS pick_weekday,
  EXTRACT(HOUR FROM drop_date_part) AS drop_hour,
  EXTRACT(DAY FROM drop_date_part) AS drop_day,
  EXTRACT(MONTH FROM drop_date_part) AS drop_month,
  EXTRACT(YEAR FROM drop_date_part) AS drop_year,
  EXTRACT(DAYOFWEEK FROM drop_date_part) AS drop_weekday
FROM datetime_cte
    );
  
[0m00:13:50.928736 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=uber-data-engineering-407103&j=bq:US:02a82921-c8f3-4f92-96e2-8859af14589f&page=queryresults
[0m00:13:50.975594 [debug] [Thread-1 (]: Timing info for model.uber.datetime_dim (execute): 00:13:45.877479 => 00:13:50.975011
[0m00:13:50.978138 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'c1f89955-9807-4854-94b9-e0c903688030', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff974f8450>]}
[0m00:13:50.980029 [info ] [Thread-1 (]: 1 of 7 OK created sql table model uber.datetime_dim ............................ [[32mCREATE TABLE (99.9k rows, 4.0 MiB processed)[0m in 5.12s]
[0m00:13:50.981648 [debug] [Thread-1 (]: Finished running node model.uber.datetime_dim
[0m00:13:50.983186 [debug] [Thread-1 (]: Began running node model.uber.dropoff_location_dim
[0m00:13:50.985656 [info ] [Thread-1 (]: 2 of 7 START sql table model uber.dropoff_location_dim ......................... [RUN]
[0m00:13:50.987807 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.uber.datetime_dim, now model.uber.dropoff_location_dim)
[0m00:13:50.988733 [debug] [Thread-1 (]: Began compiling node model.uber.dropoff_location_dim
[0m00:13:51.003505 [debug] [Thread-1 (]: Writing injected SQL for node "model.uber.dropoff_location_dim"
[0m00:13:51.007319 [debug] [Thread-1 (]: Timing info for model.uber.dropoff_location_dim (compile): 00:13:50.989389 => 00:13:51.006918
[0m00:13:51.008035 [debug] [Thread-1 (]: Began executing node model.uber.dropoff_location_dim
[0m00:13:51.011337 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m00:13:51.987239 [debug] [Thread-1 (]: Writing runtime sql for node "model.uber.dropoff_location_dim"
[0m00:13:51.992257 [debug] [Thread-1 (]: On model.uber.dropoff_location_dim: /* {"app": "dbt", "dbt_version": "1.5.9", "profile_name": "uber", "target_name": "dev", "node_id": "model.uber.dropoff_location_dim"} */

  
    

    create or replace table `uber-data-engineering-407103`.`uber`.`dropoff_location_dim`
    
    

    OPTIONS()
    as (
      WITH numbered_rows AS (
  SELECT
    to_hex(md5(cast(coalesce(cast(dropoff_latitude as STRING), '_dbt_utils_surrogate_key_null_') || '-' || coalesce(cast(dropoff_longitude as STRING), '_dbt_utils_surrogate_key_null_') as STRING))) as dropoff_location_id,
    dropoff_latitude AS dropoff_latitude,
    dropoff_longitude AS dropoff_longitude,
    ROW_NUMBER() OVER (ORDER BY dropoff_latitude, dropoff_longitude) as row_num
  FROM `uber-data-engineering-407103`.`uber`.`uber_tlc_trip_recrord_data`
)
SELECT
  dropoff_location_id,
  dropoff_latitude,
  dropoff_longitude
FROM numbered_rows
    );
  
[0m00:13:55.446932 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=uber-data-engineering-407103&j=bq:US:8f27c02d-1c96-4bdd-b46b-1c42ca7bf149&page=queryresults
[0m00:13:55.462727 [debug] [Thread-1 (]: Timing info for model.uber.dropoff_location_dim (execute): 00:13:51.008523 => 00:13:55.462089
[0m00:13:55.465635 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'c1f89955-9807-4854-94b9-e0c903688030', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff9761db90>]}
[0m00:13:55.467753 [info ] [Thread-1 (]: 2 of 7 OK created sql table model uber.dropoff_location_dim .................... [[32mCREATE TABLE (100.0k rows, 1.5 MiB processed)[0m in 4.48s]
[0m00:13:55.469822 [debug] [Thread-1 (]: Finished running node model.uber.dropoff_location_dim
[0m00:13:55.471126 [debug] [Thread-1 (]: Began running node model.uber.passenger_count_dim
[0m00:13:55.472609 [info ] [Thread-1 (]: 3 of 7 START sql table model uber.passenger_count_dim .......................... [RUN]
[0m00:13:55.473840 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.uber.dropoff_location_dim, now model.uber.passenger_count_dim)
[0m00:13:55.474617 [debug] [Thread-1 (]: Began compiling node model.uber.passenger_count_dim
[0m00:13:55.483103 [debug] [Thread-1 (]: Writing injected SQL for node "model.uber.passenger_count_dim"
[0m00:13:55.485850 [debug] [Thread-1 (]: Timing info for model.uber.passenger_count_dim (compile): 00:13:55.475137 => 00:13:55.485682
[0m00:13:55.486649 [debug] [Thread-1 (]: Began executing node model.uber.passenger_count_dim
[0m00:13:55.489495 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m00:13:55.987221 [debug] [Thread-1 (]: Writing runtime sql for node "model.uber.passenger_count_dim"
[0m00:13:55.993823 [debug] [Thread-1 (]: On model.uber.passenger_count_dim: /* {"app": "dbt", "dbt_version": "1.5.9", "profile_name": "uber", "target_name": "dev", "node_id": "model.uber.passenger_count_dim"} */

  
    

    create or replace table `uber-data-engineering-407103`.`uber`.`passenger_count_dim`
    
    

    OPTIONS()
    as (
      SELECT DISTINCT
        GENERATE_UUID() as passenger_count_id,
		passenger_count AS passenger_count,
FROM `uber-data-engineering-407103`.`uber`.`uber_tlc_trip_recrord_data`
WHERE passenger_count IS NOT NULL
    );
  
[0m00:13:59.135438 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=uber-data-engineering-407103&j=bq:US:df337557-4602-48d5-adec-daf98cb82f50&page=queryresults
[0m00:13:59.158218 [debug] [Thread-1 (]: Timing info for model.uber.passenger_count_dim (execute): 00:13:55.487126 => 00:13:59.157554
[0m00:13:59.161158 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'c1f89955-9807-4854-94b9-e0c903688030', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff973df110>]}
[0m00:13:59.163382 [info ] [Thread-1 (]: 3 of 7 OK created sql table model uber.passenger_count_dim ..................... [[32mCREATE TABLE (100.0k rows, 781.2 KiB processed)[0m in 3.69s]
[0m00:13:59.165513 [debug] [Thread-1 (]: Finished running node model.uber.passenger_count_dim
[0m00:13:59.166999 [debug] [Thread-1 (]: Began running node model.uber.payment_type_dim
[0m00:13:59.168727 [info ] [Thread-1 (]: 4 of 7 START sql table model uber.payment_type_dim ............................. [RUN]
[0m00:13:59.170173 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.uber.passenger_count_dim, now model.uber.payment_type_dim)
[0m00:13:59.170945 [debug] [Thread-1 (]: Began compiling node model.uber.payment_type_dim
[0m00:13:59.183704 [debug] [Thread-1 (]: Writing injected SQL for node "model.uber.payment_type_dim"
[0m00:13:59.186744 [debug] [Thread-1 (]: Timing info for model.uber.payment_type_dim (compile): 00:13:59.171506 => 00:13:59.186559
[0m00:13:59.187282 [debug] [Thread-1 (]: Began executing node model.uber.payment_type_dim
[0m00:13:59.191345 [debug] [Thread-1 (]: Writing runtime sql for node "model.uber.payment_type_dim"
[0m00:13:59.193510 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m00:13:59.197402 [debug] [Thread-1 (]: On model.uber.payment_type_dim: /* {"app": "dbt", "dbt_version": "1.5.9", "profile_name": "uber", "target_name": "dev", "node_id": "model.uber.payment_type_dim"} */

  
    

    create or replace table `uber-data-engineering-407103`.`uber`.`payment_type_dim`
    
    

    OPTIONS()
    as (
      WITH numbered_rows AS (
  SELECT
    GENERATE_UUID() as payment_type_id,
    payment_type AS payment_type,
    ROW_NUMBER() OVER (ORDER BY payment_type) as row_num
  FROM `uber-data-engineering-407103`.`uber`.`uber_tlc_trip_recrord_data`
  WHERE payment_type IS NOT NULL
)
SELECT
  payment_type_id,
  payment_type
FROM numbered_rows
    );
  
[0m00:14:02.560690 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=uber-data-engineering-407103&j=bq:US:fce0d0e1-1e00-4cc3-aba0-ad995a547268&page=queryresults
[0m00:14:02.563650 [debug] [Thread-1 (]: Timing info for model.uber.payment_type_dim (execute): 00:13:59.187716 => 00:14:02.563482
[0m00:14:02.564587 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'c1f89955-9807-4854-94b9-e0c903688030', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff97346e50>]}
[0m00:14:02.565420 [info ] [Thread-1 (]: 4 of 7 OK created sql table model uber.payment_type_dim ........................ [[32mCREATE TABLE (100.0k rows, 781.2 KiB processed)[0m in 3.39s]
[0m00:14:02.566533 [debug] [Thread-1 (]: Finished running node model.uber.payment_type_dim
[0m00:14:02.567294 [debug] [Thread-1 (]: Began running node model.uber.pickup_location_dim
[0m00:14:02.567926 [info ] [Thread-1 (]: 5 of 7 START sql table model uber.pickup_location_dim .......................... [RUN]
[0m00:14:02.568830 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.uber.payment_type_dim, now model.uber.pickup_location_dim)
[0m00:14:02.569339 [debug] [Thread-1 (]: Began compiling node model.uber.pickup_location_dim
[0m00:14:02.581297 [debug] [Thread-1 (]: Writing injected SQL for node "model.uber.pickup_location_dim"
[0m00:14:02.583702 [debug] [Thread-1 (]: Timing info for model.uber.pickup_location_dim (compile): 00:14:02.569775 => 00:14:02.583526
[0m00:14:02.584204 [debug] [Thread-1 (]: Began executing node model.uber.pickup_location_dim
[0m00:14:02.586903 [debug] [Thread-1 (]: Writing runtime sql for node "model.uber.pickup_location_dim"
[0m00:14:02.588917 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m00:14:02.590898 [debug] [Thread-1 (]: On model.uber.pickup_location_dim: /* {"app": "dbt", "dbt_version": "1.5.9", "profile_name": "uber", "target_name": "dev", "node_id": "model.uber.pickup_location_dim"} */

  
    

    create or replace table `uber-data-engineering-407103`.`uber`.`pickup_location_dim`
    
    

    OPTIONS()
    as (
      WITH numbered_rows AS (
  SELECT
    to_hex(md5(cast(coalesce(cast(pickup_latitude as STRING), '_dbt_utils_surrogate_key_null_') || '-' || coalesce(cast(pickup_longitude as STRING), '_dbt_utils_surrogate_key_null_') as STRING))) as pickup_location_id,
    pickup_latitude AS pickup_latitude,
    pickup_longitude AS pickup_longitude,
    ROW_NUMBER() OVER (ORDER BY pickup_latitude, pickup_longitude) as row_num
  FROM `uber-data-engineering-407103`.`uber`.`uber_tlc_trip_recrord_data`
)
SELECT
  pickup_location_id,
  pickup_latitude,
  pickup_longitude
FROM numbered_rows
    );
  
[0m00:14:06.702995 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=uber-data-engineering-407103&j=bq:US:00717ccc-d0a5-492e-9643-e13dad3f4dc2&page=queryresults
[0m00:14:06.717141 [debug] [Thread-1 (]: Timing info for model.uber.pickup_location_dim (execute): 00:14:02.584592 => 00:14:06.716432
[0m00:14:06.720074 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'c1f89955-9807-4854-94b9-e0c903688030', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff99956bd0>]}
[0m00:14:06.721857 [info ] [Thread-1 (]: 5 of 7 OK created sql table model uber.pickup_location_dim ..................... [[32mCREATE TABLE (100.0k rows, 1.5 MiB processed)[0m in 4.15s]
[0m00:14:06.724545 [debug] [Thread-1 (]: Finished running node model.uber.pickup_location_dim
[0m00:14:06.726210 [debug] [Thread-1 (]: Began running node model.uber.rate_code_dim
[0m00:14:06.727796 [info ] [Thread-1 (]: 6 of 7 START sql table model uber.rate_code_dim ................................ [RUN]
[0m00:14:06.729514 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.uber.pickup_location_dim, now model.uber.rate_code_dim)
[0m00:14:06.730272 [debug] [Thread-1 (]: Began compiling node model.uber.rate_code_dim
[0m00:14:06.737707 [debug] [Thread-1 (]: Writing injected SQL for node "model.uber.rate_code_dim"
[0m00:14:06.740302 [debug] [Thread-1 (]: Timing info for model.uber.rate_code_dim (compile): 00:14:06.730810 => 00:14:06.740139
[0m00:14:06.741112 [debug] [Thread-1 (]: Began executing node model.uber.rate_code_dim
[0m00:14:06.744794 [debug] [Thread-1 (]: Writing runtime sql for node "model.uber.rate_code_dim"
[0m00:14:06.746779 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m00:14:06.750087 [debug] [Thread-1 (]: On model.uber.rate_code_dim: /* {"app": "dbt", "dbt_version": "1.5.9", "profile_name": "uber", "target_name": "dev", "node_id": "model.uber.rate_code_dim"} */

  
    

    create or replace table `uber-data-engineering-407103`.`uber`.`rate_code_dim`
    
    

    OPTIONS()
    as (
      WITH numbered_rows AS (
  SELECT
    GENERATE_UUID() as rate_code_id,
    RatecodeID AS RatecodeID,
    ROW_NUMBER() OVER (ORDER BY RatecodeID) as row_num
  FROM `uber-data-engineering-407103`.`uber`.`uber_tlc_trip_recrord_data`
  WHERE RatecodeID IS NOT NULL
)
SELECT
  rate_code_id,
  rate_code
FROM numbered_rows
    );
  
[0m00:14:08.034143 [debug] [Thread-1 (]: BigQuery adapter: Retry attempt 1 of 1 after error: BadRequest('Unrecognized name: rate_code; Did you mean rate_code_id? at [22:3]')
[0m00:14:09.359924 [error] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=uber-data-engineering-407103&j=bq:US:c329f221-1cdd-4115-ae57-d870978bda61&page=queryresults
[0m00:14:09.365429 [debug] [Thread-1 (]: Timing info for model.uber.rate_code_dim (execute): 00:14:06.741581 => 00:14:09.364566
[0m00:14:09.392029 [debug] [Thread-1 (]: Database Error in model rate_code_dim (models/transform/rate_code_dim.sql)
  Unrecognized name: rate_code; Did you mean rate_code_id? at [22:3]
  compiled Code at target/run/uber/models/transform/rate_code_dim.sql
[0m00:14:09.393589 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'c1f89955-9807-4854-94b9-e0c903688030', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff974010d0>]}
[0m00:14:09.395181 [error] [Thread-1 (]: 6 of 7 ERROR creating sql table model uber.rate_code_dim ....................... [[31mERROR[0m in 2.66s]
[0m00:14:09.396933 [debug] [Thread-1 (]: Finished running node model.uber.rate_code_dim
[0m00:14:09.398149 [debug] [Thread-1 (]: Began running node model.uber.trip_distance
[0m00:14:09.399763 [info ] [Thread-1 (]: 7 of 7 START sql table model uber.trip_distance ................................ [RUN]
[0m00:14:09.401330 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.uber.rate_code_dim, now model.uber.trip_distance)
[0m00:14:09.402165 [debug] [Thread-1 (]: Began compiling node model.uber.trip_distance
[0m00:14:09.409233 [debug] [Thread-1 (]: Writing injected SQL for node "model.uber.trip_distance"
[0m00:14:09.412029 [debug] [Thread-1 (]: Timing info for model.uber.trip_distance (compile): 00:14:09.402809 => 00:14:09.411791
[0m00:14:09.412741 [debug] [Thread-1 (]: Began executing node model.uber.trip_distance
[0m00:14:09.416143 [debug] [Thread-1 (]: Writing runtime sql for node "model.uber.trip_distance"
[0m00:14:09.418575 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m00:14:09.420855 [debug] [Thread-1 (]: On model.uber.trip_distance: /* {"app": "dbt", "dbt_version": "1.5.9", "profile_name": "uber", "target_name": "dev", "node_id": "model.uber.trip_distance"} */

  
    

    create or replace table `uber-data-engineering-407103`.`uber`.`trip_distance`
    
    

    OPTIONS()
    as (
      WITH numbered_rows AS (
  SELECT
    GENERATE_UUID() as trip_distance_id,
    trip_distance AS trip_distance,
    ROW_NUMBER() OVER (ORDER BY trip_distance) as row_num
  FROM `uber-data-engineering-407103`.`uber`.`uber_tlc_trip_recrord_data`
  WHERE trip_distance IS NOT NULL
)
SELECT
  trip_distance_id,
  trip_distance
FROM numbered_rows
    );
  
[0m00:14:12.747028 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=uber-data-engineering-407103&j=bq:US:546f1121-ed8d-4760-a901-cd9380ef4454&page=queryresults
[0m00:14:12.759504 [debug] [Thread-1 (]: Timing info for model.uber.trip_distance (execute): 00:14:09.413173 => 00:14:12.758814
[0m00:14:12.763116 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'c1f89955-9807-4854-94b9-e0c903688030', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff96262090>]}
[0m00:14:12.765764 [info ] [Thread-1 (]: 7 of 7 OK created sql table model uber.trip_distance ........................... [[32mCREATE TABLE (100.0k rows, 781.2 KiB processed)[0m in 3.36s]
[0m00:14:12.768149 [debug] [Thread-1 (]: Finished running node model.uber.trip_distance
[0m00:14:12.791776 [debug] [MainThread]: Connection 'master' was properly closed.
[0m00:14:12.792804 [debug] [MainThread]: Connection 'model.uber.trip_distance' was properly closed.
[0m00:14:12.794084 [info ] [MainThread]: 
[0m00:14:12.795877 [info ] [MainThread]: Finished running 7 table models in 0 hours 0 minutes and 27.87 seconds (27.87s).
[0m00:14:12.803738 [debug] [MainThread]: Command end result
[0m00:14:12.867318 [info ] [MainThread]: 
[0m00:14:12.868476 [info ] [MainThread]: [31mCompleted with 1 error and 0 warnings:[0m
[0m00:14:12.869270 [info ] [MainThread]: 
[0m00:14:12.870089 [error] [MainThread]: [33mDatabase Error in model rate_code_dim (models/transform/rate_code_dim.sql)[0m
[0m00:14:12.870880 [error] [MainThread]:   Unrecognized name: rate_code; Did you mean rate_code_id? at [22:3]
[0m00:14:12.871579 [error] [MainThread]:   compiled Code at target/run/uber/models/transform/rate_code_dim.sql
[0m00:14:12.872330 [info ] [MainThread]: 
[0m00:14:12.873268 [info ] [MainThread]: Done. PASS=6 WARN=0 ERROR=1 SKIP=0 TOTAL=7
[0m00:14:12.875015 [debug] [MainThread]: Command `dbt run` failed at 00:14:12.874778 after 29.36 seconds
[0m00:14:12.876037 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff9964cc10>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff997f2350>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff9d57b090>]}
[0m00:14:12.876732 [debug] [MainThread]: Flushing usage events
[0m00:14:51.071002 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff94e83150>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff94fc5250>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff956d45d0>]}


============================== 00:14:51.076150 | 8b9a8924-e1a8-4628-a5fb-de03b3e38f67 ==============================
[0m00:14:51.076150 [info ] [MainThread]: Running with dbt=1.5.9
[0m00:14:51.077136 [debug] [MainThread]: running dbt with arguments {'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'no_print': 'None', 'use_experimental_parser': 'False', 'debug': 'False', 'static_parser': 'True', 'version_check': 'True', 'printer_width': '80', 'fail_fast': 'False', 'partial_parse': 'True', 'profiles_dir': '/usr/local/airflow/include/dbt/', 'indirect_selection': 'eager', 'target_path': 'None', 'send_anonymous_usage_stats': 'True', 'cache_selected_only': 'False', 'log_format': 'default', 'warn_error': 'None', 'log_path': '/usr/local/airflow/include/dbt/logs', 'use_colors': 'True', 'write_json': 'True', 'quiet': 'False', 'log_cache_events': 'False', 'introspect': 'True'}
[0m00:14:51.512548 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '8b9a8924-e1a8-4628-a5fb-de03b3e38f67', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff95778b90>]}
[0m00:14:51.523816 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '8b9a8924-e1a8-4628-a5fb-de03b3e38f67', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff95778b90>]}
[0m00:14:51.524576 [info ] [MainThread]: Registered adapter: bigquery=1.5.3
[0m00:14:51.539169 [debug] [MainThread]: checksum: dd837546c89c9d03f3c2cb0ca6165266a30da6076d5d44e9991f7c5a8e5f5831, vars: {}, profile: , target: , version: 1.5.9
[0m00:14:51.610271 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m00:14:51.611398 [debug] [MainThread]: Partial parsing: updated file: uber://models/transform/rate_code_dim.sql
[0m00:14:51.630851 [debug] [MainThread]: 1699: static parser successfully parsed transform/rate_code_dim.sql
[0m00:14:51.651079 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '8b9a8924-e1a8-4628-a5fb-de03b3e38f67', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff932e2790>]}
[0m00:14:51.663010 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '8b9a8924-e1a8-4628-a5fb-de03b3e38f67', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff9330e5d0>]}
[0m00:14:51.663648 [info ] [MainThread]: Found 7 models, 0 tests, 0 snapshots, 0 analyses, 474 macros, 0 operations, 0 seed files, 1 source, 0 exposures, 0 metrics, 0 groups
[0m00:14:51.664238 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '8b9a8924-e1a8-4628-a5fb-de03b3e38f67', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff983834d0>]}
[0m00:14:51.665829 [info ] [MainThread]: 
[0m00:14:51.666808 [debug] [MainThread]: Acquiring new bigquery connection 'master'
[0m00:14:51.668481 [debug] [ThreadPool]: Acquiring new bigquery connection 'list_uber-data-engineering-407103'
[0m00:14:51.668976 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m00:14:52.344262 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_uber-data-engineering-407103, now list_uber-data-engineering-407103_uber)
[0m00:14:52.346507 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m00:14:52.845569 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '8b9a8924-e1a8-4628-a5fb-de03b3e38f67', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff93471d90>]}
[0m00:14:52.849205 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m00:14:52.851121 [info ] [MainThread]: 
[0m00:14:52.885498 [debug] [Thread-1 (]: Began running node model.uber.datetime_dim
[0m00:14:52.886886 [info ] [Thread-1 (]: 1 of 7 START sql table model uber.datetime_dim ................................. [RUN]
[0m00:14:52.888396 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_uber-data-engineering-407103_uber, now model.uber.datetime_dim)
[0m00:14:52.889257 [debug] [Thread-1 (]: Began compiling node model.uber.datetime_dim
[0m00:14:52.911143 [debug] [Thread-1 (]: Writing injected SQL for node "model.uber.datetime_dim"
[0m00:14:52.913953 [debug] [Thread-1 (]: Timing info for model.uber.datetime_dim (compile): 00:14:52.889931 => 00:14:52.913668
[0m00:14:52.914711 [debug] [Thread-1 (]: Began executing node model.uber.datetime_dim
[0m00:14:52.928492 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m00:14:53.699435 [debug] [Thread-1 (]: Writing runtime sql for node "model.uber.datetime_dim"
[0m00:14:53.703069 [debug] [Thread-1 (]: On model.uber.datetime_dim: /* {"app": "dbt", "dbt_version": "1.5.9", "profile_name": "uber", "target_name": "dev", "node_id": "model.uber.datetime_dim"} */

  
    

    create or replace table `uber-data-engineering-407103`.`uber`.`datetime_dim`
    
    

    OPTIONS()
    as (
      WITH datetime_cte AS (  
  SELECT DISTINCT 
    to_hex(md5(cast(coalesce(cast(tpep_pickup_datetime as STRING), '_dbt_utils_surrogate_key_null_') || '-' || coalesce(cast(tpep_dropoff_datetime as STRING), '_dbt_utils_surrogate_key_null_') as STRING))) AS datetime_id,
    CASE
      WHEN LENGTH(tpep_pickup_datetime) = 16 THEN
        -- Date format: "DD/MM/YYYY HH:MM"
        PARSE_DATETIME('%m/%d/%Y %H:%M', tpep_pickup_datetime)
      WHEN LENGTH(tpep_pickup_datetime) <= 14 THEN
        -- Date format: "MM/DD/YY HH:MM"
        PARSE_DATETIME('%m/%d/%y %H:%M', tpep_pickup_datetime)
      ELSE
        NULL
    END AS pick_date_part,
    tpep_dropoff_datetime AS drop_datetime_id,
    CASE
      WHEN LENGTH(tpep_dropoff_datetime) = 16 THEN
        -- Date format: "DD/MM/YYYY HH:MM"
        PARSE_DATETIME('%m/%d/%Y %H:%M', tpep_dropoff_datetime)
      WHEN LENGTH(tpep_dropoff_datetime) <= 14 THEN
        -- Date format: "MM/DD/YY HH:MM"
        PARSE_DATETIME('%m/%d/%y %H:%M', tpep_dropoff_datetime)
      ELSE
        NULL
    END AS drop_date_part
  FROM `uber-data-engineering-407103`.`uber`.`uber_tlc_trip_recrord_data`
  WHERE tpep_pickup_datetime IS NOT NULL
    AND tpep_dropoff_datetime IS NOT NULL
)
SELECT
  datetime_id,
  pick_date_part AS tpep_pickup_datetime,
  drop_date_part AS tpep_dropoff_datetime,
  EXTRACT(HOUR FROM pick_date_part) AS pick_hour,
  EXTRACT(DAY FROM pick_date_part) AS pick_day,
  EXTRACT(MONTH FROM pick_date_part) AS pick_month,
  EXTRACT(YEAR FROM pick_date_part) AS pick_year,
  EXTRACT(DAYOFWEEK FROM pick_date_part) AS pick_weekday,
  EXTRACT(HOUR FROM drop_date_part) AS drop_hour,
  EXTRACT(DAY FROM drop_date_part) AS drop_day,
  EXTRACT(MONTH FROM drop_date_part) AS drop_month,
  EXTRACT(YEAR FROM drop_date_part) AS drop_year,
  EXTRACT(DAYOFWEEK FROM drop_date_part) AS drop_weekday
FROM datetime_cte
    );
  
[0m00:14:57.838976 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=uber-data-engineering-407103&j=bq:US:42d8bc1d-93b7-4249-bd9c-3ef315c717d7&page=queryresults
[0m00:14:57.872784 [debug] [Thread-1 (]: Timing info for model.uber.datetime_dim (execute): 00:14:52.915242 => 00:14:57.872226
[0m00:14:57.874592 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '8b9a8924-e1a8-4628-a5fb-de03b3e38f67', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff931ca0d0>]}
[0m00:14:57.877783 [info ] [Thread-1 (]: 1 of 7 OK created sql table model uber.datetime_dim ............................ [[32mCREATE TABLE (99.9k rows, 4.0 MiB processed)[0m in 4.99s]
[0m00:14:57.882360 [debug] [Thread-1 (]: Finished running node model.uber.datetime_dim
[0m00:14:57.884088 [debug] [Thread-1 (]: Began running node model.uber.dropoff_location_dim
[0m00:14:57.886037 [info ] [Thread-1 (]: 2 of 7 START sql table model uber.dropoff_location_dim ......................... [RUN]
[0m00:14:57.887357 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.uber.datetime_dim, now model.uber.dropoff_location_dim)
[0m00:14:57.888093 [debug] [Thread-1 (]: Began compiling node model.uber.dropoff_location_dim
[0m00:14:57.895562 [debug] [Thread-1 (]: Writing injected SQL for node "model.uber.dropoff_location_dim"
[0m00:14:57.897772 [debug] [Thread-1 (]: Timing info for model.uber.dropoff_location_dim (compile): 00:14:57.888488 => 00:14:57.897582
[0m00:14:57.898261 [debug] [Thread-1 (]: Began executing node model.uber.dropoff_location_dim
[0m00:14:57.922285 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m00:14:58.386380 [debug] [Thread-1 (]: Writing runtime sql for node "model.uber.dropoff_location_dim"
[0m00:14:58.392179 [debug] [Thread-1 (]: On model.uber.dropoff_location_dim: /* {"app": "dbt", "dbt_version": "1.5.9", "profile_name": "uber", "target_name": "dev", "node_id": "model.uber.dropoff_location_dim"} */

  
    

    create or replace table `uber-data-engineering-407103`.`uber`.`dropoff_location_dim`
    
    

    OPTIONS()
    as (
      WITH numbered_rows AS (
  SELECT
    to_hex(md5(cast(coalesce(cast(dropoff_latitude as STRING), '_dbt_utils_surrogate_key_null_') || '-' || coalesce(cast(dropoff_longitude as STRING), '_dbt_utils_surrogate_key_null_') as STRING))) as dropoff_location_id,
    dropoff_latitude AS dropoff_latitude,
    dropoff_longitude AS dropoff_longitude,
    ROW_NUMBER() OVER (ORDER BY dropoff_latitude, dropoff_longitude) as row_num
  FROM `uber-data-engineering-407103`.`uber`.`uber_tlc_trip_recrord_data`
)
SELECT
  dropoff_location_id,
  dropoff_latitude,
  dropoff_longitude
FROM numbered_rows
    );
  
[0m00:15:02.205020 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=uber-data-engineering-407103&j=bq:US:5defa94a-c866-4a88-870f-fa9607c4b808&page=queryresults
[0m00:15:02.216206 [debug] [Thread-1 (]: Timing info for model.uber.dropoff_location_dim (execute): 00:14:57.898669 => 00:15:02.215661
[0m00:15:02.218510 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '8b9a8924-e1a8-4628-a5fb-de03b3e38f67', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff93466090>]}
[0m00:15:02.220591 [info ] [Thread-1 (]: 2 of 7 OK created sql table model uber.dropoff_location_dim .................... [[32mCREATE TABLE (100.0k rows, 1.5 MiB processed)[0m in 4.33s]
[0m00:15:02.222085 [debug] [Thread-1 (]: Finished running node model.uber.dropoff_location_dim
[0m00:15:02.223097 [debug] [Thread-1 (]: Began running node model.uber.passenger_count_dim
[0m00:15:02.224384 [info ] [Thread-1 (]: 3 of 7 START sql table model uber.passenger_count_dim .......................... [RUN]
[0m00:15:02.225710 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.uber.dropoff_location_dim, now model.uber.passenger_count_dim)
[0m00:15:02.226410 [debug] [Thread-1 (]: Began compiling node model.uber.passenger_count_dim
[0m00:15:02.234592 [debug] [Thread-1 (]: Writing injected SQL for node "model.uber.passenger_count_dim"
[0m00:15:02.237812 [debug] [Thread-1 (]: Timing info for model.uber.passenger_count_dim (compile): 00:15:02.226914 => 00:15:02.237646
[0m00:15:02.238598 [debug] [Thread-1 (]: Began executing node model.uber.passenger_count_dim
[0m00:15:02.241299 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m00:15:02.887643 [debug] [Thread-1 (]: Writing runtime sql for node "model.uber.passenger_count_dim"
[0m00:15:02.894851 [debug] [Thread-1 (]: On model.uber.passenger_count_dim: /* {"app": "dbt", "dbt_version": "1.5.9", "profile_name": "uber", "target_name": "dev", "node_id": "model.uber.passenger_count_dim"} */

  
    

    create or replace table `uber-data-engineering-407103`.`uber`.`passenger_count_dim`
    
    

    OPTIONS()
    as (
      SELECT DISTINCT
        GENERATE_UUID() as passenger_count_id,
		passenger_count AS passenger_count,
FROM `uber-data-engineering-407103`.`uber`.`uber_tlc_trip_recrord_data`
WHERE passenger_count IS NOT NULL
    );
  
[0m00:15:05.726887 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=uber-data-engineering-407103&j=bq:US:2cccc0aa-3a7b-43a0-a92a-19cee762eff2&page=queryresults
[0m00:15:05.732779 [debug] [Thread-1 (]: Timing info for model.uber.passenger_count_dim (execute): 00:15:02.239046 => 00:15:05.732112
[0m00:15:05.735477 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '8b9a8924-e1a8-4628-a5fb-de03b3e38f67', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff931d8090>]}
[0m00:15:05.736919 [info ] [Thread-1 (]: 3 of 7 OK created sql table model uber.passenger_count_dim ..................... [[32mCREATE TABLE (100.0k rows, 781.2 KiB processed)[0m in 3.51s]
[0m00:15:05.738986 [debug] [Thread-1 (]: Finished running node model.uber.passenger_count_dim
[0m00:15:05.740782 [debug] [Thread-1 (]: Began running node model.uber.payment_type_dim
[0m00:15:05.742320 [info ] [Thread-1 (]: 4 of 7 START sql table model uber.payment_type_dim ............................. [RUN]
[0m00:15:05.744695 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.uber.passenger_count_dim, now model.uber.payment_type_dim)
[0m00:15:05.745904 [debug] [Thread-1 (]: Began compiling node model.uber.payment_type_dim
[0m00:15:05.756035 [debug] [Thread-1 (]: Writing injected SQL for node "model.uber.payment_type_dim"
[0m00:15:05.760749 [debug] [Thread-1 (]: Timing info for model.uber.payment_type_dim (compile): 00:15:05.746939 => 00:15:05.760176
[0m00:15:05.761971 [debug] [Thread-1 (]: Began executing node model.uber.payment_type_dim
[0m00:15:05.765577 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m00:15:06.624718 [debug] [Thread-1 (]: Writing runtime sql for node "model.uber.payment_type_dim"
[0m00:15:06.631531 [debug] [Thread-1 (]: On model.uber.payment_type_dim: /* {"app": "dbt", "dbt_version": "1.5.9", "profile_name": "uber", "target_name": "dev", "node_id": "model.uber.payment_type_dim"} */

  
    

    create or replace table `uber-data-engineering-407103`.`uber`.`payment_type_dim`
    
    

    OPTIONS()
    as (
      WITH numbered_rows AS (
  SELECT
    GENERATE_UUID() as payment_type_id,
    payment_type AS payment_type,
    ROW_NUMBER() OVER (ORDER BY payment_type) as row_num
  FROM `uber-data-engineering-407103`.`uber`.`uber_tlc_trip_recrord_data`
  WHERE payment_type IS NOT NULL
)
SELECT
  payment_type_id,
  payment_type
FROM numbered_rows
    );
  
[0m00:15:09.525634 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=uber-data-engineering-407103&j=bq:US:cf9dc549-6801-4019-aec5-89b344bb36a5&page=queryresults
[0m00:15:09.546118 [debug] [Thread-1 (]: Timing info for model.uber.payment_type_dim (execute): 00:15:05.762608 => 00:15:09.545095
[0m00:15:09.550516 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '8b9a8924-e1a8-4628-a5fb-de03b3e38f67', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff931da210>]}
[0m00:15:09.553450 [info ] [Thread-1 (]: 4 of 7 OK created sql table model uber.payment_type_dim ........................ [[32mCREATE TABLE (100.0k rows, 781.2 KiB processed)[0m in 3.81s]
[0m00:15:09.555931 [debug] [Thread-1 (]: Finished running node model.uber.payment_type_dim
[0m00:15:09.559232 [debug] [Thread-1 (]: Began running node model.uber.pickup_location_dim
[0m00:15:09.567097 [info ] [Thread-1 (]: 5 of 7 START sql table model uber.pickup_location_dim .......................... [RUN]
[0m00:15:09.569416 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.uber.payment_type_dim, now model.uber.pickup_location_dim)
[0m00:15:09.570334 [debug] [Thread-1 (]: Began compiling node model.uber.pickup_location_dim
[0m00:15:09.582649 [debug] [Thread-1 (]: Writing injected SQL for node "model.uber.pickup_location_dim"
[0m00:15:09.602011 [debug] [Thread-1 (]: Timing info for model.uber.pickup_location_dim (compile): 00:15:09.570988 => 00:15:09.600874
[0m00:15:09.612743 [debug] [Thread-1 (]: Began executing node model.uber.pickup_location_dim
[0m00:15:09.692580 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m00:15:10.379338 [debug] [Thread-1 (]: Writing runtime sql for node "model.uber.pickup_location_dim"
[0m00:15:10.382214 [debug] [Thread-1 (]: On model.uber.pickup_location_dim: /* {"app": "dbt", "dbt_version": "1.5.9", "profile_name": "uber", "target_name": "dev", "node_id": "model.uber.pickup_location_dim"} */

  
    

    create or replace table `uber-data-engineering-407103`.`uber`.`pickup_location_dim`
    
    

    OPTIONS()
    as (
      WITH numbered_rows AS (
  SELECT
    to_hex(md5(cast(coalesce(cast(pickup_latitude as STRING), '_dbt_utils_surrogate_key_null_') || '-' || coalesce(cast(pickup_longitude as STRING), '_dbt_utils_surrogate_key_null_') as STRING))) as pickup_location_id,
    pickup_latitude AS pickup_latitude,
    pickup_longitude AS pickup_longitude,
    ROW_NUMBER() OVER (ORDER BY pickup_latitude, pickup_longitude) as row_num
  FROM `uber-data-engineering-407103`.`uber`.`uber_tlc_trip_recrord_data`
)
SELECT
  pickup_location_id,
  pickup_latitude,
  pickup_longitude
FROM numbered_rows
    );
  
[0m00:15:14.523198 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=uber-data-engineering-407103&j=bq:US:a751491b-57ad-42e2-9cd7-01bedfa5e3d3&page=queryresults
[0m00:15:14.541105 [debug] [Thread-1 (]: Timing info for model.uber.pickup_location_dim (execute): 00:15:09.615127 => 00:15:14.539747
[0m00:15:14.545952 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '8b9a8924-e1a8-4628-a5fb-de03b3e38f67', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff920c48d0>]}
[0m00:15:14.549529 [info ] [Thread-1 (]: 5 of 7 OK created sql table model uber.pickup_location_dim ..................... [[32mCREATE TABLE (100.0k rows, 1.5 MiB processed)[0m in 4.98s]
[0m00:15:14.552008 [debug] [Thread-1 (]: Finished running node model.uber.pickup_location_dim
[0m00:15:14.553740 [debug] [Thread-1 (]: Began running node model.uber.rate_code_dim
[0m00:15:14.555782 [info ] [Thread-1 (]: 6 of 7 START sql table model uber.rate_code_dim ................................ [RUN]
[0m00:15:14.557654 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.uber.pickup_location_dim, now model.uber.rate_code_dim)
[0m00:15:14.558654 [debug] [Thread-1 (]: Began compiling node model.uber.rate_code_dim
[0m00:15:14.567964 [debug] [Thread-1 (]: Writing injected SQL for node "model.uber.rate_code_dim"
[0m00:15:14.570886 [debug] [Thread-1 (]: Timing info for model.uber.rate_code_dim (compile): 00:15:14.559305 => 00:15:14.570628
[0m00:15:14.571592 [debug] [Thread-1 (]: Began executing node model.uber.rate_code_dim
[0m00:15:14.578552 [debug] [Thread-1 (]: Writing runtime sql for node "model.uber.rate_code_dim"
[0m00:15:14.581883 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m00:15:14.602039 [debug] [Thread-1 (]: On model.uber.rate_code_dim: /* {"app": "dbt", "dbt_version": "1.5.9", "profile_name": "uber", "target_name": "dev", "node_id": "model.uber.rate_code_dim"} */

  
    

    create or replace table `uber-data-engineering-407103`.`uber`.`rate_code_dim`
    
    

    OPTIONS()
    as (
      WITH numbered_rows AS (
  SELECT
    GENERATE_UUID() as rate_code_id,
    RatecodeID AS RatecodeID,
    ROW_NUMBER() OVER (ORDER BY RatecodeID) as row_num
  FROM `uber-data-engineering-407103`.`uber`.`uber_tlc_trip_recrord_data`
  WHERE RatecodeID IS NOT NULL
)
SELECT
  rate_code_id,
  RatecodeID
FROM numbered_rows
    );
  
[0m00:15:18.768950 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=uber-data-engineering-407103&j=bq:US:53c8e2fe-f02a-41aa-8933-be6280c56149&page=queryresults
[0m00:15:18.803013 [debug] [Thread-1 (]: Timing info for model.uber.rate_code_dim (execute): 00:15:14.572120 => 00:15:18.801797
[0m00:15:18.806164 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '8b9a8924-e1a8-4628-a5fb-de03b3e38f67', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff92115090>]}
[0m00:15:18.808270 [info ] [Thread-1 (]: 6 of 7 OK created sql table model uber.rate_code_dim ........................... [[32mCREATE TABLE (100.0k rows, 781.2 KiB processed)[0m in 4.25s]
[0m00:15:18.810586 [debug] [Thread-1 (]: Finished running node model.uber.rate_code_dim
[0m00:15:18.829194 [debug] [Thread-1 (]: Began running node model.uber.trip_distance
[0m00:15:18.831116 [info ] [Thread-1 (]: 7 of 7 START sql table model uber.trip_distance ................................ [RUN]
[0m00:15:18.836493 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.uber.rate_code_dim, now model.uber.trip_distance)
[0m00:15:18.837991 [debug] [Thread-1 (]: Began compiling node model.uber.trip_distance
[0m00:15:18.873244 [debug] [Thread-1 (]: Writing injected SQL for node "model.uber.trip_distance"
[0m00:15:18.877120 [debug] [Thread-1 (]: Timing info for model.uber.trip_distance (compile): 00:15:18.838723 => 00:15:18.876900
[0m00:15:18.878031 [debug] [Thread-1 (]: Began executing node model.uber.trip_distance
[0m00:15:18.881192 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m00:15:19.767977 [debug] [Thread-1 (]: Writing runtime sql for node "model.uber.trip_distance"
[0m00:15:19.773557 [debug] [Thread-1 (]: On model.uber.trip_distance: /* {"app": "dbt", "dbt_version": "1.5.9", "profile_name": "uber", "target_name": "dev", "node_id": "model.uber.trip_distance"} */

  
    

    create or replace table `uber-data-engineering-407103`.`uber`.`trip_distance`
    
    

    OPTIONS()
    as (
      WITH numbered_rows AS (
  SELECT
    GENERATE_UUID() as trip_distance_id,
    trip_distance AS trip_distance,
    ROW_NUMBER() OVER (ORDER BY trip_distance) as row_num
  FROM `uber-data-engineering-407103`.`uber`.`uber_tlc_trip_recrord_data`
  WHERE trip_distance IS NOT NULL
)
SELECT
  trip_distance_id,
  trip_distance
FROM numbered_rows
    );
  
[0m00:15:22.627066 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=uber-data-engineering-407103&j=bq:US:3e6d070a-0805-4351-92b9-033c038236b8&page=queryresults
[0m00:15:22.630485 [debug] [Thread-1 (]: Timing info for model.uber.trip_distance (execute): 00:15:18.878503 => 00:15:22.630248
[0m00:15:22.631542 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '8b9a8924-e1a8-4628-a5fb-de03b3e38f67', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff9215f290>]}
[0m00:15:22.632344 [info ] [Thread-1 (]: 7 of 7 OK created sql table model uber.trip_distance ........................... [[32mCREATE TABLE (100.0k rows, 781.2 KiB processed)[0m in 3.80s]
[0m00:15:22.633516 [debug] [Thread-1 (]: Finished running node model.uber.trip_distance
[0m00:15:22.637159 [debug] [MainThread]: Connection 'master' was properly closed.
[0m00:15:22.637920 [debug] [MainThread]: Connection 'model.uber.trip_distance' was properly closed.
[0m00:15:22.638724 [info ] [MainThread]: 
[0m00:15:22.639623 [info ] [MainThread]: Finished running 7 table models in 0 hours 0 minutes and 30.97 seconds (30.97s).
[0m00:15:22.644894 [debug] [MainThread]: Command end result
[0m00:15:22.672244 [info ] [MainThread]: 
[0m00:15:22.674115 [info ] [MainThread]: [32mCompleted successfully[0m
[0m00:15:22.674989 [info ] [MainThread]: 
[0m00:15:22.679875 [info ] [MainThread]: Done. PASS=7 WARN=0 ERROR=0 SKIP=0 TOTAL=7
[0m00:15:22.692471 [debug] [MainThread]: Command `dbt run` succeeded at 00:15:22.691888 after 31.63 seconds
[0m00:15:22.693687 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff954eeb50>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff957dfa50>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff9932e350>]}
[0m00:15:22.694461 [debug] [MainThread]: Flushing usage events
