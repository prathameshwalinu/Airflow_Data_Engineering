[0m01:39:57.167838 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff9c222250>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff9afdd450>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff9ec947d0>]}


============================== 01:39:57.174619 | 7a8c47f9-39ac-412e-959f-61ae9834efbd ==============================
[0m01:39:57.174619 [info ] [MainThread]: Running with dbt=1.5.9
[0m01:39:57.175782 [debug] [MainThread]: running dbt with arguments {'warn_error': 'None', 'partial_parse': 'True', 'log_cache_events': 'False', 'indirect_selection': 'eager', 'static_parser': 'True', 'profiles_dir': '/usr/local/airflow/include/dbt', 'use_experimental_parser': 'False', 'write_json': 'True', 'log_format': 'default', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'use_colors': 'True', 'send_anonymous_usage_stats': 'True', 'quiet': 'False', 'introspect': 'True', 'version_check': 'True', 'no_print': 'None', 'log_path': '/usr/local/airflow/include/dbt/logs', 'cache_selected_only': 'False', 'printer_width': '80', 'target_path': 'None', 'debug': 'False', 'fail_fast': 'False'}
[0m01:39:57.259474 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '7a8c47f9-39ac-412e-959f-61ae9834efbd', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff9afd5c50>]}
[0m01:39:57.265436 [debug] [MainThread]: Set downloads directory='/tmp/dbt-downloads-tw0owamm'
[0m01:39:57.266370 [debug] [MainThread]: Making package index registry request: GET https://hub.getdbt.com/api/v1/index.json
[0m01:39:58.136883 [debug] [MainThread]: Response from registry index: GET https://hub.getdbt.com/api/v1/index.json 200
[0m01:39:58.146353 [debug] [MainThread]: Making package registry request: GET https://hub.getdbt.com/api/v1/dbt-labs/dbt_utils.json
[0m01:39:58.390929 [debug] [MainThread]: Response from registry: GET https://hub.getdbt.com/api/v1/dbt-labs/dbt_utils.json 200
[0m01:39:58.435452 [info ] [MainThread]: Installing dbt-labs/dbt_utils
[0m01:39:59.621803 [info ] [MainThread]: Installed from version 1.1.1
[0m01:39:59.629142 [info ] [MainThread]: Up to date!
[0m01:39:59.632154 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'package', 'label': '7a8c47f9-39ac-412e-959f-61ae9834efbd', 'property_': 'install', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff9aa41210>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff9a82bcd0>]}
[0m01:39:59.639312 [debug] [MainThread]: Command `dbt deps` succeeded at 01:39:59.636610 after 2.48 seconds
[0m01:39:59.644897 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff9ec87950>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff9eaee1d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff9eaee250>]}
[0m01:39:59.646590 [debug] [MainThread]: Flushing usage events
[0m01:41:27.869402 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffb3d55f50>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffb3cb1550>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffb3d73110>]}


============================== 01:41:27.874333 | 211f7100-c126-45e5-8ca6-0925f7b924ee ==============================
[0m01:41:27.874333 [info ] [MainThread]: Running with dbt=1.5.9
[0m01:41:27.875219 [debug] [MainThread]: running dbt with arguments {'static_parser': 'True', 'profiles_dir': '/usr/local/airflow/include/dbt/', 'no_print': 'None', 'log_path': '/usr/local/airflow/include/dbt/logs', 'send_anonymous_usage_stats': 'True', 'quiet': 'False', 'debug': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'version_check': 'True', 'warn_error': 'None', 'target_path': 'None', 'log_cache_events': 'False', 'printer_width': '80', 'use_colors': 'True', 'indirect_selection': 'eager', 'introspect': 'True', 'log_format': 'default', 'fail_fast': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'use_experimental_parser': 'False', 'write_json': 'True'}
[0m01:41:27.877517 [error] [MainThread]: Encountered an error:
Runtime Error
  
  dbt encountered an error while trying to read your profiles.yml file.
  
  The profiles.yml file at /usr/local/airflow/include/dbt/profiles.yml is empty
  
[0m01:41:27.878549 [debug] [MainThread]: Command `dbt run` failed at 01:41:27.878386 after 0.01 seconds
[0m01:41:27.878998 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffb7c60450>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffb3d714d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffb3d48e10>]}
[0m01:41:27.879453 [debug] [MainThread]: Flushing usage events
[0m01:41:51.346108 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff8c361ad0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff8c627b90>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff8c663450>]}


============================== 01:41:51.351479 | 27cb2fb8-f39b-4ab1-93cd-3845cc7ada2e ==============================
[0m01:41:51.351479 [info ] [MainThread]: Running with dbt=1.5.9
[0m01:41:51.352335 [debug] [MainThread]: running dbt with arguments {'log_cache_events': 'False', 'no_print': 'None', 'indirect_selection': 'eager', 'log_format': 'default', 'version_check': 'True', 'debug': 'False', 'profiles_dir': '/usr/local/airflow/include/dbt/', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'warn_error': 'None', 'write_json': 'True', 'static_parser': 'True', 'cache_selected_only': 'False', 'fail_fast': 'False', 'target_path': 'None', 'printer_width': '80', 'use_colors': 'True', 'use_experimental_parser': 'False', 'log_path': '/usr/local/airflow/include/dbt/logs', 'partial_parse': 'True', 'send_anonymous_usage_stats': 'True', 'quiet': 'False', 'introspect': 'True'}
[0m01:41:51.829519 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '27cb2fb8-f39b-4ab1-93cd-3845cc7ada2e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff8a2d88d0>]}
[0m01:41:51.841102 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '27cb2fb8-f39b-4ab1-93cd-3845cc7ada2e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff8a2d9590>]}
[0m01:41:51.842294 [info ] [MainThread]: Registered adapter: bigquery=1.5.3
[0m01:41:51.857977 [debug] [MainThread]: checksum: dd837546c89c9d03f3c2cb0ca6165266a30da6076d5d44e9991f7c5a8e5f5831, vars: {}, profile: , target: , version: 1.5.9
[0m01:41:51.859575 [info ] [MainThread]: Unable to do partial parsing because saved manifest not found. Starting full parse.
[0m01:41:51.860217 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'partial_parser', 'label': '27cb2fb8-f39b-4ab1-93cd-3845cc7ada2e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff8a2cea10>]}
[0m01:41:52.542245 [debug] [MainThread]: 1699: static parser successfully parsed transform/passenger_count_dim.sql
[0m01:41:52.554152 [debug] [MainThread]: 1699: static parser successfully parsed transform/datetime_dim.sql
[0m01:41:52.613852 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '27cb2fb8-f39b-4ab1-93cd-3845cc7ada2e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff8a08f490>]}
[0m01:41:52.625965 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '27cb2fb8-f39b-4ab1-93cd-3845cc7ada2e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff8a12b690>]}
[0m01:41:52.626585 [info ] [MainThread]: Found 2 models, 0 tests, 0 snapshots, 0 analyses, 474 macros, 0 operations, 0 seed files, 1 source, 0 exposures, 0 metrics, 0 groups
[0m01:41:52.627215 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '27cb2fb8-f39b-4ab1-93cd-3845cc7ada2e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff8a15ded0>]}
[0m01:41:52.628543 [info ] [MainThread]: 
[0m01:41:52.629778 [debug] [MainThread]: Acquiring new bigquery connection 'master'
[0m01:41:52.631078 [debug] [ThreadPool]: Acquiring new bigquery connection 'list_uber-data-engineering-407103'
[0m01:41:52.631602 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m01:41:53.804998 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_uber-data-engineering-407103, now list_uber-data-engineering-407103_uber)
[0m01:41:53.807446 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m01:41:54.283005 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '27cb2fb8-f39b-4ab1-93cd-3845cc7ada2e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff8a1dd850>]}
[0m01:41:54.285294 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m01:41:54.286795 [info ] [MainThread]: 
[0m01:41:54.316691 [debug] [Thread-1 (]: Began running node model.uber.datetime_dim
[0m01:41:54.317912 [info ] [Thread-1 (]: 1 of 1 START sql table model uber.datetime_dim ................................. [RUN]
[0m01:41:54.320432 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_uber-data-engineering-407103_uber, now model.uber.datetime_dim)
[0m01:41:54.321341 [debug] [Thread-1 (]: Began compiling node model.uber.datetime_dim
[0m01:41:54.329272 [debug] [Thread-1 (]: Writing injected SQL for node "model.uber.datetime_dim"
[0m01:41:54.333222 [debug] [Thread-1 (]: Timing info for model.uber.datetime_dim (compile): 01:41:54.321953 => 01:41:54.332906
[0m01:41:54.333908 [debug] [Thread-1 (]: Began executing node model.uber.datetime_dim
[0m01:41:54.369397 [debug] [Thread-1 (]: Writing runtime sql for node "model.uber.datetime_dim"
[0m01:41:54.372854 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m01:41:54.374811 [debug] [Thread-1 (]: On model.uber.datetime_dim: /* {"app": "dbt", "dbt_version": "1.5.9", "profile_name": "uber", "target_name": "dev", "node_id": "model.uber.datetime_dim"} */

  
    

    create or replace table `uber-data-engineering-407103`.`uber`.`datetime_dim`
    
    

    OPTIONS()
    as (
      WITH datetime_cte AS (  
  SELECT DISTINCT
    tpep_pickup_datetime AS datetime_id,
    CASE
      WHEN LENGTH(tpep_pickup_datetime) = 16 THEN
        -- Date format: "DD/MM/YYYY HH:MM"
        PARSE_DATETIME('%m/%d/%Y %H:%M', tpep_pickup_datetime)
      WHEN LENGTH(tpep_pickup_datetime) <= 14 THEN
        -- Date format: "MM/DD/YY HH:MM"
        PARSE_DATETIME('%m/%d/%y %H:%M', tpep_pickup_datetime)
      ELSE
        NULL
    END AS pick_date_part,
    tpep_dropoff_datetime AS drop_datetime_id,
    CASE
      WHEN LENGTH(tpep_dropoff_datetime) = 16 THEN
        -- Date format: "DD/MM/YYYY HH:MM"
        PARSE_DATETIME('%m/%d/%Y %H:%M', tpep_dropoff_datetime)
      WHEN LENGTH(tpep_dropoff_datetime) <= 14 THEN
        -- Date format: "MM/DD/YY HH:MM"
        PARSE_DATETIME('%m/%d/%y %H:%M', tpep_dropoff_datetime)
      ELSE
        NULL
    END AS drop_date_part
  FROM `uber-data-engineering-407103`.`uber`.`uber_tlc_trip_recrord_data`
  WHERE tpep_pickup_datetime IS NOT NULL
    AND tpep_dropoff_datetime IS NOT NULL
)
SELECT
  datetime_id,
  pick_date_part AS tpep_pickup_datetime,
  drop_date_part AS tpep_dropoff_datetime,
  EXTRACT(HOUR FROM pick_date_part) AS pick_hour,
  EXTRACT(DAY FROM pick_date_part) AS pick_day,
  EXTRACT(MONTH FROM pick_date_part) AS pick_month,
  EXTRACT(YEAR FROM pick_date_part) AS pick_year,
  EXTRACT(DAYOFWEEK FROM pick_date_part) AS pick_weekday,
  EXTRACT(HOUR FROM drop_date_part) AS drop_hour,
  EXTRACT(DAY FROM drop_date_part) AS drop_day,
  EXTRACT(MONTH FROM drop_date_part) AS drop_month,
  EXTRACT(YEAR FROM drop_date_part) AS drop_year,
  EXTRACT(DAYOFWEEK FROM drop_date_part) AS drop_weekday
FROM datetime_cte;
    );
  
[0m01:41:54.905434 [debug] [Thread-1 (]: BigQuery adapter: Retry attempt 1 of 1 after error: BadRequest('Syntax error: Expected ")" but got ";" at [54:18]')
[0m01:41:56.133677 [error] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=uber-data-engineering-407103&j=bq:US:21ddd9ca-6153-4f98-860c-e1b38ddfcb7f&page=queryresults
[0m01:41:56.135065 [debug] [Thread-1 (]: Timing info for model.uber.datetime_dim (execute): 01:41:54.334552 => 01:41:56.134856
[0m01:41:56.142668 [debug] [Thread-1 (]: Database Error in model datetime_dim (models/transform/datetime_dim.sql)
  Syntax error: Expected ")" but got ";" at [54:18]
  compiled Code at target/run/uber/models/transform/datetime_dim.sql
[0m01:41:56.143270 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '27cb2fb8-f39b-4ab1-93cd-3845cc7ada2e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff8a04b110>]}
[0m01:41:56.144020 [error] [Thread-1 (]: 1 of 1 ERROR creating sql table model uber.datetime_dim ........................ [[31mERROR[0m in 1.82s]
[0m01:41:56.144809 [debug] [Thread-1 (]: Finished running node model.uber.datetime_dim
[0m01:41:56.146516 [debug] [MainThread]: Connection 'master' was properly closed.
[0m01:41:56.146959 [debug] [MainThread]: Connection 'model.uber.datetime_dim' was properly closed.
[0m01:41:56.147396 [info ] [MainThread]: 
[0m01:41:56.147988 [info ] [MainThread]: Finished running 1 table model in 0 hours 0 minutes and 3.52 seconds (3.52s).
[0m01:41:56.148704 [debug] [MainThread]: Command end result
[0m01:41:56.160279 [info ] [MainThread]: 
[0m01:41:56.161107 [info ] [MainThread]: [31mCompleted with 1 error and 0 warnings:[0m
[0m01:41:56.161708 [info ] [MainThread]: 
[0m01:41:56.162428 [error] [MainThread]: [33mDatabase Error in model datetime_dim (models/transform/datetime_dim.sql)[0m
[0m01:41:56.163066 [error] [MainThread]:   Syntax error: Expected ")" but got ";" at [54:18]
[0m01:41:56.163794 [error] [MainThread]:   compiled Code at target/run/uber/models/transform/datetime_dim.sql
[0m01:41:56.164558 [info ] [MainThread]: 
[0m01:41:56.165304 [info ] [MainThread]: Done. PASS=0 WARN=0 ERROR=1 SKIP=0 TOTAL=1
[0m01:41:56.166293 [debug] [MainThread]: Command `dbt run` failed at 01:41:56.166164 after 4.83 seconds
[0m01:41:56.167003 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff8c660b90>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff8c663450>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff8c673cd0>]}
[0m01:41:56.170157 [debug] [MainThread]: Flushing usage events
[0m01:43:09.438952 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xfffface31cd0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffab9d5550>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffab2c5090>]}


============================== 01:43:09.444233 | fd822285-551f-4fb5-949a-f83433df003d ==============================
[0m01:43:09.444233 [info ] [MainThread]: Running with dbt=1.5.9
[0m01:43:09.445152 [debug] [MainThread]: running dbt with arguments {'quiet': 'False', 'use_experimental_parser': 'False', 'write_json': 'True', 'no_print': 'None', 'version_check': 'True', 'cache_selected_only': 'False', 'introspect': 'True', 'log_cache_events': 'False', 'debug': 'False', 'fail_fast': 'False', 'warn_error': 'None', 'partial_parse': 'True', 'log_path': '/usr/local/airflow/include/dbt/logs', 'target_path': 'None', 'use_colors': 'True', 'printer_width': '80', 'indirect_selection': 'eager', 'log_format': 'default', 'send_anonymous_usage_stats': 'True', 'profiles_dir': '/usr/local/airflow/include/dbt/', 'static_parser': 'True', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])'}
[0m01:43:09.836413 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'fd822285-551f-4fb5-949a-f83433df003d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffa9767450>]}
[0m01:43:09.847895 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'fd822285-551f-4fb5-949a-f83433df003d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffabb2f1d0>]}
[0m01:43:09.849038 [info ] [MainThread]: Registered adapter: bigquery=1.5.3
[0m01:43:09.864585 [debug] [MainThread]: checksum: dd837546c89c9d03f3c2cb0ca6165266a30da6076d5d44e9991f7c5a8e5f5831, vars: {}, profile: , target: , version: 1.5.9
[0m01:43:09.925988 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m01:43:09.926718 [debug] [MainThread]: Partial parsing: updated file: uber://models/transform/datetime_dim.sql
[0m01:43:09.945265 [debug] [MainThread]: 1699: static parser successfully parsed transform/datetime_dim.sql
[0m01:43:09.964221 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'fd822285-551f-4fb5-949a-f83433df003d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffa964efd0>]}
[0m01:43:09.975966 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'fd822285-551f-4fb5-949a-f83433df003d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffa9608990>]}
[0m01:43:09.976573 [info ] [MainThread]: Found 2 models, 0 tests, 0 snapshots, 0 analyses, 474 macros, 0 operations, 0 seed files, 1 source, 0 exposures, 0 metrics, 0 groups
[0m01:43:09.977271 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'fd822285-551f-4fb5-949a-f83433df003d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffae687490>]}
[0m01:43:09.978515 [info ] [MainThread]: 
[0m01:43:09.979501 [debug] [MainThread]: Acquiring new bigquery connection 'master'
[0m01:43:09.980767 [debug] [ThreadPool]: Acquiring new bigquery connection 'list_uber-data-engineering-407103'
[0m01:43:09.981251 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m01:43:10.433044 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_uber-data-engineering-407103, now list_uber-data-engineering-407103_uber)
[0m01:43:10.434317 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m01:43:10.961309 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'fd822285-551f-4fb5-949a-f83433df003d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffab6a4850>]}
[0m01:43:10.964940 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m01:43:10.966854 [info ] [MainThread]: 
[0m01:43:10.996053 [debug] [Thread-1 (]: Began running node model.uber.datetime_dim
[0m01:43:10.997371 [info ] [Thread-1 (]: 1 of 1 START sql table model uber.datetime_dim ................................. [RUN]
[0m01:43:10.998855 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_uber-data-engineering-407103_uber, now model.uber.datetime_dim)
[0m01:43:10.999711 [debug] [Thread-1 (]: Began compiling node model.uber.datetime_dim
[0m01:43:11.008281 [debug] [Thread-1 (]: Writing injected SQL for node "model.uber.datetime_dim"
[0m01:43:11.011036 [debug] [Thread-1 (]: Timing info for model.uber.datetime_dim (compile): 01:43:11.000440 => 01:43:11.010766
[0m01:43:11.011654 [debug] [Thread-1 (]: Began executing node model.uber.datetime_dim
[0m01:43:11.043035 [debug] [Thread-1 (]: Writing runtime sql for node "model.uber.datetime_dim"
[0m01:43:11.045144 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m01:43:11.047069 [debug] [Thread-1 (]: On model.uber.datetime_dim: /* {"app": "dbt", "dbt_version": "1.5.9", "profile_name": "uber", "target_name": "dev", "node_id": "model.uber.datetime_dim"} */

  
    

    create or replace table `uber-data-engineering-407103`.`uber`.`datetime_dim`
    
    

    OPTIONS()
    as (
      WITH datetime_cte AS (  
  SELECT DISTINCT
    tpep_pickup_datetime AS datetime_id,
    CASE
      WHEN LENGTH(tpep_pickup_datetime) = 16 THEN
        -- Date format: "DD/MM/YYYY HH:MM"
        PARSE_DATETIME('%m/%d/%Y %H:%M', tpep_pickup_datetime)
      WHEN LENGTH(tpep_pickup_datetime) <= 14 THEN
        -- Date format: "MM/DD/YY HH:MM"
        PARSE_DATETIME('%m/%d/%y %H:%M', tpep_pickup_datetime)
      ELSE
        NULL
    END AS pick_date_part,
    tpep_dropoff_datetime AS drop_datetime_id,
    CASE
      WHEN LENGTH(tpep_dropoff_datetime) = 16 THEN
        -- Date format: "DD/MM/YYYY HH:MM"
        PARSE_DATETIME('%m/%d/%Y %H:%M', tpep_dropoff_datetime)
      WHEN LENGTH(tpep_dropoff_datetime) <= 14 THEN
        -- Date format: "MM/DD/YY HH:MM"
        PARSE_DATETIME('%m/%d/%y %H:%M', tpep_dropoff_datetime)
      ELSE
        NULL
    END AS drop_date_part
  FROM `uber-data-engineering-407103`.`uber`.`uber_tlc_trip_recrord_data`
  WHERE tpep_pickup_datetime IS NOT NULL
    AND tpep_dropoff_datetime IS NOT NULL
)
SELECT
  datetime_id,
  pick_date_part AS tpep_pickup_datetime,
  drop_date_part AS tpep_dropoff_datetime,
  EXTRACT(HOUR FROM pick_date_part) AS pick_hour,
  EXTRACT(DAY FROM pick_date_part) AS pick_day,
  EXTRACT(MONTH FROM pick_date_part) AS pick_month,
  EXTRACT(YEAR FROM pick_date_part) AS pick_year,
  EXTRACT(DAYOFWEEK FROM pick_date_part) AS pick_weekday,
  EXTRACT(HOUR FROM drop_date_part) AS drop_hour,
  EXTRACT(DAY FROM drop_date_part) AS drop_day,
  EXTRACT(MONTH FROM drop_date_part) AS drop_month,
  EXTRACT(YEAR FROM drop_date_part) AS drop_year,
  EXTRACT(DAYOFWEEK FROM drop_date_part) AS drop_weekday
FROM datetime_cte
    );
  
[0m01:43:15.150823 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=uber-data-engineering-407103&j=bq:US:324e0140-280f-471a-a0d3-d9a07dd58d58&page=queryresults
[0m01:43:15.181326 [debug] [Thread-1 (]: Timing info for model.uber.datetime_dim (execute): 01:43:11.012101 => 01:43:15.180982
[0m01:43:15.183301 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'fd822285-551f-4fb5-949a-f83433df003d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffa9770610>]}
[0m01:43:15.184596 [info ] [Thread-1 (]: 1 of 1 OK created sql table model uber.datetime_dim ............................ [[32mCREATE TABLE (99.9k rows, 4.0 MiB processed)[0m in 4.18s]
[0m01:43:15.186379 [debug] [Thread-1 (]: Finished running node model.uber.datetime_dim
[0m01:43:15.189229 [debug] [MainThread]: Connection 'master' was properly closed.
[0m01:43:15.189986 [debug] [MainThread]: Connection 'model.uber.datetime_dim' was properly closed.
[0m01:43:15.190771 [info ] [MainThread]: 
[0m01:43:15.192039 [info ] [MainThread]: Finished running 1 table model in 0 hours 0 minutes and 5.21 seconds (5.21s).
[0m01:43:15.193327 [debug] [MainThread]: Command end result
[0m01:43:15.207676 [info ] [MainThread]: 
[0m01:43:15.208688 [info ] [MainThread]: [32mCompleted successfully[0m
[0m01:43:15.209940 [info ] [MainThread]: 
[0m01:43:15.211195 [info ] [MainThread]: Done. PASS=1 WARN=0 ERROR=0 SKIP=0 TOTAL=1
[0m01:43:15.212533 [debug] [MainThread]: Command `dbt run` succeeded at 01:43:15.212354 after 5.78 seconds
[0m01:43:15.213258 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffab19e150>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffaf632210>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffab80bad0>]}
[0m01:43:15.213932 [debug] [MainThread]: Flushing usage events
[0m21:07:30.141464 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffb3f89590>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffb3fac290>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffb3faca90>]}


============================== 21:07:30.149075 | f0b021ca-683d-4a59-b0b2-ca1669f02c7b ==============================
[0m21:07:30.149075 [info ] [MainThread]: Running with dbt=1.5.9
[0m21:07:30.150094 [debug] [MainThread]: running dbt with arguments {'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'log_cache_events': 'False', 'write_json': 'True', 'debug': 'False', 'indirect_selection': 'eager', 'fail_fast': 'False', 'version_check': 'True', 'send_anonymous_usage_stats': 'True', 'quiet': 'False', 'printer_width': '80', 'log_format': 'default', 'warn_error': 'None', 'log_path': '/usr/local/airflow/include/dbt/logs', 'target_path': 'None', 'no_print': 'None', 'cache_selected_only': 'False', 'use_colors': 'True', 'introspect': 'True', 'partial_parse': 'True', 'use_experimental_parser': 'False', 'profiles_dir': '/usr/local/airflow/include/dbt/', 'static_parser': 'True'}
[0m21:07:30.967342 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'f0b021ca-683d-4a59-b0b2-ca1669f02c7b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffb1bb7310>]}
[0m21:07:30.979874 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'f0b021ca-683d-4a59-b0b2-ca1669f02c7b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffb3c901d0>]}
[0m21:07:30.980928 [info ] [MainThread]: Registered adapter: bigquery=1.5.3
[0m21:07:31.002438 [debug] [MainThread]: checksum: dd837546c89c9d03f3c2cb0ca6165266a30da6076d5d44e9991f7c5a8e5f5831, vars: {}, profile: , target: , version: 1.5.9
[0m21:07:31.101680 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 5 files added, 1 files changed.
[0m21:07:31.102690 [debug] [MainThread]: Partial parsing: added file: uber://models/transform/trip_distance.sql
[0m21:07:31.103176 [debug] [MainThread]: Partial parsing: added file: uber://models/transform/rate_code_dim.sql
[0m21:07:31.103617 [debug] [MainThread]: Partial parsing: added file: uber://models/transform/pickup_location_dim.sql
[0m21:07:31.104065 [debug] [MainThread]: Partial parsing: added file: uber://models/transform/payment_type_dim.sql
[0m21:07:31.104505 [debug] [MainThread]: Partial parsing: added file: uber://models/transform/dropoff_location_dim.sql
[0m21:07:31.105011 [debug] [MainThread]: Partial parsing: updated file: uber://models/transform/passenger_count_dim.sql
[0m21:07:31.124754 [debug] [MainThread]: 1603: static parser failed on transform/trip_distance.sql
[0m21:07:31.130878 [error] [MainThread]: Encountered an error:
Compilation Error in model trip_distance (models/transform/trip_distance.sql)
  macro 'dbt_macro__generate_series' takes not more than 1 argument(s)
[0m21:07:31.131979 [debug] [MainThread]: Command `dbt run` failed at 21:07:31.131763 after 1.01 seconds
[0m21:07:31.132553 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffb3f3f590>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffb3f9f890>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffb3f9c7d0>]}
[0m21:07:31.133173 [debug] [MainThread]: Flushing usage events
[0m21:08:49.573280 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffa5888350>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffa51de9d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffa5a12090>]}


============================== 21:08:49.578430 | 235ff364-f18c-465d-ae11-479e955a2c16 ==============================
[0m21:08:49.578430 [info ] [MainThread]: Running with dbt=1.5.9
[0m21:08:49.579320 [debug] [MainThread]: running dbt with arguments {'introspect': 'True', 'quiet': 'False', 'log_path': '/usr/local/airflow/include/dbt/logs', 'no_print': 'None', 'version_check': 'True', 'cache_selected_only': 'False', 'printer_width': '80', 'write_json': 'True', 'log_format': 'default', 'use_colors': 'True', 'static_parser': 'True', 'debug': 'False', 'target_path': 'None', 'indirect_selection': 'eager', 'profiles_dir': '/usr/local/airflow/include/dbt/', 'fail_fast': 'False', 'partial_parse': 'True', 'log_cache_events': 'False', 'send_anonymous_usage_stats': 'True', 'warn_error': 'None', 'use_experimental_parser': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])'}
[0m21:08:50.029162 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '235ff364-f18c-465d-ae11-479e955a2c16', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffa380b810>]}
[0m21:08:50.041012 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '235ff364-f18c-465d-ae11-479e955a2c16', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffa46241d0>]}
[0m21:08:50.041615 [info ] [MainThread]: Registered adapter: bigquery=1.5.3
[0m21:08:50.057036 [debug] [MainThread]: checksum: dd837546c89c9d03f3c2cb0ca6165266a30da6076d5d44e9991f7c5a8e5f5831, vars: {}, profile: , target: , version: 1.5.9
[0m21:08:50.130868 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 5 files added, 1 files changed.
[0m21:08:50.131741 [debug] [MainThread]: Partial parsing: added file: uber://models/transform/pickup_location_dim.sql
[0m21:08:50.132231 [debug] [MainThread]: Partial parsing: added file: uber://models/transform/dropoff_location_dim.sql
[0m21:08:50.132705 [debug] [MainThread]: Partial parsing: added file: uber://models/transform/trip_distance.sql
[0m21:08:50.133155 [debug] [MainThread]: Partial parsing: added file: uber://models/transform/rate_code_dim.sql
[0m21:08:50.133555 [debug] [MainThread]: Partial parsing: added file: uber://models/transform/payment_type_dim.sql
[0m21:08:50.133999 [debug] [MainThread]: Partial parsing: updated file: uber://models/transform/passenger_count_dim.sql
[0m21:08:50.152659 [debug] [MainThread]: 1603: static parser failed on transform/pickup_location_dim.sql
[0m21:08:50.159067 [error] [MainThread]: Encountered an error:
Compilation Error in model pickup_location_dim (models/transform/pickup_location_dim.sql)
  macro 'dbt_macro__generate_series' takes not more than 1 argument(s)
[0m21:08:50.160356 [debug] [MainThread]: Command `dbt run` failed at 21:08:50.160173 after 0.60 seconds
[0m21:08:50.161024 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffa56e54d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffa51e8210>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffa56debd0>]}
[0m21:08:50.161644 [debug] [MainThread]: Flushing usage events
[0m21:09:16.847013 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff8b0e1450>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff8b393f50>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff8b3c0d10>]}


============================== 21:09:16.852751 | 8c0e2222-c8f9-44e9-8025-4d831c71142b ==============================
[0m21:09:16.852751 [info ] [MainThread]: Running with dbt=1.5.9
[0m21:09:16.853581 [debug] [MainThread]: running dbt with arguments {'debug': 'False', 'cache_selected_only': 'False', 'partial_parse': 'True', 'log_path': '/usr/local/airflow/include/dbt/logs', 'warn_error': 'None', 'target_path': 'None', 'indirect_selection': 'eager', 'printer_width': '80', 'version_check': 'True', 'quiet': 'False', 'no_print': 'None', 'use_colors': 'True', 'use_experimental_parser': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'fail_fast': 'False', 'profiles_dir': '/usr/local/airflow/include/dbt/', 'static_parser': 'True', 'log_format': 'default', 'log_cache_events': 'False', 'write_json': 'True', 'introspect': 'True', 'send_anonymous_usage_stats': 'True'}
[0m21:09:17.340666 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '8c0e2222-c8f9-44e9-8025-4d831c71142b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff8ab22f50>]}
[0m21:09:17.352418 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '8c0e2222-c8f9-44e9-8025-4d831c71142b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff8ab233d0>]}
[0m21:09:17.353105 [info ] [MainThread]: Registered adapter: bigquery=1.5.3
[0m21:09:17.367894 [debug] [MainThread]: checksum: dd837546c89c9d03f3c2cb0ca6165266a30da6076d5d44e9991f7c5a8e5f5831, vars: {}, profile: , target: , version: 1.5.9
[0m21:09:17.461658 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 5 files added, 1 files changed.
[0m21:09:17.462452 [debug] [MainThread]: Partial parsing: added file: uber://models/transform/rate_code_dim.sql
[0m21:09:17.462952 [debug] [MainThread]: Partial parsing: added file: uber://models/transform/pickup_location_dim.sql
[0m21:09:17.463401 [debug] [MainThread]: Partial parsing: added file: uber://models/transform/payment_type_dim.sql
[0m21:09:17.463850 [debug] [MainThread]: Partial parsing: added file: uber://models/transform/dropoff_location_dim.sql
[0m21:09:17.464286 [debug] [MainThread]: Partial parsing: added file: uber://models/transform/trip_distance.sql
[0m21:09:17.464742 [debug] [MainThread]: Partial parsing: updated file: uber://models/transform/passenger_count_dim.sql
[0m21:09:17.485286 [debug] [MainThread]: 1699: static parser successfully parsed transform/rate_code_dim.sql
[0m21:09:17.496487 [debug] [MainThread]: 1603: static parser failed on transform/pickup_location_dim.sql
[0m21:09:17.500892 [error] [MainThread]: Encountered an error:
Compilation Error in model pickup_location_dim (models/transform/pickup_location_dim.sql)
  macro 'dbt_macro__generate_series' takes not more than 1 argument(s)
[0m21:09:17.501985 [debug] [MainThread]: Command `dbt run` failed at 21:09:17.501839 after 0.66 seconds
[0m21:09:17.502570 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff8b0b94d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff8b0ab2d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff88f22310>]}
[0m21:09:17.503145 [debug] [MainThread]: Flushing usage events
[0m21:10:32.105987 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffba4bb150>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffbb185f50>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffbab34cd0>]}


============================== 21:10:32.112495 | 8945b254-ea8a-4690-8d36-1b27a8fbd011 ==============================
[0m21:10:32.112495 [info ] [MainThread]: Running with dbt=1.5.9
[0m21:10:32.113577 [debug] [MainThread]: running dbt with arguments {'no_print': 'None', 'target_path': 'None', 'write_json': 'True', 'send_anonymous_usage_stats': 'True', 'log_format': 'default', 'version_check': 'True', 'use_experimental_parser': 'False', 'warn_error': 'None', 'static_parser': 'True', 'use_colors': 'True', 'profiles_dir': '/usr/local/airflow/include/dbt/', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'printer_width': '80', 'indirect_selection': 'eager', 'quiet': 'False', 'introspect': 'True', 'fail_fast': 'False', 'log_cache_events': 'False', 'debug': 'False', 'log_path': '/usr/local/airflow/include/dbt/logs', 'cache_selected_only': 'False', 'partial_parse': 'True'}
[0m21:10:32.527960 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '8945b254-ea8a-4690-8d36-1b27a8fbd011', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffbab413d0>]}
[0m21:10:32.542172 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '8945b254-ea8a-4690-8d36-1b27a8fbd011', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffbab63690>]}
[0m21:10:32.543728 [info ] [MainThread]: Registered adapter: bigquery=1.5.3
[0m21:10:32.566607 [debug] [MainThread]: checksum: dd837546c89c9d03f3c2cb0ca6165266a30da6076d5d44e9991f7c5a8e5f5831, vars: {}, profile: , target: , version: 1.5.9
[0m21:10:32.632192 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 5 files added, 1 files changed.
[0m21:10:32.632963 [debug] [MainThread]: Partial parsing: added file: uber://models/transform/pickup_location_dim.sql
[0m21:10:32.633460 [debug] [MainThread]: Partial parsing: added file: uber://models/transform/payment_type_dim.sql
[0m21:10:32.633906 [debug] [MainThread]: Partial parsing: added file: uber://models/transform/rate_code_dim.sql
[0m21:10:32.634304 [debug] [MainThread]: Partial parsing: added file: uber://models/transform/dropoff_location_dim.sql
[0m21:10:32.634753 [debug] [MainThread]: Partial parsing: added file: uber://models/transform/trip_distance.sql
[0m21:10:32.635319 [debug] [MainThread]: Partial parsing: updated file: uber://models/transform/passenger_count_dim.sql
[0m21:10:32.653747 [debug] [MainThread]: 1603: static parser failed on transform/pickup_location_dim.sql
[0m21:10:32.658697 [error] [MainThread]: Encountered an error:
Compilation Error in model pickup_location_dim (models/transform/pickup_location_dim.sql)
  macro 'dbt_macro__generate_series' takes not more than 1 argument(s)
[0m21:10:32.659586 [debug] [MainThread]: Command `dbt run` failed at 21:10:32.659452 after 0.57 seconds
[0m21:10:32.660129 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffba4dab10>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffba4d2390>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffb8aa2810>]}
[0m21:10:32.660643 [debug] [MainThread]: Flushing usage events
[0m21:10:54.141330 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff929055d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff928d7f50>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff92639590>]}


============================== 21:10:54.147707 | cbddf6b8-3210-4490-90a3-e4d78bc967ec ==============================
[0m21:10:54.147707 [info ] [MainThread]: Running with dbt=1.5.9
[0m21:10:54.148948 [debug] [MainThread]: running dbt with arguments {'use_colors': 'True', 'fail_fast': 'False', 'version_check': 'True', 'log_cache_events': 'False', 'log_format': 'default', 'printer_width': '80', 'warn_error': 'None', 'quiet': 'False', 'use_experimental_parser': 'False', 'profiles_dir': '/usr/local/airflow/include/dbt/', 'indirect_selection': 'eager', 'static_parser': 'True', 'write_json': 'True', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'target_path': 'None', 'debug': 'False', 'log_path': '/usr/local/airflow/include/dbt/logs', 'send_anonymous_usage_stats': 'True', 'cache_selected_only': 'False', 'no_print': 'None', 'partial_parse': 'True', 'introspect': 'True'}
[0m21:10:54.591177 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'cbddf6b8-3210-4490-90a3-e4d78bc967ec', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff9056c790>]}
[0m21:10:54.619972 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'cbddf6b8-3210-4490-90a3-e4d78bc967ec', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff92912dd0>]}
[0m21:10:54.621799 [info ] [MainThread]: Registered adapter: bigquery=1.5.3
[0m21:10:54.641572 [debug] [MainThread]: checksum: dd837546c89c9d03f3c2cb0ca6165266a30da6076d5d44e9991f7c5a8e5f5831, vars: {}, profile: , target: , version: 1.5.9
[0m21:10:54.710516 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 5 files added, 1 files changed.
[0m21:10:54.711262 [debug] [MainThread]: Partial parsing: added file: uber://models/transform/payment_type_dim.sql
[0m21:10:54.711750 [debug] [MainThread]: Partial parsing: added file: uber://models/transform/rate_code_dim.sql
[0m21:10:54.712158 [debug] [MainThread]: Partial parsing: added file: uber://models/transform/trip_distance.sql
[0m21:10:54.712593 [debug] [MainThread]: Partial parsing: added file: uber://models/transform/pickup_location_dim.sql
[0m21:10:54.713023 [debug] [MainThread]: Partial parsing: added file: uber://models/transform/dropoff_location_dim.sql
[0m21:10:54.713481 [debug] [MainThread]: Partial parsing: updated file: uber://models/transform/passenger_count_dim.sql
[0m21:10:54.732651 [debug] [MainThread]: 1699: static parser successfully parsed transform/payment_type_dim.sql
[0m21:10:54.743694 [debug] [MainThread]: 1699: static parser successfully parsed transform/rate_code_dim.sql
[0m21:10:54.746882 [debug] [MainThread]: 1603: static parser failed on transform/trip_distance.sql
[0m21:10:54.758006 [debug] [MainThread]: 1602: parser fallback to jinja rendering on transform/trip_distance.sql
[0m21:10:54.759905 [debug] [MainThread]: 1603: static parser failed on transform/pickup_location_dim.sql
[0m21:10:54.764477 [debug] [MainThread]: 1602: parser fallback to jinja rendering on transform/pickup_location_dim.sql
[0m21:10:54.766254 [debug] [MainThread]: 1603: static parser failed on transform/dropoff_location_dim.sql
[0m21:10:54.769631 [error] [MainThread]: Encountered an error:
Compilation Error in model dropoff_location_dim (models/transform/dropoff_location_dim.sql)
  macro 'dbt_macro__generate_series' takes not more than 1 argument(s)
[0m21:10:54.770633 [debug] [MainThread]: Command `dbt run` failed at 21:10:54.770502 after 0.64 seconds
[0m21:10:54.771190 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff91f91b90>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff928d78d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff9038b790>]}
[0m21:10:54.771738 [debug] [MainThread]: Flushing usage events
[0m21:11:22.403767 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffba5cfc10>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffb9cc37d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffba423950>]}


============================== 21:11:22.409391 | 2b33a280-6d40-4a19-b127-96813ac19442 ==============================
[0m21:11:22.409391 [info ] [MainThread]: Running with dbt=1.5.9
[0m21:11:22.410353 [debug] [MainThread]: running dbt with arguments {'partial_parse': 'True', 'warn_error': 'None', 'version_check': 'True', 'use_experimental_parser': 'False', 'cache_selected_only': 'False', 'send_anonymous_usage_stats': 'True', 'fail_fast': 'False', 'write_json': 'True', 'introspect': 'True', 'log_cache_events': 'False', 'profiles_dir': '/usr/local/airflow/include/dbt/', 'indirect_selection': 'eager', 'target_path': 'None', 'quiet': 'False', 'no_print': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'debug': 'False', 'use_colors': 'True', 'log_format': 'default', 'static_parser': 'True', 'log_path': '/usr/local/airflow/include/dbt/logs', 'printer_width': '80'}
[0m21:11:22.829081 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '2b33a280-6d40-4a19-b127-96813ac19442', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffb9ae85d0>]}
[0m21:11:22.840562 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '2b33a280-6d40-4a19-b127-96813ac19442', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffb9b083d0>]}
[0m21:11:22.841486 [info ] [MainThread]: Registered adapter: bigquery=1.5.3
[0m21:11:22.857420 [debug] [MainThread]: checksum: dd837546c89c9d03f3c2cb0ca6165266a30da6076d5d44e9991f7c5a8e5f5831, vars: {}, profile: , target: , version: 1.5.9
[0m21:11:22.919461 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 5 files added, 1 files changed.
[0m21:11:22.920230 [debug] [MainThread]: Partial parsing: added file: uber://models/transform/payment_type_dim.sql
[0m21:11:22.920725 [debug] [MainThread]: Partial parsing: added file: uber://models/transform/rate_code_dim.sql
[0m21:11:22.921182 [debug] [MainThread]: Partial parsing: added file: uber://models/transform/dropoff_location_dim.sql
[0m21:11:22.921618 [debug] [MainThread]: Partial parsing: added file: uber://models/transform/trip_distance.sql
[0m21:11:22.922031 [debug] [MainThread]: Partial parsing: added file: uber://models/transform/pickup_location_dim.sql
[0m21:11:22.922521 [debug] [MainThread]: Partial parsing: updated file: uber://models/transform/passenger_count_dim.sql
[0m21:11:22.940376 [debug] [MainThread]: 1603: static parser failed on transform/payment_type_dim.sql
[0m21:11:22.958557 [debug] [MainThread]: 1602: parser fallback to jinja rendering on transform/payment_type_dim.sql
[0m21:11:22.960501 [debug] [MainThread]: 1603: static parser failed on transform/rate_code_dim.sql
[0m21:11:22.964909 [debug] [MainThread]: 1602: parser fallback to jinja rendering on transform/rate_code_dim.sql
[0m21:11:22.966697 [debug] [MainThread]: 1603: static parser failed on transform/dropoff_location_dim.sql
[0m21:11:22.971255 [debug] [MainThread]: 1602: parser fallback to jinja rendering on transform/dropoff_location_dim.sql
[0m21:11:22.973087 [debug] [MainThread]: 1603: static parser failed on transform/trip_distance.sql
[0m21:11:22.978643 [debug] [MainThread]: 1602: parser fallback to jinja rendering on transform/trip_distance.sql
[0m21:11:22.980774 [debug] [MainThread]: 1603: static parser failed on transform/pickup_location_dim.sql
[0m21:11:22.989884 [debug] [MainThread]: 1602: parser fallback to jinja rendering on transform/pickup_location_dim.sql
[0m21:11:22.992398 [debug] [MainThread]: 1603: static parser failed on transform/passenger_count_dim.sql
[0m21:11:23.009393 [debug] [MainThread]: 1602: parser fallback to jinja rendering on transform/passenger_count_dim.sql
[0m21:11:23.022508 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '2b33a280-6d40-4a19-b127-96813ac19442', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffb8091990>]}
[0m21:11:23.039554 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '2b33a280-6d40-4a19-b127-96813ac19442', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffb7d92090>]}
[0m21:11:23.040230 [info ] [MainThread]: Found 7 models, 0 tests, 0 snapshots, 0 analyses, 474 macros, 0 operations, 0 seed files, 1 source, 0 exposures, 0 metrics, 0 groups
[0m21:11:23.040953 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '2b33a280-6d40-4a19-b127-96813ac19442', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffbcfcfa10>]}
[0m21:11:23.042605 [info ] [MainThread]: 
[0m21:11:23.043824 [debug] [MainThread]: Acquiring new bigquery connection 'master'
[0m21:11:23.045735 [debug] [ThreadPool]: Acquiring new bigquery connection 'list_uber-data-engineering-407103'
[0m21:11:23.046272 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m21:11:25.461871 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_uber-data-engineering-407103, now list_uber-data-engineering-407103_uber)
[0m21:11:25.466111 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m21:11:25.975160 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '2b33a280-6d40-4a19-b127-96813ac19442', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffb7ede310>]}
[0m21:11:25.979138 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m21:11:25.981162 [info ] [MainThread]: 
[0m21:11:26.033305 [debug] [Thread-1 (]: Began running node model.uber.datetime_dim
[0m21:11:26.037058 [info ] [Thread-1 (]: 1 of 7 START sql table model uber.datetime_dim ................................. [RUN]
[0m21:11:26.040333 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_uber-data-engineering-407103_uber, now model.uber.datetime_dim)
[0m21:11:26.041531 [debug] [Thread-1 (]: Began compiling node model.uber.datetime_dim
[0m21:11:26.060947 [debug] [Thread-1 (]: Writing injected SQL for node "model.uber.datetime_dim"
[0m21:11:26.064845 [debug] [Thread-1 (]: Timing info for model.uber.datetime_dim (compile): 21:11:26.042443 => 21:11:26.064442
[0m21:11:26.065487 [debug] [Thread-1 (]: Began executing node model.uber.datetime_dim
[0m21:11:26.083209 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m21:11:26.849624 [debug] [Thread-1 (]: Writing runtime sql for node "model.uber.datetime_dim"
[0m21:11:26.853149 [debug] [Thread-1 (]: On model.uber.datetime_dim: /* {"app": "dbt", "dbt_version": "1.5.9", "profile_name": "uber", "target_name": "dev", "node_id": "model.uber.datetime_dim"} */

  
    

    create or replace table `uber-data-engineering-407103`.`uber`.`datetime_dim`
    
    

    OPTIONS()
    as (
      WITH datetime_cte AS (  
  SELECT DISTINCT
    tpep_pickup_datetime AS datetime_id,
    CASE
      WHEN LENGTH(tpep_pickup_datetime) = 16 THEN
        -- Date format: "DD/MM/YYYY HH:MM"
        PARSE_DATETIME('%m/%d/%Y %H:%M', tpep_pickup_datetime)
      WHEN LENGTH(tpep_pickup_datetime) <= 14 THEN
        -- Date format: "MM/DD/YY HH:MM"
        PARSE_DATETIME('%m/%d/%y %H:%M', tpep_pickup_datetime)
      ELSE
        NULL
    END AS pick_date_part,
    tpep_dropoff_datetime AS drop_datetime_id,
    CASE
      WHEN LENGTH(tpep_dropoff_datetime) = 16 THEN
        -- Date format: "DD/MM/YYYY HH:MM"
        PARSE_DATETIME('%m/%d/%Y %H:%M', tpep_dropoff_datetime)
      WHEN LENGTH(tpep_dropoff_datetime) <= 14 THEN
        -- Date format: "MM/DD/YY HH:MM"
        PARSE_DATETIME('%m/%d/%y %H:%M', tpep_dropoff_datetime)
      ELSE
        NULL
    END AS drop_date_part
  FROM `uber-data-engineering-407103`.`uber`.`uber_tlc_trip_recrord_data`
  WHERE tpep_pickup_datetime IS NOT NULL
    AND tpep_dropoff_datetime IS NOT NULL
)
SELECT
  datetime_id,
  pick_date_part AS tpep_pickup_datetime,
  drop_date_part AS tpep_dropoff_datetime,
  EXTRACT(HOUR FROM pick_date_part) AS pick_hour,
  EXTRACT(DAY FROM pick_date_part) AS pick_day,
  EXTRACT(MONTH FROM pick_date_part) AS pick_month,
  EXTRACT(YEAR FROM pick_date_part) AS pick_year,
  EXTRACT(DAYOFWEEK FROM pick_date_part) AS pick_weekday,
  EXTRACT(HOUR FROM drop_date_part) AS drop_hour,
  EXTRACT(DAY FROM drop_date_part) AS drop_day,
  EXTRACT(MONTH FROM drop_date_part) AS drop_month,
  EXTRACT(YEAR FROM drop_date_part) AS drop_year,
  EXTRACT(DAYOFWEEK FROM drop_date_part) AS drop_weekday
FROM datetime_cte
    );
  
[0m21:11:30.377157 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=uber-data-engineering-407103&j=bq:US:3cc8af73-b262-4cb0-ada2-7beccd75ee9a&page=queryresults
[0m21:11:30.426142 [debug] [Thread-1 (]: Timing info for model.uber.datetime_dim (execute): 21:11:26.065971 => 21:11:30.425414
[0m21:11:30.440669 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '2b33a280-6d40-4a19-b127-96813ac19442', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffb7d92b90>]}
[0m21:11:30.447166 [info ] [Thread-1 (]: 1 of 7 OK created sql table model uber.datetime_dim ............................ [[32mCREATE TABLE (99.9k rows, 4.0 MiB processed)[0m in 4.39s]
[0m21:11:30.457345 [debug] [Thread-1 (]: Finished running node model.uber.datetime_dim
[0m21:11:30.460132 [debug] [Thread-1 (]: Began running node model.uber.dropoff_location_dim
[0m21:11:30.462044 [info ] [Thread-1 (]: 2 of 7 START sql table model uber.dropoff_location_dim ......................... [RUN]
[0m21:11:30.463481 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.uber.datetime_dim, now model.uber.dropoff_location_dim)
[0m21:11:30.464340 [debug] [Thread-1 (]: Began compiling node model.uber.dropoff_location_dim
[0m21:11:30.472022 [debug] [Thread-1 (]: Writing injected SQL for node "model.uber.dropoff_location_dim"
[0m21:11:30.477526 [debug] [Thread-1 (]: Timing info for model.uber.dropoff_location_dim (compile): 21:11:30.464868 => 21:11:30.477289
[0m21:11:30.478174 [debug] [Thread-1 (]: Began executing node model.uber.dropoff_location_dim
[0m21:11:30.481827 [debug] [Thread-1 (]: Writing runtime sql for node "model.uber.dropoff_location_dim"
[0m21:11:30.483702 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m21:11:30.490686 [debug] [Thread-1 (]: On model.uber.dropoff_location_dim: /* {"app": "dbt", "dbt_version": "1.5.9", "profile_name": "uber", "target_name": "dev", "node_id": "model.uber.dropoff_location_dim"} */

  
    

    create or replace table `uber-data-engineering-407103`.`uber`.`dropoff_location_dim`
    
    

    OPTIONS()
    as (
      WITH numbered_rows AS (
  SELECT
    

    

    with p as (
        select 0 as generated_number union all select 1
    ), unioned as (

    select

    
    p0.generated_number * power(2, 0)
    
    
    + 1
    as generated_number

    from

    
    p as p0
    
    

    )

    select *
    from unioned
    where generated_number <= 1
    order by generated_number

 as dropoff_location_id,
    dropoff_latitude AS dropoff_latitude,
    dropoff_longitude AS dropoff_longitude,
    ROW_NUMBER() OVER (ORDER BY dropoff_latitude, dropoff_longitude) as row_num
  FROM `uber-data-engineering-407103`.`uber`.`uber_tlc_trip_recrord_data`
)
SELECT
  dropoff_location_id,
  dropoff_latitude,
  dropoff_longitude
FROM numbered_rows
    );
  
[0m21:11:31.572464 [debug] [Thread-1 (]: BigQuery adapter: Retry attempt 1 of 1 after error: BadRequest('Syntax error: Unexpected "(" at [18:15]')
[0m21:11:32.008143 [error] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=uber-data-engineering-407103&j=bq:US:100eb011-59c9-40f1-80df-9a2e6293cdb1&page=queryresults
[0m21:11:32.012807 [debug] [Thread-1 (]: Timing info for model.uber.dropoff_location_dim (execute): 21:11:30.478599 => 21:11:32.011924
[0m21:11:32.043508 [debug] [Thread-1 (]: Database Error in model dropoff_location_dim (models/transform/dropoff_location_dim.sql)
  Syntax error: Unexpected "(" at [18:15]
  compiled Code at target/run/uber/models/transform/dropoff_location_dim.sql
[0m21:11:32.045096 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '2b33a280-6d40-4a19-b127-96813ac19442', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffb7f3d1d0>]}
[0m21:11:32.046818 [error] [Thread-1 (]: 2 of 7 ERROR creating sql table model uber.dropoff_location_dim ................ [[31mERROR[0m in 1.58s]
[0m21:11:32.049111 [debug] [Thread-1 (]: Finished running node model.uber.dropoff_location_dim
[0m21:11:32.050225 [debug] [Thread-1 (]: Began running node model.uber.passenger_count_dim
[0m21:11:32.053537 [info ] [Thread-1 (]: 3 of 7 START sql table model uber.passenger_count_dim .......................... [RUN]
[0m21:11:32.055637 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.uber.dropoff_location_dim, now model.uber.passenger_count_dim)
[0m21:11:32.056511 [debug] [Thread-1 (]: Began compiling node model.uber.passenger_count_dim
[0m21:11:32.067003 [debug] [Thread-1 (]: Writing injected SQL for node "model.uber.passenger_count_dim"
[0m21:11:32.071118 [debug] [Thread-1 (]: Timing info for model.uber.passenger_count_dim (compile): 21:11:32.057128 => 21:11:32.070325
[0m21:11:32.072344 [debug] [Thread-1 (]: Began executing node model.uber.passenger_count_dim
[0m21:11:32.080225 [debug] [Thread-1 (]: Writing runtime sql for node "model.uber.passenger_count_dim"
[0m21:11:32.086915 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m21:11:32.089895 [debug] [Thread-1 (]: On model.uber.passenger_count_dim: /* {"app": "dbt", "dbt_version": "1.5.9", "profile_name": "uber", "target_name": "dev", "node_id": "model.uber.passenger_count_dim"} */

  
    

    create or replace table `uber-data-engineering-407103`.`uber`.`passenger_count_dim`
    
    

    OPTIONS()
    as (
      SELECT DISTINCT
    to_hex(md5(cast(coalesce(cast(VendorID as STRING), '_dbt_utils_surrogate_key_null_') || '-' || coalesce(cast(tpep_pickup_datetime as STRING), '_dbt_utils_surrogate_key_null_') || '-' || coalesce(cast(tpep_dropoff_datetime as STRING), '_dbt_utils_surrogate_key_null_') || '-' || coalesce(cast( passenger_count as STRING), '_dbt_utils_surrogate_key_null_') as STRING))) as passenger_count_id,
		passenger_count AS passenger_count,
FROM `uber-data-engineering-407103`.`uber`.`uber_tlc_trip_recrord_data`
WHERE passenger_count IS NOT NULL
    );
  
[0m21:11:35.751593 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=uber-data-engineering-407103&j=bq:US:03c2d494-b346-43da-9564-dd8e14b1100c&page=queryresults
[0m21:11:35.769307 [debug] [Thread-1 (]: Timing info for model.uber.passenger_count_dim (execute): 21:11:32.073017 => 21:11:35.768363
[0m21:11:35.774188 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '2b33a280-6d40-4a19-b127-96813ac19442', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffb7cba950>]}
[0m21:11:35.777934 [info ] [Thread-1 (]: 3 of 7 OK created sql table model uber.passenger_count_dim ..................... [[32mCREATE TABLE (99.9k rows, 5.5 MiB processed)[0m in 3.72s]
[0m21:11:35.780609 [debug] [Thread-1 (]: Finished running node model.uber.passenger_count_dim
[0m21:11:35.782602 [debug] [Thread-1 (]: Began running node model.uber.payment_type_dim
[0m21:11:35.784916 [info ] [Thread-1 (]: 4 of 7 START sql table model uber.payment_type_dim ............................. [RUN]
[0m21:11:35.787296 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.uber.passenger_count_dim, now model.uber.payment_type_dim)
[0m21:11:35.788419 [debug] [Thread-1 (]: Began compiling node model.uber.payment_type_dim
[0m21:11:35.812049 [debug] [Thread-1 (]: Writing injected SQL for node "model.uber.payment_type_dim"
[0m21:11:35.816128 [debug] [Thread-1 (]: Timing info for model.uber.payment_type_dim (compile): 21:11:35.789133 => 21:11:35.815757
[0m21:11:35.817398 [debug] [Thread-1 (]: Began executing node model.uber.payment_type_dim
[0m21:11:35.825174 [debug] [Thread-1 (]: Writing runtime sql for node "model.uber.payment_type_dim"
[0m21:11:35.829730 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m21:11:35.845903 [debug] [Thread-1 (]: On model.uber.payment_type_dim: /* {"app": "dbt", "dbt_version": "1.5.9", "profile_name": "uber", "target_name": "dev", "node_id": "model.uber.payment_type_dim"} */

  
    

    create or replace table `uber-data-engineering-407103`.`uber`.`payment_type_dim`
    
    

    OPTIONS()
    as (
      WITH numbered_rows AS (
  SELECT
    

    

    with p as (
        select 0 as generated_number union all select 1
    ), unioned as (

    select

    
    p0.generated_number * power(2, 0)
    
    
    + 1
    as generated_number

    from

    
    p as p0
    
    

    )

    select *
    from unioned
    where generated_number <= 1
    order by generated_number

 as payment_type_id,
    payment_type AS payment_type,
    ROW_NUMBER() OVER (ORDER BY payment_type) as row_num
  FROM `uber-data-engineering-407103`.`uber`.`uber_tlc_trip_recrord_data`
  WHERE passenger_count IS NOT NULL
)

SELECT
  payment_type_id,
  payment_type
FROM numbered_rows
    );
  
[0m21:11:36.511822 [debug] [Thread-1 (]: BigQuery adapter: Retry attempt 1 of 1 after error: BadRequest('Syntax error: Unexpected "(" at [18:15]')
[0m21:11:36.726156 [error] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=uber-data-engineering-407103&j=bq:US:5261c89a-1d3e-481e-abbe-5aec420234c3&page=queryresults
[0m21:11:36.729703 [debug] [Thread-1 (]: Timing info for model.uber.payment_type_dim (execute): 21:11:35.818107 => 21:11:36.729193
[0m21:11:36.737707 [debug] [Thread-1 (]: Database Error in model payment_type_dim (models/transform/payment_type_dim.sql)
  Syntax error: Unexpected "(" at [18:15]
  compiled Code at target/run/uber/models/transform/payment_type_dim.sql
[0m21:11:36.739175 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '2b33a280-6d40-4a19-b127-96813ac19442', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffb7d74210>]}
[0m21:11:36.740714 [error] [Thread-1 (]: 4 of 7 ERROR creating sql table model uber.payment_type_dim .................... [[31mERROR[0m in 0.95s]
[0m21:11:36.742320 [debug] [Thread-1 (]: Finished running node model.uber.payment_type_dim
[0m21:11:36.744133 [debug] [Thread-1 (]: Began running node model.uber.pickup_location_dim
[0m21:11:36.745825 [info ] [Thread-1 (]: 5 of 7 START sql table model uber.pickup_location_dim .......................... [RUN]
[0m21:11:36.747382 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.uber.payment_type_dim, now model.uber.pickup_location_dim)
[0m21:11:36.748136 [debug] [Thread-1 (]: Began compiling node model.uber.pickup_location_dim
[0m21:11:36.753492 [debug] [Thread-1 (]: Writing injected SQL for node "model.uber.pickup_location_dim"
[0m21:11:36.757340 [debug] [Thread-1 (]: Timing info for model.uber.pickup_location_dim (compile): 21:11:36.748784 => 21:11:36.756794
[0m21:11:36.758326 [debug] [Thread-1 (]: Began executing node model.uber.pickup_location_dim
[0m21:11:36.761948 [debug] [Thread-1 (]: Writing runtime sql for node "model.uber.pickup_location_dim"
[0m21:11:36.764566 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m21:11:36.769403 [debug] [Thread-1 (]: On model.uber.pickup_location_dim: /* {"app": "dbt", "dbt_version": "1.5.9", "profile_name": "uber", "target_name": "dev", "node_id": "model.uber.pickup_location_dim"} */

  
    

    create or replace table `uber-data-engineering-407103`.`uber`.`pickup_location_dim`
    
    

    OPTIONS()
    as (
      WITH numbered_rows AS (
  SELECT
    

    

    with p as (
        select 0 as generated_number union all select 1
    ), unioned as (

    select

    
    p0.generated_number * power(2, 0)
    
    
    + 1
    as generated_number

    from

    
    p as p0
    
    

    )

    select *
    from unioned
    where generated_number <= 1
    order by generated_number

 as pickup_location_id,
    pickup_latitude AS pickup_latitude,
    pickup_longitude AS pickup_longitude,
    ROW_NUMBER() OVER (ORDER BY pickup_latitude, pickup_longitude) as row_num
  FROM `uber-data-engineering-407103`.`uber`.`uber_tlc_trip_recrord_data`
)
SELECT
  pickup_location_id,
  pickup_latitude,
  pickup_longitude
FROM numbered_rows
    );
  
[0m21:11:37.507486 [debug] [Thread-1 (]: BigQuery adapter: Retry attempt 1 of 1 after error: BadRequest('Syntax error: Unexpected "(" at [18:15]')
[0m21:11:37.934337 [error] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=uber-data-engineering-407103&j=bq:US:85df3e6e-cf7d-436d-84c9-5c5545c20587&page=queryresults
[0m21:11:37.939182 [debug] [Thread-1 (]: Timing info for model.uber.pickup_location_dim (execute): 21:11:36.758835 => 21:11:37.938422
[0m21:11:37.950594 [debug] [Thread-1 (]: Database Error in model pickup_location_dim (models/transform/pickup_location_dim.sql)
  Syntax error: Unexpected "(" at [18:15]
  compiled Code at target/run/uber/models/transform/pickup_location_dim.sql
[0m21:11:37.952710 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '2b33a280-6d40-4a19-b127-96813ac19442', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffb7d76190>]}
[0m21:11:37.954552 [error] [Thread-1 (]: 5 of 7 ERROR creating sql table model uber.pickup_location_dim ................. [[31mERROR[0m in 1.21s]
[0m21:11:37.956358 [debug] [Thread-1 (]: Finished running node model.uber.pickup_location_dim
[0m21:11:37.957892 [debug] [Thread-1 (]: Began running node model.uber.rate_code_dim
[0m21:11:37.959455 [info ] [Thread-1 (]: 6 of 7 START sql table model uber.rate_code_dim ................................ [RUN]
[0m21:11:37.961399 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.uber.pickup_location_dim, now model.uber.rate_code_dim)
[0m21:11:37.962550 [debug] [Thread-1 (]: Began compiling node model.uber.rate_code_dim
[0m21:11:37.969743 [debug] [Thread-1 (]: Writing injected SQL for node "model.uber.rate_code_dim"
[0m21:11:37.973228 [debug] [Thread-1 (]: Timing info for model.uber.rate_code_dim (compile): 21:11:37.963427 => 21:11:37.972780
[0m21:11:37.974097 [debug] [Thread-1 (]: Began executing node model.uber.rate_code_dim
[0m21:11:37.978988 [debug] [Thread-1 (]: Writing runtime sql for node "model.uber.rate_code_dim"
[0m21:11:37.981918 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m21:11:37.987471 [debug] [Thread-1 (]: On model.uber.rate_code_dim: /* {"app": "dbt", "dbt_version": "1.5.9", "profile_name": "uber", "target_name": "dev", "node_id": "model.uber.rate_code_dim"} */

  
    

    create or replace table `uber-data-engineering-407103`.`uber`.`rate_code_dim`
    
    

    OPTIONS()
    as (
      WITH numbered_rows AS (
  SELECT
    

    

    with p as (
        select 0 as generated_number union all select 1
    ), unioned as (

    select

    
    p0.generated_number * power(2, 0)
    
    
    + 1
    as generated_number

    from

    
    p as p0
    
    

    )

    select *
    from unioned
    where generated_number <= 1
    order by generated_number

 as rate_code_id,
    RatecodeID AS RatecodeID,
    ROW_NUMBER() OVER (ORDER BY RatecodeID) as row_num
  FROM `uber-data-engineering-407103`.`uber`.`uber_tlc_trip_recrord_data`
  WHERE RatecodeID IS NOT NULL
)

SELECT
  rate_code_id,
  rate_code
FROM numbered_rows
    );
  
[0m21:11:38.372238 [debug] [Thread-1 (]: BigQuery adapter: Retry attempt 1 of 1 after error: BadRequest('Syntax error: Unexpected "(" at [18:15]')
[0m21:11:38.757449 [error] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=uber-data-engineering-407103&j=bq:US:c9a7ca64-da12-4ceb-979a-2064fe262648&page=queryresults
[0m21:11:38.760927 [debug] [Thread-1 (]: Timing info for model.uber.rate_code_dim (execute): 21:11:37.974731 => 21:11:38.760454
[0m21:11:38.765808 [debug] [Thread-1 (]: Database Error in model rate_code_dim (models/transform/rate_code_dim.sql)
  Syntax error: Unexpected "(" at [18:15]
  compiled Code at target/run/uber/models/transform/rate_code_dim.sql
[0m21:11:38.767053 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '2b33a280-6d40-4a19-b127-96813ac19442', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffb7e33650>]}
[0m21:11:38.768426 [error] [Thread-1 (]: 6 of 7 ERROR creating sql table model uber.rate_code_dim ....................... [[31mERROR[0m in 0.81s]
[0m21:11:38.769391 [debug] [Thread-1 (]: Finished running node model.uber.rate_code_dim
[0m21:11:38.770226 [debug] [Thread-1 (]: Began running node model.uber.trip_distance
[0m21:11:38.771233 [info ] [Thread-1 (]: 7 of 7 START sql table model uber.trip_distance ................................ [RUN]
[0m21:11:38.772287 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.uber.rate_code_dim, now model.uber.trip_distance)
[0m21:11:38.772837 [debug] [Thread-1 (]: Began compiling node model.uber.trip_distance
[0m21:11:38.779294 [debug] [Thread-1 (]: Writing injected SQL for node "model.uber.trip_distance"
[0m21:11:38.781230 [debug] [Thread-1 (]: Timing info for model.uber.trip_distance (compile): 21:11:38.773225 => 21:11:38.780959
[0m21:11:38.781952 [debug] [Thread-1 (]: Began executing node model.uber.trip_distance
[0m21:11:38.785508 [debug] [Thread-1 (]: Writing runtime sql for node "model.uber.trip_distance"
[0m21:11:38.787233 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m21:11:38.789277 [debug] [Thread-1 (]: On model.uber.trip_distance: /* {"app": "dbt", "dbt_version": "1.5.9", "profile_name": "uber", "target_name": "dev", "node_id": "model.uber.trip_distance"} */

  
    

    create or replace table `uber-data-engineering-407103`.`uber`.`trip_distance`
    
    

    OPTIONS()
    as (
      WITH numbered_rows AS (
  SELECT
    

    

    with p as (
        select 0 as generated_number union all select 1
    ), unioned as (

    select

    
    p0.generated_number * power(2, 0)
    
    
    + 1
    as generated_number

    from

    
    p as p0
    
    

    )

    select *
    from unioned
    where generated_number <= 1
    order by generated_number

 as trip_distance_id,
    trip_distance AS trip_distance,
    ROW_NUMBER() OVER (ORDER BY trip_distance) as row_num
  FROM `uber-data-engineering-407103`.`uber`.`uber_tlc_trip_recrord_data`
  WHERE trip_distance IS NOT NULL
)

SELECT
  trip_distance_id,
  trip_distance
FROM numbered_rows
    );
  
[0m21:11:39.298056 [debug] [Thread-1 (]: BigQuery adapter: Retry attempt 1 of 1 after error: BadRequest('Syntax error: Unexpected "(" at [18:15]')
[0m21:11:39.920614 [error] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=uber-data-engineering-407103&j=bq:US:e2eb4807-05ef-4e19-877a-4ac93828d34c&page=queryresults
[0m21:11:39.929866 [debug] [Thread-1 (]: Timing info for model.uber.trip_distance (execute): 21:11:38.782427 => 21:11:39.929522
[0m21:11:39.950933 [debug] [Thread-1 (]: Database Error in model trip_distance (models/transform/trip_distance.sql)
  Syntax error: Unexpected "(" at [18:15]
  compiled Code at target/run/uber/models/transform/trip_distance.sql
[0m21:11:39.956375 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '2b33a280-6d40-4a19-b127-96813ac19442', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffb7cd08d0>]}
[0m21:11:39.958228 [error] [Thread-1 (]: 7 of 7 ERROR creating sql table model uber.trip_distance ....................... [[31mERROR[0m in 1.18s]
[0m21:11:39.960054 [debug] [Thread-1 (]: Finished running node model.uber.trip_distance
[0m21:11:39.985234 [debug] [MainThread]: Connection 'master' was properly closed.
[0m21:11:39.989084 [debug] [MainThread]: Connection 'model.uber.trip_distance' was properly closed.
[0m21:11:39.999632 [info ] [MainThread]: 
[0m21:11:40.002868 [info ] [MainThread]: Finished running 7 table models in 0 hours 0 minutes and 16.95 seconds (16.95s).
[0m21:11:40.011721 [debug] [MainThread]: Command end result
[0m21:11:40.052251 [info ] [MainThread]: 
[0m21:11:40.055380 [info ] [MainThread]: [31mCompleted with 5 errors and 0 warnings:[0m
[0m21:11:40.057868 [info ] [MainThread]: 
[0m21:11:40.060165 [error] [MainThread]: [33mDatabase Error in model dropoff_location_dim (models/transform/dropoff_location_dim.sql)[0m
[0m21:11:40.062244 [error] [MainThread]:   Syntax error: Unexpected "(" at [18:15]
[0m21:11:40.064856 [error] [MainThread]:   compiled Code at target/run/uber/models/transform/dropoff_location_dim.sql
[0m21:11:40.068001 [info ] [MainThread]: 
[0m21:11:40.069390 [error] [MainThread]: [33mDatabase Error in model payment_type_dim (models/transform/payment_type_dim.sql)[0m
[0m21:11:40.071036 [error] [MainThread]:   Syntax error: Unexpected "(" at [18:15]
[0m21:11:40.072698 [error] [MainThread]:   compiled Code at target/run/uber/models/transform/payment_type_dim.sql
[0m21:11:40.074221 [info ] [MainThread]: 
[0m21:11:40.075404 [error] [MainThread]: [33mDatabase Error in model pickup_location_dim (models/transform/pickup_location_dim.sql)[0m
[0m21:11:40.076276 [error] [MainThread]:   Syntax error: Unexpected "(" at [18:15]
[0m21:11:40.077582 [error] [MainThread]:   compiled Code at target/run/uber/models/transform/pickup_location_dim.sql
[0m21:11:40.078848 [info ] [MainThread]: 
[0m21:11:40.080488 [error] [MainThread]: [33mDatabase Error in model rate_code_dim (models/transform/rate_code_dim.sql)[0m
[0m21:11:40.082047 [error] [MainThread]:   Syntax error: Unexpected "(" at [18:15]
[0m21:11:40.085129 [error] [MainThread]:   compiled Code at target/run/uber/models/transform/rate_code_dim.sql
[0m21:11:40.086202 [info ] [MainThread]: 
[0m21:11:40.087187 [error] [MainThread]: [33mDatabase Error in model trip_distance (models/transform/trip_distance.sql)[0m
[0m21:11:40.088340 [error] [MainThread]:   Syntax error: Unexpected "(" at [18:15]
[0m21:11:40.089367 [error] [MainThread]:   compiled Code at target/run/uber/models/transform/trip_distance.sql
[0m21:11:40.090643 [info ] [MainThread]: 
[0m21:11:40.091712 [info ] [MainThread]: Done. PASS=2 WARN=0 ERROR=5 SKIP=0 TOTAL=7
[0m21:11:40.093703 [debug] [MainThread]: Command `dbt run` failed at 21:11:40.093524 after 17.70 seconds
[0m21:11:40.094500 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffb9addad0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffba475810>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffbdf7e3d0>]}
[0m21:11:40.095143 [debug] [MainThread]: Flushing usage events
[0m21:13:32.158420 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffa3b75590>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffa36d5550>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffa33b3d50>]}


============================== 21:13:32.164848 | 67e50a86-422e-4ab6-8959-119074c420fc ==============================
[0m21:13:32.164848 [info ] [MainThread]: Running with dbt=1.5.9
[0m21:13:32.165936 [debug] [MainThread]: running dbt with arguments {'use_colors': 'True', 'log_path': '/usr/local/airflow/include/dbt/logs', 'profiles_dir': '/usr/local/airflow/include/dbt/', 'fail_fast': 'False', 'target_path': 'None', 'use_experimental_parser': 'False', 'write_json': 'True', 'static_parser': 'True', 'log_format': 'default', 'no_print': 'None', 'partial_parse': 'True', 'warn_error': 'None', 'cache_selected_only': 'False', 'send_anonymous_usage_stats': 'True', 'debug': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'quiet': 'False', 'log_cache_events': 'False', 'introspect': 'True', 'version_check': 'True', 'printer_width': '80', 'indirect_selection': 'eager'}
[0m21:13:32.592077 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '67e50a86-422e-4ab6-8959-119074c420fc', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffa3849350>]}
[0m21:13:32.603672 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '67e50a86-422e-4ab6-8959-119074c420fc', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffa32ba110>]}
[0m21:13:32.604428 [info ] [MainThread]: Registered adapter: bigquery=1.5.3
[0m21:13:32.619571 [debug] [MainThread]: checksum: dd837546c89c9d03f3c2cb0ca6165266a30da6076d5d44e9991f7c5a8e5f5831, vars: {}, profile: , target: , version: 1.5.9
[0m21:13:32.694676 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 3 files changed.
[0m21:13:32.696320 [debug] [MainThread]: Partial parsing: updated file: uber://models/transform/trip_distance.sql
[0m21:13:32.696889 [debug] [MainThread]: Partial parsing: updated file: uber://models/transform/payment_type_dim.sql
[0m21:13:32.697407 [debug] [MainThread]: Partial parsing: updated file: uber://models/transform/rate_code_dim.sql
[0m21:13:32.716207 [debug] [MainThread]: 1603: static parser failed on transform/trip_distance.sql
[0m21:13:32.735642 [debug] [MainThread]: 1602: parser fallback to jinja rendering on transform/trip_distance.sql
[0m21:13:32.737757 [debug] [MainThread]: 1603: static parser failed on transform/payment_type_dim.sql
[0m21:13:32.742431 [debug] [MainThread]: 1602: parser fallback to jinja rendering on transform/payment_type_dim.sql
[0m21:13:32.744305 [debug] [MainThread]: 1603: static parser failed on transform/rate_code_dim.sql
[0m21:13:32.751935 [debug] [MainThread]: 1602: parser fallback to jinja rendering on transform/rate_code_dim.sql
[0m21:13:32.764689 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '67e50a86-422e-4ab6-8959-119074c420fc', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffa154ac10>]}
[0m21:13:32.777216 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '67e50a86-422e-4ab6-8959-119074c420fc', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffa168d090>]}
[0m21:13:32.777838 [info ] [MainThread]: Found 7 models, 0 tests, 0 snapshots, 0 analyses, 474 macros, 0 operations, 0 seed files, 1 source, 0 exposures, 0 metrics, 0 groups
[0m21:13:32.778481 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '67e50a86-422e-4ab6-8959-119074c420fc', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffa66bfa10>]}
[0m21:13:32.780270 [info ] [MainThread]: 
[0m21:13:32.781256 [debug] [MainThread]: Acquiring new bigquery connection 'master'
[0m21:13:32.782865 [debug] [ThreadPool]: Acquiring new bigquery connection 'list_uber-data-engineering-407103'
[0m21:13:32.783351 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m21:13:33.560872 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_uber-data-engineering-407103, now list_uber-data-engineering-407103_uber)
[0m21:13:33.564094 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m21:13:34.279509 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '67e50a86-422e-4ab6-8959-119074c420fc', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffa16b1390>]}
[0m21:13:34.282782 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m21:13:34.284421 [info ] [MainThread]: 
[0m21:13:34.311675 [debug] [Thread-1 (]: Began running node model.uber.datetime_dim
[0m21:13:34.313002 [info ] [Thread-1 (]: 1 of 7 START sql table model uber.datetime_dim ................................. [RUN]
[0m21:13:34.314505 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_uber-data-engineering-407103_uber, now model.uber.datetime_dim)
[0m21:13:34.315321 [debug] [Thread-1 (]: Began compiling node model.uber.datetime_dim
[0m21:13:34.322980 [debug] [Thread-1 (]: Writing injected SQL for node "model.uber.datetime_dim"
[0m21:13:34.325284 [debug] [Thread-1 (]: Timing info for model.uber.datetime_dim (compile): 21:13:34.315827 => 21:13:34.325002
[0m21:13:34.325842 [debug] [Thread-1 (]: Began executing node model.uber.datetime_dim
[0m21:13:34.339490 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m21:13:35.594654 [debug] [Thread-1 (]: Writing runtime sql for node "model.uber.datetime_dim"
[0m21:13:35.600659 [debug] [Thread-1 (]: On model.uber.datetime_dim: /* {"app": "dbt", "dbt_version": "1.5.9", "profile_name": "uber", "target_name": "dev", "node_id": "model.uber.datetime_dim"} */

  
    

    create or replace table `uber-data-engineering-407103`.`uber`.`datetime_dim`
    
    

    OPTIONS()
    as (
      WITH datetime_cte AS (  
  SELECT DISTINCT
    tpep_pickup_datetime AS datetime_id,
    CASE
      WHEN LENGTH(tpep_pickup_datetime) = 16 THEN
        -- Date format: "DD/MM/YYYY HH:MM"
        PARSE_DATETIME('%m/%d/%Y %H:%M', tpep_pickup_datetime)
      WHEN LENGTH(tpep_pickup_datetime) <= 14 THEN
        -- Date format: "MM/DD/YY HH:MM"
        PARSE_DATETIME('%m/%d/%y %H:%M', tpep_pickup_datetime)
      ELSE
        NULL
    END AS pick_date_part,
    tpep_dropoff_datetime AS drop_datetime_id,
    CASE
      WHEN LENGTH(tpep_dropoff_datetime) = 16 THEN
        -- Date format: "DD/MM/YYYY HH:MM"
        PARSE_DATETIME('%m/%d/%Y %H:%M', tpep_dropoff_datetime)
      WHEN LENGTH(tpep_dropoff_datetime) <= 14 THEN
        -- Date format: "MM/DD/YY HH:MM"
        PARSE_DATETIME('%m/%d/%y %H:%M', tpep_dropoff_datetime)
      ELSE
        NULL
    END AS drop_date_part
  FROM `uber-data-engineering-407103`.`uber`.`uber_tlc_trip_recrord_data`
  WHERE tpep_pickup_datetime IS NOT NULL
    AND tpep_dropoff_datetime IS NOT NULL
)
SELECT
  datetime_id,
  pick_date_part AS tpep_pickup_datetime,
  drop_date_part AS tpep_dropoff_datetime,
  EXTRACT(HOUR FROM pick_date_part) AS pick_hour,
  EXTRACT(DAY FROM pick_date_part) AS pick_day,
  EXTRACT(MONTH FROM pick_date_part) AS pick_month,
  EXTRACT(YEAR FROM pick_date_part) AS pick_year,
  EXTRACT(DAYOFWEEK FROM pick_date_part) AS pick_weekday,
  EXTRACT(HOUR FROM drop_date_part) AS drop_hour,
  EXTRACT(DAY FROM drop_date_part) AS drop_day,
  EXTRACT(MONTH FROM drop_date_part) AS drop_month,
  EXTRACT(YEAR FROM drop_date_part) AS drop_year,
  EXTRACT(DAYOFWEEK FROM drop_date_part) AS drop_weekday
FROM datetime_cte
    );
  
[0m21:13:38.622719 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=uber-data-engineering-407103&j=bq:US:72d528bc-1b83-44fa-9648-31b5ef06789c&page=queryresults
[0m21:13:38.661752 [debug] [Thread-1 (]: Timing info for model.uber.datetime_dim (execute): 21:13:34.326280 => 21:13:38.661231
[0m21:13:38.663968 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '67e50a86-422e-4ab6-8959-119074c420fc', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffa1659dd0>]}
[0m21:13:38.665739 [info ] [Thread-1 (]: 1 of 7 OK created sql table model uber.datetime_dim ............................ [[32mCREATE TABLE (99.9k rows, 4.0 MiB processed)[0m in 4.35s]
[0m21:13:38.667549 [debug] [Thread-1 (]: Finished running node model.uber.datetime_dim
[0m21:13:38.668698 [debug] [Thread-1 (]: Began running node model.uber.dropoff_location_dim
[0m21:13:38.669943 [info ] [Thread-1 (]: 2 of 7 START sql table model uber.dropoff_location_dim ......................... [RUN]
[0m21:13:38.671194 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.uber.datetime_dim, now model.uber.dropoff_location_dim)
[0m21:13:38.671870 [debug] [Thread-1 (]: Began compiling node model.uber.dropoff_location_dim
[0m21:13:38.677970 [debug] [Thread-1 (]: Writing injected SQL for node "model.uber.dropoff_location_dim"
[0m21:13:38.680543 [debug] [Thread-1 (]: Timing info for model.uber.dropoff_location_dim (compile): 21:13:38.672429 => 21:13:38.680366
[0m21:13:38.681043 [debug] [Thread-1 (]: Began executing node model.uber.dropoff_location_dim
[0m21:13:38.684331 [debug] [Thread-1 (]: Writing runtime sql for node "model.uber.dropoff_location_dim"
[0m21:13:38.687279 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m21:13:38.691286 [debug] [Thread-1 (]: On model.uber.dropoff_location_dim: /* {"app": "dbt", "dbt_version": "1.5.9", "profile_name": "uber", "target_name": "dev", "node_id": "model.uber.dropoff_location_dim"} */

  
    

    create or replace table `uber-data-engineering-407103`.`uber`.`dropoff_location_dim`
    
    

    OPTIONS()
    as (
      WITH numbered_rows AS (
  SELECT
    

    

    with p as (
        select 0 as generated_number union all select 1
    ), unioned as (

    select

    
    p0.generated_number * power(2, 0)
    
    
    + 1
    as generated_number

    from

    
    p as p0
    
    

    )

    select *
    from unioned
    where generated_number <= 1
    order by generated_number

 as dropoff_location_id,
    dropoff_latitude AS dropoff_latitude,
    dropoff_longitude AS dropoff_longitude,
    ROW_NUMBER() OVER (ORDER BY dropoff_latitude, dropoff_longitude) as row_num
  FROM `uber-data-engineering-407103`.`uber`.`uber_tlc_trip_recrord_data`
)
SELECT
  dropoff_location_id,
  dropoff_latitude,
  dropoff_longitude
FROM numbered_rows
    );
  
[0m21:13:39.633569 [debug] [Thread-1 (]: BigQuery adapter: Retry attempt 1 of 1 after error: BadRequest('Syntax error: Unexpected "(" at [18:15]')
[0m21:13:40.899358 [error] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=uber-data-engineering-407103&j=bq:US:46c1d6da-94c7-497f-8de1-9ea8c4bc4aca&page=queryresults
[0m21:13:40.902371 [debug] [Thread-1 (]: Timing info for model.uber.dropoff_location_dim (execute): 21:13:38.681523 => 21:13:40.902081
[0m21:13:40.913486 [debug] [Thread-1 (]: Database Error in model dropoff_location_dim (models/transform/dropoff_location_dim.sql)
  Syntax error: Unexpected "(" at [18:15]
  compiled Code at target/run/uber/models/transform/dropoff_location_dim.sql
[0m21:13:40.914525 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '67e50a86-422e-4ab6-8959-119074c420fc', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffa16ee9d0>]}
[0m21:13:40.915639 [error] [Thread-1 (]: 2 of 7 ERROR creating sql table model uber.dropoff_location_dim ................ [[31mERROR[0m in 2.24s]
[0m21:13:40.916430 [debug] [Thread-1 (]: Finished running node model.uber.dropoff_location_dim
[0m21:13:40.917206 [debug] [Thread-1 (]: Began running node model.uber.passenger_count_dim
[0m21:13:40.918212 [info ] [Thread-1 (]: 3 of 7 START sql table model uber.passenger_count_dim .......................... [RUN]
[0m21:13:40.919517 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.uber.dropoff_location_dim, now model.uber.passenger_count_dim)
[0m21:13:40.920105 [debug] [Thread-1 (]: Began compiling node model.uber.passenger_count_dim
[0m21:13:40.940942 [debug] [Thread-1 (]: Writing injected SQL for node "model.uber.passenger_count_dim"
[0m21:13:40.943770 [debug] [Thread-1 (]: Timing info for model.uber.passenger_count_dim (compile): 21:13:40.924091 => 21:13:40.943569
[0m21:13:40.944333 [debug] [Thread-1 (]: Began executing node model.uber.passenger_count_dim
[0m21:13:40.948031 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m21:13:41.599543 [debug] [Thread-1 (]: Writing runtime sql for node "model.uber.passenger_count_dim"
[0m21:13:41.606421 [debug] [Thread-1 (]: On model.uber.passenger_count_dim: /* {"app": "dbt", "dbt_version": "1.5.9", "profile_name": "uber", "target_name": "dev", "node_id": "model.uber.passenger_count_dim"} */

  
    

    create or replace table `uber-data-engineering-407103`.`uber`.`passenger_count_dim`
    
    

    OPTIONS()
    as (
      SELECT DISTINCT
    to_hex(md5(cast(coalesce(cast(VendorID as STRING), '_dbt_utils_surrogate_key_null_') || '-' || coalesce(cast(tpep_pickup_datetime as STRING), '_dbt_utils_surrogate_key_null_') || '-' || coalesce(cast(tpep_dropoff_datetime as STRING), '_dbt_utils_surrogate_key_null_') || '-' || coalesce(cast( passenger_count as STRING), '_dbt_utils_surrogate_key_null_') as STRING))) as passenger_count_id,
		passenger_count AS passenger_count,
FROM `uber-data-engineering-407103`.`uber`.`uber_tlc_trip_recrord_data`
WHERE passenger_count IS NOT NULL
    );
  
[0m21:13:44.643577 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=uber-data-engineering-407103&j=bq:US:226cc851-9273-4599-864a-9d71e7fec397&page=queryresults
[0m21:13:44.659084 [debug] [Thread-1 (]: Timing info for model.uber.passenger_count_dim (execute): 21:13:40.944816 => 21:13:44.657915
[0m21:13:44.662931 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '67e50a86-422e-4ab6-8959-119074c420fc', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffa1556510>]}
[0m21:13:44.665684 [info ] [Thread-1 (]: 3 of 7 OK created sql table model uber.passenger_count_dim ..................... [[32mCREATE TABLE (99.9k rows, 5.5 MiB processed)[0m in 3.74s]
[0m21:13:44.668355 [debug] [Thread-1 (]: Finished running node model.uber.passenger_count_dim
[0m21:13:44.670260 [debug] [Thread-1 (]: Began running node model.uber.payment_type_dim
[0m21:13:44.672296 [info ] [Thread-1 (]: 4 of 7 START sql table model uber.payment_type_dim ............................. [RUN]
[0m21:13:44.674061 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.uber.passenger_count_dim, now model.uber.payment_type_dim)
[0m21:13:44.675064 [debug] [Thread-1 (]: Began compiling node model.uber.payment_type_dim
[0m21:13:44.697713 [debug] [Thread-1 (]: Writing injected SQL for node "model.uber.payment_type_dim"
[0m21:13:44.703307 [debug] [Thread-1 (]: Timing info for model.uber.payment_type_dim (compile): 21:13:44.675899 => 21:13:44.702875
[0m21:13:44.704397 [debug] [Thread-1 (]: Began executing node model.uber.payment_type_dim
[0m21:13:44.709116 [debug] [Thread-1 (]: Writing runtime sql for node "model.uber.payment_type_dim"
[0m21:13:44.717773 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m21:13:44.733929 [debug] [Thread-1 (]: On model.uber.payment_type_dim: /* {"app": "dbt", "dbt_version": "1.5.9", "profile_name": "uber", "target_name": "dev", "node_id": "model.uber.payment_type_dim"} */

  
    

    create or replace table `uber-data-engineering-407103`.`uber`.`payment_type_dim`
    
    

    OPTIONS()
    as (
      WITH numbered_rows AS (
  SELECT
    

    

    with p as (
        select 0 as generated_number union all select 1
    ), unioned as (

    select

    
    p0.generated_number * power(2, 0)
    
    
    + 1
    as generated_number

    from

    
    p as p0
    
    

    )

    select *
    from unioned
    where generated_number <= 1
    order by generated_number

 as payment_type_id,
    payment_type AS payment_type,
    ROW_NUMBER() OVER (ORDER BY payment_type) as row_num
  FROM `uber-data-engineering-407103`.`uber`.`uber_tlc_trip_recrord_data`
  WHERE payment_type IS NOT NULL
)
SELECT
  payment_type_id,
  payment_type
FROM numbered_rows
    );
  
[0m21:13:45.114185 [debug] [Thread-1 (]: BigQuery adapter: Retry attempt 1 of 1 after error: BadRequest('Syntax error: Unexpected "(" at [18:15]')
[0m21:13:45.843716 [error] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=uber-data-engineering-407103&j=bq:US:8ba26c91-39f6-4638-b6df-46aeb0325298&page=queryresults
[0m21:13:45.848470 [debug] [Thread-1 (]: Timing info for model.uber.payment_type_dim (execute): 21:13:44.705179 => 21:13:45.847915
[0m21:13:45.860855 [debug] [Thread-1 (]: Database Error in model payment_type_dim (models/transform/payment_type_dim.sql)
  Syntax error: Unexpected "(" at [18:15]
  compiled Code at target/run/uber/models/transform/payment_type_dim.sql
[0m21:13:45.862978 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '67e50a86-422e-4ab6-8959-119074c420fc', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffa15eaa50>]}
[0m21:13:45.865266 [error] [Thread-1 (]: 4 of 7 ERROR creating sql table model uber.payment_type_dim .................... [[31mERROR[0m in 1.19s]
[0m21:13:45.867323 [debug] [Thread-1 (]: Finished running node model.uber.payment_type_dim
[0m21:13:45.869390 [debug] [Thread-1 (]: Began running node model.uber.pickup_location_dim
[0m21:13:45.871625 [info ] [Thread-1 (]: 5 of 7 START sql table model uber.pickup_location_dim .......................... [RUN]
[0m21:13:45.873698 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.uber.payment_type_dim, now model.uber.pickup_location_dim)
[0m21:13:45.874830 [debug] [Thread-1 (]: Began compiling node model.uber.pickup_location_dim
[0m21:13:45.883106 [debug] [Thread-1 (]: Writing injected SQL for node "model.uber.pickup_location_dim"
[0m21:13:45.886827 [debug] [Thread-1 (]: Timing info for model.uber.pickup_location_dim (compile): 21:13:45.875640 => 21:13:45.886422
[0m21:13:45.887691 [debug] [Thread-1 (]: Began executing node model.uber.pickup_location_dim
[0m21:13:45.897857 [debug] [Thread-1 (]: Writing runtime sql for node "model.uber.pickup_location_dim"
[0m21:13:45.907446 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m21:13:45.915278 [debug] [Thread-1 (]: On model.uber.pickup_location_dim: /* {"app": "dbt", "dbt_version": "1.5.9", "profile_name": "uber", "target_name": "dev", "node_id": "model.uber.pickup_location_dim"} */

  
    

    create or replace table `uber-data-engineering-407103`.`uber`.`pickup_location_dim`
    
    

    OPTIONS()
    as (
      WITH numbered_rows AS (
  SELECT
    

    

    with p as (
        select 0 as generated_number union all select 1
    ), unioned as (

    select

    
    p0.generated_number * power(2, 0)
    
    
    + 1
    as generated_number

    from

    
    p as p0
    
    

    )

    select *
    from unioned
    where generated_number <= 1
    order by generated_number

 as pickup_location_id,
    pickup_latitude AS pickup_latitude,
    pickup_longitude AS pickup_longitude,
    ROW_NUMBER() OVER (ORDER BY pickup_latitude, pickup_longitude) as row_num
  FROM `uber-data-engineering-407103`.`uber`.`uber_tlc_trip_recrord_data`
)
SELECT
  pickup_location_id,
  pickup_latitude,
  pickup_longitude
FROM numbered_rows
    );
  
[0m21:13:46.333125 [debug] [Thread-1 (]: BigQuery adapter: Retry attempt 1 of 1 after error: BadRequest('Syntax error: Unexpected "(" at [18:15]')
[0m21:13:47.431107 [error] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=uber-data-engineering-407103&j=bq:US:d7ab06c7-5338-44a5-a4c0-8050083a25a3&page=queryresults
[0m21:13:47.440356 [debug] [Thread-1 (]: Timing info for model.uber.pickup_location_dim (execute): 21:13:45.888304 => 21:13:47.436925
[0m21:13:47.452370 [debug] [Thread-1 (]: Database Error in model pickup_location_dim (models/transform/pickup_location_dim.sql)
  Syntax error: Unexpected "(" at [18:15]
  compiled Code at target/run/uber/models/transform/pickup_location_dim.sql
[0m21:13:47.455702 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '67e50a86-422e-4ab6-8959-119074c420fc', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffa13816d0>]}
[0m21:13:47.459283 [error] [Thread-1 (]: 5 of 7 ERROR creating sql table model uber.pickup_location_dim ................. [[31mERROR[0m in 1.58s]
[0m21:13:47.461797 [debug] [Thread-1 (]: Finished running node model.uber.pickup_location_dim
[0m21:13:47.463903 [debug] [Thread-1 (]: Began running node model.uber.rate_code_dim
[0m21:13:47.466532 [info ] [Thread-1 (]: 6 of 7 START sql table model uber.rate_code_dim ................................ [RUN]
[0m21:13:47.471032 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.uber.pickup_location_dim, now model.uber.rate_code_dim)
[0m21:13:47.473586 [debug] [Thread-1 (]: Began compiling node model.uber.rate_code_dim
[0m21:13:47.493071 [debug] [Thread-1 (]: Writing injected SQL for node "model.uber.rate_code_dim"
[0m21:13:47.496503 [debug] [Thread-1 (]: Timing info for model.uber.rate_code_dim (compile): 21:13:47.474966 => 21:13:47.496122
[0m21:13:47.497528 [debug] [Thread-1 (]: Began executing node model.uber.rate_code_dim
[0m21:13:47.501340 [debug] [Thread-1 (]: Writing runtime sql for node "model.uber.rate_code_dim"
[0m21:13:47.503525 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m21:13:47.506864 [debug] [Thread-1 (]: On model.uber.rate_code_dim: /* {"app": "dbt", "dbt_version": "1.5.9", "profile_name": "uber", "target_name": "dev", "node_id": "model.uber.rate_code_dim"} */

  
    

    create or replace table `uber-data-engineering-407103`.`uber`.`rate_code_dim`
    
    

    OPTIONS()
    as (
      WITH numbered_rows AS (
  SELECT
    

    

    with p as (
        select 0 as generated_number union all select 1
    ), unioned as (

    select

    
    p0.generated_number * power(2, 0)
    
    
    + 1
    as generated_number

    from

    
    p as p0
    
    

    )

    select *
    from unioned
    where generated_number <= 1
    order by generated_number

 as rate_code_id,
    RatecodeID AS RatecodeID,
    ROW_NUMBER() OVER (ORDER BY RatecodeID) as row_num
  FROM `uber-data-engineering-407103`.`uber`.`uber_tlc_trip_recrord_data`
  WHERE RatecodeID IS NOT NULL
)
SELECT
  rate_code_id,
  rate_code
FROM numbered_rows
    );
  
[0m21:13:48.115405 [debug] [Thread-1 (]: BigQuery adapter: Retry attempt 1 of 1 after error: BadRequest('Syntax error: Unexpected "(" at [18:15]')
[0m21:13:48.689895 [error] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=uber-data-engineering-407103&j=bq:US:029ce766-e68a-47e1-bb2d-4caf61388649&page=queryresults
[0m21:13:48.694915 [debug] [Thread-1 (]: Timing info for model.uber.rate_code_dim (execute): 21:13:47.497976 => 21:13:48.694078
[0m21:13:48.705482 [debug] [Thread-1 (]: Database Error in model rate_code_dim (models/transform/rate_code_dim.sql)
  Syntax error: Unexpected "(" at [18:15]
  compiled Code at target/run/uber/models/transform/rate_code_dim.sql
[0m21:13:48.707618 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '67e50a86-422e-4ab6-8959-119074c420fc', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffa14cd590>]}
[0m21:13:48.709387 [error] [Thread-1 (]: 6 of 7 ERROR creating sql table model uber.rate_code_dim ....................... [[31mERROR[0m in 1.24s]
[0m21:13:48.710683 [debug] [Thread-1 (]: Finished running node model.uber.rate_code_dim
[0m21:13:48.712359 [debug] [Thread-1 (]: Began running node model.uber.trip_distance
[0m21:13:48.714632 [info ] [Thread-1 (]: 7 of 7 START sql table model uber.trip_distance ................................ [RUN]
[0m21:13:48.716766 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.uber.rate_code_dim, now model.uber.trip_distance)
[0m21:13:48.717790 [debug] [Thread-1 (]: Began compiling node model.uber.trip_distance
[0m21:13:48.727589 [debug] [Thread-1 (]: Writing injected SQL for node "model.uber.trip_distance"
[0m21:13:48.730983 [debug] [Thread-1 (]: Timing info for model.uber.trip_distance (compile): 21:13:48.718608 => 21:13:48.730669
[0m21:13:48.731897 [debug] [Thread-1 (]: Began executing node model.uber.trip_distance
[0m21:13:48.736915 [debug] [Thread-1 (]: Writing runtime sql for node "model.uber.trip_distance"
[0m21:13:48.739668 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m21:13:48.743522 [debug] [Thread-1 (]: On model.uber.trip_distance: /* {"app": "dbt", "dbt_version": "1.5.9", "profile_name": "uber", "target_name": "dev", "node_id": "model.uber.trip_distance"} */

  
    

    create or replace table `uber-data-engineering-407103`.`uber`.`trip_distance`
    
    

    OPTIONS()
    as (
      WITH numbered_rows AS (
  SELECT
    

    

    with p as (
        select 0 as generated_number union all select 1
    ), unioned as (

    select

    
    p0.generated_number * power(2, 0)
    
    
    + 1
    as generated_number

    from

    
    p as p0
    
    

    )

    select *
    from unioned
    where generated_number <= 1
    order by generated_number

 as trip_distance_id,
    trip_distance AS trip_distance,
    ROW_NUMBER() OVER (ORDER BY trip_distance) as row_num
  FROM `uber-data-engineering-407103`.`uber`.`uber_tlc_trip_recrord_data`
  WHERE trip_distance IS NOT NULL
)
SELECT
  trip_distance_id,
  trip_distance
FROM numbered_rows
    );
  
[0m21:13:49.149858 [debug] [Thread-1 (]: BigQuery adapter: Retry attempt 1 of 1 after error: BadRequest('Syntax error: Unexpected "(" at [18:15]')
[0m21:13:50.271904 [error] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=uber-data-engineering-407103&j=bq:US:481eaad4-607f-46ff-821f-3388ad3e96a4&page=queryresults
[0m21:13:50.274557 [debug] [Thread-1 (]: Timing info for model.uber.trip_distance (execute): 21:13:48.732669 => 21:13:50.274111
[0m21:13:50.279749 [debug] [Thread-1 (]: Database Error in model trip_distance (models/transform/trip_distance.sql)
  Syntax error: Unexpected "(" at [18:15]
  compiled Code at target/run/uber/models/transform/trip_distance.sql
[0m21:13:50.281101 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '67e50a86-422e-4ab6-8959-119074c420fc', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffa1556150>]}
[0m21:13:50.282434 [error] [Thread-1 (]: 7 of 7 ERROR creating sql table model uber.trip_distance ....................... [[31mERROR[0m in 1.56s]
[0m21:13:50.283842 [debug] [Thread-1 (]: Finished running node model.uber.trip_distance
[0m21:13:50.290252 [debug] [MainThread]: Connection 'master' was properly closed.
[0m21:13:50.291339 [debug] [MainThread]: Connection 'model.uber.trip_distance' was properly closed.
[0m21:13:50.292426 [info ] [MainThread]: 
[0m21:13:50.293810 [info ] [MainThread]: Finished running 7 table models in 0 hours 0 minutes and 17.51 seconds (17.51s).
[0m21:13:50.297112 [debug] [MainThread]: Command end result
[0m21:13:50.341935 [info ] [MainThread]: 
[0m21:13:50.343700 [info ] [MainThread]: [31mCompleted with 5 errors and 0 warnings:[0m
[0m21:13:50.344762 [info ] [MainThread]: 
[0m21:13:50.347048 [error] [MainThread]: [33mDatabase Error in model dropoff_location_dim (models/transform/dropoff_location_dim.sql)[0m
[0m21:13:50.349021 [error] [MainThread]:   Syntax error: Unexpected "(" at [18:15]
[0m21:13:50.350787 [error] [MainThread]:   compiled Code at target/run/uber/models/transform/dropoff_location_dim.sql
[0m21:13:50.351972 [info ] [MainThread]: 
[0m21:13:50.353023 [error] [MainThread]: [33mDatabase Error in model payment_type_dim (models/transform/payment_type_dim.sql)[0m
[0m21:13:50.353879 [error] [MainThread]:   Syntax error: Unexpected "(" at [18:15]
[0m21:13:50.354644 [error] [MainThread]:   compiled Code at target/run/uber/models/transform/payment_type_dim.sql
[0m21:13:50.355386 [info ] [MainThread]: 
[0m21:13:50.356194 [error] [MainThread]: [33mDatabase Error in model pickup_location_dim (models/transform/pickup_location_dim.sql)[0m
[0m21:13:50.356937 [error] [MainThread]:   Syntax error: Unexpected "(" at [18:15]
[0m21:13:50.357721 [error] [MainThread]:   compiled Code at target/run/uber/models/transform/pickup_location_dim.sql
[0m21:13:50.358373 [info ] [MainThread]: 
[0m21:13:50.358955 [error] [MainThread]: [33mDatabase Error in model rate_code_dim (models/transform/rate_code_dim.sql)[0m
[0m21:13:50.359600 [error] [MainThread]:   Syntax error: Unexpected "(" at [18:15]
[0m21:13:50.360175 [error] [MainThread]:   compiled Code at target/run/uber/models/transform/rate_code_dim.sql
[0m21:13:50.360755 [info ] [MainThread]: 
[0m21:13:50.361399 [error] [MainThread]: [33mDatabase Error in model trip_distance (models/transform/trip_distance.sql)[0m
[0m21:13:50.362066 [error] [MainThread]:   Syntax error: Unexpected "(" at [18:15]
[0m21:13:50.362917 [error] [MainThread]:   compiled Code at target/run/uber/models/transform/trip_distance.sql
[0m21:13:50.363703 [info ] [MainThread]: 
[0m21:13:50.364484 [info ] [MainThread]: Done. PASS=2 WARN=0 ERROR=5 SKIP=0 TOTAL=7
[0m21:13:50.365948 [debug] [MainThread]: Command `dbt run` failed at 21:13:50.365735 after 18.22 seconds
[0m21:13:50.367122 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffa3a020d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffa383b450>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffa3d28f10>]}
[0m21:13:50.367858 [debug] [MainThread]: Flushing usage events
[0m21:16:45.038006 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffa90171d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffa8e35550>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffa92b5690>]}


============================== 21:16:45.043238 | 0758f3ed-dc8c-499d-8598-8f8c93cb810c ==============================
[0m21:16:45.043238 [info ] [MainThread]: Running with dbt=1.5.9
[0m21:16:45.044102 [debug] [MainThread]: running dbt with arguments {'partial_parse': 'True', 'log_format': 'default', 'quiet': 'False', 'no_print': 'None', 'version_check': 'True', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'use_experimental_parser': 'False', 'send_anonymous_usage_stats': 'True', 'static_parser': 'True', 'printer_width': '80', 'write_json': 'True', 'debug': 'False', 'log_cache_events': 'False', 'cache_selected_only': 'False', 'warn_error': 'None', 'target_path': 'None', 'fail_fast': 'False', 'log_path': '/usr/local/airflow/include/dbt/logs', 'profiles_dir': '/usr/local/airflow/include/dbt/', 'indirect_selection': 'eager', 'introspect': 'True', 'use_colors': 'True'}
[0m21:16:45.442964 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '0758f3ed-dc8c-499d-8598-8f8c93cb810c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffa87d0790>]}
[0m21:16:45.454555 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '0758f3ed-dc8c-499d-8598-8f8c93cb810c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffa6df2b50>]}
[0m21:16:45.455377 [info ] [MainThread]: Registered adapter: bigquery=1.5.3
[0m21:16:45.471016 [debug] [MainThread]: checksum: dd837546c89c9d03f3c2cb0ca6165266a30da6076d5d44e9991f7c5a8e5f5831, vars: {}, profile: , target: , version: 1.5.9
[0m21:16:45.534366 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m21:16:45.535530 [debug] [MainThread]: Partial parsing: updated file: uber://models/transform/trip_distance.sql
[0m21:16:45.557032 [debug] [MainThread]: 1603: static parser failed on transform/trip_distance.sql
[0m21:16:45.562086 [error] [MainThread]: Encountered an error:
Compilation Error in model trip_distance (models/transform/trip_distance.sql)
  macro 'dbt_macro__generate_series' takes not more than 1 argument(s)
[0m21:16:45.563349 [debug] [MainThread]: Command `dbt run` failed at 21:16:45.563207 after 0.53 seconds
[0m21:16:45.563941 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffa9001290>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffa6c51010>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffa6bfcf90>]}
[0m21:16:45.564539 [debug] [MainThread]: Flushing usage events
[0m21:49:54.892139 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffb9bc6150>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffb9c257d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffb9e93410>]}


============================== 21:49:54.901305 | 4691e881-1698-4dee-b639-746c82fe90b7 ==============================
[0m21:49:54.901305 [info ] [MainThread]: Running with dbt=1.5.9
[0m21:49:54.903432 [debug] [MainThread]: running dbt with arguments {'log_path': '/usr/local/airflow/include/dbt/logs', 'use_experimental_parser': 'False', 'indirect_selection': 'eager', 'no_print': 'None', 'target_path': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'log_cache_events': 'False', 'warn_error': 'None', 'introspect': 'True', 'use_colors': 'True', 'static_parser': 'True', 'write_json': 'True', 'partial_parse': 'True', 'send_anonymous_usage_stats': 'True', 'profiles_dir': '/usr/local/airflow/include/dbt/', 'cache_selected_only': 'False', 'debug': 'False', 'quiet': 'False', 'printer_width': '80', 'version_check': 'True', 'log_format': 'default', 'fail_fast': 'False'}
[0m21:49:55.681931 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '4691e881-1698-4dee-b639-746c82fe90b7', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffb7b4c310>]}
[0m21:49:55.695311 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '4691e881-1698-4dee-b639-746c82fe90b7', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffb9e93810>]}
[0m21:49:55.696419 [info ] [MainThread]: Registered adapter: bigquery=1.5.3
[0m21:49:55.718597 [debug] [MainThread]: checksum: dd837546c89c9d03f3c2cb0ca6165266a30da6076d5d44e9991f7c5a8e5f5831, vars: {}, profile: , target: , version: 1.5.9
[0m21:49:55.904336 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 3 files changed.
[0m21:49:55.916294 [debug] [MainThread]: Partial parsing: updated file: uber://models/transform/dropoff_location_dim.sql
[0m21:49:55.921368 [debug] [MainThread]: Partial parsing: updated file: uber://models/transform/trip_distance.sql
[0m21:49:55.924858 [debug] [MainThread]: Partial parsing: updated file: uber://models/transform/passenger_count_dim.sql
[0m21:49:55.987186 [debug] [MainThread]: 1603: static parser failed on transform/dropoff_location_dim.sql
[0m21:49:56.079730 [debug] [MainThread]: 1602: parser fallback to jinja rendering on transform/dropoff_location_dim.sql
[0m21:49:56.084121 [debug] [MainThread]: 1603: static parser failed on transform/trip_distance.sql
[0m21:49:56.095007 [error] [MainThread]: Encountered an error:
Compilation Error in model trip_distance (models/transform/trip_distance.sql)
  macro 'dbt_macro__generate_series' takes not more than 1 argument(s)
[0m21:49:56.098387 [debug] [MainThread]: Command `dbt run` failed at 21:49:56.097848 after 1.22 seconds
[0m21:49:56.099931 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffb9d7df90>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffb9a40f90>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffb7a63090>]}
[0m21:49:56.101316 [debug] [MainThread]: Flushing usage events
[0m21:50:46.564685 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff85bb3ed0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff85bb1350>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff85349350>]}


============================== 21:50:46.571073 | 737de5ae-b0a3-40bb-95b7-f095afb24ff0 ==============================
[0m21:50:46.571073 [info ] [MainThread]: Running with dbt=1.5.9
[0m21:50:46.572509 [debug] [MainThread]: running dbt with arguments {'send_anonymous_usage_stats': 'True', 'target_path': 'None', 'quiet': 'False', 'indirect_selection': 'eager', 'printer_width': '80', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'use_experimental_parser': 'False', 'introspect': 'True', 'log_format': 'default', 'no_print': 'None', 'static_parser': 'True', 'warn_error': 'None', 'cache_selected_only': 'False', 'profiles_dir': '/usr/local/airflow/include/dbt/', 'version_check': 'True', 'write_json': 'True', 'debug': 'False', 'partial_parse': 'True', 'log_path': '/usr/local/airflow/include/dbt/logs', 'use_colors': 'True', 'log_cache_events': 'False', 'fail_fast': 'False'}
[0m21:50:47.136608 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '737de5ae-b0a3-40bb-95b7-f095afb24ff0', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff83829010>]}
[0m21:50:47.154178 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '737de5ae-b0a3-40bb-95b7-f095afb24ff0', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff83829290>]}
[0m21:50:47.156807 [info ] [MainThread]: Registered adapter: bigquery=1.5.3
[0m21:50:47.194343 [debug] [MainThread]: checksum: dd837546c89c9d03f3c2cb0ca6165266a30da6076d5d44e9991f7c5a8e5f5831, vars: {}, profile: , target: , version: 1.5.9
[0m21:50:47.314072 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 3 files changed.
[0m21:50:47.316085 [debug] [MainThread]: Partial parsing: updated file: uber://models/transform/trip_distance.sql
[0m21:50:47.317729 [debug] [MainThread]: Partial parsing: updated file: uber://models/transform/dropoff_location_dim.sql
[0m21:50:47.319180 [debug] [MainThread]: Partial parsing: updated file: uber://models/transform/passenger_count_dim.sql
[0m21:50:47.362814 [debug] [MainThread]: 1603: static parser failed on transform/trip_distance.sql
[0m21:50:47.368447 [error] [MainThread]: Encountered an error:
Compilation Error in model trip_distance (models/transform/trip_distance.sql)
  unexpected '}'
    line 3
      {{ dbt_utils.generate_surrogate_key([])} as trip_distance_id,
[0m21:50:47.370819 [debug] [MainThread]: Command `dbt run` failed at 21:50:47.370398 after 0.82 seconds
[0m21:50:47.371883 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff8577f890>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff8541a190>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff85771a90>]}
[0m21:50:47.372810 [debug] [MainThread]: Flushing usage events
[0m21:51:02.566898 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff7bbfdc10>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff7bdb9ad0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff7bbeb390>]}


============================== 21:51:02.574954 | 3f8fca31-a929-4cda-a0e2-776cf63e3adc ==============================
[0m21:51:02.574954 [info ] [MainThread]: Running with dbt=1.5.9
[0m21:51:02.576815 [debug] [MainThread]: running dbt with arguments {'quiet': 'False', 'profiles_dir': '/usr/local/airflow/include/dbt/', 'cache_selected_only': 'False', 'fail_fast': 'False', 'send_anonymous_usage_stats': 'True', 'introspect': 'True', 'warn_error': 'None', 'use_experimental_parser': 'False', 'use_colors': 'True', 'log_format': 'default', 'partial_parse': 'True', 'no_print': 'None', 'debug': 'False', 'printer_width': '80', 'target_path': 'None', 'version_check': 'True', 'log_cache_events': 'False', 'log_path': '/usr/local/airflow/include/dbt/logs', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'static_parser': 'True', 'indirect_selection': 'eager', 'write_json': 'True'}
[0m21:51:03.075392 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '3f8fca31-a929-4cda-a0e2-776cf63e3adc', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff79b88290>]}
[0m21:51:03.087759 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '3f8fca31-a929-4cda-a0e2-776cf63e3adc', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff79b88110>]}
[0m21:51:03.088802 [info ] [MainThread]: Registered adapter: bigquery=1.5.3
[0m21:51:03.104303 [debug] [MainThread]: checksum: dd837546c89c9d03f3c2cb0ca6165266a30da6076d5d44e9991f7c5a8e5f5831, vars: {}, profile: , target: , version: 1.5.9
[0m21:51:03.182689 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 3 files changed.
[0m21:51:03.183600 [debug] [MainThread]: Partial parsing: updated file: uber://models/transform/dropoff_location_dim.sql
[0m21:51:03.184238 [debug] [MainThread]: Partial parsing: updated file: uber://models/transform/passenger_count_dim.sql
[0m21:51:03.184832 [debug] [MainThread]: Partial parsing: updated file: uber://models/transform/trip_distance.sql
[0m21:51:03.204550 [debug] [MainThread]: 1603: static parser failed on transform/dropoff_location_dim.sql
[0m21:51:03.228836 [debug] [MainThread]: 1602: parser fallback to jinja rendering on transform/dropoff_location_dim.sql
[0m21:51:03.231326 [debug] [MainThread]: 1603: static parser failed on transform/passenger_count_dim.sql
[0m21:51:03.236557 [debug] [MainThread]: 1602: parser fallback to jinja rendering on transform/passenger_count_dim.sql
[0m21:51:03.238460 [debug] [MainThread]: 1603: static parser failed on transform/trip_distance.sql
[0m21:51:03.243896 [debug] [MainThread]: 1602: parser fallback to jinja rendering on transform/trip_distance.sql
[0m21:51:03.258604 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '3f8fca31-a929-4cda-a0e2-776cf63e3adc', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff799f8c50>]}
[0m21:51:03.273268 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '3f8fca31-a929-4cda-a0e2-776cf63e3adc', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff79a34210>]}
[0m21:51:03.274047 [info ] [MainThread]: Found 7 models, 0 tests, 0 snapshots, 0 analyses, 474 macros, 0 operations, 0 seed files, 1 source, 0 exposures, 0 metrics, 0 groups
[0m21:51:03.275115 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '3f8fca31-a929-4cda-a0e2-776cf63e3adc', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff7ea9f6d0>]}
[0m21:51:03.277052 [info ] [MainThread]: 
[0m21:51:03.278995 [debug] [MainThread]: Acquiring new bigquery connection 'master'
[0m21:51:03.282947 [debug] [ThreadPool]: Acquiring new bigquery connection 'list_uber-data-engineering-407103'
[0m21:51:03.284061 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m21:51:05.929395 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_uber-data-engineering-407103, now list_uber-data-engineering-407103_uber)
[0m21:51:05.933773 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m21:51:07.560711 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '3f8fca31-a929-4cda-a0e2-776cf63e3adc', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff7bf1a190>]}
[0m21:51:07.565895 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m21:51:07.569494 [info ] [MainThread]: 
[0m21:51:07.616997 [debug] [Thread-1 (]: Began running node model.uber.datetime_dim
[0m21:51:07.618924 [info ] [Thread-1 (]: 1 of 7 START sql table model uber.datetime_dim ................................. [RUN]
[0m21:51:07.621085 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_uber-data-engineering-407103_uber, now model.uber.datetime_dim)
[0m21:51:07.623027 [debug] [Thread-1 (]: Began compiling node model.uber.datetime_dim
[0m21:51:07.637102 [debug] [Thread-1 (]: Writing injected SQL for node "model.uber.datetime_dim"
[0m21:51:07.641509 [debug] [Thread-1 (]: Timing info for model.uber.datetime_dim (compile): 21:51:07.623857 => 21:51:07.641065
[0m21:51:07.642299 [debug] [Thread-1 (]: Began executing node model.uber.datetime_dim
[0m21:51:07.660796 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m21:51:08.481322 [debug] [Thread-1 (]: Writing runtime sql for node "model.uber.datetime_dim"
[0m21:51:08.485677 [debug] [Thread-1 (]: On model.uber.datetime_dim: /* {"app": "dbt", "dbt_version": "1.5.9", "profile_name": "uber", "target_name": "dev", "node_id": "model.uber.datetime_dim"} */

  
    

    create or replace table `uber-data-engineering-407103`.`uber`.`datetime_dim`
    
    

    OPTIONS()
    as (
      WITH datetime_cte AS (  
  SELECT DISTINCT
    tpep_pickup_datetime AS datetime_id,
    CASE
      WHEN LENGTH(tpep_pickup_datetime) = 16 THEN
        -- Date format: "DD/MM/YYYY HH:MM"
        PARSE_DATETIME('%m/%d/%Y %H:%M', tpep_pickup_datetime)
      WHEN LENGTH(tpep_pickup_datetime) <= 14 THEN
        -- Date format: "MM/DD/YY HH:MM"
        PARSE_DATETIME('%m/%d/%y %H:%M', tpep_pickup_datetime)
      ELSE
        NULL
    END AS pick_date_part,
    tpep_dropoff_datetime AS drop_datetime_id,
    CASE
      WHEN LENGTH(tpep_dropoff_datetime) = 16 THEN
        -- Date format: "DD/MM/YYYY HH:MM"
        PARSE_DATETIME('%m/%d/%Y %H:%M', tpep_dropoff_datetime)
      WHEN LENGTH(tpep_dropoff_datetime) <= 14 THEN
        -- Date format: "MM/DD/YY HH:MM"
        PARSE_DATETIME('%m/%d/%y %H:%M', tpep_dropoff_datetime)
      ELSE
        NULL
    END AS drop_date_part
  FROM `uber-data-engineering-407103`.`uber`.`uber_tlc_trip_recrord_data`
  WHERE tpep_pickup_datetime IS NOT NULL
    AND tpep_dropoff_datetime IS NOT NULL
)
SELECT
  datetime_id,
  pick_date_part AS tpep_pickup_datetime,
  drop_date_part AS tpep_dropoff_datetime,
  EXTRACT(HOUR FROM pick_date_part) AS pick_hour,
  EXTRACT(DAY FROM pick_date_part) AS pick_day,
  EXTRACT(MONTH FROM pick_date_part) AS pick_month,
  EXTRACT(YEAR FROM pick_date_part) AS pick_year,
  EXTRACT(DAYOFWEEK FROM pick_date_part) AS pick_weekday,
  EXTRACT(HOUR FROM drop_date_part) AS drop_hour,
  EXTRACT(DAY FROM drop_date_part) AS drop_day,
  EXTRACT(MONTH FROM drop_date_part) AS drop_month,
  EXTRACT(YEAR FROM drop_date_part) AS drop_year,
  EXTRACT(DAYOFWEEK FROM drop_date_part) AS drop_weekday
FROM datetime_cte
    );
  
[0m21:51:11.437866 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=uber-data-engineering-407103&j=bq:US:c6d438f1-f808-442e-9da3-9d224fff55df&page=queryresults
[0m21:51:11.463658 [debug] [Thread-1 (]: Timing info for model.uber.datetime_dim (execute): 21:51:07.642765 => 21:51:11.463178
[0m21:51:11.465823 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '3f8fca31-a929-4cda-a0e2-776cf63e3adc', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff799fdcd0>]}
[0m21:51:11.467503 [info ] [Thread-1 (]: 1 of 7 OK created sql table model uber.datetime_dim ............................ [[32mCREATE TABLE (99.9k rows, 4.0 MiB processed)[0m in 3.84s]
[0m21:51:11.469231 [debug] [Thread-1 (]: Finished running node model.uber.datetime_dim
[0m21:51:11.470331 [debug] [Thread-1 (]: Began running node model.uber.dropoff_location_dim
[0m21:51:11.471929 [info ] [Thread-1 (]: 2 of 7 START sql table model uber.dropoff_location_dim ......................... [RUN]
[0m21:51:11.473514 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.uber.datetime_dim, now model.uber.dropoff_location_dim)
[0m21:51:11.474367 [debug] [Thread-1 (]: Began compiling node model.uber.dropoff_location_dim
[0m21:51:11.482398 [debug] [Thread-1 (]: Writing injected SQL for node "model.uber.dropoff_location_dim"
[0m21:51:11.486660 [debug] [Thread-1 (]: Timing info for model.uber.dropoff_location_dim (compile): 21:51:11.474927 => 21:51:11.486433
[0m21:51:11.487384 [debug] [Thread-1 (]: Began executing node model.uber.dropoff_location_dim
[0m21:51:11.491447 [debug] [Thread-1 (]: Writing runtime sql for node "model.uber.dropoff_location_dim"
[0m21:51:11.494165 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m21:51:11.499129 [debug] [Thread-1 (]: On model.uber.dropoff_location_dim: /* {"app": "dbt", "dbt_version": "1.5.9", "profile_name": "uber", "target_name": "dev", "node_id": "model.uber.dropoff_location_dim"} */

  
    

    create or replace table `uber-data-engineering-407103`.`uber`.`dropoff_location_dim`
    
    

    OPTIONS()
    as (
      WITH numbered_rows AS (
  SELECT
    to_hex(md5(cast( as STRING))) as dropoff_location_id,
    dropoff_latitude AS dropoff_latitude,
    dropoff_longitude AS dropoff_longitude,
    ROW_NUMBER() OVER (ORDER BY dropoff_latitude, dropoff_longitude) as row_num
  FROM `uber-data-engineering-407103`.`uber`.`uber_tlc_trip_recrord_data`
)
SELECT
  dropoff_location_id,
  dropoff_latitude,
  dropoff_longitude
FROM numbered_rows
    );
  
[0m21:51:12.130536 [debug] [Thread-1 (]: BigQuery adapter: Retry attempt 1 of 1 after error: BadRequest('Syntax error: Unexpected keyword AS at [14:22]')
[0m21:51:13.120219 [error] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=uber-data-engineering-407103&j=bq:US:0e3ea67c-c01c-4c72-8c25-af02f3c69e42&page=queryresults
[0m21:51:13.123864 [debug] [Thread-1 (]: Timing info for model.uber.dropoff_location_dim (execute): 21:51:11.487786 => 21:51:13.123355
[0m21:51:13.143392 [debug] [Thread-1 (]: Database Error in model dropoff_location_dim (models/transform/dropoff_location_dim.sql)
  Syntax error: Unexpected keyword AS at [14:22]
  compiled Code at target/run/uber/models/transform/dropoff_location_dim.sql
[0m21:51:13.144849 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '3f8fca31-a929-4cda-a0e2-776cf63e3adc', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff799aa450>]}
[0m21:51:13.146941 [error] [Thread-1 (]: 2 of 7 ERROR creating sql table model uber.dropoff_location_dim ................ [[31mERROR[0m in 1.67s]
[0m21:51:13.148175 [debug] [Thread-1 (]: Finished running node model.uber.dropoff_location_dim
[0m21:51:13.148848 [debug] [Thread-1 (]: Began running node model.uber.passenger_count_dim
[0m21:51:13.149828 [info ] [Thread-1 (]: 3 of 7 START sql table model uber.passenger_count_dim .......................... [RUN]
[0m21:51:13.151349 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.uber.dropoff_location_dim, now model.uber.passenger_count_dim)
[0m21:51:13.152021 [debug] [Thread-1 (]: Began compiling node model.uber.passenger_count_dim
[0m21:51:13.156429 [debug] [Thread-1 (]: Writing injected SQL for node "model.uber.passenger_count_dim"
[0m21:51:13.161339 [debug] [Thread-1 (]: Timing info for model.uber.passenger_count_dim (compile): 21:51:13.152469 => 21:51:13.160555
[0m21:51:13.162176 [debug] [Thread-1 (]: Began executing node model.uber.passenger_count_dim
[0m21:51:13.165786 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m21:51:13.690615 [debug] [Thread-1 (]: Writing runtime sql for node "model.uber.passenger_count_dim"
[0m21:51:13.694907 [debug] [Thread-1 (]: On model.uber.passenger_count_dim: /* {"app": "dbt", "dbt_version": "1.5.9", "profile_name": "uber", "target_name": "dev", "node_id": "model.uber.passenger_count_dim"} */

  
    

    create or replace table `uber-data-engineering-407103`.`uber`.`passenger_count_dim`
    
    

    OPTIONS()
    as (
      SELECT DISTINCT
    to_hex(md5(cast( as STRING))) as passenger_count_id,
		passenger_count AS passenger_count,
FROM `uber-data-engineering-407103`.`uber`.`uber_tlc_trip_recrord_data`
WHERE passenger_count IS NOT NULL
    );
  
[0m21:51:13.867773 [debug] [Thread-1 (]: BigQuery adapter: Retry attempt 1 of 1 after error: BadRequest('Syntax error: Unexpected keyword AS at [13:22]')
[0m21:51:14.180616 [error] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=uber-data-engineering-407103&j=bq:US:52662204-6aa3-453b-a95f-793ccda08996&page=queryresults
[0m21:51:14.182811 [debug] [Thread-1 (]: Timing info for model.uber.passenger_count_dim (execute): 21:51:13.162576 => 21:51:14.182396
[0m21:51:14.190430 [debug] [Thread-1 (]: Database Error in model passenger_count_dim (models/transform/passenger_count_dim.sql)
  Syntax error: Unexpected keyword AS at [13:22]
  compiled Code at target/run/uber/models/transform/passenger_count_dim.sql
[0m21:51:14.191758 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '3f8fca31-a929-4cda-a0e2-776cf63e3adc', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff79a68890>]}
[0m21:51:14.193459 [error] [Thread-1 (]: 3 of 7 ERROR creating sql table model uber.passenger_count_dim ................. [[31mERROR[0m in 1.04s]
[0m21:51:14.195430 [debug] [Thread-1 (]: Finished running node model.uber.passenger_count_dim
[0m21:51:14.196898 [debug] [Thread-1 (]: Began running node model.uber.payment_type_dim
[0m21:51:14.198669 [info ] [Thread-1 (]: 4 of 7 START sql table model uber.payment_type_dim ............................. [RUN]
[0m21:51:14.203670 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.uber.passenger_count_dim, now model.uber.payment_type_dim)
[0m21:51:14.205754 [debug] [Thread-1 (]: Began compiling node model.uber.payment_type_dim
[0m21:51:14.229149 [debug] [Thread-1 (]: Writing injected SQL for node "model.uber.payment_type_dim"
[0m21:51:14.234343 [debug] [Thread-1 (]: Timing info for model.uber.payment_type_dim (compile): 21:51:14.207272 => 21:51:14.233435
[0m21:51:14.235951 [debug] [Thread-1 (]: Began executing node model.uber.payment_type_dim
[0m21:51:14.246095 [debug] [Thread-1 (]: Writing runtime sql for node "model.uber.payment_type_dim"
[0m21:51:14.251461 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m21:51:14.256544 [debug] [Thread-1 (]: On model.uber.payment_type_dim: /* {"app": "dbt", "dbt_version": "1.5.9", "profile_name": "uber", "target_name": "dev", "node_id": "model.uber.payment_type_dim"} */

  
    

    create or replace table `uber-data-engineering-407103`.`uber`.`payment_type_dim`
    
    

    OPTIONS()
    as (
      WITH numbered_rows AS (
  SELECT
    

    

    with p as (
        select 0 as generated_number union all select 1
    ), unioned as (

    select

    
    p0.generated_number * power(2, 0)
    
    
    + 1
    as generated_number

    from

    
    p as p0
    
    

    )

    select *
    from unioned
    where generated_number <= 1
    order by generated_number

 as payment_type_id,
    payment_type AS payment_type,
    ROW_NUMBER() OVER (ORDER BY payment_type) as row_num
  FROM `uber-data-engineering-407103`.`uber`.`uber_tlc_trip_recrord_data`
  WHERE payment_type IS NOT NULL
)
SELECT
  payment_type_id,
  payment_type
FROM numbered_rows
    );
  
[0m21:51:15.217993 [debug] [Thread-1 (]: BigQuery adapter: Retry attempt 1 of 1 after error: BadRequest('Syntax error: Unexpected "(" at [18:15]')
[0m21:51:15.727636 [error] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=uber-data-engineering-407103&j=bq:US:d60bd39b-fd85-450e-b6b7-a00f68091413&page=queryresults
[0m21:51:15.729793 [debug] [Thread-1 (]: Timing info for model.uber.payment_type_dim (execute): 21:51:14.237050 => 21:51:15.729386
[0m21:51:15.736361 [debug] [Thread-1 (]: Database Error in model payment_type_dim (models/transform/payment_type_dim.sql)
  Syntax error: Unexpected "(" at [18:15]
  compiled Code at target/run/uber/models/transform/payment_type_dim.sql
[0m21:51:15.737995 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '3f8fca31-a929-4cda-a0e2-776cf63e3adc', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff78717a90>]}
[0m21:51:15.739983 [error] [Thread-1 (]: 4 of 7 ERROR creating sql table model uber.payment_type_dim .................... [[31mERROR[0m in 1.53s]
[0m21:51:15.741156 [debug] [Thread-1 (]: Finished running node model.uber.payment_type_dim
[0m21:51:15.742144 [debug] [Thread-1 (]: Began running node model.uber.pickup_location_dim
[0m21:51:15.743715 [info ] [Thread-1 (]: 5 of 7 START sql table model uber.pickup_location_dim .......................... [RUN]
[0m21:51:15.744913 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.uber.payment_type_dim, now model.uber.pickup_location_dim)
[0m21:51:15.745516 [debug] [Thread-1 (]: Began compiling node model.uber.pickup_location_dim
[0m21:51:15.755695 [debug] [Thread-1 (]: Writing injected SQL for node "model.uber.pickup_location_dim"
[0m21:51:15.758518 [debug] [Thread-1 (]: Timing info for model.uber.pickup_location_dim (compile): 21:51:15.746004 => 21:51:15.758288
[0m21:51:15.759122 [debug] [Thread-1 (]: Began executing node model.uber.pickup_location_dim
[0m21:51:15.772528 [debug] [Thread-1 (]: Writing runtime sql for node "model.uber.pickup_location_dim"
[0m21:51:15.776179 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m21:51:15.778877 [debug] [Thread-1 (]: On model.uber.pickup_location_dim: /* {"app": "dbt", "dbt_version": "1.5.9", "profile_name": "uber", "target_name": "dev", "node_id": "model.uber.pickup_location_dim"} */

  
    

    create or replace table `uber-data-engineering-407103`.`uber`.`pickup_location_dim`
    
    

    OPTIONS()
    as (
      WITH numbered_rows AS (
  SELECT
    

    

    with p as (
        select 0 as generated_number union all select 1
    ), unioned as (

    select

    
    p0.generated_number * power(2, 0)
    
    
    + 1
    as generated_number

    from

    
    p as p0
    
    

    )

    select *
    from unioned
    where generated_number <= 1
    order by generated_number

 as pickup_location_id,
    pickup_latitude AS pickup_latitude,
    pickup_longitude AS pickup_longitude,
    ROW_NUMBER() OVER (ORDER BY pickup_latitude, pickup_longitude) as row_num
  FROM `uber-data-engineering-407103`.`uber`.`uber_tlc_trip_recrord_data`
)
SELECT
  pickup_location_id,
  pickup_latitude,
  pickup_longitude
FROM numbered_rows
    );
  
[0m21:51:16.300273 [debug] [Thread-1 (]: BigQuery adapter: Retry attempt 1 of 1 after error: BadRequest('Syntax error: Unexpected "(" at [18:15]')
[0m21:51:16.815538 [error] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=uber-data-engineering-407103&j=bq:US:559690d7-34e1-4273-a53f-330395982049&page=queryresults
[0m21:51:16.818273 [debug] [Thread-1 (]: Timing info for model.uber.pickup_location_dim (execute): 21:51:15.759551 => 21:51:16.817642
[0m21:51:16.825012 [debug] [Thread-1 (]: Database Error in model pickup_location_dim (models/transform/pickup_location_dim.sql)
  Syntax error: Unexpected "(" at [18:15]
  compiled Code at target/run/uber/models/transform/pickup_location_dim.sql
[0m21:51:16.826801 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '3f8fca31-a929-4cda-a0e2-776cf63e3adc', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff7873aa90>]}
[0m21:51:16.828868 [error] [Thread-1 (]: 5 of 7 ERROR creating sql table model uber.pickup_location_dim ................. [[31mERROR[0m in 1.08s]
[0m21:51:16.831170 [debug] [Thread-1 (]: Finished running node model.uber.pickup_location_dim
[0m21:51:16.832619 [debug] [Thread-1 (]: Began running node model.uber.rate_code_dim
[0m21:51:16.833954 [info ] [Thread-1 (]: 6 of 7 START sql table model uber.rate_code_dim ................................ [RUN]
[0m21:51:16.836021 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.uber.pickup_location_dim, now model.uber.rate_code_dim)
[0m21:51:16.837173 [debug] [Thread-1 (]: Began compiling node model.uber.rate_code_dim
[0m21:51:16.847782 [debug] [Thread-1 (]: Writing injected SQL for node "model.uber.rate_code_dim"
[0m21:51:16.851612 [debug] [Thread-1 (]: Timing info for model.uber.rate_code_dim (compile): 21:51:16.837928 => 21:51:16.851099
[0m21:51:16.852590 [debug] [Thread-1 (]: Began executing node model.uber.rate_code_dim
[0m21:51:16.857082 [debug] [Thread-1 (]: Writing runtime sql for node "model.uber.rate_code_dim"
[0m21:51:16.861522 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m21:51:16.866804 [debug] [Thread-1 (]: On model.uber.rate_code_dim: /* {"app": "dbt", "dbt_version": "1.5.9", "profile_name": "uber", "target_name": "dev", "node_id": "model.uber.rate_code_dim"} */

  
    

    create or replace table `uber-data-engineering-407103`.`uber`.`rate_code_dim`
    
    

    OPTIONS()
    as (
      WITH numbered_rows AS (
  SELECT
    

    

    with p as (
        select 0 as generated_number union all select 1
    ), unioned as (

    select

    
    p0.generated_number * power(2, 0)
    
    
    + 1
    as generated_number

    from

    
    p as p0
    
    

    )

    select *
    from unioned
    where generated_number <= 1
    order by generated_number

 as rate_code_id,
    RatecodeID AS RatecodeID,
    ROW_NUMBER() OVER (ORDER BY RatecodeID) as row_num
  FROM `uber-data-engineering-407103`.`uber`.`uber_tlc_trip_recrord_data`
  WHERE RatecodeID IS NOT NULL
)
SELECT
  rate_code_id,
  rate_code
FROM numbered_rows
    );
  
[0m21:51:17.949479 [debug] [Thread-1 (]: BigQuery adapter: Retry attempt 1 of 1 after error: BadRequest('Syntax error: Unexpected "(" at [18:15]')
[0m21:51:18.615586 [error] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=uber-data-engineering-407103&j=bq:US:e9a51961-5bfe-4dd6-b314-8b85a489b3d1&page=queryresults
[0m21:51:18.620826 [debug] [Thread-1 (]: Timing info for model.uber.rate_code_dim (execute): 21:51:16.853299 => 21:51:18.620069
[0m21:51:18.628995 [debug] [Thread-1 (]: Database Error in model rate_code_dim (models/transform/rate_code_dim.sql)
  Syntax error: Unexpected "(" at [18:15]
  compiled Code at target/run/uber/models/transform/rate_code_dim.sql
[0m21:51:18.631132 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '3f8fca31-a929-4cda-a0e2-776cf63e3adc', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff787383d0>]}
[0m21:51:18.635941 [error] [Thread-1 (]: 6 of 7 ERROR creating sql table model uber.rate_code_dim ....................... [[31mERROR[0m in 1.79s]
[0m21:51:18.641199 [debug] [Thread-1 (]: Finished running node model.uber.rate_code_dim
[0m21:51:18.644239 [debug] [Thread-1 (]: Began running node model.uber.trip_distance
[0m21:51:18.648143 [info ] [Thread-1 (]: 7 of 7 START sql table model uber.trip_distance ................................ [RUN]
[0m21:51:18.651157 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.uber.rate_code_dim, now model.uber.trip_distance)
[0m21:51:18.653740 [debug] [Thread-1 (]: Began compiling node model.uber.trip_distance
[0m21:51:18.674325 [debug] [Thread-1 (]: Writing injected SQL for node "model.uber.trip_distance"
[0m21:51:18.680793 [debug] [Thread-1 (]: Timing info for model.uber.trip_distance (compile): 21:51:18.655306 => 21:51:18.680333
[0m21:51:18.681643 [debug] [Thread-1 (]: Began executing node model.uber.trip_distance
[0m21:51:18.686280 [debug] [Thread-1 (]: Writing runtime sql for node "model.uber.trip_distance"
[0m21:51:18.688845 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m21:51:18.692347 [debug] [Thread-1 (]: On model.uber.trip_distance: /* {"app": "dbt", "dbt_version": "1.5.9", "profile_name": "uber", "target_name": "dev", "node_id": "model.uber.trip_distance"} */

  
    

    create or replace table `uber-data-engineering-407103`.`uber`.`trip_distance`
    
    

    OPTIONS()
    as (
      WITH numbered_rows AS (
  SELECT
    to_hex(md5(cast( as STRING))) as trip_distance_id,
    trip_distance AS trip_distance,
    ROW_NUMBER() OVER (ORDER BY trip_distance) as row_num
  FROM `uber-data-engineering-407103`.`uber`.`uber_tlc_trip_recrord_data`
  WHERE trip_distance IS NOT NULL
)
SELECT
  trip_distance_id,
  trip_distance
FROM numbered_rows
    );
  
[0m21:51:19.397547 [debug] [Thread-1 (]: BigQuery adapter: Retry attempt 1 of 1 after error: BadRequest('Syntax error: Unexpected keyword AS at [14:22]')
[0m21:51:20.276984 [error] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=uber-data-engineering-407103&j=bq:US:cd7380bd-36b8-47ca-8d0e-e272fff426fb&page=queryresults
[0m21:51:20.279736 [debug] [Thread-1 (]: Timing info for model.uber.trip_distance (execute): 21:51:18.682231 => 21:51:20.279277
[0m21:51:20.286650 [debug] [Thread-1 (]: Database Error in model trip_distance (models/transform/trip_distance.sql)
  Syntax error: Unexpected keyword AS at [14:22]
  compiled Code at target/run/uber/models/transform/trip_distance.sql
[0m21:51:20.288527 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '3f8fca31-a929-4cda-a0e2-776cf63e3adc', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff79a46150>]}
[0m21:51:20.290207 [error] [Thread-1 (]: 7 of 7 ERROR creating sql table model uber.trip_distance ....................... [[31mERROR[0m in 1.64s]
[0m21:51:20.291498 [debug] [Thread-1 (]: Finished running node model.uber.trip_distance
[0m21:51:20.302241 [debug] [MainThread]: Connection 'master' was properly closed.
[0m21:51:20.303380 [debug] [MainThread]: Connection 'model.uber.trip_distance' was properly closed.
[0m21:51:20.304920 [info ] [MainThread]: 
[0m21:51:20.307399 [info ] [MainThread]: Finished running 7 table models in 0 hours 0 minutes and 17.03 seconds (17.03s).
[0m21:51:20.310661 [debug] [MainThread]: Command end result
[0m21:51:20.335212 [info ] [MainThread]: 
[0m21:51:20.336756 [info ] [MainThread]: [31mCompleted with 6 errors and 0 warnings:[0m
[0m21:51:20.337807 [info ] [MainThread]: 
[0m21:51:20.339304 [error] [MainThread]: [33mDatabase Error in model dropoff_location_dim (models/transform/dropoff_location_dim.sql)[0m
[0m21:51:20.340729 [error] [MainThread]:   Syntax error: Unexpected keyword AS at [14:22]
[0m21:51:20.342207 [error] [MainThread]:   compiled Code at target/run/uber/models/transform/dropoff_location_dim.sql
[0m21:51:20.343186 [info ] [MainThread]: 
[0m21:51:20.343889 [error] [MainThread]: [33mDatabase Error in model passenger_count_dim (models/transform/passenger_count_dim.sql)[0m
[0m21:51:20.344531 [error] [MainThread]:   Syntax error: Unexpected keyword AS at [13:22]
[0m21:51:20.345250 [error] [MainThread]:   compiled Code at target/run/uber/models/transform/passenger_count_dim.sql
[0m21:51:20.345892 [info ] [MainThread]: 
[0m21:51:20.346863 [error] [MainThread]: [33mDatabase Error in model payment_type_dim (models/transform/payment_type_dim.sql)[0m
[0m21:51:20.347548 [error] [MainThread]:   Syntax error: Unexpected "(" at [18:15]
[0m21:51:20.348244 [error] [MainThread]:   compiled Code at target/run/uber/models/transform/payment_type_dim.sql
[0m21:51:20.348945 [info ] [MainThread]: 
[0m21:51:20.349786 [error] [MainThread]: [33mDatabase Error in model pickup_location_dim (models/transform/pickup_location_dim.sql)[0m
[0m21:51:20.350451 [error] [MainThread]:   Syntax error: Unexpected "(" at [18:15]
[0m21:51:20.351056 [error] [MainThread]:   compiled Code at target/run/uber/models/transform/pickup_location_dim.sql
[0m21:51:20.352031 [info ] [MainThread]: 
[0m21:51:20.352914 [error] [MainThread]: [33mDatabase Error in model rate_code_dim (models/transform/rate_code_dim.sql)[0m
[0m21:51:20.353670 [error] [MainThread]:   Syntax error: Unexpected "(" at [18:15]
[0m21:51:20.354324 [error] [MainThread]:   compiled Code at target/run/uber/models/transform/rate_code_dim.sql
[0m21:51:20.354990 [info ] [MainThread]: 
[0m21:51:20.355543 [error] [MainThread]: [33mDatabase Error in model trip_distance (models/transform/trip_distance.sql)[0m
[0m21:51:20.356131 [error] [MainThread]:   Syntax error: Unexpected keyword AS at [14:22]
[0m21:51:20.356765 [error] [MainThread]:   compiled Code at target/run/uber/models/transform/trip_distance.sql
[0m21:51:20.357588 [info ] [MainThread]: 
[0m21:51:20.358585 [info ] [MainThread]: Done. PASS=1 WARN=0 ERROR=6 SKIP=0 TOTAL=7
[0m21:51:20.360263 [debug] [MainThread]: Command `dbt run` failed at 21:51:20.360095 after 17.81 seconds
[0m21:51:20.361107 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff7bf19190>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff7ba7a0d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff7fa4a350>]}
[0m21:51:20.361672 [debug] [MainThread]: Flushing usage events
[0m21:59:00.544050 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff931b3b90>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff92c975d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff957f3690>]}


============================== 21:59:00.549833 | 9a463ef3-919f-4b58-837e-5ca6839de367 ==============================
[0m21:59:00.549833 [info ] [MainThread]: Running with dbt=1.5.9
[0m21:59:00.550831 [debug] [MainThread]: running dbt with arguments {'write_json': 'True', 'quiet': 'False', 'indirect_selection': 'eager', 'cache_selected_only': 'False', 'log_path': '/usr/local/airflow/include/dbt/logs', 'no_print': 'None', 'debug': 'False', 'version_check': 'True', 'warn_error': 'None', 'partial_parse': 'True', 'log_cache_events': 'False', 'log_format': 'default', 'target_path': 'None', 'fail_fast': 'False', 'printer_width': '80', 'use_colors': 'True', 'profiles_dir': '/usr/local/airflow/include/dbt/', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'introspect': 'True', 'static_parser': 'True', 'send_anonymous_usage_stats': 'True', 'use_experimental_parser': 'False'}
[0m21:59:01.288306 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '9a463ef3-919f-4b58-837e-5ca6839de367', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff912939d0>]}
[0m21:59:01.302143 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '9a463ef3-919f-4b58-837e-5ca6839de367', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff9331b950>]}
[0m21:59:01.303320 [info ] [MainThread]: Registered adapter: bigquery=1.5.3
[0m21:59:01.323578 [debug] [MainThread]: checksum: dd837546c89c9d03f3c2cb0ca6165266a30da6076d5d44e9991f7c5a8e5f5831, vars: {}, profile: , target: , version: 1.5.9
[0m21:59:01.428863 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m21:59:01.429790 [debug] [MainThread]: Partial parsing: updated file: uber://models/transform/dropoff_location_dim.sql
[0m21:59:01.452204 [debug] [MainThread]: 1603: static parser failed on transform/dropoff_location_dim.sql
[0m21:59:01.474767 [debug] [MainThread]: 1602: parser fallback to jinja rendering on transform/dropoff_location_dim.sql
[0m21:59:01.491406 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '9a463ef3-919f-4b58-837e-5ca6839de367', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff9107cd10>]}
[0m21:59:01.518443 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '9a463ef3-919f-4b58-837e-5ca6839de367', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff91137050>]}
[0m21:59:01.519722 [info ] [MainThread]: Found 7 models, 0 tests, 0 snapshots, 0 analyses, 474 macros, 0 operations, 0 seed files, 1 source, 0 exposures, 0 metrics, 0 groups
[0m21:59:01.520734 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '9a463ef3-919f-4b58-837e-5ca6839de367', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff96193490>]}
[0m21:59:01.524967 [info ] [MainThread]: 
[0m21:59:01.526327 [debug] [MainThread]: Acquiring new bigquery connection 'master'
[0m21:59:01.528018 [debug] [ThreadPool]: Acquiring new bigquery connection 'list_uber-data-engineering-407103'
[0m21:59:01.528617 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m21:59:02.503740 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_uber-data-engineering-407103, now list_uber-data-engineering-407103_uber)
[0m21:59:02.506871 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m21:59:03.010127 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '9a463ef3-919f-4b58-837e-5ca6839de367', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff9105acd0>]}
[0m21:59:03.026761 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m21:59:03.031029 [info ] [MainThread]: 
[0m21:59:03.061244 [debug] [Thread-1 (]: Began running node model.uber.datetime_dim
[0m21:59:03.062320 [info ] [Thread-1 (]: 1 of 7 START sql table model uber.datetime_dim ................................. [RUN]
[0m21:59:03.063401 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_uber-data-engineering-407103_uber, now model.uber.datetime_dim)
[0m21:59:03.063996 [debug] [Thread-1 (]: Began compiling node model.uber.datetime_dim
[0m21:59:03.073864 [debug] [Thread-1 (]: Writing injected SQL for node "model.uber.datetime_dim"
[0m21:59:03.078215 [debug] [Thread-1 (]: Timing info for model.uber.datetime_dim (compile): 21:59:03.064462 => 21:59:03.077672
[0m21:59:03.079143 [debug] [Thread-1 (]: Began executing node model.uber.datetime_dim
[0m21:59:03.095264 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m21:59:03.623963 [debug] [Thread-1 (]: Writing runtime sql for node "model.uber.datetime_dim"
[0m21:59:03.626935 [debug] [Thread-1 (]: On model.uber.datetime_dim: /* {"app": "dbt", "dbt_version": "1.5.9", "profile_name": "uber", "target_name": "dev", "node_id": "model.uber.datetime_dim"} */

  
    

    create or replace table `uber-data-engineering-407103`.`uber`.`datetime_dim`
    
    

    OPTIONS()
    as (
      WITH datetime_cte AS (  
  SELECT DISTINCT
    tpep_pickup_datetime AS datetime_id,
    CASE
      WHEN LENGTH(tpep_pickup_datetime) = 16 THEN
        -- Date format: "DD/MM/YYYY HH:MM"
        PARSE_DATETIME('%m/%d/%Y %H:%M', tpep_pickup_datetime)
      WHEN LENGTH(tpep_pickup_datetime) <= 14 THEN
        -- Date format: "MM/DD/YY HH:MM"
        PARSE_DATETIME('%m/%d/%y %H:%M', tpep_pickup_datetime)
      ELSE
        NULL
    END AS pick_date_part,
    tpep_dropoff_datetime AS drop_datetime_id,
    CASE
      WHEN LENGTH(tpep_dropoff_datetime) = 16 THEN
        -- Date format: "DD/MM/YYYY HH:MM"
        PARSE_DATETIME('%m/%d/%Y %H:%M', tpep_dropoff_datetime)
      WHEN LENGTH(tpep_dropoff_datetime) <= 14 THEN
        -- Date format: "MM/DD/YY HH:MM"
        PARSE_DATETIME('%m/%d/%y %H:%M', tpep_dropoff_datetime)
      ELSE
        NULL
    END AS drop_date_part
  FROM `uber-data-engineering-407103`.`uber`.`uber_tlc_trip_recrord_data`
  WHERE tpep_pickup_datetime IS NOT NULL
    AND tpep_dropoff_datetime IS NOT NULL
)
SELECT
  datetime_id,
  pick_date_part AS tpep_pickup_datetime,
  drop_date_part AS tpep_dropoff_datetime,
  EXTRACT(HOUR FROM pick_date_part) AS pick_hour,
  EXTRACT(DAY FROM pick_date_part) AS pick_day,
  EXTRACT(MONTH FROM pick_date_part) AS pick_month,
  EXTRACT(YEAR FROM pick_date_part) AS pick_year,
  EXTRACT(DAYOFWEEK FROM pick_date_part) AS pick_weekday,
  EXTRACT(HOUR FROM drop_date_part) AS drop_hour,
  EXTRACT(DAY FROM drop_date_part) AS drop_day,
  EXTRACT(MONTH FROM drop_date_part) AS drop_month,
  EXTRACT(YEAR FROM drop_date_part) AS drop_year,
  EXTRACT(DAYOFWEEK FROM drop_date_part) AS drop_weekday
FROM datetime_cte
    );
  
[0m21:59:06.538016 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=uber-data-engineering-407103&j=bq:US:e0628e14-6b3e-4573-bb21-ad9e0d217c26&page=queryresults
[0m21:59:06.619836 [debug] [Thread-1 (]: Timing info for model.uber.datetime_dim (execute): 21:59:03.079631 => 21:59:06.617398
[0m21:59:06.633103 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '9a463ef3-919f-4b58-837e-5ca6839de367', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff9334c890>]}
[0m21:59:06.639903 [info ] [Thread-1 (]: 1 of 7 OK created sql table model uber.datetime_dim ............................ [[32mCREATE TABLE (99.9k rows, 4.0 MiB processed)[0m in 3.57s]
[0m21:59:06.650908 [debug] [Thread-1 (]: Finished running node model.uber.datetime_dim
[0m21:59:06.653017 [debug] [Thread-1 (]: Began running node model.uber.dropoff_location_dim
[0m21:59:06.654691 [info ] [Thread-1 (]: 2 of 7 START sql table model uber.dropoff_location_dim ......................... [RUN]
[0m21:59:06.656024 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.uber.datetime_dim, now model.uber.dropoff_location_dim)
[0m21:59:06.656742 [debug] [Thread-1 (]: Began compiling node model.uber.dropoff_location_dim
[0m21:59:06.715339 [debug] [Thread-1 (]: Writing injected SQL for node "model.uber.dropoff_location_dim"
[0m21:59:06.741379 [debug] [Thread-1 (]: Timing info for model.uber.dropoff_location_dim (compile): 21:59:06.657235 => 21:59:06.731736
[0m21:59:06.752421 [debug] [Thread-1 (]: Began executing node model.uber.dropoff_location_dim
[0m21:59:06.782409 [debug] [Thread-1 (]: Writing runtime sql for node "model.uber.dropoff_location_dim"
[0m21:59:06.807382 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m21:59:06.818452 [debug] [Thread-1 (]: On model.uber.dropoff_location_dim: /* {"app": "dbt", "dbt_version": "1.5.9", "profile_name": "uber", "target_name": "dev", "node_id": "model.uber.dropoff_location_dim"} */

  
    

    create or replace table `uber-data-engineering-407103`.`uber`.`dropoff_location_dim`
    
    

    OPTIONS()
    as (
      WITH numbered_rows AS (
  SELECT
    

    

    with p as (
        select 0 as generated_number union all select 1
    ), unioned as (

    select

    
    p0.generated_number * power(2, 0)
    
    
    + 1
    as generated_number

    from

    
    p as p0
    
    

    )

    select *
    from unioned
    where generated_number <= 1
    order by generated_number

 as dropoff_location_id,
    dropoff_latitude AS dropoff_latitude,
    dropoff_longitude AS dropoff_longitude,
    ROW_NUMBER() OVER (ORDER BY dropoff_latitude, dropoff_longitude) as row_num
  FROM `uber-data-engineering-407103`.`uber`.`uber_tlc_trip_recrord_data`
)
SELECT
  dropoff_location_id,
  dropoff_latitude,
  dropoff_longitude
FROM numbered_rows
    );
  
[0m21:59:07.582372 [debug] [Thread-1 (]: BigQuery adapter: Retry attempt 1 of 1 after error: BadRequest('Syntax error: Unexpected "(" at [18:15]')
[0m21:59:08.649486 [error] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=uber-data-engineering-407103&j=bq:US:1bb094be-1ca4-4cd7-90c3-05632dc01023&page=queryresults
[0m21:59:08.658389 [debug] [Thread-1 (]: Timing info for model.uber.dropoff_location_dim (execute): 21:59:06.761744 => 21:59:08.655005
[0m21:59:08.679123 [debug] [Thread-1 (]: Database Error in model dropoff_location_dim (models/transform/dropoff_location_dim.sql)
  Syntax error: Unexpected "(" at [18:15]
  compiled Code at target/run/uber/models/transform/dropoff_location_dim.sql
[0m21:59:08.681378 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '9a463ef3-919f-4b58-837e-5ca6839de367', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff912b46d0>]}
[0m21:59:08.684037 [error] [Thread-1 (]: 2 of 7 ERROR creating sql table model uber.dropoff_location_dim ................ [[31mERROR[0m in 2.02s]
[0m21:59:08.687742 [debug] [Thread-1 (]: Finished running node model.uber.dropoff_location_dim
[0m21:59:08.692426 [debug] [Thread-1 (]: Began running node model.uber.passenger_count_dim
[0m21:59:08.698402 [info ] [Thread-1 (]: 3 of 7 START sql table model uber.passenger_count_dim .......................... [RUN]
[0m21:59:08.700382 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.uber.dropoff_location_dim, now model.uber.passenger_count_dim)
[0m21:59:08.701747 [debug] [Thread-1 (]: Began compiling node model.uber.passenger_count_dim
[0m21:59:08.730911 [debug] [Thread-1 (]: Writing injected SQL for node "model.uber.passenger_count_dim"
[0m21:59:08.734103 [debug] [Thread-1 (]: Timing info for model.uber.passenger_count_dim (compile): 21:59:08.702884 => 21:59:08.733880
[0m21:59:08.734846 [debug] [Thread-1 (]: Began executing node model.uber.passenger_count_dim
[0m21:59:08.738867 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m21:59:09.297397 [debug] [Thread-1 (]: Writing runtime sql for node "model.uber.passenger_count_dim"
[0m21:59:09.301990 [debug] [Thread-1 (]: On model.uber.passenger_count_dim: /* {"app": "dbt", "dbt_version": "1.5.9", "profile_name": "uber", "target_name": "dev", "node_id": "model.uber.passenger_count_dim"} */

  
    

    create or replace table `uber-data-engineering-407103`.`uber`.`passenger_count_dim`
    
    

    OPTIONS()
    as (
      SELECT DISTINCT
    to_hex(md5(cast( as STRING))) as passenger_count_id,
		passenger_count AS passenger_count,
FROM `uber-data-engineering-407103`.`uber`.`uber_tlc_trip_recrord_data`
WHERE passenger_count IS NOT NULL
    );
  
[0m21:59:09.480124 [debug] [Thread-1 (]: BigQuery adapter: Retry attempt 1 of 1 after error: BadRequest('Syntax error: Unexpected keyword AS at [13:22]')
[0m21:59:10.512578 [error] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=uber-data-engineering-407103&j=bq:US:ba417011-b75f-491e-bbdc-ccbd509f6625&page=queryresults
[0m21:59:10.519046 [debug] [Thread-1 (]: Timing info for model.uber.passenger_count_dim (execute): 21:59:08.735467 => 21:59:10.517252
[0m21:59:10.539530 [debug] [Thread-1 (]: Database Error in model passenger_count_dim (models/transform/passenger_count_dim.sql)
  Syntax error: Unexpected keyword AS at [13:22]
  compiled Code at target/run/uber/models/transform/passenger_count_dim.sql
[0m21:59:10.541826 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '9a463ef3-919f-4b58-837e-5ca6839de367', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff91082a90>]}
[0m21:59:10.544345 [error] [Thread-1 (]: 3 of 7 ERROR creating sql table model uber.passenger_count_dim ................. [[31mERROR[0m in 1.84s]
[0m21:59:10.546067 [debug] [Thread-1 (]: Finished running node model.uber.passenger_count_dim
[0m21:59:10.547048 [debug] [Thread-1 (]: Began running node model.uber.payment_type_dim
[0m21:59:10.548910 [info ] [Thread-1 (]: 4 of 7 START sql table model uber.payment_type_dim ............................. [RUN]
[0m21:59:10.550948 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.uber.passenger_count_dim, now model.uber.payment_type_dim)
[0m21:59:10.552766 [debug] [Thread-1 (]: Began compiling node model.uber.payment_type_dim
[0m21:59:10.599212 [debug] [Thread-1 (]: Writing injected SQL for node "model.uber.payment_type_dim"
[0m21:59:10.609267 [debug] [Thread-1 (]: Timing info for model.uber.payment_type_dim (compile): 21:59:10.553767 => 21:59:10.608398
[0m21:59:10.611109 [debug] [Thread-1 (]: Began executing node model.uber.payment_type_dim
[0m21:59:10.618970 [debug] [Thread-1 (]: Writing runtime sql for node "model.uber.payment_type_dim"
[0m21:59:10.625692 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m21:59:10.630280 [debug] [Thread-1 (]: On model.uber.payment_type_dim: /* {"app": "dbt", "dbt_version": "1.5.9", "profile_name": "uber", "target_name": "dev", "node_id": "model.uber.payment_type_dim"} */

  
    

    create or replace table `uber-data-engineering-407103`.`uber`.`payment_type_dim`
    
    

    OPTIONS()
    as (
      WITH numbered_rows AS (
  SELECT
    

    

    with p as (
        select 0 as generated_number union all select 1
    ), unioned as (

    select

    
    p0.generated_number * power(2, 0)
    
    
    + 1
    as generated_number

    from

    
    p as p0
    
    

    )

    select *
    from unioned
    where generated_number <= 1
    order by generated_number

 as payment_type_id,
    payment_type AS payment_type,
    ROW_NUMBER() OVER (ORDER BY payment_type) as row_num
  FROM `uber-data-engineering-407103`.`uber`.`uber_tlc_trip_recrord_data`
  WHERE payment_type IS NOT NULL
)
SELECT
  payment_type_id,
  payment_type
FROM numbered_rows
    );
  
[0m21:59:11.687367 [debug] [Thread-1 (]: BigQuery adapter: Retry attempt 1 of 1 after error: BadRequest('Syntax error: Unexpected "(" at [18:15]')
[0m21:59:12.563024 [info ] [MainThread]: [33mThe bigquery adapter does not support query cancellation. Some queries may still be running![0m
[0m21:59:12.975643 [error] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=uber-data-engineering-407103&j=bq:US:30d3efbc-7bc4-4ec0-b837-8cfe4c4375e3&page=queryresults
[0m21:59:12.985150 [debug] [Thread-1 (]: Timing info for model.uber.payment_type_dim (execute): 21:59:10.612123 => 21:59:12.983248
[0m21:59:13.005076 [debug] [Thread-1 (]: Database Error in model payment_type_dim (models/transform/payment_type_dim.sql)
  Syntax error: Unexpected "(" at [18:15]
  compiled Code at target/run/uber/models/transform/payment_type_dim.sql
[0m21:59:13.007488 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '9a463ef3-919f-4b58-837e-5ca6839de367', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff911847d0>]}
[0m21:59:13.010105 [error] [Thread-1 (]: 4 of 7 ERROR creating sql table model uber.payment_type_dim .................... [[31mERROR[0m in 2.46s]
[0m21:59:13.011180 [debug] [Thread-1 (]: Finished running node model.uber.payment_type_dim
[0m21:59:13.012346 [info ] [MainThread]: 
[0m21:59:13.013837 [info ] [MainThread]: [33mExited because of keyboard interrupt[0m
[0m21:59:13.014575 [info ] [MainThread]: 
[0m21:59:13.015353 [error] [MainThread]: [33mDatabase Error in model dropoff_location_dim (models/transform/dropoff_location_dim.sql)[0m
[0m21:59:13.016030 [error] [MainThread]:   Syntax error: Unexpected "(" at [18:15]
[0m21:59:13.016893 [error] [MainThread]:   compiled Code at target/run/uber/models/transform/dropoff_location_dim.sql
[0m21:59:13.017604 [info ] [MainThread]: 
[0m21:59:13.018209 [error] [MainThread]: [33mDatabase Error in model passenger_count_dim (models/transform/passenger_count_dim.sql)[0m
[0m21:59:13.018715 [error] [MainThread]:   Syntax error: Unexpected keyword AS at [13:22]
[0m21:59:13.019245 [error] [MainThread]:   compiled Code at target/run/uber/models/transform/passenger_count_dim.sql
[0m21:59:13.019837 [info ] [MainThread]: 
[0m21:59:13.020690 [info ] [MainThread]: Done. PASS=1 WARN=0 ERROR=2 SKIP=0 TOTAL=3
[0m21:59:13.021602 [debug] [MainThread]: Connection 'master' was properly closed.
[0m21:59:13.022115 [debug] [MainThread]: Connection 'model.uber.payment_type_dim' was properly closed.
[0m21:59:13.022817 [info ] [MainThread]: 
[0m21:59:13.023859 [info ] [MainThread]: Finished running 3 table models in 0 hours 0 minutes and 11.50 seconds (11.50s).
[0m21:59:13.025592 [error] [MainThread]: Encountered an error:

[0m21:59:13.034001 [error] [MainThread]: Traceback (most recent call last):
  File "/usr/local/airflow/dbt_venv/lib/python3.11/site-packages/dbt/cli/requires.py", line 86, in wrapper
    result, success = func(*args, **kwargs)
                      ^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/airflow/dbt_venv/lib/python3.11/site-packages/dbt/cli/requires.py", line 71, in wrapper
    return func(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/airflow/dbt_venv/lib/python3.11/site-packages/dbt/cli/requires.py", line 142, in wrapper
    return func(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/airflow/dbt_venv/lib/python3.11/site-packages/dbt/cli/requires.py", line 168, in wrapper
    return func(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/airflow/dbt_venv/lib/python3.11/site-packages/dbt/cli/requires.py", line 215, in wrapper
    return func(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/airflow/dbt_venv/lib/python3.11/site-packages/dbt/cli/requires.py", line 250, in wrapper
    return func(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/airflow/dbt_venv/lib/python3.11/site-packages/dbt/cli/main.py", line 584, in run
    results = task.run()
              ^^^^^^^^^^
  File "/usr/local/airflow/dbt_venv/lib/python3.11/site-packages/dbt/task/runnable.py", line 448, in run
    result = self.execute_with_hooks(selected_uids)
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/airflow/dbt_venv/lib/python3.11/site-packages/dbt/task/runnable.py", line 406, in execute_with_hooks
    res = self.execute_nodes()
          ^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/airflow/dbt_venv/lib/python3.11/site-packages/dbt/task/runnable.py", line 352, in execute_nodes
    self.run_queue(pool)
  File "/usr/local/airflow/dbt_venv/lib/python3.11/site-packages/dbt/task/runnable.py", line 279, in run_queue
    self.job_queue.join()
  File "/usr/local/airflow/dbt_venv/lib/python3.11/site-packages/dbt/graph/queue.py", line 198, in join
    self.inner.join()
  File "/usr/local/lib/python3.11/queue.py", line 90, in join
    self.all_tasks_done.wait()
  File "/usr/local/lib/python3.11/threading.py", line 327, in wait
    waiter.acquire()
KeyboardInterrupt

[0m21:59:13.036606 [debug] [MainThread]: Command `dbt run` failed at 21:59:13.036207 after 12.51 seconds
[0m21:59:13.038218 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff937a1fd0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff931b3b50>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff972dbc50>]}
[0m21:59:13.039140 [debug] [MainThread]: Flushing usage events
[0m22:01:12.944539 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff993f3650>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff9957e250>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff990ce110>]}


============================== 22:01:12.949644 | 47155f56-4e3a-471e-9f00-d7f555ea1a3a ==============================
[0m22:01:12.949644 [info ] [MainThread]: Running with dbt=1.5.9
[0m22:01:12.951018 [debug] [MainThread]: running dbt with arguments {'warn_error': 'None', 'log_cache_events': 'False', 'introspect': 'True', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'quiet': 'False', 'static_parser': 'True', 'fail_fast': 'False', 'target_path': 'None', 'no_print': 'None', 'use_colors': 'True', 'version_check': 'True', 'indirect_selection': 'eager', 'partial_parse': 'True', 'use_experimental_parser': 'False', 'log_path': '/usr/local/airflow/include/dbt/logs', 'profiles_dir': '/usr/local/airflow/include/dbt/', 'write_json': 'True', 'printer_width': '80', 'debug': 'False', 'log_format': 'default', 'cache_selected_only': 'False', 'send_anonymous_usage_stats': 'True'}
[0m22:01:13.676160 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '47155f56-4e3a-471e-9f00-d7f555ea1a3a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff971cc9d0>]}
[0m22:01:13.878890 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '47155f56-4e3a-471e-9f00-d7f555ea1a3a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff971d4450>]}
[0m22:01:13.883360 [info ] [MainThread]: Registered adapter: bigquery=1.5.3
[0m22:01:13.948634 [debug] [MainThread]: checksum: dd837546c89c9d03f3c2cb0ca6165266a30da6076d5d44e9991f7c5a8e5f5831, vars: {}, profile: , target: , version: 1.5.9
[0m22:01:14.299505 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m22:01:14.302517 [debug] [MainThread]: Partial parsing: updated file: uber://models/transform/datetime_dim.sql
[0m22:01:14.336662 [debug] [MainThread]: 1603: static parser failed on transform/datetime_dim.sql
[0m22:01:14.392183 [debug] [MainThread]: 1602: parser fallback to jinja rendering on transform/datetime_dim.sql
[0m22:01:14.419495 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '47155f56-4e3a-471e-9f00-d7f555ea1a3a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff970eaad0>]}
[0m22:01:14.441608 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '47155f56-4e3a-471e-9f00-d7f555ea1a3a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff97090f50>]}
[0m22:01:14.442521 [info ] [MainThread]: Found 7 models, 0 tests, 0 snapshots, 0 analyses, 474 macros, 0 operations, 0 seed files, 1 source, 0 exposures, 0 metrics, 0 groups
[0m22:01:14.443718 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '47155f56-4e3a-471e-9f00-d7f555ea1a3a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff9c0eb6d0>]}
[0m22:01:14.447583 [info ] [MainThread]: 
[0m22:01:14.449586 [debug] [MainThread]: Acquiring new bigquery connection 'master'
[0m22:01:14.453289 [debug] [ThreadPool]: Acquiring new bigquery connection 'list_uber-data-engineering-407103'
[0m22:01:14.454411 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m22:01:15.825757 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_uber-data-engineering-407103, now list_uber-data-engineering-407103_uber)
[0m22:01:15.835015 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m22:01:16.611348 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '47155f56-4e3a-471e-9f00-d7f555ea1a3a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff97091510>]}
[0m22:01:16.666132 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m22:01:16.676652 [info ] [MainThread]: 
[0m22:01:16.789305 [debug] [Thread-1 (]: Began running node model.uber.datetime_dim
[0m22:01:16.792830 [info ] [Thread-1 (]: 1 of 7 START sql table model uber.datetime_dim ................................. [RUN]
[0m22:01:16.796096 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_uber-data-engineering-407103_uber, now model.uber.datetime_dim)
[0m22:01:16.797989 [debug] [Thread-1 (]: Began compiling node model.uber.datetime_dim
[0m22:01:16.830441 [debug] [Thread-1 (]: Writing injected SQL for node "model.uber.datetime_dim"
[0m22:01:16.845514 [debug] [Thread-1 (]: Timing info for model.uber.datetime_dim (compile): 22:01:16.799763 => 22:01:16.843764
[0m22:01:16.850269 [debug] [Thread-1 (]: Began executing node model.uber.datetime_dim
[0m22:01:16.882194 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m22:01:17.713067 [debug] [Thread-1 (]: Writing runtime sql for node "model.uber.datetime_dim"
[0m22:01:17.715826 [debug] [Thread-1 (]: On model.uber.datetime_dim: /* {"app": "dbt", "dbt_version": "1.5.9", "profile_name": "uber", "target_name": "dev", "node_id": "model.uber.datetime_dim"} */

  
    

    create or replace table `uber-data-engineering-407103`.`uber`.`datetime_dim`
    
    

    OPTIONS()
    as (
      WITH datetime_cte AS (  
  SELECT DISTINCT 
    to_hex(md5(cast(coalesce(cast(tpep_pickup_datetime as STRING), '_dbt_utils_surrogate_key_null_') || '-' || coalesce(cast(tpep_dropoff_datetime as STRING), '_dbt_utils_surrogate_key_null_') as STRING))) AS datetime_id,
    CASE
      WHEN LENGTH(tpep_pickup_datetime) = 16 THEN
        -- Date format: "DD/MM/YYYY HH:MM"
        PARSE_DATETIME('%m/%d/%Y %H:%M', tpep_pickup_datetime)
      WHEN LENGTH(tpep_pickup_datetime) <= 14 THEN
        -- Date format: "MM/DD/YY HH:MM"
        PARSE_DATETIME('%m/%d/%y %H:%M', tpep_pickup_datetime)
      ELSE
        NULL
    END AS pick_date_part,
    tpep_dropoff_datetime AS drop_datetime_id,
    CASE
      WHEN LENGTH(tpep_dropoff_datetime) = 16 THEN
        -- Date format: "DD/MM/YYYY HH:MM"
        PARSE_DATETIME('%m/%d/%Y %H:%M', tpep_dropoff_datetime)
      WHEN LENGTH(tpep_dropoff_datetime) <= 14 THEN
        -- Date format: "MM/DD/YY HH:MM"
        PARSE_DATETIME('%m/%d/%y %H:%M', tpep_dropoff_datetime)
      ELSE
        NULL
    END AS drop_date_part
  FROM `uber-data-engineering-407103`.`uber`.`uber_tlc_trip_recrord_data`
  WHERE tpep_pickup_datetime IS NOT NULL
    AND tpep_dropoff_datetime IS NOT NULL
)
SELECT
  datetime_id,
  pick_date_part AS tpep_pickup_datetime,
  drop_date_part AS tpep_dropoff_datetime,
  EXTRACT(HOUR FROM pick_date_part) AS pick_hour,
  EXTRACT(DAY FROM pick_date_part) AS pick_day,
  EXTRACT(MONTH FROM pick_date_part) AS pick_month,
  EXTRACT(YEAR FROM pick_date_part) AS pick_year,
  EXTRACT(DAYOFWEEK FROM pick_date_part) AS pick_weekday,
  EXTRACT(HOUR FROM drop_date_part) AS drop_hour,
  EXTRACT(DAY FROM drop_date_part) AS drop_day,
  EXTRACT(MONTH FROM drop_date_part) AS drop_month,
  EXTRACT(YEAR FROM drop_date_part) AS drop_year,
  EXTRACT(DAYOFWEEK FROM drop_date_part) AS drop_weekday
FROM datetime_cte
    );
  
[0m22:01:21.032857 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=uber-data-engineering-407103&j=bq:US:af27b24b-0b59-49cb-a9c3-bca86a56bbc0&page=queryresults
[0m22:01:21.088200 [debug] [Thread-1 (]: Timing info for model.uber.datetime_dim (execute): 22:01:16.854327 => 22:01:21.086685
[0m22:01:21.092992 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '47155f56-4e3a-471e-9f00-d7f555ea1a3a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff97077f90>]}
[0m22:01:21.096829 [info ] [Thread-1 (]: 1 of 7 OK created sql table model uber.datetime_dim ............................ [[32mCREATE TABLE (99.9k rows, 4.0 MiB processed)[0m in 4.30s]
[0m22:01:21.100595 [debug] [Thread-1 (]: Finished running node model.uber.datetime_dim
[0m22:01:21.103196 [debug] [Thread-1 (]: Began running node model.uber.dropoff_location_dim
[0m22:01:21.116659 [info ] [Thread-1 (]: 2 of 7 START sql table model uber.dropoff_location_dim ......................... [RUN]
[0m22:01:21.127140 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.uber.datetime_dim, now model.uber.dropoff_location_dim)
[0m22:01:21.136342 [debug] [Thread-1 (]: Began compiling node model.uber.dropoff_location_dim
[0m22:01:21.219405 [debug] [Thread-1 (]: Writing injected SQL for node "model.uber.dropoff_location_dim"
[0m22:01:21.222600 [debug] [Thread-1 (]: Timing info for model.uber.dropoff_location_dim (compile): 22:01:21.142713 => 22:01:21.222272
[0m22:01:21.223346 [debug] [Thread-1 (]: Began executing node model.uber.dropoff_location_dim
[0m22:01:21.240144 [debug] [Thread-1 (]: Writing runtime sql for node "model.uber.dropoff_location_dim"
[0m22:01:21.256844 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m22:01:21.301613 [debug] [Thread-1 (]: On model.uber.dropoff_location_dim: /* {"app": "dbt", "dbt_version": "1.5.9", "profile_name": "uber", "target_name": "dev", "node_id": "model.uber.dropoff_location_dim"} */

  
    

    create or replace table `uber-data-engineering-407103`.`uber`.`dropoff_location_dim`
    
    

    OPTIONS()
    as (
      WITH numbered_rows AS (
  SELECT
    

    

    with p as (
        select 0 as generated_number union all select 1
    ), unioned as (

    select

    
    p0.generated_number * power(2, 0)
    
    
    + 1
    as generated_number

    from

    
    p as p0
    
    

    )

    select *
    from unioned
    where generated_number <= 1
    order by generated_number

 as dropoff_location_id,
    dropoff_latitude AS dropoff_latitude,
    dropoff_longitude AS dropoff_longitude,
    ROW_NUMBER() OVER (ORDER BY dropoff_latitude, dropoff_longitude) as row_num
  FROM `uber-data-engineering-407103`.`uber`.`uber_tlc_trip_recrord_data`
)
SELECT
  dropoff_location_id,
  dropoff_latitude,
  dropoff_longitude
FROM numbered_rows
    );
  
[0m22:01:22.360138 [debug] [Thread-1 (]: BigQuery adapter: Retry attempt 1 of 1 after error: BadRequest('Syntax error: Unexpected "(" at [18:15]')
[0m22:01:23.124132 [error] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=uber-data-engineering-407103&j=bq:US:8b0e32ee-c283-405d-a9a1-c010fe1526cd&page=queryresults
[0m22:01:23.128331 [debug] [Thread-1 (]: Timing info for model.uber.dropoff_location_dim (execute): 22:01:21.223790 => 22:01:23.127370
[0m22:01:23.149271 [debug] [Thread-1 (]: Database Error in model dropoff_location_dim (models/transform/dropoff_location_dim.sql)
  Syntax error: Unexpected "(" at [18:15]
  compiled Code at target/run/uber/models/transform/dropoff_location_dim.sql
[0m22:01:23.153547 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '47155f56-4e3a-471e-9f00-d7f555ea1a3a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff970e1310>]}
[0m22:01:23.162902 [error] [Thread-1 (]: 2 of 7 ERROR creating sql table model uber.dropoff_location_dim ................ [[31mERROR[0m in 2.03s]
[0m22:01:23.165112 [debug] [Thread-1 (]: Finished running node model.uber.dropoff_location_dim
[0m22:01:23.166130 [debug] [Thread-1 (]: Began running node model.uber.passenger_count_dim
[0m22:01:23.167796 [info ] [Thread-1 (]: 3 of 7 START sql table model uber.passenger_count_dim .......................... [RUN]
[0m22:01:23.168933 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.uber.dropoff_location_dim, now model.uber.passenger_count_dim)
[0m22:01:23.169618 [debug] [Thread-1 (]: Began compiling node model.uber.passenger_count_dim
[0m22:01:23.179359 [debug] [Thread-1 (]: Writing injected SQL for node "model.uber.passenger_count_dim"
[0m22:01:23.182902 [debug] [Thread-1 (]: Timing info for model.uber.passenger_count_dim (compile): 22:01:23.170140 => 22:01:23.182502
[0m22:01:23.183645 [debug] [Thread-1 (]: Began executing node model.uber.passenger_count_dim
[0m22:01:23.187329 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m22:01:23.652753 [debug] [Thread-1 (]: Writing runtime sql for node "model.uber.passenger_count_dim"
[0m22:01:23.657706 [debug] [Thread-1 (]: On model.uber.passenger_count_dim: /* {"app": "dbt", "dbt_version": "1.5.9", "profile_name": "uber", "target_name": "dev", "node_id": "model.uber.passenger_count_dim"} */

  
    

    create or replace table `uber-data-engineering-407103`.`uber`.`passenger_count_dim`
    
    

    OPTIONS()
    as (
      SELECT DISTINCT
    to_hex(md5(cast( as STRING))) as passenger_count_id,
		passenger_count AS passenger_count,
FROM `uber-data-engineering-407103`.`uber`.`uber_tlc_trip_recrord_data`
WHERE passenger_count IS NOT NULL
    );
  
[0m22:01:24.695093 [debug] [Thread-1 (]: BigQuery adapter: Retry attempt 1 of 1 after error: BadRequest('Syntax error: Unexpected keyword AS at [13:22]')
[0m22:01:25.374639 [error] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=uber-data-engineering-407103&j=bq:US:83e3e5ce-c7bb-40bf-a93b-4ab68c93ad39&page=queryresults
[0m22:01:25.380141 [debug] [Thread-1 (]: Timing info for model.uber.passenger_count_dim (execute): 22:01:23.184225 => 22:01:25.378846
[0m22:01:25.391341 [debug] [Thread-1 (]: Database Error in model passenger_count_dim (models/transform/passenger_count_dim.sql)
  Syntax error: Unexpected keyword AS at [13:22]
  compiled Code at target/run/uber/models/transform/passenger_count_dim.sql
[0m22:01:25.393821 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '47155f56-4e3a-471e-9f00-d7f555ea1a3a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff94d44850>]}
[0m22:01:25.396370 [error] [Thread-1 (]: 3 of 7 ERROR creating sql table model uber.passenger_count_dim ................. [[31mERROR[0m in 2.22s]
[0m22:01:25.397927 [debug] [Thread-1 (]: Finished running node model.uber.passenger_count_dim
[0m22:01:25.398993 [debug] [Thread-1 (]: Began running node model.uber.payment_type_dim
[0m22:01:25.400340 [info ] [Thread-1 (]: 4 of 7 START sql table model uber.payment_type_dim ............................. [RUN]
[0m22:01:25.401513 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.uber.passenger_count_dim, now model.uber.payment_type_dim)
[0m22:01:25.402123 [debug] [Thread-1 (]: Began compiling node model.uber.payment_type_dim
[0m22:01:25.411738 [debug] [Thread-1 (]: Writing injected SQL for node "model.uber.payment_type_dim"
[0m22:01:25.414696 [debug] [Thread-1 (]: Timing info for model.uber.payment_type_dim (compile): 22:01:25.402547 => 22:01:25.414413
[0m22:01:25.415378 [debug] [Thread-1 (]: Began executing node model.uber.payment_type_dim
[0m22:01:25.420079 [debug] [Thread-1 (]: Writing runtime sql for node "model.uber.payment_type_dim"
[0m22:01:25.422031 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m22:01:25.424467 [debug] [Thread-1 (]: On model.uber.payment_type_dim: /* {"app": "dbt", "dbt_version": "1.5.9", "profile_name": "uber", "target_name": "dev", "node_id": "model.uber.payment_type_dim"} */

  
    

    create or replace table `uber-data-engineering-407103`.`uber`.`payment_type_dim`
    
    

    OPTIONS()
    as (
      WITH numbered_rows AS (
  SELECT
    

    

    with p as (
        select 0 as generated_number union all select 1
    ), unioned as (

    select

    
    p0.generated_number * power(2, 0)
    
    
    + 1
    as generated_number

    from

    
    p as p0
    
    

    )

    select *
    from unioned
    where generated_number <= 1
    order by generated_number

 as payment_type_id,
    payment_type AS payment_type,
    ROW_NUMBER() OVER (ORDER BY payment_type) as row_num
  FROM `uber-data-engineering-407103`.`uber`.`uber_tlc_trip_recrord_data`
  WHERE payment_type IS NOT NULL
)
SELECT
  payment_type_id,
  payment_type
FROM numbered_rows
    );
  
[0m22:01:26.203904 [debug] [Thread-1 (]: BigQuery adapter: Retry attempt 1 of 1 after error: BadRequest('Syntax error: Unexpected "(" at [18:15]')
[0m22:01:26.590719 [error] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=uber-data-engineering-407103&j=bq:US:f06882ff-3605-4da0-8f47-0a4b8f684e2e&page=queryresults
[0m22:01:26.592129 [debug] [Thread-1 (]: Timing info for model.uber.payment_type_dim (execute): 22:01:25.415836 => 22:01:26.591942
[0m22:01:26.595231 [debug] [Thread-1 (]: Database Error in model payment_type_dim (models/transform/payment_type_dim.sql)
  Syntax error: Unexpected "(" at [18:15]
  compiled Code at target/run/uber/models/transform/payment_type_dim.sql
[0m22:01:26.595892 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '47155f56-4e3a-471e-9f00-d7f555ea1a3a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff94d72fd0>]}
[0m22:01:26.596607 [error] [Thread-1 (]: 4 of 7 ERROR creating sql table model uber.payment_type_dim .................... [[31mERROR[0m in 1.19s]
[0m22:01:26.597443 [debug] [Thread-1 (]: Finished running node model.uber.payment_type_dim
[0m22:01:26.598097 [debug] [Thread-1 (]: Began running node model.uber.pickup_location_dim
[0m22:01:26.598927 [info ] [Thread-1 (]: 5 of 7 START sql table model uber.pickup_location_dim .......................... [RUN]
[0m22:01:26.599922 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.uber.payment_type_dim, now model.uber.pickup_location_dim)
[0m22:01:26.600683 [debug] [Thread-1 (]: Began compiling node model.uber.pickup_location_dim
[0m22:01:26.606453 [debug] [Thread-1 (]: Writing injected SQL for node "model.uber.pickup_location_dim"
[0m22:01:26.608562 [debug] [Thread-1 (]: Timing info for model.uber.pickup_location_dim (compile): 22:01:26.601146 => 22:01:26.608382
[0m22:01:26.609109 [debug] [Thread-1 (]: Began executing node model.uber.pickup_location_dim
[0m22:01:26.612461 [debug] [Thread-1 (]: Writing runtime sql for node "model.uber.pickup_location_dim"
[0m22:01:26.614561 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m22:01:26.617036 [debug] [Thread-1 (]: On model.uber.pickup_location_dim: /* {"app": "dbt", "dbt_version": "1.5.9", "profile_name": "uber", "target_name": "dev", "node_id": "model.uber.pickup_location_dim"} */

  
    

    create or replace table `uber-data-engineering-407103`.`uber`.`pickup_location_dim`
    
    

    OPTIONS()
    as (
      WITH numbered_rows AS (
  SELECT
    

    

    with p as (
        select 0 as generated_number union all select 1
    ), unioned as (

    select

    
    p0.generated_number * power(2, 0)
    
    
    + 1
    as generated_number

    from

    
    p as p0
    
    

    )

    select *
    from unioned
    where generated_number <= 1
    order by generated_number

 as pickup_location_id,
    pickup_latitude AS pickup_latitude,
    pickup_longitude AS pickup_longitude,
    ROW_NUMBER() OVER (ORDER BY pickup_latitude, pickup_longitude) as row_num
  FROM `uber-data-engineering-407103`.`uber`.`uber_tlc_trip_recrord_data`
)
SELECT
  pickup_location_id,
  pickup_latitude,
  pickup_longitude
FROM numbered_rows
    );
  
[0m22:01:27.453204 [debug] [Thread-1 (]: BigQuery adapter: Retry attempt 1 of 1 after error: BadRequest('Syntax error: Unexpected "(" at [18:15]')
[0m22:01:28.328103 [error] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=uber-data-engineering-407103&j=bq:US:a20ac84d-e6af-42f9-9e6a-2e7e0754be53&page=queryresults
[0m22:01:28.333606 [debug] [Thread-1 (]: Timing info for model.uber.pickup_location_dim (execute): 22:01:26.609525 => 22:01:28.332770
[0m22:01:28.343263 [debug] [Thread-1 (]: Database Error in model pickup_location_dim (models/transform/pickup_location_dim.sql)
  Syntax error: Unexpected "(" at [18:15]
  compiled Code at target/run/uber/models/transform/pickup_location_dim.sql
[0m22:01:28.344974 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '47155f56-4e3a-471e-9f00-d7f555ea1a3a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff94d74c90>]}
[0m22:01:28.347003 [error] [Thread-1 (]: 5 of 7 ERROR creating sql table model uber.pickup_location_dim ................. [[31mERROR[0m in 1.74s]
[0m22:01:28.348873 [debug] [Thread-1 (]: Finished running node model.uber.pickup_location_dim
[0m22:01:28.350309 [debug] [Thread-1 (]: Began running node model.uber.rate_code_dim
[0m22:01:28.351860 [info ] [Thread-1 (]: 6 of 7 START sql table model uber.rate_code_dim ................................ [RUN]
[0m22:01:28.353585 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.uber.pickup_location_dim, now model.uber.rate_code_dim)
[0m22:01:28.354342 [debug] [Thread-1 (]: Began compiling node model.uber.rate_code_dim
[0m22:01:28.360937 [debug] [Thread-1 (]: Writing injected SQL for node "model.uber.rate_code_dim"
[0m22:01:28.363515 [debug] [Thread-1 (]: Timing info for model.uber.rate_code_dim (compile): 22:01:28.354852 => 22:01:28.363309
[0m22:01:28.364185 [debug] [Thread-1 (]: Began executing node model.uber.rate_code_dim
[0m22:01:28.376609 [debug] [Thread-1 (]: Writing runtime sql for node "model.uber.rate_code_dim"
[0m22:01:28.380608 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m22:01:28.384740 [debug] [Thread-1 (]: On model.uber.rate_code_dim: /* {"app": "dbt", "dbt_version": "1.5.9", "profile_name": "uber", "target_name": "dev", "node_id": "model.uber.rate_code_dim"} */

  
    

    create or replace table `uber-data-engineering-407103`.`uber`.`rate_code_dim`
    
    

    OPTIONS()
    as (
      WITH numbered_rows AS (
  SELECT
    

    

    with p as (
        select 0 as generated_number union all select 1
    ), unioned as (

    select

    
    p0.generated_number * power(2, 0)
    
    
    + 1
    as generated_number

    from

    
    p as p0
    
    

    )

    select *
    from unioned
    where generated_number <= 1
    order by generated_number

 as rate_code_id,
    RatecodeID AS RatecodeID,
    ROW_NUMBER() OVER (ORDER BY RatecodeID) as row_num
  FROM `uber-data-engineering-407103`.`uber`.`uber_tlc_trip_recrord_data`
  WHERE RatecodeID IS NOT NULL
)
SELECT
  rate_code_id,
  rate_code
FROM numbered_rows
    );
  
[0m22:01:29.469080 [debug] [Thread-1 (]: BigQuery adapter: Retry attempt 1 of 1 after error: BadRequest('Syntax error: Unexpected "(" at [18:15]')
[0m22:01:30.724346 [error] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=uber-data-engineering-407103&j=bq:US:c0c697a4-1d3f-4d85-ba9f-892c1f766ec2&page=queryresults
[0m22:01:30.730297 [debug] [Thread-1 (]: Timing info for model.uber.rate_code_dim (execute): 22:01:28.364694 => 22:01:30.729633
[0m22:01:30.739194 [debug] [Thread-1 (]: Database Error in model rate_code_dim (models/transform/rate_code_dim.sql)
  Syntax error: Unexpected "(" at [18:15]
  compiled Code at target/run/uber/models/transform/rate_code_dim.sql
[0m22:01:30.740832 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '47155f56-4e3a-471e-9f00-d7f555ea1a3a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff94da82d0>]}
[0m22:01:30.742962 [error] [Thread-1 (]: 6 of 7 ERROR creating sql table model uber.rate_code_dim ....................... [[31mERROR[0m in 2.39s]
[0m22:01:30.745721 [debug] [Thread-1 (]: Finished running node model.uber.rate_code_dim
[0m22:01:30.747086 [debug] [Thread-1 (]: Began running node model.uber.trip_distance
[0m22:01:30.748002 [info ] [Thread-1 (]: 7 of 7 START sql table model uber.trip_distance ................................ [RUN]
[0m22:01:30.749464 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.uber.rate_code_dim, now model.uber.trip_distance)
[0m22:01:30.750320 [debug] [Thread-1 (]: Began compiling node model.uber.trip_distance
[0m22:01:30.758114 [debug] [Thread-1 (]: Writing injected SQL for node "model.uber.trip_distance"
[0m22:01:30.759952 [debug] [Thread-1 (]: Timing info for model.uber.trip_distance (compile): 22:01:30.750756 => 22:01:30.759742
[0m22:01:30.760432 [debug] [Thread-1 (]: Began executing node model.uber.trip_distance
[0m22:01:30.763650 [debug] [Thread-1 (]: Writing runtime sql for node "model.uber.trip_distance"
[0m22:01:30.764974 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m22:01:30.766847 [debug] [Thread-1 (]: On model.uber.trip_distance: /* {"app": "dbt", "dbt_version": "1.5.9", "profile_name": "uber", "target_name": "dev", "node_id": "model.uber.trip_distance"} */

  
    

    create or replace table `uber-data-engineering-407103`.`uber`.`trip_distance`
    
    

    OPTIONS()
    as (
      WITH numbered_rows AS (
  SELECT
    to_hex(md5(cast( as STRING))) as trip_distance_id,
    trip_distance AS trip_distance,
    ROW_NUMBER() OVER (ORDER BY trip_distance) as row_num
  FROM `uber-data-engineering-407103`.`uber`.`uber_tlc_trip_recrord_data`
  WHERE trip_distance IS NOT NULL
)
SELECT
  trip_distance_id,
  trip_distance
FROM numbered_rows
    );
  
[0m22:01:31.284482 [debug] [Thread-1 (]: BigQuery adapter: Retry attempt 1 of 1 after error: BadRequest('Syntax error: Unexpected keyword AS at [14:22]')
[0m22:01:31.744210 [error] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=uber-data-engineering-407103&j=bq:US:75c96205-78b1-41ba-a820-ebb9132c4e6f&page=queryresults
[0m22:01:31.749696 [debug] [Thread-1 (]: Timing info for model.uber.trip_distance (execute): 22:01:30.760847 => 22:01:31.748877
[0m22:01:31.758849 [debug] [Thread-1 (]: Database Error in model trip_distance (models/transform/trip_distance.sql)
  Syntax error: Unexpected keyword AS at [14:22]
  compiled Code at target/run/uber/models/transform/trip_distance.sql
[0m22:01:31.761879 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '47155f56-4e3a-471e-9f00-d7f555ea1a3a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff94da7790>]}
[0m22:01:31.764738 [error] [Thread-1 (]: 7 of 7 ERROR creating sql table model uber.trip_distance ....................... [[31mERROR[0m in 1.01s]
[0m22:01:31.766809 [debug] [Thread-1 (]: Finished running node model.uber.trip_distance
[0m22:01:31.771644 [debug] [MainThread]: Connection 'master' was properly closed.
[0m22:01:31.772444 [debug] [MainThread]: Connection 'model.uber.trip_distance' was properly closed.
[0m22:01:31.773393 [info ] [MainThread]: 
[0m22:01:31.774759 [info ] [MainThread]: Finished running 7 table models in 0 hours 0 minutes and 17.32 seconds (17.32s).
[0m22:01:31.776959 [debug] [MainThread]: Command end result
[0m22:01:31.795315 [info ] [MainThread]: 
[0m22:01:31.796642 [info ] [MainThread]: [31mCompleted with 6 errors and 0 warnings:[0m
[0m22:01:31.797282 [info ] [MainThread]: 
[0m22:01:31.798101 [error] [MainThread]: [33mDatabase Error in model dropoff_location_dim (models/transform/dropoff_location_dim.sql)[0m
[0m22:01:31.798811 [error] [MainThread]:   Syntax error: Unexpected "(" at [18:15]
[0m22:01:31.799411 [error] [MainThread]:   compiled Code at target/run/uber/models/transform/dropoff_location_dim.sql
[0m22:01:31.799966 [info ] [MainThread]: 
[0m22:01:31.800511 [error] [MainThread]: [33mDatabase Error in model passenger_count_dim (models/transform/passenger_count_dim.sql)[0m
[0m22:01:31.801076 [error] [MainThread]:   Syntax error: Unexpected keyword AS at [13:22]
[0m22:01:31.801630 [error] [MainThread]:   compiled Code at target/run/uber/models/transform/passenger_count_dim.sql
[0m22:01:31.802277 [info ] [MainThread]: 
[0m22:01:31.803604 [error] [MainThread]: [33mDatabase Error in model payment_type_dim (models/transform/payment_type_dim.sql)[0m
[0m22:01:31.804706 [error] [MainThread]:   Syntax error: Unexpected "(" at [18:15]
[0m22:01:31.805503 [error] [MainThread]:   compiled Code at target/run/uber/models/transform/payment_type_dim.sql
[0m22:01:31.806148 [info ] [MainThread]: 
[0m22:01:31.806695 [error] [MainThread]: [33mDatabase Error in model pickup_location_dim (models/transform/pickup_location_dim.sql)[0m
[0m22:01:31.807234 [error] [MainThread]:   Syntax error: Unexpected "(" at [18:15]
[0m22:01:31.807764 [error] [MainThread]:   compiled Code at target/run/uber/models/transform/pickup_location_dim.sql
[0m22:01:31.808283 [info ] [MainThread]: 
[0m22:01:31.808871 [error] [MainThread]: [33mDatabase Error in model rate_code_dim (models/transform/rate_code_dim.sql)[0m
[0m22:01:31.809390 [error] [MainThread]:   Syntax error: Unexpected "(" at [18:15]
[0m22:01:31.810091 [error] [MainThread]:   compiled Code at target/run/uber/models/transform/rate_code_dim.sql
[0m22:01:31.810868 [info ] [MainThread]: 
[0m22:01:31.811695 [error] [MainThread]: [33mDatabase Error in model trip_distance (models/transform/trip_distance.sql)[0m
[0m22:01:31.812461 [error] [MainThread]:   Syntax error: Unexpected keyword AS at [14:22]
[0m22:01:31.813092 [error] [MainThread]:   compiled Code at target/run/uber/models/transform/trip_distance.sql
[0m22:01:31.813930 [info ] [MainThread]: 
[0m22:01:31.814923 [info ] [MainThread]: Done. PASS=1 WARN=0 ERROR=6 SKIP=0 TOTAL=7
[0m22:01:31.816845 [debug] [MainThread]: Command `dbt run` failed at 22:01:31.816640 after 18.88 seconds
[0m22:01:31.817625 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff993f3090>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff99548990>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff990ce550>]}
[0m22:01:31.818512 [debug] [MainThread]: Flushing usage events
[0m22:17:39.608138 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff93997810>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff93957110>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff93fc1c10>]}


============================== 22:17:39.614626 | 0c4f0e59-7607-4343-8136-6edaa34b2fb3 ==============================
[0m22:17:39.614626 [info ] [MainThread]: Running with dbt=1.5.9
[0m22:17:39.615533 [debug] [MainThread]: running dbt with arguments {'cache_selected_only': 'False', 'printer_width': '80', 'write_json': 'True', 'quiet': 'False', 'log_path': '/usr/local/airflow/include/dbt/logs', 'debug': 'False', 'use_colors': 'True', 'version_check': 'True', 'no_print': 'None', 'static_parser': 'True', 'fail_fast': 'False', 'warn_error': 'None', 'partial_parse': 'True', 'send_anonymous_usage_stats': 'True', 'log_cache_events': 'False', 'introspect': 'True', 'use_experimental_parser': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'profiles_dir': '/usr/local/airflow/include/dbt/', 'target_path': 'None', 'indirect_selection': 'eager', 'log_format': 'default'}
[0m22:17:40.267120 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '0c4f0e59-7607-4343-8136-6edaa34b2fb3', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff933176d0>]}
[0m22:17:40.278606 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '0c4f0e59-7607-4343-8136-6edaa34b2fb3', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff9273bbd0>]}
[0m22:17:40.279377 [info ] [MainThread]: Registered adapter: bigquery=1.5.3
[0m22:17:40.295005 [debug] [MainThread]: checksum: dd837546c89c9d03f3c2cb0ca6165266a30da6076d5d44e9991f7c5a8e5f5831, vars: {}, profile: , target: , version: 1.5.9
[0m22:17:40.376154 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m22:17:40.376903 [debug] [MainThread]: Partial parsing: updated file: uber://models/transform/dropoff_location_dim.sql
[0m22:17:40.394806 [debug] [MainThread]: 1603: static parser failed on transform/dropoff_location_dim.sql
[0m22:17:40.406119 [error] [MainThread]: Encountered an error:
Compilation Error in model dropoff_location_dim (models/transform/dropoff_location_dim.sql)
  '<=' not supported between instances of 'list' and 'int'
  
  > in macro get_powers_of_two (macros/sql/generate_series.sql)
  > called by macro default__generate_series (macros/sql/generate_series.sql)
  > called by macro generate_series (macros/sql/generate_series.sql)
  > called by model dropoff_location_dim (models/transform/dropoff_location_dim.sql)
[0m22:17:40.407039 [debug] [MainThread]: Command `dbt run` failed at 22:17:40.406873 after 0.81 seconds
[0m22:17:40.407571 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff9179c4d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff97884450>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff933073d0>]}
[0m22:17:40.408119 [debug] [MainThread]: Flushing usage events
[0m22:20:13.190356 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffb80ab3d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffb837f2d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffb7f8b490>]}


============================== 22:20:13.195810 | 854abc27-a4cf-427e-b361-f419b610a77e ==============================
[0m22:20:13.195810 [info ] [MainThread]: Running with dbt=1.5.9
[0m22:20:13.197419 [debug] [MainThread]: running dbt with arguments {'target_path': 'None', 'write_json': 'True', 'use_colors': 'True', 'log_path': '/usr/local/airflow/include/dbt/logs', 'indirect_selection': 'eager', 'static_parser': 'True', 'partial_parse': 'True', 'version_check': 'True', 'warn_error': 'None', 'log_cache_events': 'False', 'printer_width': '80', 'debug': 'False', 'introspect': 'True', 'quiet': 'False', 'cache_selected_only': 'False', 'no_print': 'None', 'send_anonymous_usage_stats': 'True', 'use_experimental_parser': 'False', 'fail_fast': 'False', 'profiles_dir': '/usr/local/airflow/include/dbt/', 'log_format': 'default', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])'}
[0m22:20:13.923562 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '854abc27-a4cf-427e-b361-f419b610a77e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffb6063a10>]}
[0m22:20:13.954682 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '854abc27-a4cf-427e-b361-f419b610a77e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffb7b27d10>]}
[0m22:20:13.956213 [info ] [MainThread]: Registered adapter: bigquery=1.5.3
[0m22:20:13.977086 [debug] [MainThread]: checksum: dd837546c89c9d03f3c2cb0ca6165266a30da6076d5d44e9991f7c5a8e5f5831, vars: {}, profile: , target: , version: 1.5.9
[0m22:20:14.052803 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m22:20:14.053658 [debug] [MainThread]: Partial parsing: updated file: uber://models/transform/dropoff_location_dim.sql
[0m22:20:14.076609 [debug] [MainThread]: 1603: static parser failed on transform/dropoff_location_dim.sql
[0m22:20:14.088958 [error] [MainThread]: Encountered an error:
Compilation Error in model dropoff_location_dim (models/transform/dropoff_location_dim.sql)
  parameter 'upper_bound' was not provided
  
  > in macro get_powers_of_two (macros/sql/generate_series.sql)
  > called by macro default__generate_series (macros/sql/generate_series.sql)
  > called by macro generate_series (macros/sql/generate_series.sql)
  > called by model dropoff_location_dim (models/transform/dropoff_location_dim.sql)
[0m22:20:14.090192 [debug] [MainThread]: Command `dbt run` failed at 22:20:14.090025 after 0.91 seconds
[0m22:20:14.090783 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffb7f37b50>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffb5ec5010>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffb7f9eb50>]}
[0m22:20:14.091317 [debug] [MainThread]: Flushing usage events
[0m22:22:31.938581 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff9ef837d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff9ef82e50>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffa35b8850>]}


============================== 22:22:31.943892 | d0e5fb09-c566-472d-a99a-721d2cc7a788 ==============================
[0m22:22:31.943892 [info ] [MainThread]: Running with dbt=1.5.9
[0m22:22:31.944915 [debug] [MainThread]: running dbt with arguments {'debug': 'False', 'introspect': 'True', 'write_json': 'True', 'log_cache_events': 'False', 'cache_selected_only': 'False', 'log_format': 'default', 'warn_error': 'None', 'fail_fast': 'False', 'partial_parse': 'True', 'indirect_selection': 'eager', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'static_parser': 'True', 'send_anonymous_usage_stats': 'True', 'profiles_dir': '/usr/local/airflow/include/dbt/', 'use_colors': 'True', 'printer_width': '80', 'quiet': 'False', 'use_experimental_parser': 'False', 'log_path': '/usr/local/airflow/include/dbt/logs', 'target_path': 'None', 'version_check': 'True', 'no_print': 'None'}
[0m22:22:32.392115 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'd0e5fb09-c566-472d-a99a-721d2cc7a788', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff9d567050>]}
[0m22:22:32.403423 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'd0e5fb09-c566-472d-a99a-721d2cc7a788', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff9f9231d0>]}
[0m22:22:32.404174 [info ] [MainThread]: Registered adapter: bigquery=1.5.3
[0m22:22:32.419410 [debug] [MainThread]: checksum: dd837546c89c9d03f3c2cb0ca6165266a30da6076d5d44e9991f7c5a8e5f5831, vars: {}, profile: , target: , version: 1.5.9
[0m22:22:32.484223 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m22:22:32.484974 [debug] [MainThread]: Partial parsing: updated file: uber://models/transform/dropoff_location_dim.sql
[0m22:22:32.506521 [debug] [MainThread]: 1603: static parser failed on transform/dropoff_location_dim.sql
[0m22:22:32.512282 [error] [MainThread]: Encountered an error:
Compilation Error in model dropoff_location_dim (models/transform/dropoff_location_dim.sql)
  expected token ',', got 'COUNT'
    line 3
      {{ dbt_utils.generate_series(upper_bound = SELECT COUNT(*) FROM {{ source('uber', 'uber_tlc_trip_recrord_data') }})}} as dropoff_location_id,
[0m22:22:32.513927 [debug] [MainThread]: Command `dbt run` failed at 22:22:32.513447 after 0.58 seconds
[0m22:22:32.514713 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff9f7b7550>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff9f90f790>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff9f921b90>]}
[0m22:22:32.515412 [debug] [MainThread]: Flushing usage events
[0m22:26:36.637913 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffa78dcbd0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffa7848b10>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffab5a8850>]}


============================== 22:26:36.647133 | c51d7520-6be6-4e04-9e07-ac4a04420c9b ==============================
[0m22:26:36.647133 [info ] [MainThread]: Running with dbt=1.5.9
[0m22:26:36.649514 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'target_path': 'None', 'use_colors': 'True', 'indirect_selection': 'eager', 'no_print': 'None', 'send_anonymous_usage_stats': 'True', 'debug': 'False', 'use_experimental_parser': 'False', 'warn_error': 'None', 'fail_fast': 'False', 'partial_parse': 'True', 'log_format': 'default', 'log_cache_events': 'False', 'profiles_dir': '/usr/local/airflow/include/dbt/', 'cache_selected_only': 'False', 'log_path': '/usr/local/airflow/include/dbt/logs', 'introspect': 'True', 'write_json': 'True', 'quiet': 'False', 'version_check': 'True', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'static_parser': 'True'}
[0m22:26:37.237818 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'c51d7520-6be6-4e04-9e07-ac4a04420c9b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffa6f736d0>]}
[0m22:26:37.249947 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'c51d7520-6be6-4e04-9e07-ac4a04420c9b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffa552fa10>]}
[0m22:26:37.250827 [info ] [MainThread]: Registered adapter: bigquery=1.5.3
[0m22:26:37.266942 [debug] [MainThread]: checksum: dd837546c89c9d03f3c2cb0ca6165266a30da6076d5d44e9991f7c5a8e5f5831, vars: {}, profile: , target: , version: 1.5.9
[0m22:26:37.360111 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m22:26:37.360854 [debug] [MainThread]: Partial parsing: updated file: uber://models/transform/dropoff_location_dim.sql
[0m22:26:37.381280 [debug] [MainThread]: 1699: static parser successfully parsed transform/dropoff_location_dim.sql
[0m22:26:37.401995 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'c51d7520-6be6-4e04-9e07-ac4a04420c9b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffa5572750>]}
[0m22:26:37.421749 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'c51d7520-6be6-4e04-9e07-ac4a04420c9b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffa5409c90>]}
[0m22:26:37.422573 [info ] [MainThread]: Found 7 models, 0 tests, 0 snapshots, 0 analyses, 474 macros, 0 operations, 0 seed files, 1 source, 0 exposures, 0 metrics, 0 groups
[0m22:26:37.424226 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'c51d7520-6be6-4e04-9e07-ac4a04420c9b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffa74738d0>]}
[0m22:26:37.426704 [info ] [MainThread]: 
[0m22:26:37.429023 [debug] [MainThread]: Acquiring new bigquery connection 'master'
[0m22:26:37.431389 [debug] [ThreadPool]: Acquiring new bigquery connection 'list_uber-data-engineering-407103'
[0m22:26:37.431953 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m22:26:38.785554 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_uber-data-engineering-407103, now list_uber-data-engineering-407103_uber)
[0m22:26:38.796669 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m22:26:41.970589 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'c51d7520-6be6-4e04-9e07-ac4a04420c9b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffa555c690>]}
[0m22:26:41.974038 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m22:26:41.975107 [info ] [MainThread]: 
[0m22:26:42.027546 [debug] [Thread-1 (]: Began running node model.uber.datetime_dim
[0m22:26:42.034208 [info ] [Thread-1 (]: 1 of 7 START sql table model uber.datetime_dim ................................. [RUN]
[0m22:26:42.041070 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_uber-data-engineering-407103_uber, now model.uber.datetime_dim)
[0m22:26:42.042352 [debug] [Thread-1 (]: Began compiling node model.uber.datetime_dim
[0m22:26:42.098187 [debug] [Thread-1 (]: Writing injected SQL for node "model.uber.datetime_dim"
[0m22:26:42.101817 [debug] [Thread-1 (]: Timing info for model.uber.datetime_dim (compile): 22:26:42.043027 => 22:26:42.101190
[0m22:26:42.103446 [debug] [Thread-1 (]: Began executing node model.uber.datetime_dim
[0m22:26:42.123497 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m22:26:43.681046 [debug] [Thread-1 (]: Writing runtime sql for node "model.uber.datetime_dim"
[0m22:26:43.683313 [debug] [Thread-1 (]: On model.uber.datetime_dim: /* {"app": "dbt", "dbt_version": "1.5.9", "profile_name": "uber", "target_name": "dev", "node_id": "model.uber.datetime_dim"} */

  
    

    create or replace table `uber-data-engineering-407103`.`uber`.`datetime_dim`
    
    

    OPTIONS()
    as (
      WITH datetime_cte AS (  
  SELECT DISTINCT 
    to_hex(md5(cast(coalesce(cast(tpep_pickup_datetime as STRING), '_dbt_utils_surrogate_key_null_') || '-' || coalesce(cast(tpep_dropoff_datetime as STRING), '_dbt_utils_surrogate_key_null_') as STRING))) AS datetime_id,
    CASE
      WHEN LENGTH(tpep_pickup_datetime) = 16 THEN
        -- Date format: "DD/MM/YYYY HH:MM"
        PARSE_DATETIME('%m/%d/%Y %H:%M', tpep_pickup_datetime)
      WHEN LENGTH(tpep_pickup_datetime) <= 14 THEN
        -- Date format: "MM/DD/YY HH:MM"
        PARSE_DATETIME('%m/%d/%y %H:%M', tpep_pickup_datetime)
      ELSE
        NULL
    END AS pick_date_part,
    tpep_dropoff_datetime AS drop_datetime_id,
    CASE
      WHEN LENGTH(tpep_dropoff_datetime) = 16 THEN
        -- Date format: "DD/MM/YYYY HH:MM"
        PARSE_DATETIME('%m/%d/%Y %H:%M', tpep_dropoff_datetime)
      WHEN LENGTH(tpep_dropoff_datetime) <= 14 THEN
        -- Date format: "MM/DD/YY HH:MM"
        PARSE_DATETIME('%m/%d/%y %H:%M', tpep_dropoff_datetime)
      ELSE
        NULL
    END AS drop_date_part
  FROM `uber-data-engineering-407103`.`uber`.`uber_tlc_trip_recrord_data`
  WHERE tpep_pickup_datetime IS NOT NULL
    AND tpep_dropoff_datetime IS NOT NULL
)
SELECT
  datetime_id,
  pick_date_part AS tpep_pickup_datetime,
  drop_date_part AS tpep_dropoff_datetime,
  EXTRACT(HOUR FROM pick_date_part) AS pick_hour,
  EXTRACT(DAY FROM pick_date_part) AS pick_day,
  EXTRACT(MONTH FROM pick_date_part) AS pick_month,
  EXTRACT(YEAR FROM pick_date_part) AS pick_year,
  EXTRACT(DAYOFWEEK FROM pick_date_part) AS pick_weekday,
  EXTRACT(HOUR FROM drop_date_part) AS drop_hour,
  EXTRACT(DAY FROM drop_date_part) AS drop_day,
  EXTRACT(MONTH FROM drop_date_part) AS drop_month,
  EXTRACT(YEAR FROM drop_date_part) AS drop_year,
  EXTRACT(DAYOFWEEK FROM drop_date_part) AS drop_weekday
FROM datetime_cte
    );
  
[0m22:26:46.984251 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=uber-data-engineering-407103&j=bq:US:fc05b278-a109-4444-824f-d21faa93556d&page=queryresults
[0m22:26:47.039640 [debug] [Thread-1 (]: Timing info for model.uber.datetime_dim (execute): 22:26:42.104251 => 22:26:47.039035
[0m22:26:47.042163 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'c51d7520-6be6-4e04-9e07-ac4a04420c9b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffa55868d0>]}
[0m22:26:47.044161 [info ] [Thread-1 (]: 1 of 7 OK created sql table model uber.datetime_dim ............................ [[32mCREATE TABLE (99.9k rows, 4.0 MiB processed)[0m in 5.00s]
[0m22:26:47.046128 [debug] [Thread-1 (]: Finished running node model.uber.datetime_dim
[0m22:26:47.048621 [debug] [Thread-1 (]: Began running node model.uber.dropoff_location_dim
[0m22:26:47.050407 [info ] [Thread-1 (]: 2 of 7 START sql table model uber.dropoff_location_dim ......................... [RUN]
[0m22:26:47.051781 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.uber.datetime_dim, now model.uber.dropoff_location_dim)
[0m22:26:47.052705 [debug] [Thread-1 (]: Began compiling node model.uber.dropoff_location_dim
[0m22:26:47.059962 [debug] [Thread-1 (]: Writing injected SQL for node "model.uber.dropoff_location_dim"
[0m22:26:47.064608 [debug] [Thread-1 (]: Timing info for model.uber.dropoff_location_dim (compile): 22:26:47.053398 => 22:26:47.064216
[0m22:26:47.065418 [debug] [Thread-1 (]: Began executing node model.uber.dropoff_location_dim
[0m22:26:47.086918 [debug] [Thread-1 (]: Writing runtime sql for node "model.uber.dropoff_location_dim"
[0m22:26:47.091657 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m22:26:47.101826 [debug] [Thread-1 (]: On model.uber.dropoff_location_dim: /* {"app": "dbt", "dbt_version": "1.5.9", "profile_name": "uber", "target_name": "dev", "node_id": "model.uber.dropoff_location_dim"} */

  
    

    create or replace table `uber-data-engineering-407103`.`uber`.`dropoff_location_dim`
    
    

    OPTIONS()
    as (
      WITH numbered_rows AS (
  SELECT
    CAST(ROW_NUMBER() OVER () AS INT64) as dropoff_location_id,
    dropoff_latitude AS dropoff_latitude,
    dropoff_longitude AS dropoff_longitude,
    ROW_NUMBER() OVER (ORDER BY dropoff_latitude, dropoff_longitude) as row_num
  FROM `uber-data-engineering-407103`.`uber`.`uber_tlc_trip_recrord_data`
)
SELECT
  dropoff_location_id,
  dropoff_latitude,
  dropoff_longitude
FROM numbered_rows
    );
  
[0m22:27:25.580201 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=uber-data-engineering-407103&j=bq:US:a4c2b84f-8b1d-4549-8d3c-1a170ed0baea&page=queryresults
[0m22:27:25.602441 [debug] [Thread-1 (]: Timing info for model.uber.dropoff_location_dim (execute): 22:26:47.065961 => 22:27:25.601878
[0m22:27:25.604997 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'c51d7520-6be6-4e04-9e07-ac4a04420c9b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffa5290790>]}
[0m22:27:25.606830 [info ] [Thread-1 (]: 2 of 7 OK created sql table model uber.dropoff_location_dim .................... [[32mCREATE TABLE (100.0k rows, 1.5 MiB processed)[0m in 38.55s]
[0m22:27:25.608505 [debug] [Thread-1 (]: Finished running node model.uber.dropoff_location_dim
[0m22:27:25.610338 [debug] [Thread-1 (]: Began running node model.uber.passenger_count_dim
[0m22:27:25.611542 [info ] [Thread-1 (]: 3 of 7 START sql table model uber.passenger_count_dim .......................... [RUN]
[0m22:27:25.612774 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.uber.dropoff_location_dim, now model.uber.passenger_count_dim)
[0m22:27:25.613536 [debug] [Thread-1 (]: Began compiling node model.uber.passenger_count_dim
[0m22:27:25.622833 [debug] [Thread-1 (]: Writing injected SQL for node "model.uber.passenger_count_dim"
[0m22:27:25.626221 [debug] [Thread-1 (]: Timing info for model.uber.passenger_count_dim (compile): 22:27:25.614043 => 22:27:25.625990
[0m22:27:25.626874 [debug] [Thread-1 (]: Began executing node model.uber.passenger_count_dim
[0m22:27:25.630119 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m22:27:26.456354 [debug] [Thread-1 (]: Writing runtime sql for node "model.uber.passenger_count_dim"
[0m22:27:26.465357 [debug] [Thread-1 (]: On model.uber.passenger_count_dim: /* {"app": "dbt", "dbt_version": "1.5.9", "profile_name": "uber", "target_name": "dev", "node_id": "model.uber.passenger_count_dim"} */

  
    

    create or replace table `uber-data-engineering-407103`.`uber`.`passenger_count_dim`
    
    

    OPTIONS()
    as (
      SELECT DISTINCT
    to_hex(md5(cast( as STRING))) as passenger_count_id,
		passenger_count AS passenger_count,
FROM `uber-data-engineering-407103`.`uber`.`uber_tlc_trip_recrord_data`
WHERE passenger_count IS NOT NULL
    );
  
[0m22:27:26.695259 [debug] [Thread-1 (]: BigQuery adapter: Retry attempt 1 of 1 after error: BadRequest('Syntax error: Unexpected keyword AS at [13:22]')
[0m22:27:26.985686 [error] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=uber-data-engineering-407103&j=bq:US:e42041e4-3d37-48f7-9f67-f4bca3e32c40&page=queryresults
[0m22:27:26.988856 [debug] [Thread-1 (]: Timing info for model.uber.passenger_count_dim (execute): 22:27:25.627340 => 22:27:26.988287
[0m22:27:27.015525 [debug] [Thread-1 (]: Database Error in model passenger_count_dim (models/transform/passenger_count_dim.sql)
  Syntax error: Unexpected keyword AS at [13:22]
  compiled Code at target/run/uber/models/transform/passenger_count_dim.sql
[0m22:27:27.016700 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'c51d7520-6be6-4e04-9e07-ac4a04420c9b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffa53b0cd0>]}
[0m22:27:27.017710 [error] [Thread-1 (]: 3 of 7 ERROR creating sql table model uber.passenger_count_dim ................. [[31mERROR[0m in 1.40s]
[0m22:27:27.018753 [debug] [Thread-1 (]: Finished running node model.uber.passenger_count_dim
[0m22:27:27.019584 [debug] [Thread-1 (]: Began running node model.uber.payment_type_dim
[0m22:27:27.020875 [info ] [Thread-1 (]: 4 of 7 START sql table model uber.payment_type_dim ............................. [RUN]
[0m22:27:27.022633 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.uber.passenger_count_dim, now model.uber.payment_type_dim)
[0m22:27:27.023437 [debug] [Thread-1 (]: Began compiling node model.uber.payment_type_dim
[0m22:27:27.037654 [debug] [Thread-1 (]: Writing injected SQL for node "model.uber.payment_type_dim"
[0m22:27:27.040599 [debug] [Thread-1 (]: Timing info for model.uber.payment_type_dim (compile): 22:27:27.023912 => 22:27:27.040286
[0m22:27:27.041270 [debug] [Thread-1 (]: Began executing node model.uber.payment_type_dim
[0m22:27:27.045402 [debug] [Thread-1 (]: Writing runtime sql for node "model.uber.payment_type_dim"
[0m22:27:27.047072 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m22:27:27.049245 [debug] [Thread-1 (]: On model.uber.payment_type_dim: /* {"app": "dbt", "dbt_version": "1.5.9", "profile_name": "uber", "target_name": "dev", "node_id": "model.uber.payment_type_dim"} */

  
    

    create or replace table `uber-data-engineering-407103`.`uber`.`payment_type_dim`
    
    

    OPTIONS()
    as (
      WITH numbered_rows AS (
  SELECT
    

    

    with p as (
        select 0 as generated_number union all select 1
    ), unioned as (

    select

    
    p0.generated_number * power(2, 0)
    
    
    + 1
    as generated_number

    from

    
    p as p0
    
    

    )

    select *
    from unioned
    where generated_number <= 1
    order by generated_number

 as payment_type_id,
    payment_type AS payment_type,
    ROW_NUMBER() OVER (ORDER BY payment_type) as row_num
  FROM `uber-data-engineering-407103`.`uber`.`uber_tlc_trip_recrord_data`
  WHERE payment_type IS NOT NULL
)
SELECT
  payment_type_id,
  payment_type
FROM numbered_rows
    );
  
[0m22:27:27.556132 [debug] [Thread-1 (]: BigQuery adapter: Retry attempt 1 of 1 after error: BadRequest('Syntax error: Unexpected "(" at [18:15]')
[0m22:27:28.324013 [error] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=uber-data-engineering-407103&j=bq:US:d1c4fdf4-0b75-49a4-94bb-37d24f09f213&page=queryresults
[0m22:27:28.329952 [debug] [Thread-1 (]: Timing info for model.uber.payment_type_dim (execute): 22:27:27.042008 => 22:27:28.329168
[0m22:27:28.338067 [debug] [Thread-1 (]: Database Error in model payment_type_dim (models/transform/payment_type_dim.sql)
  Syntax error: Unexpected "(" at [18:15]
  compiled Code at target/run/uber/models/transform/payment_type_dim.sql
[0m22:27:28.339713 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'c51d7520-6be6-4e04-9e07-ac4a04420c9b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffa418a650>]}
[0m22:27:28.341296 [error] [Thread-1 (]: 4 of 7 ERROR creating sql table model uber.payment_type_dim .................... [[31mERROR[0m in 1.32s]
[0m22:27:28.342792 [debug] [Thread-1 (]: Finished running node model.uber.payment_type_dim
[0m22:27:28.343761 [debug] [Thread-1 (]: Began running node model.uber.pickup_location_dim
[0m22:27:28.344710 [info ] [Thread-1 (]: 5 of 7 START sql table model uber.pickup_location_dim .......................... [RUN]
[0m22:27:28.345952 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.uber.payment_type_dim, now model.uber.pickup_location_dim)
[0m22:27:28.346586 [debug] [Thread-1 (]: Began compiling node model.uber.pickup_location_dim
[0m22:27:28.353237 [debug] [Thread-1 (]: Writing injected SQL for node "model.uber.pickup_location_dim"
[0m22:27:28.355634 [debug] [Thread-1 (]: Timing info for model.uber.pickup_location_dim (compile): 22:27:28.347073 => 22:27:28.355382
[0m22:27:28.356286 [debug] [Thread-1 (]: Began executing node model.uber.pickup_location_dim
[0m22:27:28.359847 [debug] [Thread-1 (]: Writing runtime sql for node "model.uber.pickup_location_dim"
[0m22:27:28.361807 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m22:27:28.363711 [debug] [Thread-1 (]: On model.uber.pickup_location_dim: /* {"app": "dbt", "dbt_version": "1.5.9", "profile_name": "uber", "target_name": "dev", "node_id": "model.uber.pickup_location_dim"} */

  
    

    create or replace table `uber-data-engineering-407103`.`uber`.`pickup_location_dim`
    
    

    OPTIONS()
    as (
      WITH numbered_rows AS (
  SELECT
    

    

    with p as (
        select 0 as generated_number union all select 1
    ), unioned as (

    select

    
    p0.generated_number * power(2, 0)
    
    
    + 1
    as generated_number

    from

    
    p as p0
    
    

    )

    select *
    from unioned
    where generated_number <= 1
    order by generated_number

 as pickup_location_id,
    pickup_latitude AS pickup_latitude,
    pickup_longitude AS pickup_longitude,
    ROW_NUMBER() OVER (ORDER BY pickup_latitude, pickup_longitude) as row_num
  FROM `uber-data-engineering-407103`.`uber`.`uber_tlc_trip_recrord_data`
)
SELECT
  pickup_location_id,
  pickup_latitude,
  pickup_longitude
FROM numbered_rows
    );
  
[0m22:27:28.927703 [debug] [Thread-1 (]: BigQuery adapter: Retry attempt 1 of 1 after error: BadRequest('Syntax error: Unexpected "(" at [18:15]')
[0m22:27:30.023227 [error] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=uber-data-engineering-407103&j=bq:US:d957dd90-79de-4320-85e2-d90dec2ec58c&page=queryresults
[0m22:27:30.028489 [debug] [Thread-1 (]: Timing info for model.uber.pickup_location_dim (execute): 22:27:28.356790 => 22:27:30.027260
[0m22:27:30.037099 [debug] [Thread-1 (]: Database Error in model pickup_location_dim (models/transform/pickup_location_dim.sql)
  Syntax error: Unexpected "(" at [18:15]
  compiled Code at target/run/uber/models/transform/pickup_location_dim.sql
[0m22:27:30.039356 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'c51d7520-6be6-4e04-9e07-ac4a04420c9b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffa409eb50>]}
[0m22:27:30.043451 [error] [Thread-1 (]: 5 of 7 ERROR creating sql table model uber.pickup_location_dim ................. [[31mERROR[0m in 1.69s]
[0m22:27:30.045478 [debug] [Thread-1 (]: Finished running node model.uber.pickup_location_dim
[0m22:27:30.046948 [debug] [Thread-1 (]: Began running node model.uber.rate_code_dim
[0m22:27:30.049274 [info ] [Thread-1 (]: 6 of 7 START sql table model uber.rate_code_dim ................................ [RUN]
[0m22:27:30.051236 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.uber.pickup_location_dim, now model.uber.rate_code_dim)
[0m22:27:30.052418 [debug] [Thread-1 (]: Began compiling node model.uber.rate_code_dim
[0m22:27:30.063262 [debug] [Thread-1 (]: Writing injected SQL for node "model.uber.rate_code_dim"
[0m22:27:30.066060 [debug] [Thread-1 (]: Timing info for model.uber.rate_code_dim (compile): 22:27:30.053176 => 22:27:30.065857
[0m22:27:30.066706 [debug] [Thread-1 (]: Began executing node model.uber.rate_code_dim
[0m22:27:30.070472 [debug] [Thread-1 (]: Writing runtime sql for node "model.uber.rate_code_dim"
[0m22:27:30.072890 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m22:27:30.076100 [debug] [Thread-1 (]: On model.uber.rate_code_dim: /* {"app": "dbt", "dbt_version": "1.5.9", "profile_name": "uber", "target_name": "dev", "node_id": "model.uber.rate_code_dim"} */

  
    

    create or replace table `uber-data-engineering-407103`.`uber`.`rate_code_dim`
    
    

    OPTIONS()
    as (
      WITH numbered_rows AS (
  SELECT
    

    

    with p as (
        select 0 as generated_number union all select 1
    ), unioned as (

    select

    
    p0.generated_number * power(2, 0)
    
    
    + 1
    as generated_number

    from

    
    p as p0
    
    

    )

    select *
    from unioned
    where generated_number <= 1
    order by generated_number

 as rate_code_id,
    RatecodeID AS RatecodeID,
    ROW_NUMBER() OVER (ORDER BY RatecodeID) as row_num
  FROM `uber-data-engineering-407103`.`uber`.`uber_tlc_trip_recrord_data`
  WHERE RatecodeID IS NOT NULL
)
SELECT
  rate_code_id,
  rate_code
FROM numbered_rows
    );
  
[0m22:27:30.599114 [debug] [Thread-1 (]: BigQuery adapter: Retry attempt 1 of 1 after error: BadRequest('Syntax error: Unexpected "(" at [18:15]')
[0m22:27:31.195204 [error] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=uber-data-engineering-407103&j=bq:US:021e3489-f8b3-4eb8-8752-ec1601642c23&page=queryresults
[0m22:27:31.196990 [debug] [Thread-1 (]: Timing info for model.uber.rate_code_dim (execute): 22:27:30.067201 => 22:27:31.196747
[0m22:27:31.201506 [debug] [Thread-1 (]: Database Error in model rate_code_dim (models/transform/rate_code_dim.sql)
  Syntax error: Unexpected "(" at [18:15]
  compiled Code at target/run/uber/models/transform/rate_code_dim.sql
[0m22:27:31.202227 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'c51d7520-6be6-4e04-9e07-ac4a04420c9b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffa40f42d0>]}
[0m22:27:31.203066 [error] [Thread-1 (]: 6 of 7 ERROR creating sql table model uber.rate_code_dim ....................... [[31mERROR[0m in 1.15s]
[0m22:27:31.203907 [debug] [Thread-1 (]: Finished running node model.uber.rate_code_dim
[0m22:27:31.204541 [debug] [Thread-1 (]: Began running node model.uber.trip_distance
[0m22:27:31.205374 [info ] [Thread-1 (]: 7 of 7 START sql table model uber.trip_distance ................................ [RUN]
[0m22:27:31.206522 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.uber.rate_code_dim, now model.uber.trip_distance)
[0m22:27:31.207143 [debug] [Thread-1 (]: Began compiling node model.uber.trip_distance
[0m22:27:31.211630 [debug] [Thread-1 (]: Writing injected SQL for node "model.uber.trip_distance"
[0m22:27:31.213527 [debug] [Thread-1 (]: Timing info for model.uber.trip_distance (compile): 22:27:31.207649 => 22:27:31.213375
[0m22:27:31.214022 [debug] [Thread-1 (]: Began executing node model.uber.trip_distance
[0m22:27:31.216835 [debug] [Thread-1 (]: Writing runtime sql for node "model.uber.trip_distance"
[0m22:27:31.218558 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m22:27:31.220334 [debug] [Thread-1 (]: On model.uber.trip_distance: /* {"app": "dbt", "dbt_version": "1.5.9", "profile_name": "uber", "target_name": "dev", "node_id": "model.uber.trip_distance"} */

  
    

    create or replace table `uber-data-engineering-407103`.`uber`.`trip_distance`
    
    

    OPTIONS()
    as (
      WITH numbered_rows AS (
  SELECT
    to_hex(md5(cast( as STRING))) as trip_distance_id,
    trip_distance AS trip_distance,
    ROW_NUMBER() OVER (ORDER BY trip_distance) as row_num
  FROM `uber-data-engineering-407103`.`uber`.`uber_tlc_trip_recrord_data`
  WHERE trip_distance IS NOT NULL
)
SELECT
  trip_distance_id,
  trip_distance
FROM numbered_rows
    );
  
[0m22:27:31.883012 [debug] [Thread-1 (]: BigQuery adapter: Retry attempt 1 of 1 after error: BadRequest('Syntax error: Unexpected keyword AS at [14:22]')
[0m22:27:32.618235 [error] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=uber-data-engineering-407103&j=bq:US:ae81f617-4434-4340-943f-065adb178bc3&page=queryresults
[0m22:27:32.623513 [debug] [Thread-1 (]: Timing info for model.uber.trip_distance (execute): 22:27:31.214438 => 22:27:32.622642
[0m22:27:32.632707 [debug] [Thread-1 (]: Database Error in model trip_distance (models/transform/trip_distance.sql)
  Syntax error: Unexpected keyword AS at [14:22]
  compiled Code at target/run/uber/models/transform/trip_distance.sql
[0m22:27:32.634794 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'c51d7520-6be6-4e04-9e07-ac4a04420c9b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffa40b9d90>]}
[0m22:27:32.636896 [error] [Thread-1 (]: 7 of 7 ERROR creating sql table model uber.trip_distance ....................... [[31mERROR[0m in 1.43s]
[0m22:27:32.639607 [debug] [Thread-1 (]: Finished running node model.uber.trip_distance
[0m22:27:32.647344 [debug] [MainThread]: Connection 'master' was properly closed.
[0m22:27:32.648537 [debug] [MainThread]: Connection 'model.uber.trip_distance' was properly closed.
[0m22:27:32.649998 [info ] [MainThread]: 
[0m22:27:32.651290 [info ] [MainThread]: Finished running 7 table models in 0 hours 0 minutes and 55.22 seconds (55.22s).
[0m22:27:32.654078 [debug] [MainThread]: Command end result
[0m22:27:32.697398 [info ] [MainThread]: 
[0m22:27:32.700283 [info ] [MainThread]: [31mCompleted with 5 errors and 0 warnings:[0m
[0m22:27:32.701506 [info ] [MainThread]: 
[0m22:27:32.702252 [error] [MainThread]: [33mDatabase Error in model passenger_count_dim (models/transform/passenger_count_dim.sql)[0m
[0m22:27:32.703194 [error] [MainThread]:   Syntax error: Unexpected keyword AS at [13:22]
[0m22:27:32.704239 [error] [MainThread]:   compiled Code at target/run/uber/models/transform/passenger_count_dim.sql
[0m22:27:32.708140 [info ] [MainThread]: 
[0m22:27:32.709451 [error] [MainThread]: [33mDatabase Error in model payment_type_dim (models/transform/payment_type_dim.sql)[0m
[0m22:27:32.710188 [error] [MainThread]:   Syntax error: Unexpected "(" at [18:15]
[0m22:27:32.710961 [error] [MainThread]:   compiled Code at target/run/uber/models/transform/payment_type_dim.sql
[0m22:27:32.711748 [info ] [MainThread]: 
[0m22:27:32.712480 [error] [MainThread]: [33mDatabase Error in model pickup_location_dim (models/transform/pickup_location_dim.sql)[0m
[0m22:27:32.713200 [error] [MainThread]:   Syntax error: Unexpected "(" at [18:15]
[0m22:27:32.713812 [error] [MainThread]:   compiled Code at target/run/uber/models/transform/pickup_location_dim.sql
[0m22:27:32.714434 [info ] [MainThread]: 
[0m22:27:32.715000 [error] [MainThread]: [33mDatabase Error in model rate_code_dim (models/transform/rate_code_dim.sql)[0m
[0m22:27:32.715546 [error] [MainThread]:   Syntax error: Unexpected "(" at [18:15]
[0m22:27:32.716070 [error] [MainThread]:   compiled Code at target/run/uber/models/transform/rate_code_dim.sql
[0m22:27:32.716634 [info ] [MainThread]: 
[0m22:27:32.717137 [error] [MainThread]: [33mDatabase Error in model trip_distance (models/transform/trip_distance.sql)[0m
[0m22:27:32.717675 [error] [MainThread]:   Syntax error: Unexpected keyword AS at [14:22]
[0m22:27:32.718185 [error] [MainThread]:   compiled Code at target/run/uber/models/transform/trip_distance.sql
[0m22:27:32.718740 [info ] [MainThread]: 
[0m22:27:32.719549 [info ] [MainThread]: Done. PASS=2 WARN=0 ERROR=5 SKIP=0 TOTAL=7
[0m22:27:32.722424 [debug] [MainThread]: Command `dbt run` failed at 22:27:32.722153 after 56.10 seconds
[0m22:27:32.724195 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffa872e790>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffa5390b50>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffa77a6710>]}
[0m22:27:32.724937 [debug] [MainThread]: Flushing usage events
[0m00:13:43.550432 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff9964ff10>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff99cff350>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff99957fd0>]}


============================== 00:13:43.561368 | c1f89955-9807-4854-94b9-e0c903688030 ==============================
[0m00:13:43.561368 [info ] [MainThread]: Running with dbt=1.5.9
[0m00:13:43.563035 [debug] [MainThread]: running dbt with arguments {'cache_selected_only': 'False', 'use_colors': 'True', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'use_experimental_parser': 'False', 'fail_fast': 'False', 'introspect': 'True', 'log_format': 'default', 'printer_width': '80', 'profiles_dir': '/usr/local/airflow/include/dbt/', 'indirect_selection': 'eager', 'partial_parse': 'True', 'log_path': '/usr/local/airflow/include/dbt/logs', 'write_json': 'True', 'static_parser': 'True', 'debug': 'False', 'log_cache_events': 'False', 'warn_error': 'None', 'target_path': 'None', 'no_print': 'None', 'quiet': 'False', 'version_check': 'True', 'send_anonymous_usage_stats': 'True'}
[0m00:13:44.667924 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'c1f89955-9807-4854-94b9-e0c903688030', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff99661050>]}
[0m00:13:44.684801 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'c1f89955-9807-4854-94b9-e0c903688030', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff975e7ed0>]}
[0m00:13:44.685895 [info ] [MainThread]: Registered adapter: bigquery=1.5.3
[0m00:13:44.705249 [debug] [MainThread]: checksum: dd837546c89c9d03f3c2cb0ca6165266a30da6076d5d44e9991f7c5a8e5f5831, vars: {}, profile: , target: , version: 1.5.9
[0m00:13:44.796642 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 7 files changed.
[0m00:13:44.797554 [debug] [MainThread]: Partial parsing: updated file: uber://models/transform/payment_type_dim.sql
[0m00:13:44.798163 [debug] [MainThread]: Partial parsing: updated file: uber://models/transform/dropoff_location_dim.sql
[0m00:13:44.798729 [debug] [MainThread]: Partial parsing: updated file: uber://models/transform/passenger_count_dim.sql
[0m00:13:44.799279 [debug] [MainThread]: Partial parsing: updated file: uber://models/transform/pickup_location_dim.sql
[0m00:13:44.799831 [debug] [MainThread]: Partial parsing: updated file: uber://models/transform/datetime_dim.sql
[0m00:13:44.800378 [debug] [MainThread]: Partial parsing: updated file: uber://models/transform/trip_distance.sql
[0m00:13:44.800906 [debug] [MainThread]: Partial parsing: updated file: uber://models/transform/rate_code_dim.sql
[0m00:13:44.825580 [debug] [MainThread]: 1699: static parser successfully parsed transform/payment_type_dim.sql
[0m00:13:44.836659 [debug] [MainThread]: 1603: static parser failed on transform/dropoff_location_dim.sql
[0m00:13:44.855011 [debug] [MainThread]: 1602: parser fallback to jinja rendering on transform/dropoff_location_dim.sql
[0m00:13:44.856886 [debug] [MainThread]: 1699: static parser successfully parsed transform/passenger_count_dim.sql
[0m00:13:44.861351 [debug] [MainThread]: 1603: static parser failed on transform/pickup_location_dim.sql
[0m00:13:44.867540 [debug] [MainThread]: 1602: parser fallback to jinja rendering on transform/pickup_location_dim.sql
[0m00:13:44.869880 [debug] [MainThread]: 1603: static parser failed on transform/datetime_dim.sql
[0m00:13:44.878860 [debug] [MainThread]: 1602: parser fallback to jinja rendering on transform/datetime_dim.sql
[0m00:13:44.880726 [debug] [MainThread]: 1699: static parser successfully parsed transform/trip_distance.sql
[0m00:13:44.885920 [debug] [MainThread]: 1699: static parser successfully parsed transform/rate_code_dim.sql
[0m00:13:44.902608 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'c1f89955-9807-4854-94b9-e0c903688030', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff974f8450>]}
[0m00:13:44.924285 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'c1f89955-9807-4854-94b9-e0c903688030', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff97414350>]}
[0m00:13:44.924959 [info ] [MainThread]: Found 7 models, 0 tests, 0 snapshots, 0 analyses, 474 macros, 0 operations, 0 seed files, 1 source, 0 exposures, 0 metrics, 0 groups
[0m00:13:44.925693 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'c1f89955-9807-4854-94b9-e0c903688030', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff9c4eb6d0>]}
[0m00:13:44.927463 [info ] [MainThread]: 
[0m00:13:44.928380 [debug] [MainThread]: Acquiring new bigquery connection 'master'
[0m00:13:44.930466 [debug] [ThreadPool]: Acquiring new bigquery connection 'list_uber-data-engineering-407103'
[0m00:13:44.931075 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m00:13:45.453171 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_uber-data-engineering-407103, now list_uber-data-engineering-407103_uber)
[0m00:13:45.454153 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m00:13:45.831296 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'c1f89955-9807-4854-94b9-e0c903688030', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff973fcfd0>]}
[0m00:13:45.833787 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m00:13:45.834994 [info ] [MainThread]: 
[0m00:13:45.859301 [debug] [Thread-1 (]: Began running node model.uber.datetime_dim
[0m00:13:45.860154 [info ] [Thread-1 (]: 1 of 7 START sql table model uber.datetime_dim ................................. [RUN]
[0m00:13:45.861230 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_uber-data-engineering-407103_uber, now model.uber.datetime_dim)
[0m00:13:45.861762 [debug] [Thread-1 (]: Began compiling node model.uber.datetime_dim
[0m00:13:45.874174 [debug] [Thread-1 (]: Writing injected SQL for node "model.uber.datetime_dim"
[0m00:13:45.876496 [debug] [Thread-1 (]: Timing info for model.uber.datetime_dim (compile): 00:13:45.862271 => 00:13:45.876296
[0m00:13:45.877059 [debug] [Thread-1 (]: Began executing node model.uber.datetime_dim
[0m00:13:45.890342 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m00:13:46.555789 [debug] [Thread-1 (]: Writing runtime sql for node "model.uber.datetime_dim"
[0m00:13:46.559786 [debug] [Thread-1 (]: On model.uber.datetime_dim: /* {"app": "dbt", "dbt_version": "1.5.9", "profile_name": "uber", "target_name": "dev", "node_id": "model.uber.datetime_dim"} */

  
    

    create or replace table `uber-data-engineering-407103`.`uber`.`datetime_dim`
    
    

    OPTIONS()
    as (
      WITH datetime_cte AS (  
  SELECT DISTINCT 
    to_hex(md5(cast(coalesce(cast(tpep_pickup_datetime as STRING), '_dbt_utils_surrogate_key_null_') || '-' || coalesce(cast(tpep_dropoff_datetime as STRING), '_dbt_utils_surrogate_key_null_') as STRING))) AS datetime_id,
    CASE
      WHEN LENGTH(tpep_pickup_datetime) = 16 THEN
        -- Date format: "DD/MM/YYYY HH:MM"
        PARSE_DATETIME('%m/%d/%Y %H:%M', tpep_pickup_datetime)
      WHEN LENGTH(tpep_pickup_datetime) <= 14 THEN
        -- Date format: "MM/DD/YY HH:MM"
        PARSE_DATETIME('%m/%d/%y %H:%M', tpep_pickup_datetime)
      ELSE
        NULL
    END AS pick_date_part,
    tpep_dropoff_datetime AS drop_datetime_id,
    CASE
      WHEN LENGTH(tpep_dropoff_datetime) = 16 THEN
        -- Date format: "DD/MM/YYYY HH:MM"
        PARSE_DATETIME('%m/%d/%Y %H:%M', tpep_dropoff_datetime)
      WHEN LENGTH(tpep_dropoff_datetime) <= 14 THEN
        -- Date format: "MM/DD/YY HH:MM"
        PARSE_DATETIME('%m/%d/%y %H:%M', tpep_dropoff_datetime)
      ELSE
        NULL
    END AS drop_date_part
  FROM `uber-data-engineering-407103`.`uber`.`uber_tlc_trip_recrord_data`
  WHERE tpep_pickup_datetime IS NOT NULL
    AND tpep_dropoff_datetime IS NOT NULL
)
SELECT
  datetime_id,
  pick_date_part AS tpep_pickup_datetime,
  drop_date_part AS tpep_dropoff_datetime,
  EXTRACT(HOUR FROM pick_date_part) AS pick_hour,
  EXTRACT(DAY FROM pick_date_part) AS pick_day,
  EXTRACT(MONTH FROM pick_date_part) AS pick_month,
  EXTRACT(YEAR FROM pick_date_part) AS pick_year,
  EXTRACT(DAYOFWEEK FROM pick_date_part) AS pick_weekday,
  EXTRACT(HOUR FROM drop_date_part) AS drop_hour,
  EXTRACT(DAY FROM drop_date_part) AS drop_day,
  EXTRACT(MONTH FROM drop_date_part) AS drop_month,
  EXTRACT(YEAR FROM drop_date_part) AS drop_year,
  EXTRACT(DAYOFWEEK FROM drop_date_part) AS drop_weekday
FROM datetime_cte
    );
  
[0m00:13:50.928736 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=uber-data-engineering-407103&j=bq:US:02a82921-c8f3-4f92-96e2-8859af14589f&page=queryresults
[0m00:13:50.975594 [debug] [Thread-1 (]: Timing info for model.uber.datetime_dim (execute): 00:13:45.877479 => 00:13:50.975011
[0m00:13:50.978138 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'c1f89955-9807-4854-94b9-e0c903688030', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff974f8450>]}
[0m00:13:50.980029 [info ] [Thread-1 (]: 1 of 7 OK created sql table model uber.datetime_dim ............................ [[32mCREATE TABLE (99.9k rows, 4.0 MiB processed)[0m in 5.12s]
[0m00:13:50.981648 [debug] [Thread-1 (]: Finished running node model.uber.datetime_dim
[0m00:13:50.983186 [debug] [Thread-1 (]: Began running node model.uber.dropoff_location_dim
[0m00:13:50.985656 [info ] [Thread-1 (]: 2 of 7 START sql table model uber.dropoff_location_dim ......................... [RUN]
[0m00:13:50.987807 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.uber.datetime_dim, now model.uber.dropoff_location_dim)
[0m00:13:50.988733 [debug] [Thread-1 (]: Began compiling node model.uber.dropoff_location_dim
[0m00:13:51.003505 [debug] [Thread-1 (]: Writing injected SQL for node "model.uber.dropoff_location_dim"
[0m00:13:51.007319 [debug] [Thread-1 (]: Timing info for model.uber.dropoff_location_dim (compile): 00:13:50.989389 => 00:13:51.006918
[0m00:13:51.008035 [debug] [Thread-1 (]: Began executing node model.uber.dropoff_location_dim
[0m00:13:51.011337 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m00:13:51.987239 [debug] [Thread-1 (]: Writing runtime sql for node "model.uber.dropoff_location_dim"
[0m00:13:51.992257 [debug] [Thread-1 (]: On model.uber.dropoff_location_dim: /* {"app": "dbt", "dbt_version": "1.5.9", "profile_name": "uber", "target_name": "dev", "node_id": "model.uber.dropoff_location_dim"} */

  
    

    create or replace table `uber-data-engineering-407103`.`uber`.`dropoff_location_dim`
    
    

    OPTIONS()
    as (
      WITH numbered_rows AS (
  SELECT
    to_hex(md5(cast(coalesce(cast(dropoff_latitude as STRING), '_dbt_utils_surrogate_key_null_') || '-' || coalesce(cast(dropoff_longitude as STRING), '_dbt_utils_surrogate_key_null_') as STRING))) as dropoff_location_id,
    dropoff_latitude AS dropoff_latitude,
    dropoff_longitude AS dropoff_longitude,
    ROW_NUMBER() OVER (ORDER BY dropoff_latitude, dropoff_longitude) as row_num
  FROM `uber-data-engineering-407103`.`uber`.`uber_tlc_trip_recrord_data`
)
SELECT
  dropoff_location_id,
  dropoff_latitude,
  dropoff_longitude
FROM numbered_rows
    );
  
[0m00:13:55.446932 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=uber-data-engineering-407103&j=bq:US:8f27c02d-1c96-4bdd-b46b-1c42ca7bf149&page=queryresults
[0m00:13:55.462727 [debug] [Thread-1 (]: Timing info for model.uber.dropoff_location_dim (execute): 00:13:51.008523 => 00:13:55.462089
[0m00:13:55.465635 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'c1f89955-9807-4854-94b9-e0c903688030', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff9761db90>]}
[0m00:13:55.467753 [info ] [Thread-1 (]: 2 of 7 OK created sql table model uber.dropoff_location_dim .................... [[32mCREATE TABLE (100.0k rows, 1.5 MiB processed)[0m in 4.48s]
[0m00:13:55.469822 [debug] [Thread-1 (]: Finished running node model.uber.dropoff_location_dim
[0m00:13:55.471126 [debug] [Thread-1 (]: Began running node model.uber.passenger_count_dim
[0m00:13:55.472609 [info ] [Thread-1 (]: 3 of 7 START sql table model uber.passenger_count_dim .......................... [RUN]
[0m00:13:55.473840 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.uber.dropoff_location_dim, now model.uber.passenger_count_dim)
[0m00:13:55.474617 [debug] [Thread-1 (]: Began compiling node model.uber.passenger_count_dim
[0m00:13:55.483103 [debug] [Thread-1 (]: Writing injected SQL for node "model.uber.passenger_count_dim"
[0m00:13:55.485850 [debug] [Thread-1 (]: Timing info for model.uber.passenger_count_dim (compile): 00:13:55.475137 => 00:13:55.485682
[0m00:13:55.486649 [debug] [Thread-1 (]: Began executing node model.uber.passenger_count_dim
[0m00:13:55.489495 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m00:13:55.987221 [debug] [Thread-1 (]: Writing runtime sql for node "model.uber.passenger_count_dim"
[0m00:13:55.993823 [debug] [Thread-1 (]: On model.uber.passenger_count_dim: /* {"app": "dbt", "dbt_version": "1.5.9", "profile_name": "uber", "target_name": "dev", "node_id": "model.uber.passenger_count_dim"} */

  
    

    create or replace table `uber-data-engineering-407103`.`uber`.`passenger_count_dim`
    
    

    OPTIONS()
    as (
      SELECT DISTINCT
        GENERATE_UUID() as passenger_count_id,
		passenger_count AS passenger_count,
FROM `uber-data-engineering-407103`.`uber`.`uber_tlc_trip_recrord_data`
WHERE passenger_count IS NOT NULL
    );
  
[0m00:13:59.135438 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=uber-data-engineering-407103&j=bq:US:df337557-4602-48d5-adec-daf98cb82f50&page=queryresults
[0m00:13:59.158218 [debug] [Thread-1 (]: Timing info for model.uber.passenger_count_dim (execute): 00:13:55.487126 => 00:13:59.157554
[0m00:13:59.161158 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'c1f89955-9807-4854-94b9-e0c903688030', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff973df110>]}
[0m00:13:59.163382 [info ] [Thread-1 (]: 3 of 7 OK created sql table model uber.passenger_count_dim ..................... [[32mCREATE TABLE (100.0k rows, 781.2 KiB processed)[0m in 3.69s]
[0m00:13:59.165513 [debug] [Thread-1 (]: Finished running node model.uber.passenger_count_dim
[0m00:13:59.166999 [debug] [Thread-1 (]: Began running node model.uber.payment_type_dim
[0m00:13:59.168727 [info ] [Thread-1 (]: 4 of 7 START sql table model uber.payment_type_dim ............................. [RUN]
[0m00:13:59.170173 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.uber.passenger_count_dim, now model.uber.payment_type_dim)
[0m00:13:59.170945 [debug] [Thread-1 (]: Began compiling node model.uber.payment_type_dim
[0m00:13:59.183704 [debug] [Thread-1 (]: Writing injected SQL for node "model.uber.payment_type_dim"
[0m00:13:59.186744 [debug] [Thread-1 (]: Timing info for model.uber.payment_type_dim (compile): 00:13:59.171506 => 00:13:59.186559
[0m00:13:59.187282 [debug] [Thread-1 (]: Began executing node model.uber.payment_type_dim
[0m00:13:59.191345 [debug] [Thread-1 (]: Writing runtime sql for node "model.uber.payment_type_dim"
[0m00:13:59.193510 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m00:13:59.197402 [debug] [Thread-1 (]: On model.uber.payment_type_dim: /* {"app": "dbt", "dbt_version": "1.5.9", "profile_name": "uber", "target_name": "dev", "node_id": "model.uber.payment_type_dim"} */

  
    

    create or replace table `uber-data-engineering-407103`.`uber`.`payment_type_dim`
    
    

    OPTIONS()
    as (
      WITH numbered_rows AS (
  SELECT
    GENERATE_UUID() as payment_type_id,
    payment_type AS payment_type,
    ROW_NUMBER() OVER (ORDER BY payment_type) as row_num
  FROM `uber-data-engineering-407103`.`uber`.`uber_tlc_trip_recrord_data`
  WHERE payment_type IS NOT NULL
)
SELECT
  payment_type_id,
  payment_type
FROM numbered_rows
    );
  
[0m00:14:02.560690 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=uber-data-engineering-407103&j=bq:US:fce0d0e1-1e00-4cc3-aba0-ad995a547268&page=queryresults
[0m00:14:02.563650 [debug] [Thread-1 (]: Timing info for model.uber.payment_type_dim (execute): 00:13:59.187716 => 00:14:02.563482
[0m00:14:02.564587 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'c1f89955-9807-4854-94b9-e0c903688030', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff97346e50>]}
[0m00:14:02.565420 [info ] [Thread-1 (]: 4 of 7 OK created sql table model uber.payment_type_dim ........................ [[32mCREATE TABLE (100.0k rows, 781.2 KiB processed)[0m in 3.39s]
[0m00:14:02.566533 [debug] [Thread-1 (]: Finished running node model.uber.payment_type_dim
[0m00:14:02.567294 [debug] [Thread-1 (]: Began running node model.uber.pickup_location_dim
[0m00:14:02.567926 [info ] [Thread-1 (]: 5 of 7 START sql table model uber.pickup_location_dim .......................... [RUN]
[0m00:14:02.568830 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.uber.payment_type_dim, now model.uber.pickup_location_dim)
[0m00:14:02.569339 [debug] [Thread-1 (]: Began compiling node model.uber.pickup_location_dim
[0m00:14:02.581297 [debug] [Thread-1 (]: Writing injected SQL for node "model.uber.pickup_location_dim"
[0m00:14:02.583702 [debug] [Thread-1 (]: Timing info for model.uber.pickup_location_dim (compile): 00:14:02.569775 => 00:14:02.583526
[0m00:14:02.584204 [debug] [Thread-1 (]: Began executing node model.uber.pickup_location_dim
[0m00:14:02.586903 [debug] [Thread-1 (]: Writing runtime sql for node "model.uber.pickup_location_dim"
[0m00:14:02.588917 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m00:14:02.590898 [debug] [Thread-1 (]: On model.uber.pickup_location_dim: /* {"app": "dbt", "dbt_version": "1.5.9", "profile_name": "uber", "target_name": "dev", "node_id": "model.uber.pickup_location_dim"} */

  
    

    create or replace table `uber-data-engineering-407103`.`uber`.`pickup_location_dim`
    
    

    OPTIONS()
    as (
      WITH numbered_rows AS (
  SELECT
    to_hex(md5(cast(coalesce(cast(pickup_latitude as STRING), '_dbt_utils_surrogate_key_null_') || '-' || coalesce(cast(pickup_longitude as STRING), '_dbt_utils_surrogate_key_null_') as STRING))) as pickup_location_id,
    pickup_latitude AS pickup_latitude,
    pickup_longitude AS pickup_longitude,
    ROW_NUMBER() OVER (ORDER BY pickup_latitude, pickup_longitude) as row_num
  FROM `uber-data-engineering-407103`.`uber`.`uber_tlc_trip_recrord_data`
)
SELECT
  pickup_location_id,
  pickup_latitude,
  pickup_longitude
FROM numbered_rows
    );
  
[0m00:14:06.702995 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=uber-data-engineering-407103&j=bq:US:00717ccc-d0a5-492e-9643-e13dad3f4dc2&page=queryresults
[0m00:14:06.717141 [debug] [Thread-1 (]: Timing info for model.uber.pickup_location_dim (execute): 00:14:02.584592 => 00:14:06.716432
[0m00:14:06.720074 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'c1f89955-9807-4854-94b9-e0c903688030', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff99956bd0>]}
[0m00:14:06.721857 [info ] [Thread-1 (]: 5 of 7 OK created sql table model uber.pickup_location_dim ..................... [[32mCREATE TABLE (100.0k rows, 1.5 MiB processed)[0m in 4.15s]
[0m00:14:06.724545 [debug] [Thread-1 (]: Finished running node model.uber.pickup_location_dim
[0m00:14:06.726210 [debug] [Thread-1 (]: Began running node model.uber.rate_code_dim
[0m00:14:06.727796 [info ] [Thread-1 (]: 6 of 7 START sql table model uber.rate_code_dim ................................ [RUN]
[0m00:14:06.729514 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.uber.pickup_location_dim, now model.uber.rate_code_dim)
[0m00:14:06.730272 [debug] [Thread-1 (]: Began compiling node model.uber.rate_code_dim
[0m00:14:06.737707 [debug] [Thread-1 (]: Writing injected SQL for node "model.uber.rate_code_dim"
[0m00:14:06.740302 [debug] [Thread-1 (]: Timing info for model.uber.rate_code_dim (compile): 00:14:06.730810 => 00:14:06.740139
[0m00:14:06.741112 [debug] [Thread-1 (]: Began executing node model.uber.rate_code_dim
[0m00:14:06.744794 [debug] [Thread-1 (]: Writing runtime sql for node "model.uber.rate_code_dim"
[0m00:14:06.746779 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m00:14:06.750087 [debug] [Thread-1 (]: On model.uber.rate_code_dim: /* {"app": "dbt", "dbt_version": "1.5.9", "profile_name": "uber", "target_name": "dev", "node_id": "model.uber.rate_code_dim"} */

  
    

    create or replace table `uber-data-engineering-407103`.`uber`.`rate_code_dim`
    
    

    OPTIONS()
    as (
      WITH numbered_rows AS (
  SELECT
    GENERATE_UUID() as rate_code_id,
    RatecodeID AS RatecodeID,
    ROW_NUMBER() OVER (ORDER BY RatecodeID) as row_num
  FROM `uber-data-engineering-407103`.`uber`.`uber_tlc_trip_recrord_data`
  WHERE RatecodeID IS NOT NULL
)
SELECT
  rate_code_id,
  rate_code
FROM numbered_rows
    );
  
[0m00:14:08.034143 [debug] [Thread-1 (]: BigQuery adapter: Retry attempt 1 of 1 after error: BadRequest('Unrecognized name: rate_code; Did you mean rate_code_id? at [22:3]')
[0m00:14:09.359924 [error] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=uber-data-engineering-407103&j=bq:US:c329f221-1cdd-4115-ae57-d870978bda61&page=queryresults
[0m00:14:09.365429 [debug] [Thread-1 (]: Timing info for model.uber.rate_code_dim (execute): 00:14:06.741581 => 00:14:09.364566
[0m00:14:09.392029 [debug] [Thread-1 (]: Database Error in model rate_code_dim (models/transform/rate_code_dim.sql)
  Unrecognized name: rate_code; Did you mean rate_code_id? at [22:3]
  compiled Code at target/run/uber/models/transform/rate_code_dim.sql
[0m00:14:09.393589 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'c1f89955-9807-4854-94b9-e0c903688030', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff974010d0>]}
[0m00:14:09.395181 [error] [Thread-1 (]: 6 of 7 ERROR creating sql table model uber.rate_code_dim ....................... [[31mERROR[0m in 2.66s]
[0m00:14:09.396933 [debug] [Thread-1 (]: Finished running node model.uber.rate_code_dim
[0m00:14:09.398149 [debug] [Thread-1 (]: Began running node model.uber.trip_distance
[0m00:14:09.399763 [info ] [Thread-1 (]: 7 of 7 START sql table model uber.trip_distance ................................ [RUN]
[0m00:14:09.401330 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.uber.rate_code_dim, now model.uber.trip_distance)
[0m00:14:09.402165 [debug] [Thread-1 (]: Began compiling node model.uber.trip_distance
[0m00:14:09.409233 [debug] [Thread-1 (]: Writing injected SQL for node "model.uber.trip_distance"
[0m00:14:09.412029 [debug] [Thread-1 (]: Timing info for model.uber.trip_distance (compile): 00:14:09.402809 => 00:14:09.411791
[0m00:14:09.412741 [debug] [Thread-1 (]: Began executing node model.uber.trip_distance
[0m00:14:09.416143 [debug] [Thread-1 (]: Writing runtime sql for node "model.uber.trip_distance"
[0m00:14:09.418575 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m00:14:09.420855 [debug] [Thread-1 (]: On model.uber.trip_distance: /* {"app": "dbt", "dbt_version": "1.5.9", "profile_name": "uber", "target_name": "dev", "node_id": "model.uber.trip_distance"} */

  
    

    create or replace table `uber-data-engineering-407103`.`uber`.`trip_distance`
    
    

    OPTIONS()
    as (
      WITH numbered_rows AS (
  SELECT
    GENERATE_UUID() as trip_distance_id,
    trip_distance AS trip_distance,
    ROW_NUMBER() OVER (ORDER BY trip_distance) as row_num
  FROM `uber-data-engineering-407103`.`uber`.`uber_tlc_trip_recrord_data`
  WHERE trip_distance IS NOT NULL
)
SELECT
  trip_distance_id,
  trip_distance
FROM numbered_rows
    );
  
[0m00:14:12.747028 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=uber-data-engineering-407103&j=bq:US:546f1121-ed8d-4760-a901-cd9380ef4454&page=queryresults
[0m00:14:12.759504 [debug] [Thread-1 (]: Timing info for model.uber.trip_distance (execute): 00:14:09.413173 => 00:14:12.758814
[0m00:14:12.763116 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'c1f89955-9807-4854-94b9-e0c903688030', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff96262090>]}
[0m00:14:12.765764 [info ] [Thread-1 (]: 7 of 7 OK created sql table model uber.trip_distance ........................... [[32mCREATE TABLE (100.0k rows, 781.2 KiB processed)[0m in 3.36s]
[0m00:14:12.768149 [debug] [Thread-1 (]: Finished running node model.uber.trip_distance
[0m00:14:12.791776 [debug] [MainThread]: Connection 'master' was properly closed.
[0m00:14:12.792804 [debug] [MainThread]: Connection 'model.uber.trip_distance' was properly closed.
[0m00:14:12.794084 [info ] [MainThread]: 
[0m00:14:12.795877 [info ] [MainThread]: Finished running 7 table models in 0 hours 0 minutes and 27.87 seconds (27.87s).
[0m00:14:12.803738 [debug] [MainThread]: Command end result
[0m00:14:12.867318 [info ] [MainThread]: 
[0m00:14:12.868476 [info ] [MainThread]: [31mCompleted with 1 error and 0 warnings:[0m
[0m00:14:12.869270 [info ] [MainThread]: 
[0m00:14:12.870089 [error] [MainThread]: [33mDatabase Error in model rate_code_dim (models/transform/rate_code_dim.sql)[0m
[0m00:14:12.870880 [error] [MainThread]:   Unrecognized name: rate_code; Did you mean rate_code_id? at [22:3]
[0m00:14:12.871579 [error] [MainThread]:   compiled Code at target/run/uber/models/transform/rate_code_dim.sql
[0m00:14:12.872330 [info ] [MainThread]: 
[0m00:14:12.873268 [info ] [MainThread]: Done. PASS=6 WARN=0 ERROR=1 SKIP=0 TOTAL=7
[0m00:14:12.875015 [debug] [MainThread]: Command `dbt run` failed at 00:14:12.874778 after 29.36 seconds
[0m00:14:12.876037 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff9964cc10>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff997f2350>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff9d57b090>]}
[0m00:14:12.876732 [debug] [MainThread]: Flushing usage events
[0m00:14:51.071002 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff94e83150>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff94fc5250>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff956d45d0>]}


============================== 00:14:51.076150 | 8b9a8924-e1a8-4628-a5fb-de03b3e38f67 ==============================
[0m00:14:51.076150 [info ] [MainThread]: Running with dbt=1.5.9
[0m00:14:51.077136 [debug] [MainThread]: running dbt with arguments {'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'no_print': 'None', 'use_experimental_parser': 'False', 'debug': 'False', 'static_parser': 'True', 'version_check': 'True', 'printer_width': '80', 'fail_fast': 'False', 'partial_parse': 'True', 'profiles_dir': '/usr/local/airflow/include/dbt/', 'indirect_selection': 'eager', 'target_path': 'None', 'send_anonymous_usage_stats': 'True', 'cache_selected_only': 'False', 'log_format': 'default', 'warn_error': 'None', 'log_path': '/usr/local/airflow/include/dbt/logs', 'use_colors': 'True', 'write_json': 'True', 'quiet': 'False', 'log_cache_events': 'False', 'introspect': 'True'}
[0m00:14:51.512548 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '8b9a8924-e1a8-4628-a5fb-de03b3e38f67', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff95778b90>]}
[0m00:14:51.523816 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '8b9a8924-e1a8-4628-a5fb-de03b3e38f67', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff95778b90>]}
[0m00:14:51.524576 [info ] [MainThread]: Registered adapter: bigquery=1.5.3
[0m00:14:51.539169 [debug] [MainThread]: checksum: dd837546c89c9d03f3c2cb0ca6165266a30da6076d5d44e9991f7c5a8e5f5831, vars: {}, profile: , target: , version: 1.5.9
[0m00:14:51.610271 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m00:14:51.611398 [debug] [MainThread]: Partial parsing: updated file: uber://models/transform/rate_code_dim.sql
[0m00:14:51.630851 [debug] [MainThread]: 1699: static parser successfully parsed transform/rate_code_dim.sql
[0m00:14:51.651079 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '8b9a8924-e1a8-4628-a5fb-de03b3e38f67', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff932e2790>]}
[0m00:14:51.663010 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '8b9a8924-e1a8-4628-a5fb-de03b3e38f67', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff9330e5d0>]}
[0m00:14:51.663648 [info ] [MainThread]: Found 7 models, 0 tests, 0 snapshots, 0 analyses, 474 macros, 0 operations, 0 seed files, 1 source, 0 exposures, 0 metrics, 0 groups
[0m00:14:51.664238 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '8b9a8924-e1a8-4628-a5fb-de03b3e38f67', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff983834d0>]}
[0m00:14:51.665829 [info ] [MainThread]: 
[0m00:14:51.666808 [debug] [MainThread]: Acquiring new bigquery connection 'master'
[0m00:14:51.668481 [debug] [ThreadPool]: Acquiring new bigquery connection 'list_uber-data-engineering-407103'
[0m00:14:51.668976 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m00:14:52.344262 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_uber-data-engineering-407103, now list_uber-data-engineering-407103_uber)
[0m00:14:52.346507 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m00:14:52.845569 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '8b9a8924-e1a8-4628-a5fb-de03b3e38f67', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff93471d90>]}
[0m00:14:52.849205 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m00:14:52.851121 [info ] [MainThread]: 
[0m00:14:52.885498 [debug] [Thread-1 (]: Began running node model.uber.datetime_dim
[0m00:14:52.886886 [info ] [Thread-1 (]: 1 of 7 START sql table model uber.datetime_dim ................................. [RUN]
[0m00:14:52.888396 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_uber-data-engineering-407103_uber, now model.uber.datetime_dim)
[0m00:14:52.889257 [debug] [Thread-1 (]: Began compiling node model.uber.datetime_dim
[0m00:14:52.911143 [debug] [Thread-1 (]: Writing injected SQL for node "model.uber.datetime_dim"
[0m00:14:52.913953 [debug] [Thread-1 (]: Timing info for model.uber.datetime_dim (compile): 00:14:52.889931 => 00:14:52.913668
[0m00:14:52.914711 [debug] [Thread-1 (]: Began executing node model.uber.datetime_dim
[0m00:14:52.928492 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m00:14:53.699435 [debug] [Thread-1 (]: Writing runtime sql for node "model.uber.datetime_dim"
[0m00:14:53.703069 [debug] [Thread-1 (]: On model.uber.datetime_dim: /* {"app": "dbt", "dbt_version": "1.5.9", "profile_name": "uber", "target_name": "dev", "node_id": "model.uber.datetime_dim"} */

  
    

    create or replace table `uber-data-engineering-407103`.`uber`.`datetime_dim`
    
    

    OPTIONS()
    as (
      WITH datetime_cte AS (  
  SELECT DISTINCT 
    to_hex(md5(cast(coalesce(cast(tpep_pickup_datetime as STRING), '_dbt_utils_surrogate_key_null_') || '-' || coalesce(cast(tpep_dropoff_datetime as STRING), '_dbt_utils_surrogate_key_null_') as STRING))) AS datetime_id,
    CASE
      WHEN LENGTH(tpep_pickup_datetime) = 16 THEN
        -- Date format: "DD/MM/YYYY HH:MM"
        PARSE_DATETIME('%m/%d/%Y %H:%M', tpep_pickup_datetime)
      WHEN LENGTH(tpep_pickup_datetime) <= 14 THEN
        -- Date format: "MM/DD/YY HH:MM"
        PARSE_DATETIME('%m/%d/%y %H:%M', tpep_pickup_datetime)
      ELSE
        NULL
    END AS pick_date_part,
    tpep_dropoff_datetime AS drop_datetime_id,
    CASE
      WHEN LENGTH(tpep_dropoff_datetime) = 16 THEN
        -- Date format: "DD/MM/YYYY HH:MM"
        PARSE_DATETIME('%m/%d/%Y %H:%M', tpep_dropoff_datetime)
      WHEN LENGTH(tpep_dropoff_datetime) <= 14 THEN
        -- Date format: "MM/DD/YY HH:MM"
        PARSE_DATETIME('%m/%d/%y %H:%M', tpep_dropoff_datetime)
      ELSE
        NULL
    END AS drop_date_part
  FROM `uber-data-engineering-407103`.`uber`.`uber_tlc_trip_recrord_data`
  WHERE tpep_pickup_datetime IS NOT NULL
    AND tpep_dropoff_datetime IS NOT NULL
)
SELECT
  datetime_id,
  pick_date_part AS tpep_pickup_datetime,
  drop_date_part AS tpep_dropoff_datetime,
  EXTRACT(HOUR FROM pick_date_part) AS pick_hour,
  EXTRACT(DAY FROM pick_date_part) AS pick_day,
  EXTRACT(MONTH FROM pick_date_part) AS pick_month,
  EXTRACT(YEAR FROM pick_date_part) AS pick_year,
  EXTRACT(DAYOFWEEK FROM pick_date_part) AS pick_weekday,
  EXTRACT(HOUR FROM drop_date_part) AS drop_hour,
  EXTRACT(DAY FROM drop_date_part) AS drop_day,
  EXTRACT(MONTH FROM drop_date_part) AS drop_month,
  EXTRACT(YEAR FROM drop_date_part) AS drop_year,
  EXTRACT(DAYOFWEEK FROM drop_date_part) AS drop_weekday
FROM datetime_cte
    );
  
[0m00:14:57.838976 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=uber-data-engineering-407103&j=bq:US:42d8bc1d-93b7-4249-bd9c-3ef315c717d7&page=queryresults
[0m00:14:57.872784 [debug] [Thread-1 (]: Timing info for model.uber.datetime_dim (execute): 00:14:52.915242 => 00:14:57.872226
[0m00:14:57.874592 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '8b9a8924-e1a8-4628-a5fb-de03b3e38f67', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff931ca0d0>]}
[0m00:14:57.877783 [info ] [Thread-1 (]: 1 of 7 OK created sql table model uber.datetime_dim ............................ [[32mCREATE TABLE (99.9k rows, 4.0 MiB processed)[0m in 4.99s]
[0m00:14:57.882360 [debug] [Thread-1 (]: Finished running node model.uber.datetime_dim
[0m00:14:57.884088 [debug] [Thread-1 (]: Began running node model.uber.dropoff_location_dim
[0m00:14:57.886037 [info ] [Thread-1 (]: 2 of 7 START sql table model uber.dropoff_location_dim ......................... [RUN]
[0m00:14:57.887357 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.uber.datetime_dim, now model.uber.dropoff_location_dim)
[0m00:14:57.888093 [debug] [Thread-1 (]: Began compiling node model.uber.dropoff_location_dim
[0m00:14:57.895562 [debug] [Thread-1 (]: Writing injected SQL for node "model.uber.dropoff_location_dim"
[0m00:14:57.897772 [debug] [Thread-1 (]: Timing info for model.uber.dropoff_location_dim (compile): 00:14:57.888488 => 00:14:57.897582
[0m00:14:57.898261 [debug] [Thread-1 (]: Began executing node model.uber.dropoff_location_dim
[0m00:14:57.922285 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m00:14:58.386380 [debug] [Thread-1 (]: Writing runtime sql for node "model.uber.dropoff_location_dim"
[0m00:14:58.392179 [debug] [Thread-1 (]: On model.uber.dropoff_location_dim: /* {"app": "dbt", "dbt_version": "1.5.9", "profile_name": "uber", "target_name": "dev", "node_id": "model.uber.dropoff_location_dim"} */

  
    

    create or replace table `uber-data-engineering-407103`.`uber`.`dropoff_location_dim`
    
    

    OPTIONS()
    as (
      WITH numbered_rows AS (
  SELECT
    to_hex(md5(cast(coalesce(cast(dropoff_latitude as STRING), '_dbt_utils_surrogate_key_null_') || '-' || coalesce(cast(dropoff_longitude as STRING), '_dbt_utils_surrogate_key_null_') as STRING))) as dropoff_location_id,
    dropoff_latitude AS dropoff_latitude,
    dropoff_longitude AS dropoff_longitude,
    ROW_NUMBER() OVER (ORDER BY dropoff_latitude, dropoff_longitude) as row_num
  FROM `uber-data-engineering-407103`.`uber`.`uber_tlc_trip_recrord_data`
)
SELECT
  dropoff_location_id,
  dropoff_latitude,
  dropoff_longitude
FROM numbered_rows
    );
  
[0m00:15:02.205020 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=uber-data-engineering-407103&j=bq:US:5defa94a-c866-4a88-870f-fa9607c4b808&page=queryresults
[0m00:15:02.216206 [debug] [Thread-1 (]: Timing info for model.uber.dropoff_location_dim (execute): 00:14:57.898669 => 00:15:02.215661
[0m00:15:02.218510 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '8b9a8924-e1a8-4628-a5fb-de03b3e38f67', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff93466090>]}
[0m00:15:02.220591 [info ] [Thread-1 (]: 2 of 7 OK created sql table model uber.dropoff_location_dim .................... [[32mCREATE TABLE (100.0k rows, 1.5 MiB processed)[0m in 4.33s]
[0m00:15:02.222085 [debug] [Thread-1 (]: Finished running node model.uber.dropoff_location_dim
[0m00:15:02.223097 [debug] [Thread-1 (]: Began running node model.uber.passenger_count_dim
[0m00:15:02.224384 [info ] [Thread-1 (]: 3 of 7 START sql table model uber.passenger_count_dim .......................... [RUN]
[0m00:15:02.225710 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.uber.dropoff_location_dim, now model.uber.passenger_count_dim)
[0m00:15:02.226410 [debug] [Thread-1 (]: Began compiling node model.uber.passenger_count_dim
[0m00:15:02.234592 [debug] [Thread-1 (]: Writing injected SQL for node "model.uber.passenger_count_dim"
[0m00:15:02.237812 [debug] [Thread-1 (]: Timing info for model.uber.passenger_count_dim (compile): 00:15:02.226914 => 00:15:02.237646
[0m00:15:02.238598 [debug] [Thread-1 (]: Began executing node model.uber.passenger_count_dim
[0m00:15:02.241299 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m00:15:02.887643 [debug] [Thread-1 (]: Writing runtime sql for node "model.uber.passenger_count_dim"
[0m00:15:02.894851 [debug] [Thread-1 (]: On model.uber.passenger_count_dim: /* {"app": "dbt", "dbt_version": "1.5.9", "profile_name": "uber", "target_name": "dev", "node_id": "model.uber.passenger_count_dim"} */

  
    

    create or replace table `uber-data-engineering-407103`.`uber`.`passenger_count_dim`
    
    

    OPTIONS()
    as (
      SELECT DISTINCT
        GENERATE_UUID() as passenger_count_id,
		passenger_count AS passenger_count,
FROM `uber-data-engineering-407103`.`uber`.`uber_tlc_trip_recrord_data`
WHERE passenger_count IS NOT NULL
    );
  
[0m00:15:05.726887 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=uber-data-engineering-407103&j=bq:US:2cccc0aa-3a7b-43a0-a92a-19cee762eff2&page=queryresults
[0m00:15:05.732779 [debug] [Thread-1 (]: Timing info for model.uber.passenger_count_dim (execute): 00:15:02.239046 => 00:15:05.732112
[0m00:15:05.735477 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '8b9a8924-e1a8-4628-a5fb-de03b3e38f67', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff931d8090>]}
[0m00:15:05.736919 [info ] [Thread-1 (]: 3 of 7 OK created sql table model uber.passenger_count_dim ..................... [[32mCREATE TABLE (100.0k rows, 781.2 KiB processed)[0m in 3.51s]
[0m00:15:05.738986 [debug] [Thread-1 (]: Finished running node model.uber.passenger_count_dim
[0m00:15:05.740782 [debug] [Thread-1 (]: Began running node model.uber.payment_type_dim
[0m00:15:05.742320 [info ] [Thread-1 (]: 4 of 7 START sql table model uber.payment_type_dim ............................. [RUN]
[0m00:15:05.744695 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.uber.passenger_count_dim, now model.uber.payment_type_dim)
[0m00:15:05.745904 [debug] [Thread-1 (]: Began compiling node model.uber.payment_type_dim
[0m00:15:05.756035 [debug] [Thread-1 (]: Writing injected SQL for node "model.uber.payment_type_dim"
[0m00:15:05.760749 [debug] [Thread-1 (]: Timing info for model.uber.payment_type_dim (compile): 00:15:05.746939 => 00:15:05.760176
[0m00:15:05.761971 [debug] [Thread-1 (]: Began executing node model.uber.payment_type_dim
[0m00:15:05.765577 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m00:15:06.624718 [debug] [Thread-1 (]: Writing runtime sql for node "model.uber.payment_type_dim"
[0m00:15:06.631531 [debug] [Thread-1 (]: On model.uber.payment_type_dim: /* {"app": "dbt", "dbt_version": "1.5.9", "profile_name": "uber", "target_name": "dev", "node_id": "model.uber.payment_type_dim"} */

  
    

    create or replace table `uber-data-engineering-407103`.`uber`.`payment_type_dim`
    
    

    OPTIONS()
    as (
      WITH numbered_rows AS (
  SELECT
    GENERATE_UUID() as payment_type_id,
    payment_type AS payment_type,
    ROW_NUMBER() OVER (ORDER BY payment_type) as row_num
  FROM `uber-data-engineering-407103`.`uber`.`uber_tlc_trip_recrord_data`
  WHERE payment_type IS NOT NULL
)
SELECT
  payment_type_id,
  payment_type
FROM numbered_rows
    );
  
[0m00:15:09.525634 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=uber-data-engineering-407103&j=bq:US:cf9dc549-6801-4019-aec5-89b344bb36a5&page=queryresults
[0m00:15:09.546118 [debug] [Thread-1 (]: Timing info for model.uber.payment_type_dim (execute): 00:15:05.762608 => 00:15:09.545095
[0m00:15:09.550516 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '8b9a8924-e1a8-4628-a5fb-de03b3e38f67', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff931da210>]}
[0m00:15:09.553450 [info ] [Thread-1 (]: 4 of 7 OK created sql table model uber.payment_type_dim ........................ [[32mCREATE TABLE (100.0k rows, 781.2 KiB processed)[0m in 3.81s]
[0m00:15:09.555931 [debug] [Thread-1 (]: Finished running node model.uber.payment_type_dim
[0m00:15:09.559232 [debug] [Thread-1 (]: Began running node model.uber.pickup_location_dim
[0m00:15:09.567097 [info ] [Thread-1 (]: 5 of 7 START sql table model uber.pickup_location_dim .......................... [RUN]
[0m00:15:09.569416 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.uber.payment_type_dim, now model.uber.pickup_location_dim)
[0m00:15:09.570334 [debug] [Thread-1 (]: Began compiling node model.uber.pickup_location_dim
[0m00:15:09.582649 [debug] [Thread-1 (]: Writing injected SQL for node "model.uber.pickup_location_dim"
[0m00:15:09.602011 [debug] [Thread-1 (]: Timing info for model.uber.pickup_location_dim (compile): 00:15:09.570988 => 00:15:09.600874
[0m00:15:09.612743 [debug] [Thread-1 (]: Began executing node model.uber.pickup_location_dim
[0m00:15:09.692580 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m00:15:10.379338 [debug] [Thread-1 (]: Writing runtime sql for node "model.uber.pickup_location_dim"
[0m00:15:10.382214 [debug] [Thread-1 (]: On model.uber.pickup_location_dim: /* {"app": "dbt", "dbt_version": "1.5.9", "profile_name": "uber", "target_name": "dev", "node_id": "model.uber.pickup_location_dim"} */

  
    

    create or replace table `uber-data-engineering-407103`.`uber`.`pickup_location_dim`
    
    

    OPTIONS()
    as (
      WITH numbered_rows AS (
  SELECT
    to_hex(md5(cast(coalesce(cast(pickup_latitude as STRING), '_dbt_utils_surrogate_key_null_') || '-' || coalesce(cast(pickup_longitude as STRING), '_dbt_utils_surrogate_key_null_') as STRING))) as pickup_location_id,
    pickup_latitude AS pickup_latitude,
    pickup_longitude AS pickup_longitude,
    ROW_NUMBER() OVER (ORDER BY pickup_latitude, pickup_longitude) as row_num
  FROM `uber-data-engineering-407103`.`uber`.`uber_tlc_trip_recrord_data`
)
SELECT
  pickup_location_id,
  pickup_latitude,
  pickup_longitude
FROM numbered_rows
    );
  
[0m00:15:14.523198 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=uber-data-engineering-407103&j=bq:US:a751491b-57ad-42e2-9cd7-01bedfa5e3d3&page=queryresults
[0m00:15:14.541105 [debug] [Thread-1 (]: Timing info for model.uber.pickup_location_dim (execute): 00:15:09.615127 => 00:15:14.539747
[0m00:15:14.545952 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '8b9a8924-e1a8-4628-a5fb-de03b3e38f67', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff920c48d0>]}
[0m00:15:14.549529 [info ] [Thread-1 (]: 5 of 7 OK created sql table model uber.pickup_location_dim ..................... [[32mCREATE TABLE (100.0k rows, 1.5 MiB processed)[0m in 4.98s]
[0m00:15:14.552008 [debug] [Thread-1 (]: Finished running node model.uber.pickup_location_dim
[0m00:15:14.553740 [debug] [Thread-1 (]: Began running node model.uber.rate_code_dim
[0m00:15:14.555782 [info ] [Thread-1 (]: 6 of 7 START sql table model uber.rate_code_dim ................................ [RUN]
[0m00:15:14.557654 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.uber.pickup_location_dim, now model.uber.rate_code_dim)
[0m00:15:14.558654 [debug] [Thread-1 (]: Began compiling node model.uber.rate_code_dim
[0m00:15:14.567964 [debug] [Thread-1 (]: Writing injected SQL for node "model.uber.rate_code_dim"
[0m00:15:14.570886 [debug] [Thread-1 (]: Timing info for model.uber.rate_code_dim (compile): 00:15:14.559305 => 00:15:14.570628
[0m00:15:14.571592 [debug] [Thread-1 (]: Began executing node model.uber.rate_code_dim
[0m00:15:14.578552 [debug] [Thread-1 (]: Writing runtime sql for node "model.uber.rate_code_dim"
[0m00:15:14.581883 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m00:15:14.602039 [debug] [Thread-1 (]: On model.uber.rate_code_dim: /* {"app": "dbt", "dbt_version": "1.5.9", "profile_name": "uber", "target_name": "dev", "node_id": "model.uber.rate_code_dim"} */

  
    

    create or replace table `uber-data-engineering-407103`.`uber`.`rate_code_dim`
    
    

    OPTIONS()
    as (
      WITH numbered_rows AS (
  SELECT
    GENERATE_UUID() as rate_code_id,
    RatecodeID AS RatecodeID,
    ROW_NUMBER() OVER (ORDER BY RatecodeID) as row_num
  FROM `uber-data-engineering-407103`.`uber`.`uber_tlc_trip_recrord_data`
  WHERE RatecodeID IS NOT NULL
)
SELECT
  rate_code_id,
  RatecodeID
FROM numbered_rows
    );
  
[0m00:15:18.768950 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=uber-data-engineering-407103&j=bq:US:53c8e2fe-f02a-41aa-8933-be6280c56149&page=queryresults
[0m00:15:18.803013 [debug] [Thread-1 (]: Timing info for model.uber.rate_code_dim (execute): 00:15:14.572120 => 00:15:18.801797
[0m00:15:18.806164 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '8b9a8924-e1a8-4628-a5fb-de03b3e38f67', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff92115090>]}
[0m00:15:18.808270 [info ] [Thread-1 (]: 6 of 7 OK created sql table model uber.rate_code_dim ........................... [[32mCREATE TABLE (100.0k rows, 781.2 KiB processed)[0m in 4.25s]
[0m00:15:18.810586 [debug] [Thread-1 (]: Finished running node model.uber.rate_code_dim
[0m00:15:18.829194 [debug] [Thread-1 (]: Began running node model.uber.trip_distance
[0m00:15:18.831116 [info ] [Thread-1 (]: 7 of 7 START sql table model uber.trip_distance ................................ [RUN]
[0m00:15:18.836493 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.uber.rate_code_dim, now model.uber.trip_distance)
[0m00:15:18.837991 [debug] [Thread-1 (]: Began compiling node model.uber.trip_distance
[0m00:15:18.873244 [debug] [Thread-1 (]: Writing injected SQL for node "model.uber.trip_distance"
[0m00:15:18.877120 [debug] [Thread-1 (]: Timing info for model.uber.trip_distance (compile): 00:15:18.838723 => 00:15:18.876900
[0m00:15:18.878031 [debug] [Thread-1 (]: Began executing node model.uber.trip_distance
[0m00:15:18.881192 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m00:15:19.767977 [debug] [Thread-1 (]: Writing runtime sql for node "model.uber.trip_distance"
[0m00:15:19.773557 [debug] [Thread-1 (]: On model.uber.trip_distance: /* {"app": "dbt", "dbt_version": "1.5.9", "profile_name": "uber", "target_name": "dev", "node_id": "model.uber.trip_distance"} */

  
    

    create or replace table `uber-data-engineering-407103`.`uber`.`trip_distance`
    
    

    OPTIONS()
    as (
      WITH numbered_rows AS (
  SELECT
    GENERATE_UUID() as trip_distance_id,
    trip_distance AS trip_distance,
    ROW_NUMBER() OVER (ORDER BY trip_distance) as row_num
  FROM `uber-data-engineering-407103`.`uber`.`uber_tlc_trip_recrord_data`
  WHERE trip_distance IS NOT NULL
)
SELECT
  trip_distance_id,
  trip_distance
FROM numbered_rows
    );
  
[0m00:15:22.627066 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=uber-data-engineering-407103&j=bq:US:3e6d070a-0805-4351-92b9-033c038236b8&page=queryresults
[0m00:15:22.630485 [debug] [Thread-1 (]: Timing info for model.uber.trip_distance (execute): 00:15:18.878503 => 00:15:22.630248
[0m00:15:22.631542 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '8b9a8924-e1a8-4628-a5fb-de03b3e38f67', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff9215f290>]}
[0m00:15:22.632344 [info ] [Thread-1 (]: 7 of 7 OK created sql table model uber.trip_distance ........................... [[32mCREATE TABLE (100.0k rows, 781.2 KiB processed)[0m in 3.80s]
[0m00:15:22.633516 [debug] [Thread-1 (]: Finished running node model.uber.trip_distance
[0m00:15:22.637159 [debug] [MainThread]: Connection 'master' was properly closed.
[0m00:15:22.637920 [debug] [MainThread]: Connection 'model.uber.trip_distance' was properly closed.
[0m00:15:22.638724 [info ] [MainThread]: 
[0m00:15:22.639623 [info ] [MainThread]: Finished running 7 table models in 0 hours 0 minutes and 30.97 seconds (30.97s).
[0m00:15:22.644894 [debug] [MainThread]: Command end result
[0m00:15:22.672244 [info ] [MainThread]: 
[0m00:15:22.674115 [info ] [MainThread]: [32mCompleted successfully[0m
[0m00:15:22.674989 [info ] [MainThread]: 
[0m00:15:22.679875 [info ] [MainThread]: Done. PASS=7 WARN=0 ERROR=0 SKIP=0 TOTAL=7
[0m00:15:22.692471 [debug] [MainThread]: Command `dbt run` succeeded at 00:15:22.691888 after 31.63 seconds
[0m00:15:22.693687 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff954eeb50>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff957dfa50>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff9932e350>]}
[0m00:15:22.694461 [debug] [MainThread]: Flushing usage events
[0m00:51:15.594385 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff8961f5d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff88dcfc90>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff892d4450>]}


============================== 00:51:15.603580 | 626cdc9b-e6ba-4d48-a009-3602a9d9a9fc ==============================
[0m00:51:15.603580 [info ] [MainThread]: Running with dbt=1.5.9
[0m00:51:15.605954 [debug] [MainThread]: running dbt with arguments {'quiet': 'False', 'introspect': 'True', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'debug': 'False', 'no_print': 'None', 'use_experimental_parser': 'False', 'static_parser': 'True', 'log_format': 'default', 'send_anonymous_usage_stats': 'True', 'cache_selected_only': 'False', 'write_json': 'True', 'partial_parse': 'True', 'warn_error': 'None', 'target_path': 'None', 'fail_fast': 'False', 'log_path': '/usr/local/airflow/include/dbt/logs', 'use_colors': 'True', 'profiles_dir': '/usr/local/airflow/include/dbt/', 'log_cache_events': 'False', 'indirect_selection': 'eager', 'version_check': 'True', 'printer_width': '80'}
[0m00:51:16.240676 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '626cdc9b-e6ba-4d48-a009-3602a9d9a9fc', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff89413450>]}
[0m00:51:16.252313 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '626cdc9b-e6ba-4d48-a009-3602a9d9a9fc', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff88ebbbd0>]}
[0m00:51:16.253085 [info ] [MainThread]: Registered adapter: bigquery=1.5.3
[0m00:51:16.268841 [debug] [MainThread]: checksum: dd837546c89c9d03f3c2cb0ca6165266a30da6076d5d44e9991f7c5a8e5f5831, vars: {}, profile: , target: , version: 1.5.9
[0m00:51:16.353498 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 1 files added, 0 files changed.
[0m00:51:16.354209 [debug] [MainThread]: Partial parsing: added file: uber://models/transform/fact_trip.sql
[0m00:51:16.375790 [debug] [MainThread]: 1699: static parser successfully parsed transform/fact_trip.sql
[0m00:51:16.386100 [error] [MainThread]: Encountered an error:
Compilation Error
  Model 'model.uber.fact_trip' (models/transform/fact_trip.sql) depends on a node named 'trip_distance_dim' which was not found
[0m00:51:16.386969 [debug] [MainThread]: Command `dbt run` failed at 00:51:16.386822 after 0.81 seconds
[0m00:51:16.387730 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff88fb6a90>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff88dcd750>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff894645d0>]}
[0m00:51:16.388219 [debug] [MainThread]: Flushing usage events
[0m00:51:47.996119 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff91b17710>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff91ccd050>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff93119190>]}


============================== 00:51:48.001281 | f8ad7c80-001d-4612-a87b-c2e44c155261 ==============================
[0m00:51:48.001281 [info ] [MainThread]: Running with dbt=1.5.9
[0m00:51:48.002226 [debug] [MainThread]: running dbt with arguments {'log_format': 'default', 'static_parser': 'True', 'log_path': '/usr/local/airflow/include/dbt/logs', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'printer_width': '80', 'debug': 'False', 'use_colors': 'True', 'target_path': 'None', 'log_cache_events': 'False', 'send_anonymous_usage_stats': 'True', 'use_experimental_parser': 'False', 'version_check': 'True', 'no_print': 'None', 'indirect_selection': 'eager', 'warn_error': 'None', 'fail_fast': 'False', 'introspect': 'True', 'profiles_dir': '/usr/local/airflow/include/dbt/', 'cache_selected_only': 'False', 'write_json': 'True', 'partial_parse': 'True', 'quiet': 'False'}
[0m00:51:48.493078 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'f8ad7c80-001d-4612-a87b-c2e44c155261', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff91b00250>]}
[0m00:51:48.507145 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'f8ad7c80-001d-4612-a87b-c2e44c155261', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff91b00250>]}
[0m00:51:48.508686 [info ] [MainThread]: Registered adapter: bigquery=1.5.3
[0m00:51:48.527829 [debug] [MainThread]: checksum: dd837546c89c9d03f3c2cb0ca6165266a30da6076d5d44e9991f7c5a8e5f5831, vars: {}, profile: , target: , version: 1.5.9
[0m00:51:48.620921 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 1 files added, 0 files changed.
[0m00:51:48.622092 [debug] [MainThread]: Partial parsing: added file: uber://models/transform/fact_trip.sql
[0m00:51:48.647031 [debug] [MainThread]: 1699: static parser successfully parsed transform/fact_trip.sql
[0m00:51:48.678826 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'f8ad7c80-001d-4612-a87b-c2e44c155261', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff8f7a5090>]}
[0m00:51:48.694524 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'f8ad7c80-001d-4612-a87b-c2e44c155261', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff8f4c5e90>]}
[0m00:51:48.695260 [info ] [MainThread]: Found 8 models, 0 tests, 0 snapshots, 0 analyses, 474 macros, 0 operations, 0 seed files, 1 source, 0 exposures, 0 metrics, 0 groups
[0m00:51:48.696113 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'f8ad7c80-001d-4612-a87b-c2e44c155261', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff9466b790>]}
[0m00:51:48.697925 [info ] [MainThread]: 
[0m00:51:48.699103 [debug] [MainThread]: Acquiring new bigquery connection 'master'
[0m00:51:48.701302 [debug] [ThreadPool]: Acquiring new bigquery connection 'list_uber-data-engineering-407103'
[0m00:51:48.702376 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m00:51:49.203246 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_uber-data-engineering-407103, now list_uber-data-engineering-407103_uber)
[0m00:51:49.206603 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m00:51:49.649758 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'f8ad7c80-001d-4612-a87b-c2e44c155261', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff8f780190>]}
[0m00:51:49.650884 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m00:51:49.651637 [info ] [MainThread]: 
[0m00:51:49.669978 [debug] [Thread-1 (]: Began running node model.uber.datetime_dim
[0m00:51:49.671022 [info ] [Thread-1 (]: 1 of 8 START sql table model uber.datetime_dim ................................. [RUN]
[0m00:51:49.672839 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_uber-data-engineering-407103_uber, now model.uber.datetime_dim)
[0m00:51:49.674101 [debug] [Thread-1 (]: Began compiling node model.uber.datetime_dim
[0m00:51:49.705608 [debug] [Thread-1 (]: Writing injected SQL for node "model.uber.datetime_dim"
[0m00:51:49.713910 [debug] [Thread-1 (]: Timing info for model.uber.datetime_dim (compile): 00:51:49.674784 => 00:51:49.712886
[0m00:51:49.714792 [debug] [Thread-1 (]: Began executing node model.uber.datetime_dim
[0m00:51:49.729989 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m00:51:50.174188 [debug] [Thread-1 (]: Writing runtime sql for node "model.uber.datetime_dim"
[0m00:51:50.177015 [debug] [Thread-1 (]: On model.uber.datetime_dim: /* {"app": "dbt", "dbt_version": "1.5.9", "profile_name": "uber", "target_name": "dev", "node_id": "model.uber.datetime_dim"} */

  
    

    create or replace table `uber-data-engineering-407103`.`uber`.`datetime_dim`
    
    

    OPTIONS()
    as (
      WITH datetime_cte AS (  
  SELECT DISTINCT 
    to_hex(md5(cast(coalesce(cast(tpep_pickup_datetime as STRING), '_dbt_utils_surrogate_key_null_') || '-' || coalesce(cast(tpep_dropoff_datetime as STRING), '_dbt_utils_surrogate_key_null_') as STRING))) AS datetime_id,
    CASE
      WHEN LENGTH(tpep_pickup_datetime) = 16 THEN
        -- Date format: "DD/MM/YYYY HH:MM"
        PARSE_DATETIME('%m/%d/%Y %H:%M', tpep_pickup_datetime)
      WHEN LENGTH(tpep_pickup_datetime) <= 14 THEN
        -- Date format: "MM/DD/YY HH:MM"
        PARSE_DATETIME('%m/%d/%y %H:%M', tpep_pickup_datetime)
      ELSE
        NULL
    END AS pick_date_part,
    tpep_dropoff_datetime AS drop_datetime_id,
    CASE
      WHEN LENGTH(tpep_dropoff_datetime) = 16 THEN
        -- Date format: "DD/MM/YYYY HH:MM"
        PARSE_DATETIME('%m/%d/%Y %H:%M', tpep_dropoff_datetime)
      WHEN LENGTH(tpep_dropoff_datetime) <= 14 THEN
        -- Date format: "MM/DD/YY HH:MM"
        PARSE_DATETIME('%m/%d/%y %H:%M', tpep_dropoff_datetime)
      ELSE
        NULL
    END AS drop_date_part
  FROM `uber-data-engineering-407103`.`uber`.`uber_tlc_trip_recrord_data`
  WHERE tpep_pickup_datetime IS NOT NULL
    AND tpep_dropoff_datetime IS NOT NULL
)
SELECT
  datetime_id,
  pick_date_part AS tpep_pickup_datetime,
  drop_date_part AS tpep_dropoff_datetime,
  EXTRACT(HOUR FROM pick_date_part) AS pick_hour,
  EXTRACT(DAY FROM pick_date_part) AS pick_day,
  EXTRACT(MONTH FROM pick_date_part) AS pick_month,
  EXTRACT(YEAR FROM pick_date_part) AS pick_year,
  EXTRACT(DAYOFWEEK FROM pick_date_part) AS pick_weekday,
  EXTRACT(HOUR FROM drop_date_part) AS drop_hour,
  EXTRACT(DAY FROM drop_date_part) AS drop_day,
  EXTRACT(MONTH FROM drop_date_part) AS drop_month,
  EXTRACT(YEAR FROM drop_date_part) AS drop_year,
  EXTRACT(DAYOFWEEK FROM drop_date_part) AS drop_weekday
FROM datetime_cte
    );
  
[0m00:51:53.284032 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=uber-data-engineering-407103&j=bq:US:128bce7f-bcb2-4dc7-970a-9f282115c4de&page=queryresults
[0m00:51:53.306378 [debug] [Thread-1 (]: Timing info for model.uber.datetime_dim (execute): 00:51:49.715293 => 00:51:53.306031
[0m00:51:53.307892 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'f8ad7c80-001d-4612-a87b-c2e44c155261', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff8f5c91d0>]}
[0m00:51:53.309173 [info ] [Thread-1 (]: 1 of 8 OK created sql table model uber.datetime_dim ............................ [[32mCREATE TABLE (99.9k rows, 4.0 MiB processed)[0m in 3.64s]
[0m00:51:53.310676 [debug] [Thread-1 (]: Finished running node model.uber.datetime_dim
[0m00:51:53.311650 [debug] [Thread-1 (]: Began running node model.uber.dropoff_location_dim
[0m00:51:53.312776 [info ] [Thread-1 (]: 2 of 8 START sql table model uber.dropoff_location_dim ......................... [RUN]
[0m00:51:53.313790 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.uber.datetime_dim, now model.uber.dropoff_location_dim)
[0m00:51:53.314388 [debug] [Thread-1 (]: Began compiling node model.uber.dropoff_location_dim
[0m00:51:53.331160 [debug] [Thread-1 (]: Writing injected SQL for node "model.uber.dropoff_location_dim"
[0m00:51:53.334477 [debug] [Thread-1 (]: Timing info for model.uber.dropoff_location_dim (compile): 00:51:53.314854 => 00:51:53.334303
[0m00:51:53.334990 [debug] [Thread-1 (]: Began executing node model.uber.dropoff_location_dim
[0m00:51:53.337399 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m00:51:53.889583 [debug] [Thread-1 (]: Writing runtime sql for node "model.uber.dropoff_location_dim"
[0m00:51:53.892430 [debug] [Thread-1 (]: On model.uber.dropoff_location_dim: /* {"app": "dbt", "dbt_version": "1.5.9", "profile_name": "uber", "target_name": "dev", "node_id": "model.uber.dropoff_location_dim"} */

  
    

    create or replace table `uber-data-engineering-407103`.`uber`.`dropoff_location_dim`
    
    

    OPTIONS()
    as (
      WITH numbered_rows AS (
  SELECT
    to_hex(md5(cast(coalesce(cast(dropoff_latitude as STRING), '_dbt_utils_surrogate_key_null_') || '-' || coalesce(cast(dropoff_longitude as STRING), '_dbt_utils_surrogate_key_null_') as STRING))) as dropoff_location_id,
    dropoff_latitude AS dropoff_latitude,
    dropoff_longitude AS dropoff_longitude,
    ROW_NUMBER() OVER (ORDER BY dropoff_latitude, dropoff_longitude) as row_num
  FROM `uber-data-engineering-407103`.`uber`.`uber_tlc_trip_recrord_data`
)
SELECT
  dropoff_location_id,
  dropoff_latitude,
  dropoff_longitude
FROM numbered_rows
    );
  
[0m00:51:57.072949 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=uber-data-engineering-407103&j=bq:US:9c1a04b1-c0cf-445e-b1c6-258c4354cc9a&page=queryresults
[0m00:51:57.083519 [debug] [Thread-1 (]: Timing info for model.uber.dropoff_location_dim (execute): 00:51:53.335360 => 00:51:57.082624
[0m00:51:57.087008 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'f8ad7c80-001d-4612-a87b-c2e44c155261', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff8e3f2350>]}
[0m00:51:57.089727 [info ] [Thread-1 (]: 2 of 8 OK created sql table model uber.dropoff_location_dim .................... [[32mCREATE TABLE (100.0k rows, 1.5 MiB processed)[0m in 3.77s]
[0m00:51:57.093647 [debug] [Thread-1 (]: Finished running node model.uber.dropoff_location_dim
[0m00:51:57.095909 [debug] [Thread-1 (]: Began running node model.uber.passenger_count_dim
[0m00:51:57.097231 [info ] [Thread-1 (]: 3 of 8 START sql table model uber.passenger_count_dim .......................... [RUN]
[0m00:51:57.098414 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.uber.dropoff_location_dim, now model.uber.passenger_count_dim)
[0m00:51:57.099159 [debug] [Thread-1 (]: Began compiling node model.uber.passenger_count_dim
[0m00:51:57.106665 [debug] [Thread-1 (]: Writing injected SQL for node "model.uber.passenger_count_dim"
[0m00:51:57.109624 [debug] [Thread-1 (]: Timing info for model.uber.passenger_count_dim (compile): 00:51:57.099661 => 00:51:57.109316
[0m00:51:57.111042 [debug] [Thread-1 (]: Began executing node model.uber.passenger_count_dim
[0m00:51:57.114771 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m00:51:57.523553 [debug] [Thread-1 (]: Writing runtime sql for node "model.uber.passenger_count_dim"
[0m00:51:57.531888 [debug] [Thread-1 (]: On model.uber.passenger_count_dim: /* {"app": "dbt", "dbt_version": "1.5.9", "profile_name": "uber", "target_name": "dev", "node_id": "model.uber.passenger_count_dim"} */

  
    

    create or replace table `uber-data-engineering-407103`.`uber`.`passenger_count_dim`
    
    

    OPTIONS()
    as (
      SELECT DISTINCT
        GENERATE_UUID() as passenger_count_id,
		passenger_count AS passenger_count,
FROM `uber-data-engineering-407103`.`uber`.`uber_tlc_trip_recrord_data`
WHERE passenger_count IS NOT NULL
    );
  
[0m00:52:00.180078 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=uber-data-engineering-407103&j=bq:US:ba549556-398f-4a06-b451-8c44ffdf2a09&page=queryresults
[0m00:52:00.194467 [debug] [Thread-1 (]: Timing info for model.uber.passenger_count_dim (execute): 00:51:57.111725 => 00:52:00.193754
[0m00:52:00.197773 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'f8ad7c80-001d-4612-a87b-c2e44c155261', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff8e3f52d0>]}
[0m00:52:00.199942 [info ] [Thread-1 (]: 3 of 8 OK created sql table model uber.passenger_count_dim ..................... [[32mCREATE TABLE (100.0k rows, 781.2 KiB processed)[0m in 3.10s]
[0m00:52:00.201655 [debug] [Thread-1 (]: Finished running node model.uber.passenger_count_dim
[0m00:52:00.202911 [debug] [Thread-1 (]: Began running node model.uber.payment_type_dim
[0m00:52:00.204677 [info ] [Thread-1 (]: 4 of 8 START sql table model uber.payment_type_dim ............................. [RUN]
[0m00:52:00.206443 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.uber.passenger_count_dim, now model.uber.payment_type_dim)
[0m00:52:00.207936 [debug] [Thread-1 (]: Began compiling node model.uber.payment_type_dim
[0m00:52:00.223850 [debug] [Thread-1 (]: Writing injected SQL for node "model.uber.payment_type_dim"
[0m00:52:00.228251 [debug] [Thread-1 (]: Timing info for model.uber.payment_type_dim (compile): 00:52:00.208585 => 00:52:00.227892
[0m00:52:00.228997 [debug] [Thread-1 (]: Began executing node model.uber.payment_type_dim
[0m00:52:00.233608 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m00:52:00.736838 [debug] [Thread-1 (]: Writing runtime sql for node "model.uber.payment_type_dim"
[0m00:52:00.742739 [debug] [Thread-1 (]: On model.uber.payment_type_dim: /* {"app": "dbt", "dbt_version": "1.5.9", "profile_name": "uber", "target_name": "dev", "node_id": "model.uber.payment_type_dim"} */

  
    

    create or replace table `uber-data-engineering-407103`.`uber`.`payment_type_dim`
    
    

    OPTIONS()
    as (
      WITH numbered_rows AS (
  SELECT
    GENERATE_UUID() as payment_type_id,
    payment_type AS payment_type,
    ROW_NUMBER() OVER (ORDER BY payment_type) as row_num
  FROM `uber-data-engineering-407103`.`uber`.`uber_tlc_trip_recrord_data`
  WHERE payment_type IS NOT NULL
)
SELECT
  payment_type_id,
  payment_type
FROM numbered_rows
    );
  
[0m00:52:03.253101 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=uber-data-engineering-407103&j=bq:US:437fb1b4-e61c-48ff-8ba9-7e4324f7624d&page=queryresults
[0m00:52:03.259733 [debug] [Thread-1 (]: Timing info for model.uber.payment_type_dim (execute): 00:52:00.229568 => 00:52:03.259216
[0m00:52:03.262652 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'f8ad7c80-001d-4612-a87b-c2e44c155261', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff8f585890>]}
[0m00:52:03.264794 [info ] [Thread-1 (]: 4 of 8 OK created sql table model uber.payment_type_dim ........................ [[32mCREATE TABLE (100.0k rows, 781.2 KiB processed)[0m in 3.06s]
[0m00:52:03.267978 [debug] [Thread-1 (]: Finished running node model.uber.payment_type_dim
[0m00:52:03.270036 [debug] [Thread-1 (]: Began running node model.uber.pickup_location_dim
[0m00:52:03.271678 [info ] [Thread-1 (]: 5 of 8 START sql table model uber.pickup_location_dim .......................... [RUN]
[0m00:52:03.273859 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.uber.payment_type_dim, now model.uber.pickup_location_dim)
[0m00:52:03.275004 [debug] [Thread-1 (]: Began compiling node model.uber.pickup_location_dim
[0m00:52:03.283532 [debug] [Thread-1 (]: Writing injected SQL for node "model.uber.pickup_location_dim"
[0m00:52:03.288209 [debug] [Thread-1 (]: Timing info for model.uber.pickup_location_dim (compile): 00:52:03.275843 => 00:52:03.287879
[0m00:52:03.289642 [debug] [Thread-1 (]: Began executing node model.uber.pickup_location_dim
[0m00:52:03.293714 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m00:52:03.686223 [debug] [Thread-1 (]: Writing runtime sql for node "model.uber.pickup_location_dim"
[0m00:52:03.692631 [debug] [Thread-1 (]: On model.uber.pickup_location_dim: /* {"app": "dbt", "dbt_version": "1.5.9", "profile_name": "uber", "target_name": "dev", "node_id": "model.uber.pickup_location_dim"} */

  
    

    create or replace table `uber-data-engineering-407103`.`uber`.`pickup_location_dim`
    
    

    OPTIONS()
    as (
      WITH numbered_rows AS (
  SELECT
    to_hex(md5(cast(coalesce(cast(pickup_latitude as STRING), '_dbt_utils_surrogate_key_null_') || '-' || coalesce(cast(pickup_longitude as STRING), '_dbt_utils_surrogate_key_null_') as STRING))) as pickup_location_id,
    pickup_latitude AS pickup_latitude,
    pickup_longitude AS pickup_longitude,
    ROW_NUMBER() OVER (ORDER BY pickup_latitude, pickup_longitude) as row_num
  FROM `uber-data-engineering-407103`.`uber`.`uber_tlc_trip_recrord_data`
)
SELECT
  pickup_location_id,
  pickup_latitude,
  pickup_longitude
FROM numbered_rows
    );
  
[0m00:52:07.198397 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=uber-data-engineering-407103&j=bq:US:f0636f57-e0cc-4901-9f42-16b9e0ab338d&page=queryresults
[0m00:52:07.218579 [debug] [Thread-1 (]: Timing info for model.uber.pickup_location_dim (execute): 00:52:03.290513 => 00:52:07.217471
[0m00:52:07.224202 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'f8ad7c80-001d-4612-a87b-c2e44c155261', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff8e449b10>]}
[0m00:52:07.227989 [info ] [Thread-1 (]: 5 of 8 OK created sql table model uber.pickup_location_dim ..................... [[32mCREATE TABLE (100.0k rows, 1.5 MiB processed)[0m in 3.95s]
[0m00:52:07.230816 [debug] [Thread-1 (]: Finished running node model.uber.pickup_location_dim
[0m00:52:07.232812 [debug] [Thread-1 (]: Began running node model.uber.rate_code_dim
[0m00:52:07.234885 [info ] [Thread-1 (]: 6 of 8 START sql table model uber.rate_code_dim ................................ [RUN]
[0m00:52:07.236881 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.uber.pickup_location_dim, now model.uber.rate_code_dim)
[0m00:52:07.238180 [debug] [Thread-1 (]: Began compiling node model.uber.rate_code_dim
[0m00:52:07.248931 [debug] [Thread-1 (]: Writing injected SQL for node "model.uber.rate_code_dim"
[0m00:52:07.252914 [debug] [Thread-1 (]: Timing info for model.uber.rate_code_dim (compile): 00:52:07.239318 => 00:52:07.252655
[0m00:52:07.253566 [debug] [Thread-1 (]: Began executing node model.uber.rate_code_dim
[0m00:52:07.300825 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m00:52:07.725836 [debug] [Thread-1 (]: Writing runtime sql for node "model.uber.rate_code_dim"
[0m00:52:07.729537 [debug] [Thread-1 (]: On model.uber.rate_code_dim: /* {"app": "dbt", "dbt_version": "1.5.9", "profile_name": "uber", "target_name": "dev", "node_id": "model.uber.rate_code_dim"} */

  
    

    create or replace table `uber-data-engineering-407103`.`uber`.`rate_code_dim`
    
    

    OPTIONS()
    as (
      WITH numbered_rows AS (
  SELECT
    GENERATE_UUID() as rate_code_id,
    RatecodeID AS RatecodeID,
    ROW_NUMBER() OVER (ORDER BY RatecodeID) as row_num
  FROM `uber-data-engineering-407103`.`uber`.`uber_tlc_trip_recrord_data`
  WHERE RatecodeID IS NOT NULL
)
SELECT
  rate_code_id,
  RatecodeID
FROM numbered_rows
    );
  
[0m00:53:02.488303 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=uber-data-engineering-407103&j=bq:US:79a79fe0-6253-4303-b903-dc16a83e57e6&page=queryresults
[0m00:53:02.530234 [debug] [Thread-1 (]: Timing info for model.uber.rate_code_dim (execute): 00:52:07.254045 => 00:53:02.529408
[0m00:53:02.533952 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'f8ad7c80-001d-4612-a87b-c2e44c155261', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff8e4399d0>]}
[0m00:53:02.536849 [info ] [Thread-1 (]: 6 of 8 OK created sql table model uber.rate_code_dim ........................... [[32mCREATE TABLE (100.0k rows, 781.2 KiB processed)[0m in 55.30s]
[0m00:53:02.540180 [debug] [Thread-1 (]: Finished running node model.uber.rate_code_dim
[0m00:53:02.541642 [debug] [Thread-1 (]: Began running node model.uber.trip_distance
[0m00:53:02.543435 [info ] [Thread-1 (]: 7 of 8 START sql table model uber.trip_distance ................................ [RUN]
[0m00:53:02.544981 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.uber.rate_code_dim, now model.uber.trip_distance)
[0m00:53:02.545817 [debug] [Thread-1 (]: Began compiling node model.uber.trip_distance
[0m00:53:02.555964 [debug] [Thread-1 (]: Writing injected SQL for node "model.uber.trip_distance"
[0m00:53:02.559502 [debug] [Thread-1 (]: Timing info for model.uber.trip_distance (compile): 00:53:02.546404 => 00:53:02.559286
[0m00:53:02.560439 [debug] [Thread-1 (]: Began executing node model.uber.trip_distance
[0m00:53:02.563551 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m00:53:03.006770 [debug] [Thread-1 (]: Writing runtime sql for node "model.uber.trip_distance"
[0m00:53:03.010494 [debug] [Thread-1 (]: On model.uber.trip_distance: /* {"app": "dbt", "dbt_version": "1.5.9", "profile_name": "uber", "target_name": "dev", "node_id": "model.uber.trip_distance"} */

  
    

    create or replace table `uber-data-engineering-407103`.`uber`.`trip_distance`
    
    

    OPTIONS()
    as (
      WITH numbered_rows AS (
  SELECT
    GENERATE_UUID() as trip_distance_id,
    trip_distance AS trip_distance,
    ROW_NUMBER() OVER (ORDER BY trip_distance) as row_num
  FROM `uber-data-engineering-407103`.`uber`.`uber_tlc_trip_recrord_data`
  WHERE trip_distance IS NOT NULL
)
SELECT
  trip_distance_id,
  trip_distance
FROM numbered_rows
    );
  
[0m00:53:05.746673 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=uber-data-engineering-407103&j=bq:US:3198394a-aff7-4417-8d8d-3ef676e3aaae&page=queryresults
[0m00:53:05.755783 [debug] [Thread-1 (]: Timing info for model.uber.trip_distance (execute): 00:53:02.560990 => 00:53:05.755255
[0m00:53:05.758173 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'f8ad7c80-001d-4612-a87b-c2e44c155261', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff8f74c510>]}
[0m00:53:05.759929 [info ] [Thread-1 (]: 7 of 8 OK created sql table model uber.trip_distance ........................... [[32mCREATE TABLE (100.0k rows, 781.2 KiB processed)[0m in 3.21s]
[0m00:53:05.761638 [debug] [Thread-1 (]: Finished running node model.uber.trip_distance
[0m00:53:05.764749 [debug] [Thread-1 (]: Began running node model.uber.fact_trip
[0m00:53:05.766906 [info ] [Thread-1 (]: 8 of 8 START sql table model uber.fact_trip .................................... [RUN]
[0m00:53:05.770519 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.uber.trip_distance, now model.uber.fact_trip)
[0m00:53:05.771390 [debug] [Thread-1 (]: Began compiling node model.uber.fact_trip
[0m00:53:05.786125 [debug] [Thread-1 (]: Writing injected SQL for node "model.uber.fact_trip"
[0m00:53:05.790776 [debug] [Thread-1 (]: Timing info for model.uber.fact_trip (compile): 00:53:05.771974 => 00:53:05.790576
[0m00:53:05.791440 [debug] [Thread-1 (]: Began executing node model.uber.fact_trip
[0m00:53:05.795381 [debug] [Thread-1 (]: Writing runtime sql for node "model.uber.fact_trip"
[0m00:53:05.800070 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m00:53:05.818168 [debug] [Thread-1 (]: On model.uber.fact_trip: /* {"app": "dbt", "dbt_version": "1.5.9", "profile_name": "uber", "target_name": "dev", "node_id": "model.uber.fact_trip"} */

  
    

    create or replace table `uber-data-engineering-407103`.`uber`.`fact_trip`
    
    

    OPTIONS()
    as (
      WITH fct_invoices_cte AS (
    SELECT
        CAST(ROW_NUMBER() OVER () AS INT64) as trip_id,
        VendorID AS VendorID,
        datetime_id AS datetime_id,
        passenger_count_id AS passenger_count_id,
        trip_distance_id AS trip_distance_id,
        rate_code_id AS rate_code_id,
        store_and_fwd_flag AS store_and_fwd_flag,
        pickup_location_id AS pickup_location_id,
        dropoff_location_id AS dropoff_location_id,
        payment_type_id AS payment_type_id,
        fare_amount AS fare_amount,
        extra AS extra,
        mta_tax AS mta_tax,
        tip_amount AS tip_amount,
        tolls_amount AS tolls_amount,
        improvement_surcharge AS improvement_surcharge,
        total_amount AS total_amount
    FROM `uber-data-engineering-407103`.`uber`.`uber_tlc_trip_recrord_data`
)
SELECT
    trip_id,
    do.dropoff_location_id,
    pu.pickup_location_id,
    pc.passenger_count_id,
    pt.payment_type_id,
    rc.rate_code_id,
    td.trip_distance_id,
    fare_amount,
    extra,
    mta_tax,
    tip_amount,
    tolls_amount,
    improvement_surcharge_amount,
    tolls_amount
FROM fct_invoices_cte fi
INNER JOIN `uber-data-engineering-407103`.`uber`.`datetime_dim` dt ON fi.datetime_id = dt.datetime_id
INNER JOIN `uber-data-engineering-407103`.`uber`.`dropoff_location_dim` do ON fi.dropoff_location_id = do.dropoff_location_id
INNER JOIN `uber-data-engineering-407103`.`uber`.`pickup_location_dim` pu ON fi.pickup_location_id = pu.pickup_location_id
INNER JOIN `uber-data-engineering-407103`.`uber`.`passenger_count_dim` pc ON fi.passenger_count_id = pc.passenger_count_id
INNER JOIN `uber-data-engineering-407103`.`uber`.`payment_type_dim` pt ON fi.payment_type_id = pt.payment_type_id
INNER JOIN `uber-data-engineering-407103`.`uber`.`rate_code_dim` rc ON fi.rate_code_id = rc.rate_code_id
INNER JOIN `uber-data-engineering-407103`.`uber`.`trip_distance` td ON fi.trip_distance_id = td.trip_distance_id
    );
  
[0m00:53:06.928917 [debug] [Thread-1 (]: BigQuery adapter: Retry attempt 1 of 1 after error: BadRequest('Unrecognized name: datetime_id at [16:9]')
[0m00:53:07.924748 [error] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=uber-data-engineering-407103&j=bq:US:8def45c8-3656-4329-9e42-8a43459f10b4&page=queryresults
[0m00:53:07.928905 [debug] [Thread-1 (]: Timing info for model.uber.fact_trip (execute): 00:53:05.791929 => 00:53:07.928479
[0m00:53:07.949371 [debug] [Thread-1 (]: Database Error in model fact_trip (models/transform/fact_trip.sql)
  Unrecognized name: datetime_id at [16:9]
  compiled Code at target/run/uber/models/transform/fact_trip.sql
[0m00:53:07.950595 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'f8ad7c80-001d-4612-a87b-c2e44c155261', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff8f4f39d0>]}
[0m00:53:07.951598 [error] [Thread-1 (]: 8 of 8 ERROR creating sql table model uber.fact_trip ........................... [[31mERROR[0m in 2.18s]
[0m00:53:07.952506 [debug] [Thread-1 (]: Finished running node model.uber.fact_trip
[0m00:53:07.955928 [debug] [MainThread]: Connection 'master' was properly closed.
[0m00:53:07.956583 [debug] [MainThread]: Connection 'model.uber.fact_trip' was properly closed.
[0m00:53:07.957473 [info ] [MainThread]: 
[0m00:53:07.958822 [info ] [MainThread]: Finished running 8 table models in 0 hours 1 minutes and 19.26 seconds (79.26s).
[0m00:53:07.961823 [debug] [MainThread]: Command end result
[0m00:53:08.003621 [info ] [MainThread]: 
[0m00:53:08.004665 [info ] [MainThread]: [31mCompleted with 1 error and 0 warnings:[0m
[0m00:53:08.005345 [info ] [MainThread]: 
[0m00:53:08.006316 [error] [MainThread]: [33mDatabase Error in model fact_trip (models/transform/fact_trip.sql)[0m
[0m00:53:08.007042 [error] [MainThread]:   Unrecognized name: datetime_id at [16:9]
[0m00:53:08.007722 [error] [MainThread]:   compiled Code at target/run/uber/models/transform/fact_trip.sql
[0m00:53:08.010682 [info ] [MainThread]: 
[0m00:53:08.012406 [info ] [MainThread]: Done. PASS=7 WARN=0 ERROR=1 SKIP=0 TOTAL=8
[0m00:53:08.015238 [debug] [MainThread]: Command `dbt run` failed at 00:53:08.014903 after 80.03 seconds
[0m00:53:08.016208 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff917feb50>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff917fdbd0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff91814490>]}
[0m00:53:08.016914 [debug] [MainThread]: Flushing usage events
[0m00:55:34.835394 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff92edf290>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff92bb9350>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff92bb9250>]}


============================== 00:55:34.840930 | 6c32a062-f4a9-4e60-aea0-3a16266f02e8 ==============================
[0m00:55:34.840930 [info ] [MainThread]: Running with dbt=1.5.9
[0m00:55:34.842027 [debug] [MainThread]: running dbt with arguments {'debug': 'False', 'printer_width': '80', 'send_anonymous_usage_stats': 'True', 'static_parser': 'True', 'partial_parse': 'True', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'cache_selected_only': 'False', 'use_experimental_parser': 'False', 'profiles_dir': '/usr/local/airflow/include/dbt/', 'quiet': 'False', 'log_path': '/usr/local/airflow/include/dbt/logs', 'indirect_selection': 'eager', 'introspect': 'True', 'use_colors': 'True', 'warn_error': 'None', 'write_json': 'True', 'version_check': 'True', 'log_cache_events': 'False', 'target_path': 'None', 'log_format': 'default', 'no_print': 'None', 'fail_fast': 'False'}
[0m00:55:35.242637 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '6c32a062-f4a9-4e60-aea0-3a16266f02e8', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff90b6ad10>]}
[0m00:55:35.254021 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '6c32a062-f4a9-4e60-aea0-3a16266f02e8', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff90b63f90>]}
[0m00:55:35.254781 [info ] [MainThread]: Registered adapter: bigquery=1.5.3
[0m00:55:35.269622 [debug] [MainThread]: checksum: dd837546c89c9d03f3c2cb0ca6165266a30da6076d5d44e9991f7c5a8e5f5831, vars: {}, profile: , target: , version: 1.5.9
[0m00:55:35.343425 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m00:55:35.344303 [debug] [MainThread]: Partial parsing: updated file: uber://models/transform/fact_trip.sql
[0m00:55:35.367796 [debug] [MainThread]: 1699: static parser successfully parsed transform/fact_trip.sql
[0m00:55:35.392182 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '6c32a062-f4a9-4e60-aea0-3a16266f02e8', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff909aaed0>]}
[0m00:55:35.405939 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '6c32a062-f4a9-4e60-aea0-3a16266f02e8', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff8394eb10>]}
[0m00:55:35.406570 [info ] [MainThread]: Found 8 models, 0 tests, 0 snapshots, 0 analyses, 474 macros, 0 operations, 0 seed files, 1 source, 0 exposures, 0 metrics, 0 groups
[0m00:55:35.407315 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '6c32a062-f4a9-4e60-aea0-3a16266f02e8', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff95a4fa10>]}
[0m00:55:35.410069 [info ] [MainThread]: 
[0m00:55:35.411533 [debug] [MainThread]: Acquiring new bigquery connection 'master'
[0m00:55:35.413553 [debug] [ThreadPool]: Acquiring new bigquery connection 'list_uber-data-engineering-407103'
[0m00:55:35.414442 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m00:55:35.875431 [debug] [ThreadPool]: Acquiring new bigquery connection 'list_uber-data-engineering-407103_uber'
[0m00:55:35.876520 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m00:55:36.234131 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '6c32a062-f4a9-4e60-aea0-3a16266f02e8', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff90b74e10>]}
[0m00:55:36.236083 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m00:55:36.237323 [info ] [MainThread]: 
[0m00:55:36.259074 [debug] [Thread-1 (]: Began running node model.uber.datetime_dim
[0m00:55:36.260126 [info ] [Thread-1 (]: 1 of 8 START sql table model uber.datetime_dim ................................. [RUN]
[0m00:55:36.261258 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_uber-data-engineering-407103_uber, now model.uber.datetime_dim)
[0m00:55:36.261893 [debug] [Thread-1 (]: Began compiling node model.uber.datetime_dim
[0m00:55:36.279627 [debug] [Thread-1 (]: Writing injected SQL for node "model.uber.datetime_dim"
[0m00:55:36.281951 [debug] [Thread-1 (]: Timing info for model.uber.datetime_dim (compile): 00:55:36.262332 => 00:55:36.281739
[0m00:55:36.282519 [debug] [Thread-1 (]: Began executing node model.uber.datetime_dim
[0m00:55:36.295758 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m00:55:36.882880 [debug] [Thread-1 (]: Writing runtime sql for node "model.uber.datetime_dim"
[0m00:55:36.886939 [debug] [Thread-1 (]: On model.uber.datetime_dim: /* {"app": "dbt", "dbt_version": "1.5.9", "profile_name": "uber", "target_name": "dev", "node_id": "model.uber.datetime_dim"} */

  
    

    create or replace table `uber-data-engineering-407103`.`uber`.`datetime_dim`
    
    

    OPTIONS()
    as (
      WITH datetime_cte AS (  
  SELECT DISTINCT 
    to_hex(md5(cast(coalesce(cast(tpep_pickup_datetime as STRING), '_dbt_utils_surrogate_key_null_') || '-' || coalesce(cast(tpep_dropoff_datetime as STRING), '_dbt_utils_surrogate_key_null_') as STRING))) AS datetime_id,
    CASE
      WHEN LENGTH(tpep_pickup_datetime) = 16 THEN
        -- Date format: "DD/MM/YYYY HH:MM"
        PARSE_DATETIME('%m/%d/%Y %H:%M', tpep_pickup_datetime)
      WHEN LENGTH(tpep_pickup_datetime) <= 14 THEN
        -- Date format: "MM/DD/YY HH:MM"
        PARSE_DATETIME('%m/%d/%y %H:%M', tpep_pickup_datetime)
      ELSE
        NULL
    END AS pick_date_part,
    tpep_dropoff_datetime AS drop_datetime_id,
    CASE
      WHEN LENGTH(tpep_dropoff_datetime) = 16 THEN
        -- Date format: "DD/MM/YYYY HH:MM"
        PARSE_DATETIME('%m/%d/%Y %H:%M', tpep_dropoff_datetime)
      WHEN LENGTH(tpep_dropoff_datetime) <= 14 THEN
        -- Date format: "MM/DD/YY HH:MM"
        PARSE_DATETIME('%m/%d/%y %H:%M', tpep_dropoff_datetime)
      ELSE
        NULL
    END AS drop_date_part
  FROM `uber-data-engineering-407103`.`uber`.`uber_tlc_trip_recrord_data`
  WHERE tpep_pickup_datetime IS NOT NULL
    AND tpep_dropoff_datetime IS NOT NULL
)
SELECT
  datetime_id,
  pick_date_part AS tpep_pickup_datetime,
  drop_date_part AS tpep_dropoff_datetime,
  EXTRACT(HOUR FROM pick_date_part) AS pick_hour,
  EXTRACT(DAY FROM pick_date_part) AS pick_day,
  EXTRACT(MONTH FROM pick_date_part) AS pick_month,
  EXTRACT(YEAR FROM pick_date_part) AS pick_year,
  EXTRACT(DAYOFWEEK FROM pick_date_part) AS pick_weekday,
  EXTRACT(HOUR FROM drop_date_part) AS drop_hour,
  EXTRACT(DAY FROM drop_date_part) AS drop_day,
  EXTRACT(MONTH FROM drop_date_part) AS drop_month,
  EXTRACT(YEAR FROM drop_date_part) AS drop_year,
  EXTRACT(DAYOFWEEK FROM drop_date_part) AS drop_weekday
FROM datetime_cte
    );
  
[0m00:55:39.898419 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=uber-data-engineering-407103&j=bq:US:fb4a8d78-3b06-4a0b-b9aa-8d6f1d9c070e&page=queryresults
[0m00:55:39.947598 [debug] [Thread-1 (]: Timing info for model.uber.datetime_dim (execute): 00:55:36.282991 => 00:55:39.946608
[0m00:55:39.950033 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '6c32a062-f4a9-4e60-aea0-3a16266f02e8', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff90a28e90>]}
[0m00:55:39.952120 [info ] [Thread-1 (]: 1 of 8 OK created sql table model uber.datetime_dim ............................ [[32mCREATE TABLE (99.9k rows, 4.0 MiB processed)[0m in 3.69s]
[0m00:55:39.954014 [debug] [Thread-1 (]: Finished running node model.uber.datetime_dim
[0m00:55:39.955015 [debug] [Thread-1 (]: Began running node model.uber.dropoff_location_dim
[0m00:55:39.956098 [info ] [Thread-1 (]: 2 of 8 START sql table model uber.dropoff_location_dim ......................... [RUN]
[0m00:55:39.957378 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.uber.datetime_dim, now model.uber.dropoff_location_dim)
[0m00:55:39.958063 [debug] [Thread-1 (]: Began compiling node model.uber.dropoff_location_dim
[0m00:55:39.965248 [debug] [Thread-1 (]: Writing injected SQL for node "model.uber.dropoff_location_dim"
[0m00:55:39.968193 [debug] [Thread-1 (]: Timing info for model.uber.dropoff_location_dim (compile): 00:55:39.958537 => 00:55:39.967987
[0m00:55:39.968767 [debug] [Thread-1 (]: Began executing node model.uber.dropoff_location_dim
[0m00:55:39.972204 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m00:55:40.443338 [debug] [Thread-1 (]: Writing runtime sql for node "model.uber.dropoff_location_dim"
[0m00:55:40.445513 [debug] [Thread-1 (]: On model.uber.dropoff_location_dim: /* {"app": "dbt", "dbt_version": "1.5.9", "profile_name": "uber", "target_name": "dev", "node_id": "model.uber.dropoff_location_dim"} */

  
    

    create or replace table `uber-data-engineering-407103`.`uber`.`dropoff_location_dim`
    
    

    OPTIONS()
    as (
      WITH numbered_rows AS (
  SELECT
    to_hex(md5(cast(coalesce(cast(dropoff_latitude as STRING), '_dbt_utils_surrogate_key_null_') || '-' || coalesce(cast(dropoff_longitude as STRING), '_dbt_utils_surrogate_key_null_') as STRING))) as dropoff_location_id,
    dropoff_latitude AS dropoff_latitude,
    dropoff_longitude AS dropoff_longitude,
    ROW_NUMBER() OVER (ORDER BY dropoff_latitude, dropoff_longitude) as row_num
  FROM `uber-data-engineering-407103`.`uber`.`uber_tlc_trip_recrord_data`
)
SELECT
  dropoff_location_id,
  dropoff_latitude,
  dropoff_longitude
FROM numbered_rows
    );
  
[0m00:55:43.529677 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=uber-data-engineering-407103&j=bq:US:e4d06c27-6f81-4ab2-b81b-d64a05e64a59&page=queryresults
[0m00:55:43.547425 [debug] [Thread-1 (]: Timing info for model.uber.dropoff_location_dim (execute): 00:55:39.969221 => 00:55:43.546635
[0m00:55:43.550696 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '6c32a062-f4a9-4e60-aea0-3a16266f02e8', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff83919910>]}
[0m00:55:43.553000 [info ] [Thread-1 (]: 2 of 8 OK created sql table model uber.dropoff_location_dim .................... [[32mCREATE TABLE (100.0k rows, 1.5 MiB processed)[0m in 3.59s]
[0m00:55:43.554988 [debug] [Thread-1 (]: Finished running node model.uber.dropoff_location_dim
[0m00:55:43.556346 [debug] [Thread-1 (]: Began running node model.uber.passenger_count_dim
[0m00:55:43.558003 [info ] [Thread-1 (]: 3 of 8 START sql table model uber.passenger_count_dim .......................... [RUN]
[0m00:55:43.559359 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.uber.dropoff_location_dim, now model.uber.passenger_count_dim)
[0m00:55:43.560080 [debug] [Thread-1 (]: Began compiling node model.uber.passenger_count_dim
[0m00:55:43.568368 [debug] [Thread-1 (]: Writing injected SQL for node "model.uber.passenger_count_dim"
[0m00:55:43.570746 [debug] [Thread-1 (]: Timing info for model.uber.passenger_count_dim (compile): 00:55:43.560543 => 00:55:43.570434
[0m00:55:43.571972 [debug] [Thread-1 (]: Began executing node model.uber.passenger_count_dim
[0m00:55:43.582225 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m00:55:44.052808 [debug] [Thread-1 (]: Writing runtime sql for node "model.uber.passenger_count_dim"
[0m00:55:44.059510 [debug] [Thread-1 (]: On model.uber.passenger_count_dim: /* {"app": "dbt", "dbt_version": "1.5.9", "profile_name": "uber", "target_name": "dev", "node_id": "model.uber.passenger_count_dim"} */

  
    

    create or replace table `uber-data-engineering-407103`.`uber`.`passenger_count_dim`
    
    

    OPTIONS()
    as (
      SELECT DISTINCT
        GENERATE_UUID() as passenger_count_id,
		passenger_count AS passenger_count,
FROM `uber-data-engineering-407103`.`uber`.`uber_tlc_trip_recrord_data`
WHERE passenger_count IS NOT NULL
    );
  
[0m00:55:46.957933 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=uber-data-engineering-407103&j=bq:US:16ca0675-a032-44d2-b517-b3720276dc35&page=queryresults
[0m00:55:46.967760 [debug] [Thread-1 (]: Timing info for model.uber.passenger_count_dim (execute): 00:55:43.572865 => 00:55:46.967177
[0m00:55:46.970422 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '6c32a062-f4a9-4e60-aea0-3a16266f02e8', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff908e4810>]}
[0m00:55:46.972491 [info ] [Thread-1 (]: 3 of 8 OK created sql table model uber.passenger_count_dim ..................... [[32mCREATE TABLE (100.0k rows, 781.2 KiB processed)[0m in 3.41s]
[0m00:55:46.974911 [debug] [Thread-1 (]: Finished running node model.uber.passenger_count_dim
[0m00:55:46.976556 [debug] [Thread-1 (]: Began running node model.uber.payment_type_dim
[0m00:55:46.978082 [info ] [Thread-1 (]: 4 of 8 START sql table model uber.payment_type_dim ............................. [RUN]
[0m00:55:46.980359 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.uber.passenger_count_dim, now model.uber.payment_type_dim)
[0m00:55:46.981753 [debug] [Thread-1 (]: Began compiling node model.uber.payment_type_dim
[0m00:55:46.991769 [debug] [Thread-1 (]: Writing injected SQL for node "model.uber.payment_type_dim"
[0m00:55:46.997131 [debug] [Thread-1 (]: Timing info for model.uber.payment_type_dim (compile): 00:55:46.982553 => 00:55:46.996814
[0m00:55:46.997987 [debug] [Thread-1 (]: Began executing node model.uber.payment_type_dim
[0m00:55:47.001533 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m00:55:47.354232 [debug] [Thread-1 (]: Writing runtime sql for node "model.uber.payment_type_dim"
[0m00:55:47.359068 [debug] [Thread-1 (]: On model.uber.payment_type_dim: /* {"app": "dbt", "dbt_version": "1.5.9", "profile_name": "uber", "target_name": "dev", "node_id": "model.uber.payment_type_dim"} */

  
    

    create or replace table `uber-data-engineering-407103`.`uber`.`payment_type_dim`
    
    

    OPTIONS()
    as (
      WITH numbered_rows AS (
  SELECT
    GENERATE_UUID() as payment_type_id,
    payment_type AS payment_type,
    ROW_NUMBER() OVER (ORDER BY payment_type) as row_num
  FROM `uber-data-engineering-407103`.`uber`.`uber_tlc_trip_recrord_data`
  WHERE payment_type IS NOT NULL
)
SELECT
  payment_type_id,
  payment_type
FROM numbered_rows
    );
  
[0m00:55:50.033011 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=uber-data-engineering-407103&j=bq:US:75fb79a8-d613-46c3-bf69-f68e3a5934e0&page=queryresults
[0m00:55:50.046533 [debug] [Thread-1 (]: Timing info for model.uber.payment_type_dim (execute): 00:55:46.998702 => 00:55:50.045912
[0m00:55:50.049406 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '6c32a062-f4a9-4e60-aea0-3a16266f02e8', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff90a7e790>]}
[0m00:55:50.051548 [info ] [Thread-1 (]: 4 of 8 OK created sql table model uber.payment_type_dim ........................ [[32mCREATE TABLE (100.0k rows, 781.2 KiB processed)[0m in 3.07s]
[0m00:55:50.054878 [debug] [Thread-1 (]: Finished running node model.uber.payment_type_dim
[0m00:55:50.057141 [debug] [Thread-1 (]: Began running node model.uber.pickup_location_dim
[0m00:55:50.059009 [info ] [Thread-1 (]: 5 of 8 START sql table model uber.pickup_location_dim .......................... [RUN]
[0m00:55:50.061074 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.uber.payment_type_dim, now model.uber.pickup_location_dim)
[0m00:55:50.062051 [debug] [Thread-1 (]: Began compiling node model.uber.pickup_location_dim
[0m00:55:50.073153 [debug] [Thread-1 (]: Writing injected SQL for node "model.uber.pickup_location_dim"
[0m00:55:50.076830 [debug] [Thread-1 (]: Timing info for model.uber.pickup_location_dim (compile): 00:55:50.062841 => 00:55:50.076552
[0m00:55:50.077477 [debug] [Thread-1 (]: Began executing node model.uber.pickup_location_dim
[0m00:55:50.080968 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m00:55:50.487136 [debug] [Thread-1 (]: Writing runtime sql for node "model.uber.pickup_location_dim"
[0m00:55:50.492835 [debug] [Thread-1 (]: On model.uber.pickup_location_dim: /* {"app": "dbt", "dbt_version": "1.5.9", "profile_name": "uber", "target_name": "dev", "node_id": "model.uber.pickup_location_dim"} */

  
    

    create or replace table `uber-data-engineering-407103`.`uber`.`pickup_location_dim`
    
    

    OPTIONS()
    as (
      WITH numbered_rows AS (
  SELECT
    to_hex(md5(cast(coalesce(cast(pickup_latitude as STRING), '_dbt_utils_surrogate_key_null_') || '-' || coalesce(cast(pickup_longitude as STRING), '_dbt_utils_surrogate_key_null_') as STRING))) as pickup_location_id,
    pickup_latitude AS pickup_latitude,
    pickup_longitude AS pickup_longitude,
    ROW_NUMBER() OVER (ORDER BY pickup_latitude, pickup_longitude) as row_num
  FROM `uber-data-engineering-407103`.`uber`.`uber_tlc_trip_recrord_data`
)
SELECT
  pickup_location_id,
  pickup_latitude,
  pickup_longitude
FROM numbered_rows
    );
  
[0m00:55:53.559946 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=uber-data-engineering-407103&j=bq:US:43b83591-eec7-4a77-8b31-d550eb7785f2&page=queryresults
[0m00:55:53.566326 [debug] [Thread-1 (]: Timing info for model.uber.pickup_location_dim (execute): 00:55:50.077996 => 00:55:53.565833
[0m00:55:53.568236 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '6c32a062-f4a9-4e60-aea0-3a16266f02e8', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff839953d0>]}
[0m00:55:53.569699 [info ] [Thread-1 (]: 5 of 8 OK created sql table model uber.pickup_location_dim ..................... [[32mCREATE TABLE (100.0k rows, 1.5 MiB processed)[0m in 3.51s]
[0m00:55:53.571458 [debug] [Thread-1 (]: Finished running node model.uber.pickup_location_dim
[0m00:55:53.572978 [debug] [Thread-1 (]: Began running node model.uber.rate_code_dim
[0m00:55:53.574235 [info ] [Thread-1 (]: 6 of 8 START sql table model uber.rate_code_dim ................................ [RUN]
[0m00:55:53.575665 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.uber.pickup_location_dim, now model.uber.rate_code_dim)
[0m00:55:53.576562 [debug] [Thread-1 (]: Began compiling node model.uber.rate_code_dim
[0m00:55:53.598113 [debug] [Thread-1 (]: Writing injected SQL for node "model.uber.rate_code_dim"
[0m00:55:53.602807 [debug] [Thread-1 (]: Timing info for model.uber.rate_code_dim (compile): 00:55:53.577384 => 00:55:53.602415
[0m00:55:53.603602 [debug] [Thread-1 (]: Began executing node model.uber.rate_code_dim
[0m00:55:53.607063 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m00:55:54.091592 [debug] [Thread-1 (]: Writing runtime sql for node "model.uber.rate_code_dim"
[0m00:55:54.097099 [debug] [Thread-1 (]: On model.uber.rate_code_dim: /* {"app": "dbt", "dbt_version": "1.5.9", "profile_name": "uber", "target_name": "dev", "node_id": "model.uber.rate_code_dim"} */

  
    

    create or replace table `uber-data-engineering-407103`.`uber`.`rate_code_dim`
    
    

    OPTIONS()
    as (
      WITH numbered_rows AS (
  SELECT
    GENERATE_UUID() as rate_code_id,
    RatecodeID AS RatecodeID,
    ROW_NUMBER() OVER (ORDER BY RatecodeID) as row_num
  FROM `uber-data-engineering-407103`.`uber`.`uber_tlc_trip_recrord_data`
  WHERE RatecodeID IS NOT NULL
)
SELECT
  rate_code_id,
  RatecodeID
FROM numbered_rows
    );
  
[0m00:55:57.125219 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=uber-data-engineering-407103&j=bq:US:1caa1bef-b4d5-46e5-8490-a3a5963c4f40&page=queryresults
[0m00:55:57.133909 [debug] [Thread-1 (]: Timing info for model.uber.rate_code_dim (execute): 00:55:53.604232 => 00:55:57.133249
[0m00:55:57.136901 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '6c32a062-f4a9-4e60-aea0-3a16266f02e8', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff839ea850>]}
[0m00:55:57.138951 [info ] [Thread-1 (]: 6 of 8 OK created sql table model uber.rate_code_dim ........................... [[32mCREATE TABLE (100.0k rows, 781.2 KiB processed)[0m in 3.56s]
[0m00:55:57.141013 [debug] [Thread-1 (]: Finished running node model.uber.rate_code_dim
[0m00:55:57.143691 [debug] [Thread-1 (]: Began running node model.uber.trip_distance
[0m00:55:57.145970 [info ] [Thread-1 (]: 7 of 8 START sql table model uber.trip_distance ................................ [RUN]
[0m00:55:57.147639 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.uber.rate_code_dim, now model.uber.trip_distance)
[0m00:55:57.148470 [debug] [Thread-1 (]: Began compiling node model.uber.trip_distance
[0m00:55:57.161977 [debug] [Thread-1 (]: Writing injected SQL for node "model.uber.trip_distance"
[0m00:55:57.165590 [debug] [Thread-1 (]: Timing info for model.uber.trip_distance (compile): 00:55:57.149188 => 00:55:57.165354
[0m00:55:57.167193 [debug] [Thread-1 (]: Began executing node model.uber.trip_distance
[0m00:55:57.171151 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m00:55:57.803657 [debug] [Thread-1 (]: Writing runtime sql for node "model.uber.trip_distance"
[0m00:55:57.837270 [debug] [Thread-1 (]: On model.uber.trip_distance: /* {"app": "dbt", "dbt_version": "1.5.9", "profile_name": "uber", "target_name": "dev", "node_id": "model.uber.trip_distance"} */

  
    

    create or replace table `uber-data-engineering-407103`.`uber`.`trip_distance`
    
    

    OPTIONS()
    as (
      WITH numbered_rows AS (
  SELECT
    GENERATE_UUID() as trip_distance_id,
    trip_distance AS trip_distance,
    ROW_NUMBER() OVER (ORDER BY trip_distance) as row_num
  FROM `uber-data-engineering-407103`.`uber`.`uber_tlc_trip_recrord_data`
  WHERE trip_distance IS NOT NULL
)
SELECT
  trip_distance_id,
  trip_distance
FROM numbered_rows
    );
  
[0m00:56:00.471954 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=uber-data-engineering-407103&j=bq:US:d8e1b29f-092d-4b57-bb86-9bceb2c8bfb5&page=queryresults
[0m00:56:00.489732 [debug] [Thread-1 (]: Timing info for model.uber.trip_distance (execute): 00:55:57.167713 => 00:56:00.489059
[0m00:56:00.492955 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '6c32a062-f4a9-4e60-aea0-3a16266f02e8', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff839ea7d0>]}
[0m00:56:00.496620 [info ] [Thread-1 (]: 7 of 8 OK created sql table model uber.trip_distance ........................... [[32mCREATE TABLE (100.0k rows, 781.2 KiB processed)[0m in 3.34s]
[0m00:56:00.499665 [debug] [Thread-1 (]: Finished running node model.uber.trip_distance
[0m00:56:00.504527 [debug] [Thread-1 (]: Began running node model.uber.fact_trip
[0m00:56:00.505583 [info ] [Thread-1 (]: 8 of 8 START sql table model uber.fact_trip .................................... [RUN]
[0m00:56:00.507288 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.uber.trip_distance, now model.uber.fact_trip)
[0m00:56:00.508140 [debug] [Thread-1 (]: Began compiling node model.uber.fact_trip
[0m00:56:00.521219 [debug] [Thread-1 (]: Writing injected SQL for node "model.uber.fact_trip"
[0m00:56:00.523799 [debug] [Thread-1 (]: Timing info for model.uber.fact_trip (compile): 00:56:00.508723 => 00:56:00.523530
[0m00:56:00.524360 [debug] [Thread-1 (]: Began executing node model.uber.fact_trip
[0m00:56:00.528873 [debug] [Thread-1 (]: Writing runtime sql for node "model.uber.fact_trip"
[0m00:56:00.530815 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m00:56:00.534388 [debug] [Thread-1 (]: On model.uber.fact_trip: /* {"app": "dbt", "dbt_version": "1.5.9", "profile_name": "uber", "target_name": "dev", "node_id": "model.uber.fact_trip"} */

  
    

    create or replace table `uber-data-engineering-407103`.`uber`.`fact_trip`
    
    

    OPTIONS()
    as (
      WITH fct_invoices_cte AS (
    SELECT
        CAST(ROW_NUMBER() OVER () AS INT64) as trip_id,
        VendorID AS VendorID,
        datetime_id AS datetime_id,
        passenger_count_id AS passenger_count_id,
        trip_distance_id AS trip_distance_id,
        rate_code_id AS rate_code_id,
        store_and_fwd_flag AS store_and_fwd_flag,
        pickup_location_id AS pickup_location_id,
        dropoff_location_id AS dropoff_location_id,
        payment_type_id AS payment_type_id,
        fare_amount AS fare_amount,
        extra AS extra,
        mta_tax AS mta_tax,
        tip_amount AS tip_amount,
        tolls_amount AS tolls_amount,
        improvement_surcharge AS improvement_surcharge,
        total_amount AS total_amount
    FROM `uber-data-engineering-407103`.`uber`.`uber_tlc_trip_recrord_data`
)
SELECT
    trip_id,
    VendorID,
    datetime_id,
    do.dropoff_location_id,
    pu.pickup_location_id,
    pc.passenger_count_id,
    pt.payment_type_id,
    rc.rate_code_id,
    store_and_fwd_flag,
    td.trip_distance_id,
    fare_amount,
    extra,
    mta_tax,
    tip_amount,
    tolls_amount,
    improvement_surcharge_amount,
    tolls_amount
FROM fct_invoices_cte fi
INNER JOIN `uber-data-engineering-407103`.`uber`.`datetime_dim` dt ON fi.datetime_id = dt.datetime_id
INNER JOIN `uber-data-engineering-407103`.`uber`.`dropoff_location_dim` do ON fi.dropoff_location_id = do.dropoff_location_id
INNER JOIN `uber-data-engineering-407103`.`uber`.`pickup_location_dim` pu ON fi.pickup_location_id = pu.pickup_location_id
INNER JOIN `uber-data-engineering-407103`.`uber`.`passenger_count_dim` pc ON fi.passenger_count_id = pc.passenger_count_id
INNER JOIN `uber-data-engineering-407103`.`uber`.`payment_type_dim` pt ON fi.payment_type_id = pt.payment_type_id
INNER JOIN `uber-data-engineering-407103`.`uber`.`rate_code_dim` rc ON fi.rate_code_id = rc.rate_code_id
INNER JOIN `uber-data-engineering-407103`.`uber`.`trip_distance` td ON fi.trip_distance_id = td.trip_distance_id
    );
  
[0m00:56:01.809089 [debug] [Thread-1 (]: BigQuery adapter: Retry attempt 1 of 1 after error: BadRequest('Unrecognized name: datetime_id at [16:9]')
[0m00:56:02.747449 [error] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=uber-data-engineering-407103&j=bq:US:6bd2ff2d-a72e-4592-b7b5-d95a628d2478&page=queryresults
[0m00:56:02.751103 [debug] [Thread-1 (]: Timing info for model.uber.fact_trip (execute): 00:56:00.524793 => 00:56:02.750391
[0m00:56:02.768238 [debug] [Thread-1 (]: Database Error in model fact_trip (models/transform/fact_trip.sql)
  Unrecognized name: datetime_id at [16:9]
  compiled Code at target/run/uber/models/transform/fact_trip.sql
[0m00:56:02.769882 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '6c32a062-f4a9-4e60-aea0-3a16266f02e8', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff909b0d50>]}
[0m00:56:02.771252 [error] [Thread-1 (]: 8 of 8 ERROR creating sql table model uber.fact_trip ........................... [[31mERROR[0m in 2.26s]
[0m00:56:02.773443 [debug] [Thread-1 (]: Finished running node model.uber.fact_trip
[0m00:56:02.779914 [debug] [MainThread]: Connection 'master' was properly closed.
[0m00:56:02.781086 [debug] [MainThread]: Connection 'list_uber-data-engineering-407103' was properly closed.
[0m00:56:02.781823 [debug] [MainThread]: Connection 'model.uber.fact_trip' was properly closed.
[0m00:56:02.783157 [info ] [MainThread]: 
[0m00:56:02.785016 [info ] [MainThread]: Finished running 8 table models in 0 hours 0 minutes and 27.37 seconds (27.37s).
[0m00:56:02.789019 [debug] [MainThread]: Command end result
[0m00:56:02.837330 [info ] [MainThread]: 
[0m00:56:02.838495 [info ] [MainThread]: [31mCompleted with 1 error and 0 warnings:[0m
[0m00:56:02.839169 [info ] [MainThread]: 
[0m00:56:02.839907 [error] [MainThread]: [33mDatabase Error in model fact_trip (models/transform/fact_trip.sql)[0m
[0m00:56:02.840592 [error] [MainThread]:   Unrecognized name: datetime_id at [16:9]
[0m00:56:02.841233 [error] [MainThread]:   compiled Code at target/run/uber/models/transform/fact_trip.sql
[0m00:56:02.841926 [info ] [MainThread]: 
[0m00:56:02.843141 [info ] [MainThread]: Done. PASS=7 WARN=0 ERROR=1 SKIP=0 TOTAL=8
[0m00:56:02.846156 [debug] [MainThread]: Command `dbt run` failed at 00:56:02.845951 after 28.02 seconds
[0m00:56:02.847561 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff92c01a50>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff92eedad0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff909abe90>]}
[0m00:56:02.848377 [debug] [MainThread]: Flushing usage events
[0m00:59:17.332615 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff9b4b3950>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff9b4b1110>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff9b8f4d90>]}


============================== 00:59:17.340297 | 89df32e8-ab07-434d-86d2-bf6480156e07 ==============================
[0m00:59:17.340297 [info ] [MainThread]: Running with dbt=1.5.9
[0m00:59:17.343898 [debug] [MainThread]: running dbt with arguments {'debug': 'False', 'introspect': 'True', 'cache_selected_only': 'False', 'log_path': '/usr/local/airflow/include/dbt/logs', 'write_json': 'True', 'use_experimental_parser': 'False', 'target_path': 'None', 'static_parser': 'True', 'fail_fast': 'False', 'log_cache_events': 'False', 'use_colors': 'True', 'version_check': 'True', 'indirect_selection': 'eager', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'partial_parse': 'True', 'profiles_dir': '/usr/local/airflow/include/dbt/', 'quiet': 'False', 'log_format': 'default', 'warn_error': 'None', 'printer_width': '80', 'send_anonymous_usage_stats': 'True', 'no_print': 'None'}
[0m00:59:18.925760 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '89df32e8-ab07-434d-86d2-bf6480156e07', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff99a4ec90>]}
[0m00:59:18.963586 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '89df32e8-ab07-434d-86d2-bf6480156e07', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff99a89f50>]}
[0m00:59:18.966424 [info ] [MainThread]: Registered adapter: bigquery=1.5.3
[0m00:59:19.025690 [debug] [MainThread]: checksum: dd837546c89c9d03f3c2cb0ca6165266a30da6076d5d44e9991f7c5a8e5f5831, vars: {}, profile: , target: , version: 1.5.9
[0m00:59:19.213159 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m00:59:19.214564 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m00:59:19.223787 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '89df32e8-ab07-434d-86d2-bf6480156e07', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff99994810>]}
[0m00:59:19.255999 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '89df32e8-ab07-434d-86d2-bf6480156e07', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff99a859d0>]}
[0m00:59:19.259411 [info ] [MainThread]: Found 8 models, 0 tests, 0 snapshots, 0 analyses, 474 macros, 0 operations, 0 seed files, 1 source, 0 exposures, 0 metrics, 0 groups
[0m00:59:19.264384 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '89df32e8-ab07-434d-86d2-bf6480156e07', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff9e9a34d0>]}
[0m00:59:19.281890 [info ] [MainThread]: 
[0m00:59:19.287641 [debug] [MainThread]: Acquiring new bigquery connection 'master'
[0m00:59:19.293349 [debug] [ThreadPool]: Acquiring new bigquery connection 'list_uber-data-engineering-407103'
[0m00:59:19.297080 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m00:59:20.005754 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_uber-data-engineering-407103, now list_uber-data-engineering-407103_uber)
[0m00:59:20.008927 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m00:59:20.790022 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '89df32e8-ab07-434d-86d2-bf6480156e07', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff9c5b6b10>]}
[0m00:59:20.793321 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m00:59:20.795673 [info ] [MainThread]: 
[0m00:59:20.829706 [debug] [Thread-1 (]: Began running node model.uber.datetime_dim
[0m00:59:20.831350 [info ] [Thread-1 (]: 1 of 8 START sql table model uber.datetime_dim ................................. [RUN]
[0m00:59:20.832901 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_uber-data-engineering-407103_uber, now model.uber.datetime_dim)
[0m00:59:20.833737 [debug] [Thread-1 (]: Began compiling node model.uber.datetime_dim
[0m00:59:20.854406 [debug] [Thread-1 (]: Writing injected SQL for node "model.uber.datetime_dim"
[0m00:59:20.856947 [debug] [Thread-1 (]: Timing info for model.uber.datetime_dim (compile): 00:59:20.834376 => 00:59:20.856598
[0m00:59:20.857558 [debug] [Thread-1 (]: Began executing node model.uber.datetime_dim
[0m00:59:20.874061 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m00:59:21.415876 [debug] [Thread-1 (]: Writing runtime sql for node "model.uber.datetime_dim"
[0m00:59:21.418377 [debug] [Thread-1 (]: On model.uber.datetime_dim: /* {"app": "dbt", "dbt_version": "1.5.9", "profile_name": "uber", "target_name": "dev", "node_id": "model.uber.datetime_dim"} */

  
    

    create or replace table `uber-data-engineering-407103`.`uber`.`datetime_dim`
    
    

    OPTIONS()
    as (
      WITH datetime_cte AS (  
  SELECT DISTINCT 
    to_hex(md5(cast(coalesce(cast(tpep_pickup_datetime as STRING), '_dbt_utils_surrogate_key_null_') || '-' || coalesce(cast(tpep_dropoff_datetime as STRING), '_dbt_utils_surrogate_key_null_') as STRING))) AS datetime_id,
    CASE
      WHEN LENGTH(tpep_pickup_datetime) = 16 THEN
        -- Date format: "DD/MM/YYYY HH:MM"
        PARSE_DATETIME('%m/%d/%Y %H:%M', tpep_pickup_datetime)
      WHEN LENGTH(tpep_pickup_datetime) <= 14 THEN
        -- Date format: "MM/DD/YY HH:MM"
        PARSE_DATETIME('%m/%d/%y %H:%M', tpep_pickup_datetime)
      ELSE
        NULL
    END AS pick_date_part,
    tpep_dropoff_datetime AS drop_datetime_id,
    CASE
      WHEN LENGTH(tpep_dropoff_datetime) = 16 THEN
        -- Date format: "DD/MM/YYYY HH:MM"
        PARSE_DATETIME('%m/%d/%Y %H:%M', tpep_dropoff_datetime)
      WHEN LENGTH(tpep_dropoff_datetime) <= 14 THEN
        -- Date format: "MM/DD/YY HH:MM"
        PARSE_DATETIME('%m/%d/%y %H:%M', tpep_dropoff_datetime)
      ELSE
        NULL
    END AS drop_date_part
  FROM `uber-data-engineering-407103`.`uber`.`uber_tlc_trip_recrord_data`
  WHERE tpep_pickup_datetime IS NOT NULL
    AND tpep_dropoff_datetime IS NOT NULL
)
SELECT
  datetime_id,
  pick_date_part AS tpep_pickup_datetime,
  drop_date_part AS tpep_dropoff_datetime,
  EXTRACT(HOUR FROM pick_date_part) AS pick_hour,
  EXTRACT(DAY FROM pick_date_part) AS pick_day,
  EXTRACT(MONTH FROM pick_date_part) AS pick_month,
  EXTRACT(YEAR FROM pick_date_part) AS pick_year,
  EXTRACT(DAYOFWEEK FROM pick_date_part) AS pick_weekday,
  EXTRACT(HOUR FROM drop_date_part) AS drop_hour,
  EXTRACT(DAY FROM drop_date_part) AS drop_day,
  EXTRACT(MONTH FROM drop_date_part) AS drop_month,
  EXTRACT(YEAR FROM drop_date_part) AS drop_year,
  EXTRACT(DAYOFWEEK FROM drop_date_part) AS drop_weekday
FROM datetime_cte
    );
  
[0m00:59:24.217269 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=uber-data-engineering-407103&j=bq:US:95e3091e-0f36-4883-b5be-6d839a13918b&page=queryresults
[0m00:59:24.275224 [debug] [Thread-1 (]: Timing info for model.uber.datetime_dim (execute): 00:59:20.857991 => 00:59:24.274570
[0m00:59:24.277751 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '89df32e8-ab07-434d-86d2-bf6480156e07', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff99ac1010>]}
[0m00:59:24.279960 [info ] [Thread-1 (]: 1 of 8 OK created sql table model uber.datetime_dim ............................ [[32mCREATE TABLE (99.9k rows, 4.0 MiB processed)[0m in 3.44s]
[0m00:59:24.281788 [debug] [Thread-1 (]: Finished running node model.uber.datetime_dim
[0m00:59:24.282744 [debug] [Thread-1 (]: Began running node model.uber.dropoff_location_dim
[0m00:59:24.283982 [info ] [Thread-1 (]: 2 of 8 START sql table model uber.dropoff_location_dim ......................... [RUN]
[0m00:59:24.285175 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.uber.datetime_dim, now model.uber.dropoff_location_dim)
[0m00:59:24.285949 [debug] [Thread-1 (]: Began compiling node model.uber.dropoff_location_dim
[0m00:59:24.295004 [debug] [Thread-1 (]: Writing injected SQL for node "model.uber.dropoff_location_dim"
[0m00:59:24.297730 [debug] [Thread-1 (]: Timing info for model.uber.dropoff_location_dim (compile): 00:59:24.286341 => 00:59:24.297519
[0m00:59:24.298297 [debug] [Thread-1 (]: Began executing node model.uber.dropoff_location_dim
[0m00:59:24.301332 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m00:59:25.004185 [debug] [Thread-1 (]: Writing runtime sql for node "model.uber.dropoff_location_dim"
[0m00:59:25.010375 [debug] [Thread-1 (]: On model.uber.dropoff_location_dim: /* {"app": "dbt", "dbt_version": "1.5.9", "profile_name": "uber", "target_name": "dev", "node_id": "model.uber.dropoff_location_dim"} */

  
    

    create or replace table `uber-data-engineering-407103`.`uber`.`dropoff_location_dim`
    
    

    OPTIONS()
    as (
      WITH numbered_rows AS (
  SELECT
    to_hex(md5(cast(coalesce(cast(dropoff_latitude as STRING), '_dbt_utils_surrogate_key_null_') || '-' || coalesce(cast(dropoff_longitude as STRING), '_dbt_utils_surrogate_key_null_') as STRING))) as dropoff_location_id,
    dropoff_latitude AS dropoff_latitude,
    dropoff_longitude AS dropoff_longitude,
    ROW_NUMBER() OVER (ORDER BY dropoff_latitude, dropoff_longitude) as row_num
  FROM `uber-data-engineering-407103`.`uber`.`uber_tlc_trip_recrord_data`
)
SELECT
  dropoff_location_id,
  dropoff_latitude,
  dropoff_longitude
FROM numbered_rows
    );
  
[0m00:59:28.598327 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=uber-data-engineering-407103&j=bq:US:aa5227a8-9a93-43a7-852e-6e0eec5b7c17&page=queryresults
[0m00:59:28.610290 [debug] [Thread-1 (]: Timing info for model.uber.dropoff_location_dim (execute): 00:59:24.298650 => 00:59:28.609703
[0m00:59:28.612492 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '89df32e8-ab07-434d-86d2-bf6480156e07', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff9c5b6b10>]}
[0m00:59:28.614312 [info ] [Thread-1 (]: 2 of 8 OK created sql table model uber.dropoff_location_dim .................... [[32mCREATE TABLE (100.0k rows, 1.5 MiB processed)[0m in 4.33s]
[0m00:59:28.616329 [debug] [Thread-1 (]: Finished running node model.uber.dropoff_location_dim
[0m00:59:28.617460 [debug] [Thread-1 (]: Began running node model.uber.passenger_count_dim
[0m00:59:28.618771 [info ] [Thread-1 (]: 3 of 8 START sql table model uber.passenger_count_dim .......................... [RUN]
[0m00:59:28.620006 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.uber.dropoff_location_dim, now model.uber.passenger_count_dim)
[0m00:59:28.620745 [debug] [Thread-1 (]: Began compiling node model.uber.passenger_count_dim
[0m00:59:28.628760 [debug] [Thread-1 (]: Writing injected SQL for node "model.uber.passenger_count_dim"
[0m00:59:28.631542 [debug] [Thread-1 (]: Timing info for model.uber.passenger_count_dim (compile): 00:59:28.621246 => 00:59:28.631366
[0m00:59:28.632511 [debug] [Thread-1 (]: Began executing node model.uber.passenger_count_dim
[0m00:59:28.635150 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m00:59:29.893638 [debug] [Thread-1 (]: Writing runtime sql for node "model.uber.passenger_count_dim"
[0m00:59:29.904716 [debug] [Thread-1 (]: On model.uber.passenger_count_dim: /* {"app": "dbt", "dbt_version": "1.5.9", "profile_name": "uber", "target_name": "dev", "node_id": "model.uber.passenger_count_dim"} */

  
    

    create or replace table `uber-data-engineering-407103`.`uber`.`passenger_count_dim`
    
    

    OPTIONS()
    as (
      SELECT DISTINCT
        GENERATE_UUID() as passenger_count_id,
		passenger_count AS passenger_count,
FROM `uber-data-engineering-407103`.`uber`.`uber_tlc_trip_recrord_data`
WHERE passenger_count IS NOT NULL
    );
  
[0m00:59:33.522304 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=uber-data-engineering-407103&j=bq:US:9891ccec-bb1d-42f5-b251-ea63c0779c8e&page=queryresults
[0m00:59:33.532694 [debug] [Thread-1 (]: Timing info for model.uber.passenger_count_dim (execute): 00:59:28.632929 => 00:59:33.532099
[0m00:59:33.534985 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '89df32e8-ab07-434d-86d2-bf6480156e07', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff99ac1f50>]}
[0m00:59:33.537301 [info ] [Thread-1 (]: 3 of 8 OK created sql table model uber.passenger_count_dim ..................... [[32mCREATE TABLE (100.0k rows, 781.2 KiB processed)[0m in 4.91s]
[0m00:59:33.539268 [debug] [Thread-1 (]: Finished running node model.uber.passenger_count_dim
[0m00:59:33.540393 [debug] [Thread-1 (]: Began running node model.uber.payment_type_dim
[0m00:59:33.541709 [info ] [Thread-1 (]: 4 of 8 START sql table model uber.payment_type_dim ............................. [RUN]
[0m00:59:33.542885 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.uber.passenger_count_dim, now model.uber.payment_type_dim)
[0m00:59:33.543521 [debug] [Thread-1 (]: Began compiling node model.uber.payment_type_dim
[0m00:59:33.573312 [debug] [Thread-1 (]: Writing injected SQL for node "model.uber.payment_type_dim"
[0m00:59:33.576141 [debug] [Thread-1 (]: Timing info for model.uber.payment_type_dim (compile): 00:59:33.543940 => 00:59:33.575967
[0m00:59:33.576562 [debug] [Thread-1 (]: Began executing node model.uber.payment_type_dim
[0m00:59:33.579286 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m00:59:36.753782 [debug] [Thread-1 (]: Writing runtime sql for node "model.uber.payment_type_dim"
[0m00:59:36.769057 [debug] [Thread-1 (]: On model.uber.payment_type_dim: /* {"app": "dbt", "dbt_version": "1.5.9", "profile_name": "uber", "target_name": "dev", "node_id": "model.uber.payment_type_dim"} */

  
    

    create or replace table `uber-data-engineering-407103`.`uber`.`payment_type_dim`
    
    

    OPTIONS()
    as (
      WITH numbered_rows AS (
  SELECT
    GENERATE_UUID() as payment_type_id,
    payment_type AS payment_type,
    ROW_NUMBER() OVER (ORDER BY payment_type) as row_num
  FROM `uber-data-engineering-407103`.`uber`.`uber_tlc_trip_recrord_data`
  WHERE payment_type IS NOT NULL
)
SELECT
  payment_type_id,
  payment_type
FROM numbered_rows
    );
  
[0m00:59:39.830494 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=uber-data-engineering-407103&j=bq:US:5c8660ef-3c11-4a81-bfce-7646e551d473&page=queryresults
[0m00:59:39.841794 [debug] [Thread-1 (]: Timing info for model.uber.payment_type_dim (execute): 00:59:33.576865 => 00:59:39.841185
[0m00:59:39.844496 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '89df32e8-ab07-434d-86d2-bf6480156e07', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff9991e010>]}
[0m00:59:39.846787 [info ] [Thread-1 (]: 4 of 8 OK created sql table model uber.payment_type_dim ........................ [[32mCREATE TABLE (100.0k rows, 781.2 KiB processed)[0m in 6.30s]
[0m00:59:39.848654 [debug] [Thread-1 (]: Finished running node model.uber.payment_type_dim
[0m00:59:39.849855 [debug] [Thread-1 (]: Began running node model.uber.pickup_location_dim
[0m00:59:39.851349 [info ] [Thread-1 (]: 5 of 8 START sql table model uber.pickup_location_dim .......................... [RUN]
[0m00:59:39.852696 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.uber.payment_type_dim, now model.uber.pickup_location_dim)
[0m00:59:39.853580 [debug] [Thread-1 (]: Began compiling node model.uber.pickup_location_dim
[0m00:59:39.865006 [debug] [Thread-1 (]: Writing injected SQL for node "model.uber.pickup_location_dim"
[0m00:59:39.867480 [debug] [Thread-1 (]: Timing info for model.uber.pickup_location_dim (compile): 00:59:39.854065 => 00:59:39.867291
[0m00:59:39.868008 [debug] [Thread-1 (]: Began executing node model.uber.pickup_location_dim
[0m00:59:39.870879 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m00:59:40.468028 [debug] [Thread-1 (]: Writing runtime sql for node "model.uber.pickup_location_dim"
[0m00:59:40.475001 [debug] [Thread-1 (]: On model.uber.pickup_location_dim: /* {"app": "dbt", "dbt_version": "1.5.9", "profile_name": "uber", "target_name": "dev", "node_id": "model.uber.pickup_location_dim"} */

  
    

    create or replace table `uber-data-engineering-407103`.`uber`.`pickup_location_dim`
    
    

    OPTIONS()
    as (
      WITH numbered_rows AS (
  SELECT
    to_hex(md5(cast(coalesce(cast(pickup_latitude as STRING), '_dbt_utils_surrogate_key_null_') || '-' || coalesce(cast(pickup_longitude as STRING), '_dbt_utils_surrogate_key_null_') as STRING))) as pickup_location_id,
    pickup_latitude AS pickup_latitude,
    pickup_longitude AS pickup_longitude,
    ROW_NUMBER() OVER (ORDER BY pickup_latitude, pickup_longitude) as row_num
  FROM `uber-data-engineering-407103`.`uber`.`uber_tlc_trip_recrord_data`
)
SELECT
  pickup_location_id,
  pickup_latitude,
  pickup_longitude
FROM numbered_rows
    );
  
[0m00:59:43.455811 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=uber-data-engineering-407103&j=bq:US:6326b4f4-7509-4fb6-b48c-a5eeb9f980dd&page=queryresults
[0m00:59:43.474102 [debug] [Thread-1 (]: Timing info for model.uber.pickup_location_dim (execute): 00:59:39.868393 => 00:59:43.473193
[0m00:59:43.477676 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '89df32e8-ab07-434d-86d2-bf6480156e07', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff99734b90>]}
[0m00:59:43.480400 [info ] [Thread-1 (]: 5 of 8 OK created sql table model uber.pickup_location_dim ..................... [[32mCREATE TABLE (100.0k rows, 1.5 MiB processed)[0m in 3.62s]
[0m00:59:43.482254 [debug] [Thread-1 (]: Finished running node model.uber.pickup_location_dim
[0m00:59:43.483554 [debug] [Thread-1 (]: Began running node model.uber.rate_code_dim
[0m00:59:43.485090 [info ] [Thread-1 (]: 6 of 8 START sql table model uber.rate_code_dim ................................ [RUN]
[0m00:59:43.486505 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.uber.pickup_location_dim, now model.uber.rate_code_dim)
[0m00:59:43.487375 [debug] [Thread-1 (]: Began compiling node model.uber.rate_code_dim
[0m00:59:43.497370 [debug] [Thread-1 (]: Writing injected SQL for node "model.uber.rate_code_dim"
[0m00:59:43.499441 [debug] [Thread-1 (]: Timing info for model.uber.rate_code_dim (compile): 00:59:43.487861 => 00:59:43.499261
[0m00:59:43.499952 [debug] [Thread-1 (]: Began executing node model.uber.rate_code_dim
[0m00:59:43.502560 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m00:59:44.212640 [debug] [Thread-1 (]: Writing runtime sql for node "model.uber.rate_code_dim"
[0m00:59:44.218711 [debug] [Thread-1 (]: On model.uber.rate_code_dim: /* {"app": "dbt", "dbt_version": "1.5.9", "profile_name": "uber", "target_name": "dev", "node_id": "model.uber.rate_code_dim"} */

  
    

    create or replace table `uber-data-engineering-407103`.`uber`.`rate_code_dim`
    
    

    OPTIONS()
    as (
      WITH numbered_rows AS (
  SELECT
    GENERATE_UUID() as rate_code_id,
    RatecodeID AS RatecodeID,
    ROW_NUMBER() OVER (ORDER BY RatecodeID) as row_num
  FROM `uber-data-engineering-407103`.`uber`.`uber_tlc_trip_recrord_data`
  WHERE RatecodeID IS NOT NULL
)
SELECT
  rate_code_id,
  RatecodeID
FROM numbered_rows
    );
  
[0m00:59:47.402415 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=uber-data-engineering-407103&j=bq:US:489d2cd9-562c-47f0-b8cb-fbe901f7a02d&page=queryresults
[0m00:59:47.414658 [debug] [Thread-1 (]: Timing info for model.uber.rate_code_dim (execute): 00:59:43.500292 => 00:59:47.413917
[0m00:59:47.422592 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '89df32e8-ab07-434d-86d2-bf6480156e07', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff99708390>]}
[0m00:59:47.428667 [info ] [Thread-1 (]: 6 of 8 OK created sql table model uber.rate_code_dim ........................... [[32mCREATE TABLE (100.0k rows, 781.2 KiB processed)[0m in 3.93s]
[0m00:59:47.434998 [debug] [Thread-1 (]: Finished running node model.uber.rate_code_dim
[0m00:59:47.442033 [debug] [Thread-1 (]: Began running node model.uber.trip_distance
[0m00:59:47.445170 [info ] [Thread-1 (]: 7 of 8 START sql table model uber.trip_distance ................................ [RUN]
[0m00:59:47.447753 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.uber.rate_code_dim, now model.uber.trip_distance)
[0m00:59:47.449435 [debug] [Thread-1 (]: Began compiling node model.uber.trip_distance
[0m00:59:47.459879 [debug] [Thread-1 (]: Writing injected SQL for node "model.uber.trip_distance"
[0m00:59:47.462563 [debug] [Thread-1 (]: Timing info for model.uber.trip_distance (compile): 00:59:47.451284 => 00:59:47.462363
[0m00:59:47.463428 [debug] [Thread-1 (]: Began executing node model.uber.trip_distance
[0m00:59:47.466113 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m00:59:48.012946 [debug] [Thread-1 (]: Writing runtime sql for node "model.uber.trip_distance"
[0m00:59:48.018355 [debug] [Thread-1 (]: On model.uber.trip_distance: /* {"app": "dbt", "dbt_version": "1.5.9", "profile_name": "uber", "target_name": "dev", "node_id": "model.uber.trip_distance"} */

  
    

    create or replace table `uber-data-engineering-407103`.`uber`.`trip_distance`
    
    

    OPTIONS()
    as (
      WITH numbered_rows AS (
  SELECT
    GENERATE_UUID() as trip_distance_id,
    trip_distance AS trip_distance,
    ROW_NUMBER() OVER (ORDER BY trip_distance) as row_num
  FROM `uber-data-engineering-407103`.`uber`.`uber_tlc_trip_recrord_data`
  WHERE trip_distance IS NOT NULL
)
SELECT
  trip_distance_id,
  trip_distance
FROM numbered_rows
    );
  
[0m00:59:51.007282 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=uber-data-engineering-407103&j=bq:US:19505201-c8a5-42be-b7ac-59c3ecb34e48&page=queryresults
[0m00:59:51.018052 [debug] [Thread-1 (]: Timing info for model.uber.trip_distance (execute): 00:59:47.463852 => 00:59:51.017252
[0m00:59:51.021553 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '89df32e8-ab07-434d-86d2-bf6480156e07', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff9bb58210>]}
[0m00:59:51.023443 [info ] [Thread-1 (]: 7 of 8 OK created sql table model uber.trip_distance ........................... [[32mCREATE TABLE (100.0k rows, 781.2 KiB processed)[0m in 3.57s]
[0m00:59:51.025377 [debug] [Thread-1 (]: Finished running node model.uber.trip_distance
[0m00:59:51.028480 [debug] [Thread-1 (]: Began running node model.uber.fact_trip
[0m00:59:51.029545 [info ] [Thread-1 (]: 8 of 8 START sql table model uber.fact_trip .................................... [RUN]
[0m00:59:51.031559 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.uber.trip_distance, now model.uber.fact_trip)
[0m00:59:51.032493 [debug] [Thread-1 (]: Began compiling node model.uber.fact_trip
[0m00:59:51.042346 [debug] [Thread-1 (]: Writing injected SQL for node "model.uber.fact_trip"
[0m00:59:51.045304 [debug] [Thread-1 (]: Timing info for model.uber.fact_trip (compile): 00:59:51.033133 => 00:59:51.045104
[0m00:59:51.045967 [debug] [Thread-1 (]: Began executing node model.uber.fact_trip
[0m00:59:51.049512 [debug] [Thread-1 (]: Writing runtime sql for node "model.uber.fact_trip"
[0m00:59:51.051160 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m00:59:51.053562 [debug] [Thread-1 (]: On model.uber.fact_trip: /* {"app": "dbt", "dbt_version": "1.5.9", "profile_name": "uber", "target_name": "dev", "node_id": "model.uber.fact_trip"} */

  
    

    create or replace table `uber-data-engineering-407103`.`uber`.`fact_trip`
    
    

    OPTIONS()
    as (
      WITH fct_invoices_cte AS (
    SELECT
        CAST(ROW_NUMBER() OVER () AS INT64) as trip_id,
        VendorID AS VendorID,
        datetime_id AS datetime_id,
        passenger_count_id AS passenger_count_id,
        trip_distance_id AS trip_distance_id,
        rate_code_id AS rate_code_id,
        store_and_fwd_flag AS store_and_fwd_flag,
        pickup_location_id AS pickup_location_id,
        dropoff_location_id AS dropoff_location_id,
        payment_type_id AS payment_type_id,
        fare_amount AS fare_amount,
        extra AS extra,
        mta_tax AS mta_tax,
        tip_amount AS tip_amount,
        tolls_amount AS tolls_amount,
        improvement_surcharge AS improvement_surcharge,
        total_amount AS total_amount
    FROM `uber-data-engineering-407103`.`uber`.`uber_tlc_trip_recrord_data`
)
SELECT
    trip_id,
    VendorID,
    datetime_id,
    do.dropoff_location_id,
    pu.pickup_location_id,
    pc.passenger_count_id,
    pt.payment_type_id,
    rc.rate_code_id,
    store_and_fwd_flag,
    td.trip_distance_id,
    fare_amount,
    extra,
    mta_tax,
    tip_amount,
    tolls_amount,
    improvement_surcharge_amount,
    tolls_amount
FROM fct_invoices_cte fi
INNER JOIN `uber-data-engineering-407103`.`uber`.`datetime_dim` dt ON fi.datetime_id = dt.datetime_id
INNER JOIN `uber-data-engineering-407103`.`uber`.`dropoff_location_dim` do ON fi.dropoff_location_id = do.dropoff_location_id
INNER JOIN `uber-data-engineering-407103`.`uber`.`pickup_location_dim` pu ON fi.pickup_location_id = pu.pickup_location_id
INNER JOIN `uber-data-engineering-407103`.`uber`.`passenger_count_dim` pc ON fi.passenger_count_id = pc.passenger_count_id
INNER JOIN `uber-data-engineering-407103`.`uber`.`payment_type_dim` pt ON fi.payment_type_id = pt.payment_type_id
INNER JOIN `uber-data-engineering-407103`.`uber`.`rate_code_dim` rc ON fi.rate_code_id = rc.rate_code_id
INNER JOIN `uber-data-engineering-407103`.`uber`.`trip_distance` td ON fi.trip_distance_id = td.trip_distance_id
    );
  
[0m00:59:53.177825 [debug] [Thread-1 (]: BigQuery adapter: Retry attempt 1 of 1 after error: BadRequest('Unrecognized name: datetime_id at [16:9]')
[0m00:59:53.959958 [error] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=uber-data-engineering-407103&j=bq:US:430cf4a7-d285-49f3-a743-85f6b227d0b3&page=queryresults
[0m00:59:53.962275 [debug] [Thread-1 (]: Timing info for model.uber.fact_trip (execute): 00:59:51.046576 => 00:59:53.962016
[0m00:59:53.974186 [debug] [Thread-1 (]: Database Error in model fact_trip (models/transform/fact_trip.sql)
  Unrecognized name: datetime_id at [16:9]
  compiled Code at target/run/uber/models/transform/fact_trip.sql
[0m00:59:53.975026 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '89df32e8-ab07-434d-86d2-bf6480156e07', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff999b3f90>]}
[0m00:59:53.976195 [error] [Thread-1 (]: 8 of 8 ERROR creating sql table model uber.fact_trip ........................... [[31mERROR[0m in 2.94s]
[0m00:59:53.977113 [debug] [Thread-1 (]: Finished running node model.uber.fact_trip
[0m00:59:53.981481 [debug] [MainThread]: Connection 'master' was properly closed.
[0m00:59:53.981998 [debug] [MainThread]: Connection 'model.uber.fact_trip' was properly closed.
[0m00:59:53.982660 [info ] [MainThread]: 
[0m00:59:53.983490 [info ] [MainThread]: Finished running 8 table models in 0 hours 0 minutes and 34.70 seconds (34.70s).
[0m00:59:53.986339 [debug] [MainThread]: Command end result
[0m00:59:54.013329 [info ] [MainThread]: 
[0m00:59:54.014929 [info ] [MainThread]: [31mCompleted with 1 error and 0 warnings:[0m
[0m00:59:54.015972 [info ] [MainThread]: 
[0m00:59:54.016935 [error] [MainThread]: [33mDatabase Error in model fact_trip (models/transform/fact_trip.sql)[0m
[0m00:59:54.017667 [error] [MainThread]:   Unrecognized name: datetime_id at [16:9]
[0m00:59:54.018291 [error] [MainThread]:   compiled Code at target/run/uber/models/transform/fact_trip.sql
[0m00:59:54.019040 [info ] [MainThread]: 
[0m00:59:54.020662 [info ] [MainThread]: Done. PASS=7 WARN=0 ERROR=1 SKIP=0 TOTAL=8
[0m00:59:54.023205 [debug] [MainThread]: Command `dbt run` failed at 00:59:54.022915 after 36.71 seconds
[0m00:59:54.024745 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff9bb2af90>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff9bcf5950>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff9b49ff90>]}
[0m00:59:54.025465 [debug] [MainThread]: Flushing usage events
[0m01:02:35.087124 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffb4518890>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffb44dfb10>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffb470cd90>]}


============================== 01:02:35.092585 | bad62315-42fb-4621-9f46-a8f98c0e9f96 ==============================
[0m01:02:35.092585 [info ] [MainThread]: Running with dbt=1.5.9
[0m01:02:35.093976 [debug] [MainThread]: running dbt with arguments {'write_json': 'True', 'send_anonymous_usage_stats': 'True', 'log_cache_events': 'False', 'version_check': 'True', 'indirect_selection': 'eager', 'printer_width': '80', 'no_print': 'None', 'partial_parse': 'True', 'warn_error': 'None', 'log_format': 'default', 'cache_selected_only': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'fail_fast': 'False', 'debug': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'introspect': 'True', 'target_path': 'None', 'profiles_dir': '/usr/local/airflow/include/dbt/', 'log_path': '/usr/local/airflow/include/dbt/logs', 'static_parser': 'True', 'quiet': 'False'}
[0m01:02:35.562547 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'bad62315-42fb-4621-9f46-a8f98c0e9f96', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffb24a2a90>]}
[0m01:02:35.573926 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'bad62315-42fb-4621-9f46-a8f98c0e9f96', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffb24a2a90>]}
[0m01:02:35.574660 [info ] [MainThread]: Registered adapter: bigquery=1.5.3
[0m01:02:35.589998 [debug] [MainThread]: checksum: dd837546c89c9d03f3c2cb0ca6165266a30da6076d5d44e9991f7c5a8e5f5831, vars: {}, profile: , target: , version: 1.5.9
[0m01:02:35.654931 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m01:02:35.655684 [debug] [MainThread]: Partial parsing: updated file: uber://models/transform/fact_trip.sql
[0m01:02:35.675553 [debug] [MainThread]: 1699: static parser successfully parsed transform/fact_trip.sql
[0m01:02:35.697052 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'bad62315-42fb-4621-9f46-a8f98c0e9f96', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffb3f8aed0>]}
[0m01:02:35.723172 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'bad62315-42fb-4621-9f46-a8f98c0e9f96', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffb1116a90>]}
[0m01:02:35.724521 [info ] [MainThread]: Found 8 models, 0 tests, 0 snapshots, 0 analyses, 474 macros, 0 operations, 0 seed files, 1 source, 0 exposures, 0 metrics, 0 groups
[0m01:02:35.726332 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'bad62315-42fb-4621-9f46-a8f98c0e9f96', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffb73cb6d0>]}
[0m01:02:35.728856 [info ] [MainThread]: 
[0m01:02:35.730686 [debug] [MainThread]: Acquiring new bigquery connection 'master'
[0m01:02:35.736124 [debug] [ThreadPool]: Acquiring new bigquery connection 'list_uber-data-engineering-407103'
[0m01:02:35.738389 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m01:02:37.276770 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_uber-data-engineering-407103, now list_uber-data-engineering-407103_uber)
[0m01:02:37.279154 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m01:02:39.393671 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'bad62315-42fb-4621-9f46-a8f98c0e9f96', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffb248c3d0>]}
[0m01:02:39.398275 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m01:02:39.401295 [info ] [MainThread]: 
[0m01:02:39.462394 [debug] [Thread-1 (]: Began running node model.uber.datetime_dim
[0m01:02:39.465184 [info ] [Thread-1 (]: 1 of 8 START sql table model uber.datetime_dim ................................. [RUN]
[0m01:02:39.468346 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_uber-data-engineering-407103_uber, now model.uber.datetime_dim)
[0m01:02:39.469550 [debug] [Thread-1 (]: Began compiling node model.uber.datetime_dim
[0m01:02:39.506363 [debug] [Thread-1 (]: Writing injected SQL for node "model.uber.datetime_dim"
[0m01:02:39.509379 [debug] [Thread-1 (]: Timing info for model.uber.datetime_dim (compile): 01:02:39.470381 => 01:02:39.508957
[0m01:02:39.510065 [debug] [Thread-1 (]: Began executing node model.uber.datetime_dim
[0m01:02:39.527935 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m01:02:41.202769 [debug] [Thread-1 (]: Writing runtime sql for node "model.uber.datetime_dim"
[0m01:02:41.206699 [debug] [Thread-1 (]: On model.uber.datetime_dim: /* {"app": "dbt", "dbt_version": "1.5.9", "profile_name": "uber", "target_name": "dev", "node_id": "model.uber.datetime_dim"} */

  
    

    create or replace table `uber-data-engineering-407103`.`uber`.`datetime_dim`
    
    

    OPTIONS()
    as (
      WITH datetime_cte AS (  
  SELECT DISTINCT 
    to_hex(md5(cast(coalesce(cast(tpep_pickup_datetime as STRING), '_dbt_utils_surrogate_key_null_') || '-' || coalesce(cast(tpep_dropoff_datetime as STRING), '_dbt_utils_surrogate_key_null_') as STRING))) AS datetime_id,
    CASE
      WHEN LENGTH(tpep_pickup_datetime) = 16 THEN
        -- Date format: "DD/MM/YYYY HH:MM"
        PARSE_DATETIME('%m/%d/%Y %H:%M', tpep_pickup_datetime)
      WHEN LENGTH(tpep_pickup_datetime) <= 14 THEN
        -- Date format: "MM/DD/YY HH:MM"
        PARSE_DATETIME('%m/%d/%y %H:%M', tpep_pickup_datetime)
      ELSE
        NULL
    END AS pick_date_part,
    tpep_dropoff_datetime AS drop_datetime_id,
    CASE
      WHEN LENGTH(tpep_dropoff_datetime) = 16 THEN
        -- Date format: "DD/MM/YYYY HH:MM"
        PARSE_DATETIME('%m/%d/%Y %H:%M', tpep_dropoff_datetime)
      WHEN LENGTH(tpep_dropoff_datetime) <= 14 THEN
        -- Date format: "MM/DD/YY HH:MM"
        PARSE_DATETIME('%m/%d/%y %H:%M', tpep_dropoff_datetime)
      ELSE
        NULL
    END AS drop_date_part
  FROM `uber-data-engineering-407103`.`uber`.`uber_tlc_trip_recrord_data`
  WHERE tpep_pickup_datetime IS NOT NULL
    AND tpep_dropoff_datetime IS NOT NULL
)
SELECT
  datetime_id,
  pick_date_part AS tpep_pickup_datetime,
  drop_date_part AS tpep_dropoff_datetime,
  EXTRACT(HOUR FROM pick_date_part) AS pick_hour,
  EXTRACT(DAY FROM pick_date_part) AS pick_day,
  EXTRACT(MONTH FROM pick_date_part) AS pick_month,
  EXTRACT(YEAR FROM pick_date_part) AS pick_year,
  EXTRACT(DAYOFWEEK FROM pick_date_part) AS pick_weekday,
  EXTRACT(HOUR FROM drop_date_part) AS drop_hour,
  EXTRACT(DAY FROM drop_date_part) AS drop_day,
  EXTRACT(MONTH FROM drop_date_part) AS drop_month,
  EXTRACT(YEAR FROM drop_date_part) AS drop_year,
  EXTRACT(DAYOFWEEK FROM drop_date_part) AS drop_weekday
FROM datetime_cte
    );
  
[0m01:02:59.271137 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=uber-data-engineering-407103&j=bq:US:03f8eed3-f43c-4a14-997c-6024b10e37cf&page=queryresults
[0m01:02:59.320105 [debug] [Thread-1 (]: Timing info for model.uber.datetime_dim (execute): 01:02:39.510555 => 01:02:59.319006
[0m01:02:59.324062 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'bad62315-42fb-4621-9f46-a8f98c0e9f96', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffb2219d50>]}
[0m01:02:59.330781 [info ] [Thread-1 (]: 1 of 8 OK created sql table model uber.datetime_dim ............................ [[32mCREATE TABLE (99.9k rows, 4.0 MiB processed)[0m in 19.86s]
[0m01:02:59.333819 [debug] [Thread-1 (]: Finished running node model.uber.datetime_dim
[0m01:02:59.336662 [debug] [Thread-1 (]: Began running node model.uber.dropoff_location_dim
[0m01:02:59.338998 [info ] [Thread-1 (]: 2 of 8 START sql table model uber.dropoff_location_dim ......................... [RUN]
[0m01:02:59.341187 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.uber.datetime_dim, now model.uber.dropoff_location_dim)
[0m01:02:59.342337 [debug] [Thread-1 (]: Began compiling node model.uber.dropoff_location_dim
[0m01:02:59.352780 [debug] [Thread-1 (]: Writing injected SQL for node "model.uber.dropoff_location_dim"
[0m01:02:59.360777 [debug] [Thread-1 (]: Timing info for model.uber.dropoff_location_dim (compile): 01:02:59.343055 => 01:02:59.359984
[0m01:02:59.362691 [debug] [Thread-1 (]: Began executing node model.uber.dropoff_location_dim
[0m01:02:59.370251 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m01:03:01.422902 [debug] [Thread-1 (]: Writing runtime sql for node "model.uber.dropoff_location_dim"
[0m01:03:01.428613 [debug] [Thread-1 (]: On model.uber.dropoff_location_dim: /* {"app": "dbt", "dbt_version": "1.5.9", "profile_name": "uber", "target_name": "dev", "node_id": "model.uber.dropoff_location_dim"} */

  
    

    create or replace table `uber-data-engineering-407103`.`uber`.`dropoff_location_dim`
    
    

    OPTIONS()
    as (
      WITH numbered_rows AS (
  SELECT
    to_hex(md5(cast(coalesce(cast(dropoff_latitude as STRING), '_dbt_utils_surrogate_key_null_') || '-' || coalesce(cast(dropoff_longitude as STRING), '_dbt_utils_surrogate_key_null_') as STRING))) as dropoff_location_id,
    dropoff_latitude AS dropoff_latitude,
    dropoff_longitude AS dropoff_longitude,
    ROW_NUMBER() OVER (ORDER BY dropoff_latitude, dropoff_longitude) as row_num
  FROM `uber-data-engineering-407103`.`uber`.`uber_tlc_trip_recrord_data`
)
SELECT
  dropoff_location_id,
  dropoff_latitude,
  dropoff_longitude
FROM numbered_rows
    );
  
[0m01:03:05.098197 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=uber-data-engineering-407103&j=bq:US:6e9d9068-3e72-4089-9960-707321d8f654&page=queryresults
[0m01:03:05.114127 [debug] [Thread-1 (]: Timing info for model.uber.dropoff_location_dim (execute): 01:02:59.364031 => 01:03:05.113316
[0m01:03:05.117083 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'bad62315-42fb-4621-9f46-a8f98c0e9f96', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffb24ac690>]}
[0m01:03:05.119620 [info ] [Thread-1 (]: 2 of 8 OK created sql table model uber.dropoff_location_dim .................... [[32mCREATE TABLE (100.0k rows, 1.5 MiB processed)[0m in 5.78s]
[0m01:03:05.122052 [debug] [Thread-1 (]: Finished running node model.uber.dropoff_location_dim
[0m01:03:05.123539 [debug] [Thread-1 (]: Began running node model.uber.passenger_count_dim
[0m01:03:05.125144 [info ] [Thread-1 (]: 3 of 8 START sql table model uber.passenger_count_dim .......................... [RUN]
[0m01:03:05.126568 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.uber.dropoff_location_dim, now model.uber.passenger_count_dim)
[0m01:03:05.127419 [debug] [Thread-1 (]: Began compiling node model.uber.passenger_count_dim
[0m01:03:05.134801 [debug] [Thread-1 (]: Writing injected SQL for node "model.uber.passenger_count_dim"
[0m01:03:05.137973 [debug] [Thread-1 (]: Timing info for model.uber.passenger_count_dim (compile): 01:03:05.128029 => 01:03:05.137697
[0m01:03:05.138551 [debug] [Thread-1 (]: Began executing node model.uber.passenger_count_dim
[0m01:03:05.141324 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m01:03:06.365836 [debug] [Thread-1 (]: Writing runtime sql for node "model.uber.passenger_count_dim"
[0m01:03:06.374563 [debug] [Thread-1 (]: On model.uber.passenger_count_dim: /* {"app": "dbt", "dbt_version": "1.5.9", "profile_name": "uber", "target_name": "dev", "node_id": "model.uber.passenger_count_dim"} */

  
    

    create or replace table `uber-data-engineering-407103`.`uber`.`passenger_count_dim`
    
    

    OPTIONS()
    as (
      SELECT DISTINCT
        GENERATE_UUID() as passenger_count_id,
		passenger_count AS passenger_count,
FROM `uber-data-engineering-407103`.`uber`.`uber_tlc_trip_recrord_data`
WHERE passenger_count IS NOT NULL
    );
  
[0m01:03:09.508577 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=uber-data-engineering-407103&j=bq:US:89bdff3c-0064-44d1-a718-0635403a7016&page=queryresults
[0m01:03:09.517115 [debug] [Thread-1 (]: Timing info for model.uber.passenger_count_dim (execute): 01:03:05.138958 => 01:03:09.516559
[0m01:03:09.519508 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'bad62315-42fb-4621-9f46-a8f98c0e9f96', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffb23475d0>]}
[0m01:03:09.521289 [info ] [Thread-1 (]: 3 of 8 OK created sql table model uber.passenger_count_dim ..................... [[32mCREATE TABLE (100.0k rows, 781.2 KiB processed)[0m in 4.39s]
[0m01:03:09.523268 [debug] [Thread-1 (]: Finished running node model.uber.passenger_count_dim
[0m01:03:09.525089 [debug] [Thread-1 (]: Began running node model.uber.payment_type_dim
[0m01:03:09.526586 [info ] [Thread-1 (]: 4 of 8 START sql table model uber.payment_type_dim ............................. [RUN]
[0m01:03:09.528028 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.uber.passenger_count_dim, now model.uber.payment_type_dim)
[0m01:03:09.528769 [debug] [Thread-1 (]: Began compiling node model.uber.payment_type_dim
[0m01:03:09.534104 [debug] [Thread-1 (]: Writing injected SQL for node "model.uber.payment_type_dim"
[0m01:03:09.536797 [debug] [Thread-1 (]: Timing info for model.uber.payment_type_dim (compile): 01:03:09.529311 => 01:03:09.536612
[0m01:03:09.537628 [debug] [Thread-1 (]: Began executing node model.uber.payment_type_dim
[0m01:03:09.540132 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m01:03:10.802237 [debug] [Thread-1 (]: Writing runtime sql for node "model.uber.payment_type_dim"
[0m01:03:10.808847 [debug] [Thread-1 (]: On model.uber.payment_type_dim: /* {"app": "dbt", "dbt_version": "1.5.9", "profile_name": "uber", "target_name": "dev", "node_id": "model.uber.payment_type_dim"} */

  
    

    create or replace table `uber-data-engineering-407103`.`uber`.`payment_type_dim`
    
    

    OPTIONS()
    as (
      WITH numbered_rows AS (
  SELECT
    GENERATE_UUID() as payment_type_id,
    payment_type AS payment_type,
    ROW_NUMBER() OVER (ORDER BY payment_type) as row_num
  FROM `uber-data-engineering-407103`.`uber`.`uber_tlc_trip_recrord_data`
  WHERE payment_type IS NOT NULL
)
SELECT
  payment_type_id,
  payment_type
FROM numbered_rows
    );
  
[0m01:03:16.939648 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=uber-data-engineering-407103&j=bq:US:05492100-d88b-4f83-8406-daa1183fc865&page=queryresults
[0m01:03:16.955578 [debug] [Thread-1 (]: Timing info for model.uber.payment_type_dim (execute): 01:03:09.538098 => 01:03:16.954618
[0m01:03:16.959365 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'bad62315-42fb-4621-9f46-a8f98c0e9f96', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffb2350550>]}
[0m01:03:16.962549 [info ] [Thread-1 (]: 4 of 8 OK created sql table model uber.payment_type_dim ........................ [[32mCREATE TABLE (100.0k rows, 781.2 KiB processed)[0m in 7.43s]
[0m01:03:16.964900 [debug] [Thread-1 (]: Finished running node model.uber.payment_type_dim
[0m01:03:16.966353 [debug] [Thread-1 (]: Began running node model.uber.pickup_location_dim
[0m01:03:16.968174 [info ] [Thread-1 (]: 5 of 8 START sql table model uber.pickup_location_dim .......................... [RUN]
[0m01:03:16.969700 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.uber.payment_type_dim, now model.uber.pickup_location_dim)
[0m01:03:16.970524 [debug] [Thread-1 (]: Began compiling node model.uber.pickup_location_dim
[0m01:03:16.985976 [debug] [Thread-1 (]: Writing injected SQL for node "model.uber.pickup_location_dim"
[0m01:03:16.988499 [debug] [Thread-1 (]: Timing info for model.uber.pickup_location_dim (compile): 01:03:16.970978 => 01:03:16.988275
[0m01:03:16.989028 [debug] [Thread-1 (]: Began executing node model.uber.pickup_location_dim
[0m01:03:16.991883 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m01:03:18.707562 [debug] [Thread-1 (]: Writing runtime sql for node "model.uber.pickup_location_dim"
[0m01:03:18.712695 [debug] [Thread-1 (]: On model.uber.pickup_location_dim: /* {"app": "dbt", "dbt_version": "1.5.9", "profile_name": "uber", "target_name": "dev", "node_id": "model.uber.pickup_location_dim"} */

  
    

    create or replace table `uber-data-engineering-407103`.`uber`.`pickup_location_dim`
    
    

    OPTIONS()
    as (
      WITH numbered_rows AS (
  SELECT
    to_hex(md5(cast(coalesce(cast(pickup_latitude as STRING), '_dbt_utils_surrogate_key_null_') || '-' || coalesce(cast(pickup_longitude as STRING), '_dbt_utils_surrogate_key_null_') as STRING))) as pickup_location_id,
    pickup_latitude AS pickup_latitude,
    pickup_longitude AS pickup_longitude,
    ROW_NUMBER() OVER (ORDER BY pickup_latitude, pickup_longitude) as row_num
  FROM `uber-data-engineering-407103`.`uber`.`uber_tlc_trip_recrord_data`
)
SELECT
  pickup_location_id,
  pickup_latitude,
  pickup_longitude
FROM numbered_rows
    );
  
[0m01:03:22.593515 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=uber-data-engineering-407103&j=bq:US:c9fa4a59-0009-4416-a1aa-eedc9633bbf7&page=queryresults
[0m01:03:22.606553 [debug] [Thread-1 (]: Timing info for model.uber.pickup_location_dim (execute): 01:03:16.989354 => 01:03:22.605800
[0m01:03:22.609378 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'bad62315-42fb-4621-9f46-a8f98c0e9f96', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffb2346e50>]}
[0m01:03:22.611503 [info ] [Thread-1 (]: 5 of 8 OK created sql table model uber.pickup_location_dim ..................... [[32mCREATE TABLE (100.0k rows, 1.5 MiB processed)[0m in 5.64s]
[0m01:03:22.613190 [debug] [Thread-1 (]: Finished running node model.uber.pickup_location_dim
[0m01:03:22.614293 [debug] [Thread-1 (]: Began running node model.uber.rate_code_dim
[0m01:03:22.615695 [info ] [Thread-1 (]: 6 of 8 START sql table model uber.rate_code_dim ................................ [RUN]
[0m01:03:22.616809 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.uber.pickup_location_dim, now model.uber.rate_code_dim)
[0m01:03:22.617503 [debug] [Thread-1 (]: Began compiling node model.uber.rate_code_dim
[0m01:03:22.659670 [debug] [Thread-1 (]: Writing injected SQL for node "model.uber.rate_code_dim"
[0m01:03:22.662408 [debug] [Thread-1 (]: Timing info for model.uber.rate_code_dim (compile): 01:03:22.617914 => 01:03:22.662089
[0m01:03:22.663109 [debug] [Thread-1 (]: Began executing node model.uber.rate_code_dim
[0m01:03:22.666429 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m01:03:24.026063 [debug] [Thread-1 (]: Writing runtime sql for node "model.uber.rate_code_dim"
[0m01:03:24.033446 [debug] [Thread-1 (]: On model.uber.rate_code_dim: /* {"app": "dbt", "dbt_version": "1.5.9", "profile_name": "uber", "target_name": "dev", "node_id": "model.uber.rate_code_dim"} */

  
    

    create or replace table `uber-data-engineering-407103`.`uber`.`rate_code_dim`
    
    

    OPTIONS()
    as (
      WITH numbered_rows AS (
  SELECT
    GENERATE_UUID() as rate_code_id,
    RatecodeID AS RatecodeID,
    ROW_NUMBER() OVER (ORDER BY RatecodeID) as row_num
  FROM `uber-data-engineering-407103`.`uber`.`uber_tlc_trip_recrord_data`
  WHERE RatecodeID IS NOT NULL
)
SELECT
  rate_code_id,
  RatecodeID
FROM numbered_rows
    );
  
[0m01:03:27.147984 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=uber-data-engineering-407103&j=bq:US:cd263954-ab3a-45a4-93a9-8174f1bea54a&page=queryresults
[0m01:03:27.168636 [debug] [Thread-1 (]: Timing info for model.uber.rate_code_dim (execute): 01:03:22.663622 => 01:03:27.166507
[0m01:03:27.173987 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'bad62315-42fb-4621-9f46-a8f98c0e9f96', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffb23acad0>]}
[0m01:03:27.177140 [info ] [Thread-1 (]: 6 of 8 OK created sql table model uber.rate_code_dim ........................... [[32mCREATE TABLE (100.0k rows, 781.2 KiB processed)[0m in 4.56s]
[0m01:03:27.179690 [debug] [Thread-1 (]: Finished running node model.uber.rate_code_dim
[0m01:03:27.181514 [debug] [Thread-1 (]: Began running node model.uber.trip_distance
[0m01:03:27.183594 [info ] [Thread-1 (]: 7 of 8 START sql table model uber.trip_distance ................................ [RUN]
[0m01:03:27.185105 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.uber.rate_code_dim, now model.uber.trip_distance)
[0m01:03:27.186067 [debug] [Thread-1 (]: Began compiling node model.uber.trip_distance
[0m01:03:27.195168 [debug] [Thread-1 (]: Writing injected SQL for node "model.uber.trip_distance"
[0m01:03:27.198002 [debug] [Thread-1 (]: Timing info for model.uber.trip_distance (compile): 01:03:27.186766 => 01:03:27.197764
[0m01:03:27.198654 [debug] [Thread-1 (]: Began executing node model.uber.trip_distance
[0m01:03:27.204940 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m01:03:29.021075 [debug] [Thread-1 (]: Writing runtime sql for node "model.uber.trip_distance"
[0m01:03:29.023965 [debug] [Thread-1 (]: On model.uber.trip_distance: /* {"app": "dbt", "dbt_version": "1.5.9", "profile_name": "uber", "target_name": "dev", "node_id": "model.uber.trip_distance"} */

  
    

    create or replace table `uber-data-engineering-407103`.`uber`.`trip_distance`
    
    

    OPTIONS()
    as (
      WITH numbered_rows AS (
  SELECT
    GENERATE_UUID() as trip_distance_id,
    trip_distance AS trip_distance,
    ROW_NUMBER() OVER (ORDER BY trip_distance) as row_num
  FROM `uber-data-engineering-407103`.`uber`.`uber_tlc_trip_recrord_data`
  WHERE trip_distance IS NOT NULL
)
SELECT
  trip_distance_id,
  trip_distance
FROM numbered_rows
    );
  
[0m01:03:31.704699 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=uber-data-engineering-407103&j=bq:US:f5275cd2-8f61-42ce-9272-95fdcb6a4245&page=queryresults
[0m01:03:31.714734 [debug] [Thread-1 (]: Timing info for model.uber.trip_distance (execute): 01:03:27.199068 => 01:03:31.714148
[0m01:03:31.717508 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'bad62315-42fb-4621-9f46-a8f98c0e9f96', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffb24a28d0>]}
[0m01:03:31.719528 [info ] [Thread-1 (]: 7 of 8 OK created sql table model uber.trip_distance ........................... [[32mCREATE TABLE (100.0k rows, 781.2 KiB processed)[0m in 4.53s]
[0m01:03:31.721710 [debug] [Thread-1 (]: Finished running node model.uber.trip_distance
[0m01:03:31.727037 [debug] [Thread-1 (]: Began running node model.uber.fact_trip
[0m01:03:31.728441 [info ] [Thread-1 (]: 8 of 8 START sql table model uber.fact_trip .................................... [RUN]
[0m01:03:31.730196 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.uber.trip_distance, now model.uber.fact_trip)
[0m01:03:31.731325 [debug] [Thread-1 (]: Began compiling node model.uber.fact_trip
[0m01:03:31.739703 [debug] [Thread-1 (]: Writing injected SQL for node "model.uber.fact_trip"
[0m01:03:31.743836 [debug] [Thread-1 (]: Timing info for model.uber.fact_trip (compile): 01:03:31.732069 => 01:03:31.743392
[0m01:03:31.745002 [debug] [Thread-1 (]: Began executing node model.uber.fact_trip
[0m01:03:31.750274 [debug] [Thread-1 (]: Writing runtime sql for node "model.uber.fact_trip"
[0m01:03:31.753951 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m01:03:31.761200 [debug] [Thread-1 (]: On model.uber.fact_trip: /* {"app": "dbt", "dbt_version": "1.5.9", "profile_name": "uber", "target_name": "dev", "node_id": "model.uber.fact_trip"} */

  
    

    create or replace table `uber-data-engineering-407103`.`uber`.`fact_trip`
    
    

    OPTIONS()
    as (
      WITH fct_invoices_cte AS (
    SELECT
        CAST(ROW_NUMBER() OVER () AS INT64) as trip_id,
        VendorID AS VendorID,
        passenger_count_id AS passenger_count_id,
        trip_distance_id AS trip_distance_id,
        rate_code_id AS rate_code_id,
        store_and_fwd_flag AS store_and_fwd_flag,
        pickup_location_id AS pickup_location_id,
        dropoff_location_id AS dropoff_location_id,
        payment_type_id AS payment_type_id,
        fare_amount AS fare_amount,
        extra AS extra,
        mta_tax AS mta_tax,
        tip_amount AS tip_amount,
        tolls_amount AS tolls_amount,
        improvement_surcharge AS improvement_surcharge,
        total_amount AS total_amount
    FROM `uber-data-engineering-407103`.`uber`.`uber_tlc_trip_recrord_data`
)
SELECT
    trip_id,
    VendorID,
    datetime_id,
    do.dropoff_location_id,
    pu.pickup_location_id,
    pc.passenger_count_id,
    pt.payment_type_id,
    rc.rate_code_id,
    store_and_fwd_flag,
    td.trip_distance_id,
    fare_amount,
    extra,
    mta_tax,
    tip_amount,
    tolls_amount,
    improvement_surcharge_amount,
    tolls_amount
FROM fct_invoices_cte fi
INNER JOIN `uber-data-engineering-407103`.`uber`.`datetime_dim` dt ON fi.datetime_id = dt.datetime_id
INNER JOIN `uber-data-engineering-407103`.`uber`.`dropoff_location_dim` do ON fi.dropoff_location_id = do.dropoff_location_id
INNER JOIN `uber-data-engineering-407103`.`uber`.`pickup_location_dim` pu ON fi.pickup_location_id = pu.pickup_location_id
INNER JOIN `uber-data-engineering-407103`.`uber`.`passenger_count_dim` pc ON fi.passenger_count_id = pc.passenger_count_id
INNER JOIN `uber-data-engineering-407103`.`uber`.`payment_type_dim` pt ON fi.payment_type_id = pt.payment_type_id
INNER JOIN `uber-data-engineering-407103`.`uber`.`rate_code_dim` rc ON fi.rate_code_id = rc.rate_code_id
INNER JOIN `uber-data-engineering-407103`.`uber`.`trip_distance` td ON fi.trip_distance_id = td.trip_distance_id
    );
  
[0m01:03:33.310537 [debug] [Thread-1 (]: BigQuery adapter: Retry attempt 1 of 1 after error: BadRequest('Unrecognized name: passenger_count_id; Did you mean passenger_count? at [16:9]')
[0m01:03:35.125924 [error] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=uber-data-engineering-407103&j=bq:US:6619e89f-2dcf-4d58-8ded-aac9050f05cc&page=queryresults
[0m01:03:35.134985 [debug] [Thread-1 (]: Timing info for model.uber.fact_trip (execute): 01:03:31.746031 => 01:03:35.133300
[0m01:03:35.157150 [debug] [Thread-1 (]: Database Error in model fact_trip (models/transform/fact_trip.sql)
  Unrecognized name: passenger_count_id; Did you mean passenger_count? at [16:9]
  compiled Code at target/run/uber/models/transform/fact_trip.sql
[0m01:03:35.159648 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'bad62315-42fb-4621-9f46-a8f98c0e9f96', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffb2231990>]}
[0m01:03:35.162484 [error] [Thread-1 (]: 8 of 8 ERROR creating sql table model uber.fact_trip ........................... [[31mERROR[0m in 3.43s]
[0m01:03:35.164790 [debug] [Thread-1 (]: Finished running node model.uber.fact_trip
[0m01:03:35.173469 [debug] [MainThread]: Connection 'master' was properly closed.
[0m01:03:35.174555 [debug] [MainThread]: Connection 'model.uber.fact_trip' was properly closed.
[0m01:03:35.175994 [info ] [MainThread]: 
[0m01:03:35.177562 [info ] [MainThread]: Finished running 8 table models in 0 hours 0 minutes and 59.45 seconds (59.45s).
[0m01:03:35.182857 [debug] [MainThread]: Command end result
[0m01:03:35.251817 [info ] [MainThread]: 
[0m01:03:35.253182 [info ] [MainThread]: [31mCompleted with 1 error and 0 warnings:[0m
[0m01:03:35.254315 [info ] [MainThread]: 
[0m01:03:35.255355 [error] [MainThread]: [33mDatabase Error in model fact_trip (models/transform/fact_trip.sql)[0m
[0m01:03:35.256371 [error] [MainThread]:   Unrecognized name: passenger_count_id; Did you mean passenger_count? at [16:9]
[0m01:03:35.257814 [error] [MainThread]:   compiled Code at target/run/uber/models/transform/fact_trip.sql
[0m01:03:35.262129 [info ] [MainThread]: 
[0m01:03:35.267037 [info ] [MainThread]: Done. PASS=7 WARN=0 ERROR=1 SKIP=0 TOTAL=8
[0m01:03:35.284792 [debug] [MainThread]: Command `dbt run` failed at 01:03:35.283665 after 60.21 seconds
[0m01:03:35.287886 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffb4834990>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffb485eb50>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffb8520b10>]}
[0m01:03:35.289869 [debug] [MainThread]: Flushing usage events
[0m01:04:38.132067 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff9c0722d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff9be05210>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff9c1e3190>]}


============================== 01:04:38.140138 | 976ef1f6-f5a8-40a4-82b5-681e25a99a8d ==============================
[0m01:04:38.140138 [info ] [MainThread]: Running with dbt=1.5.9
[0m01:04:38.141323 [debug] [MainThread]: running dbt with arguments {'log_path': '/usr/local/airflow/include/dbt/logs', 'version_check': 'True', 'cache_selected_only': 'False', 'log_cache_events': 'False', 'target_path': 'None', 'use_experimental_parser': 'False', 'static_parser': 'True', 'quiet': 'False', 'printer_width': '80', 'warn_error': 'None', 'log_format': 'default', 'debug': 'False', 'introspect': 'True', 'no_print': 'None', 'fail_fast': 'False', 'use_colors': 'True', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'write_json': 'True', 'partial_parse': 'True', 'send_anonymous_usage_stats': 'True', 'indirect_selection': 'eager', 'profiles_dir': '/usr/local/airflow/include/dbt/'}
[0m01:04:38.607746 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '976ef1f6-f5a8-40a4-82b5-681e25a99a8d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff99fd0f10>]}
[0m01:04:38.627644 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '976ef1f6-f5a8-40a4-82b5-681e25a99a8d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff99fd1290>]}
[0m01:04:38.629631 [info ] [MainThread]: Registered adapter: bigquery=1.5.3
[0m01:04:38.645706 [debug] [MainThread]: checksum: dd837546c89c9d03f3c2cb0ca6165266a30da6076d5d44e9991f7c5a8e5f5831, vars: {}, profile: , target: , version: 1.5.9
[0m01:04:38.730957 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m01:04:38.732001 [debug] [MainThread]: Partial parsing: updated file: uber://models/transform/fact_trip.sql
[0m01:04:38.754584 [debug] [MainThread]: 1699: static parser successfully parsed transform/fact_trip.sql
[0m01:04:38.774549 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '976ef1f6-f5a8-40a4-82b5-681e25a99a8d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff99e0ee10>]}
[0m01:04:38.788577 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '976ef1f6-f5a8-40a4-82b5-681e25a99a8d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff99ee1250>]}
[0m01:04:38.789200 [info ] [MainThread]: Found 8 models, 0 tests, 0 snapshots, 0 analyses, 474 macros, 0 operations, 0 seed files, 1 source, 0 exposures, 0 metrics, 0 groups
[0m01:04:38.789975 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '976ef1f6-f5a8-40a4-82b5-681e25a99a8d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff9eec3790>]}
[0m01:04:38.791547 [info ] [MainThread]: 
[0m01:04:38.792456 [debug] [MainThread]: Acquiring new bigquery connection 'master'
[0m01:04:38.794087 [debug] [ThreadPool]: Acquiring new bigquery connection 'list_uber-data-engineering-407103'
[0m01:04:38.794864 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m01:04:39.840398 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_uber-data-engineering-407103, now list_uber-data-engineering-407103_uber)
[0m01:04:39.843265 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m01:04:41.516642 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '976ef1f6-f5a8-40a4-82b5-681e25a99a8d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff99d33890>]}
[0m01:04:41.520504 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m01:04:41.522006 [info ] [MainThread]: 
[0m01:04:41.553842 [debug] [Thread-1 (]: Began running node model.uber.datetime_dim
[0m01:04:41.555835 [info ] [Thread-1 (]: 1 of 8 START sql table model uber.datetime_dim ................................. [RUN]
[0m01:04:41.557809 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_uber-data-engineering-407103_uber, now model.uber.datetime_dim)
[0m01:04:41.558620 [debug] [Thread-1 (]: Began compiling node model.uber.datetime_dim
[0m01:04:41.579629 [debug] [Thread-1 (]: Writing injected SQL for node "model.uber.datetime_dim"
[0m01:04:41.582359 [debug] [Thread-1 (]: Timing info for model.uber.datetime_dim (compile): 01:04:41.559303 => 01:04:41.582088
[0m01:04:41.583038 [debug] [Thread-1 (]: Began executing node model.uber.datetime_dim
[0m01:04:41.597329 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m01:04:42.609435 [debug] [Thread-1 (]: Writing runtime sql for node "model.uber.datetime_dim"
[0m01:04:42.613507 [debug] [Thread-1 (]: On model.uber.datetime_dim: /* {"app": "dbt", "dbt_version": "1.5.9", "profile_name": "uber", "target_name": "dev", "node_id": "model.uber.datetime_dim"} */

  
    

    create or replace table `uber-data-engineering-407103`.`uber`.`datetime_dim`
    
    

    OPTIONS()
    as (
      WITH datetime_cte AS (  
  SELECT DISTINCT 
    to_hex(md5(cast(coalesce(cast(tpep_pickup_datetime as STRING), '_dbt_utils_surrogate_key_null_') || '-' || coalesce(cast(tpep_dropoff_datetime as STRING), '_dbt_utils_surrogate_key_null_') as STRING))) AS datetime_id,
    CASE
      WHEN LENGTH(tpep_pickup_datetime) = 16 THEN
        -- Date format: "DD/MM/YYYY HH:MM"
        PARSE_DATETIME('%m/%d/%Y %H:%M', tpep_pickup_datetime)
      WHEN LENGTH(tpep_pickup_datetime) <= 14 THEN
        -- Date format: "MM/DD/YY HH:MM"
        PARSE_DATETIME('%m/%d/%y %H:%M', tpep_pickup_datetime)
      ELSE
        NULL
    END AS pick_date_part,
    tpep_dropoff_datetime AS drop_datetime_id,
    CASE
      WHEN LENGTH(tpep_dropoff_datetime) = 16 THEN
        -- Date format: "DD/MM/YYYY HH:MM"
        PARSE_DATETIME('%m/%d/%Y %H:%M', tpep_dropoff_datetime)
      WHEN LENGTH(tpep_dropoff_datetime) <= 14 THEN
        -- Date format: "MM/DD/YY HH:MM"
        PARSE_DATETIME('%m/%d/%y %H:%M', tpep_dropoff_datetime)
      ELSE
        NULL
    END AS drop_date_part
  FROM `uber-data-engineering-407103`.`uber`.`uber_tlc_trip_recrord_data`
  WHERE tpep_pickup_datetime IS NOT NULL
    AND tpep_dropoff_datetime IS NOT NULL
)
SELECT
  datetime_id,
  pick_date_part AS tpep_pickup_datetime,
  drop_date_part AS tpep_dropoff_datetime,
  EXTRACT(HOUR FROM pick_date_part) AS pick_hour,
  EXTRACT(DAY FROM pick_date_part) AS pick_day,
  EXTRACT(MONTH FROM pick_date_part) AS pick_month,
  EXTRACT(YEAR FROM pick_date_part) AS pick_year,
  EXTRACT(DAYOFWEEK FROM pick_date_part) AS pick_weekday,
  EXTRACT(HOUR FROM drop_date_part) AS drop_hour,
  EXTRACT(DAY FROM drop_date_part) AS drop_day,
  EXTRACT(MONTH FROM drop_date_part) AS drop_month,
  EXTRACT(YEAR FROM drop_date_part) AS drop_year,
  EXTRACT(DAYOFWEEK FROM drop_date_part) AS drop_weekday
FROM datetime_cte
    );
  
[0m01:04:45.698653 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=uber-data-engineering-407103&j=bq:US:b4a4eeb7-c26a-49a9-89c5-f8d9d8432291&page=queryresults
[0m01:04:45.746768 [debug] [Thread-1 (]: Timing info for model.uber.datetime_dim (execute): 01:04:41.583472 => 01:04:45.746385
[0m01:04:45.748652 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '976ef1f6-f5a8-40a4-82b5-681e25a99a8d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff99d0fd90>]}
[0m01:04:45.750296 [info ] [Thread-1 (]: 1 of 8 OK created sql table model uber.datetime_dim ............................ [[32mCREATE TABLE (99.9k rows, 4.0 MiB processed)[0m in 4.19s]
[0m01:04:45.751880 [debug] [Thread-1 (]: Finished running node model.uber.datetime_dim
[0m01:04:45.752803 [debug] [Thread-1 (]: Began running node model.uber.dropoff_location_dim
[0m01:04:45.753853 [info ] [Thread-1 (]: 2 of 8 START sql table model uber.dropoff_location_dim ......................... [RUN]
[0m01:04:45.755053 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.uber.datetime_dim, now model.uber.dropoff_location_dim)
[0m01:04:45.755804 [debug] [Thread-1 (]: Began compiling node model.uber.dropoff_location_dim
[0m01:04:45.761214 [debug] [Thread-1 (]: Writing injected SQL for node "model.uber.dropoff_location_dim"
[0m01:04:45.764869 [debug] [Thread-1 (]: Timing info for model.uber.dropoff_location_dim (compile): 01:04:45.756318 => 01:04:45.764682
[0m01:04:45.765364 [debug] [Thread-1 (]: Began executing node model.uber.dropoff_location_dim
[0m01:04:45.767697 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m01:04:46.753614 [debug] [Thread-1 (]: Writing runtime sql for node "model.uber.dropoff_location_dim"
[0m01:04:46.759235 [debug] [Thread-1 (]: On model.uber.dropoff_location_dim: /* {"app": "dbt", "dbt_version": "1.5.9", "profile_name": "uber", "target_name": "dev", "node_id": "model.uber.dropoff_location_dim"} */

  
    

    create or replace table `uber-data-engineering-407103`.`uber`.`dropoff_location_dim`
    
    

    OPTIONS()
    as (
      WITH numbered_rows AS (
  SELECT
    to_hex(md5(cast(coalesce(cast(dropoff_latitude as STRING), '_dbt_utils_surrogate_key_null_') || '-' || coalesce(cast(dropoff_longitude as STRING), '_dbt_utils_surrogate_key_null_') as STRING))) as dropoff_location_id,
    dropoff_latitude AS dropoff_latitude,
    dropoff_longitude AS dropoff_longitude,
    ROW_NUMBER() OVER (ORDER BY dropoff_latitude, dropoff_longitude) as row_num
  FROM `uber-data-engineering-407103`.`uber`.`uber_tlc_trip_recrord_data`
)
SELECT
  dropoff_location_id,
  dropoff_latitude,
  dropoff_longitude
FROM numbered_rows
    );
  
[0m01:04:50.940292 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=uber-data-engineering-407103&j=bq:US:6d349a46-bd48-4e74-9ed4-74ce7eb63560&page=queryresults
[0m01:04:50.950484 [debug] [Thread-1 (]: Timing info for model.uber.dropoff_location_dim (execute): 01:04:45.765778 => 01:04:50.949916
[0m01:04:50.953242 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '976ef1f6-f5a8-40a4-82b5-681e25a99a8d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff99e82110>]}
[0m01:04:50.955351 [info ] [Thread-1 (]: 2 of 8 OK created sql table model uber.dropoff_location_dim .................... [[32mCREATE TABLE (100.0k rows, 1.5 MiB processed)[0m in 5.20s]
[0m01:04:50.959202 [debug] [Thread-1 (]: Finished running node model.uber.dropoff_location_dim
[0m01:04:50.960952 [debug] [Thread-1 (]: Began running node model.uber.passenger_count_dim
[0m01:04:50.962060 [info ] [Thread-1 (]: 3 of 8 START sql table model uber.passenger_count_dim .......................... [RUN]
[0m01:04:50.963380 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.uber.dropoff_location_dim, now model.uber.passenger_count_dim)
[0m01:04:50.964197 [debug] [Thread-1 (]: Began compiling node model.uber.passenger_count_dim
[0m01:04:50.969392 [debug] [Thread-1 (]: Writing injected SQL for node "model.uber.passenger_count_dim"
[0m01:04:50.972564 [debug] [Thread-1 (]: Timing info for model.uber.passenger_count_dim (compile): 01:04:50.964934 => 01:04:50.972322
[0m01:04:50.973635 [debug] [Thread-1 (]: Began executing node model.uber.passenger_count_dim
[0m01:04:50.976606 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m01:04:51.738966 [debug] [Thread-1 (]: Writing runtime sql for node "model.uber.passenger_count_dim"
[0m01:04:51.744796 [debug] [Thread-1 (]: On model.uber.passenger_count_dim: /* {"app": "dbt", "dbt_version": "1.5.9", "profile_name": "uber", "target_name": "dev", "node_id": "model.uber.passenger_count_dim"} */

  
    

    create or replace table `uber-data-engineering-407103`.`uber`.`passenger_count_dim`
    
    

    OPTIONS()
    as (
      SELECT DISTINCT
        GENERATE_UUID() as passenger_count_id,
		passenger_count AS passenger_count,
FROM `uber-data-engineering-407103`.`uber`.`uber_tlc_trip_recrord_data`
WHERE passenger_count IS NOT NULL
    );
  
[0m01:04:55.447687 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=uber-data-engineering-407103&j=bq:US:856454d2-0976-415a-a8e3-06339ce95894&page=queryresults
[0m01:04:55.455373 [debug] [Thread-1 (]: Timing info for model.uber.passenger_count_dim (execute): 01:04:50.974219 => 01:04:55.454919
[0m01:04:55.457274 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '976ef1f6-f5a8-40a4-82b5-681e25a99a8d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff99e21150>]}
[0m01:04:55.458921 [info ] [Thread-1 (]: 3 of 8 OK created sql table model uber.passenger_count_dim ..................... [[32mCREATE TABLE (100.0k rows, 781.2 KiB processed)[0m in 4.49s]
[0m01:04:55.460371 [debug] [Thread-1 (]: Finished running node model.uber.passenger_count_dim
[0m01:04:55.461392 [debug] [Thread-1 (]: Began running node model.uber.payment_type_dim
[0m01:04:55.462654 [info ] [Thread-1 (]: 4 of 8 START sql table model uber.payment_type_dim ............................. [RUN]
[0m01:04:55.463859 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.uber.passenger_count_dim, now model.uber.payment_type_dim)
[0m01:04:55.464799 [debug] [Thread-1 (]: Began compiling node model.uber.payment_type_dim
[0m01:04:55.473487 [debug] [Thread-1 (]: Writing injected SQL for node "model.uber.payment_type_dim"
[0m01:04:55.476493 [debug] [Thread-1 (]: Timing info for model.uber.payment_type_dim (compile): 01:04:55.465295 => 01:04:55.476330
[0m01:04:55.477041 [debug] [Thread-1 (]: Began executing node model.uber.payment_type_dim
[0m01:04:55.479606 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m01:04:56.475202 [debug] [Thread-1 (]: Writing runtime sql for node "model.uber.payment_type_dim"
[0m01:04:56.482628 [debug] [Thread-1 (]: On model.uber.payment_type_dim: /* {"app": "dbt", "dbt_version": "1.5.9", "profile_name": "uber", "target_name": "dev", "node_id": "model.uber.payment_type_dim"} */

  
    

    create or replace table `uber-data-engineering-407103`.`uber`.`payment_type_dim`
    
    

    OPTIONS()
    as (
      WITH numbered_rows AS (
  SELECT
    GENERATE_UUID() as payment_type_id,
    payment_type AS payment_type,
    ROW_NUMBER() OVER (ORDER BY payment_type) as row_num
  FROM `uber-data-engineering-407103`.`uber`.`uber_tlc_trip_recrord_data`
  WHERE payment_type IS NOT NULL
)
SELECT
  payment_type_id,
  payment_type
FROM numbered_rows
    );
  
[0m01:05:00.899274 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=uber-data-engineering-407103&j=bq:US:2f883126-b20d-4fcb-a13e-72acf3aca6cb&page=queryresults
[0m01:05:00.917506 [debug] [Thread-1 (]: Timing info for model.uber.payment_type_dim (execute): 01:04:55.477454 => 01:05:00.916603
[0m01:05:00.921630 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '976ef1f6-f5a8-40a4-82b5-681e25a99a8d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff99ddce50>]}
[0m01:05:00.923924 [info ] [Thread-1 (]: 4 of 8 OK created sql table model uber.payment_type_dim ........................ [[32mCREATE TABLE (100.0k rows, 781.2 KiB processed)[0m in 5.46s]
[0m01:05:00.926891 [debug] [Thread-1 (]: Finished running node model.uber.payment_type_dim
[0m01:05:00.928244 [debug] [Thread-1 (]: Began running node model.uber.pickup_location_dim
[0m01:05:00.929646 [info ] [Thread-1 (]: 5 of 8 START sql table model uber.pickup_location_dim .......................... [RUN]
[0m01:05:00.931937 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.uber.payment_type_dim, now model.uber.pickup_location_dim)
[0m01:05:00.933570 [debug] [Thread-1 (]: Began compiling node model.uber.pickup_location_dim
[0m01:05:00.955526 [debug] [Thread-1 (]: Writing injected SQL for node "model.uber.pickup_location_dim"
[0m01:05:00.958462 [debug] [Thread-1 (]: Timing info for model.uber.pickup_location_dim (compile): 01:05:00.934415 => 01:05:00.958250
[0m01:05:00.959104 [debug] [Thread-1 (]: Began executing node model.uber.pickup_location_dim
[0m01:05:00.962542 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m01:05:02.017661 [debug] [Thread-1 (]: Writing runtime sql for node "model.uber.pickup_location_dim"
[0m01:05:02.024617 [debug] [Thread-1 (]: On model.uber.pickup_location_dim: /* {"app": "dbt", "dbt_version": "1.5.9", "profile_name": "uber", "target_name": "dev", "node_id": "model.uber.pickup_location_dim"} */

  
    

    create or replace table `uber-data-engineering-407103`.`uber`.`pickup_location_dim`
    
    

    OPTIONS()
    as (
      WITH numbered_rows AS (
  SELECT
    to_hex(md5(cast(coalesce(cast(pickup_latitude as STRING), '_dbt_utils_surrogate_key_null_') || '-' || coalesce(cast(pickup_longitude as STRING), '_dbt_utils_surrogate_key_null_') as STRING))) as pickup_location_id,
    pickup_latitude AS pickup_latitude,
    pickup_longitude AS pickup_longitude,
    ROW_NUMBER() OVER (ORDER BY pickup_latitude, pickup_longitude) as row_num
  FROM `uber-data-engineering-407103`.`uber`.`uber_tlc_trip_recrord_data`
)
SELECT
  pickup_location_id,
  pickup_latitude,
  pickup_longitude
FROM numbered_rows
    );
  
[0m01:05:06.144620 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=uber-data-engineering-407103&j=bq:US:2191bd27-338c-48b3-a7c5-76a115728c27&page=queryresults
[0m01:05:06.155229 [debug] [Thread-1 (]: Timing info for model.uber.pickup_location_dim (execute): 01:05:00.959587 => 01:05:06.154638
[0m01:05:06.157723 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '976ef1f6-f5a8-40a4-82b5-681e25a99a8d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff99d0c110>]}
[0m01:05:06.159693 [info ] [Thread-1 (]: 5 of 8 OK created sql table model uber.pickup_location_dim ..................... [[32mCREATE TABLE (100.0k rows, 1.5 MiB processed)[0m in 5.23s]
[0m01:05:06.161699 [debug] [Thread-1 (]: Finished running node model.uber.pickup_location_dim
[0m01:05:06.163041 [debug] [Thread-1 (]: Began running node model.uber.rate_code_dim
[0m01:05:06.174955 [info ] [Thread-1 (]: 6 of 8 START sql table model uber.rate_code_dim ................................ [RUN]
[0m01:05:06.176851 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.uber.pickup_location_dim, now model.uber.rate_code_dim)
[0m01:05:06.177597 [debug] [Thread-1 (]: Began compiling node model.uber.rate_code_dim
[0m01:05:06.202580 [debug] [Thread-1 (]: Writing injected SQL for node "model.uber.rate_code_dim"
[0m01:05:06.206867 [debug] [Thread-1 (]: Timing info for model.uber.rate_code_dim (compile): 01:05:06.178125 => 01:05:06.206365
[0m01:05:06.207873 [debug] [Thread-1 (]: Began executing node model.uber.rate_code_dim
[0m01:05:06.213469 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m01:05:07.549002 [debug] [Thread-1 (]: Writing runtime sql for node "model.uber.rate_code_dim"
[0m01:05:07.556685 [debug] [Thread-1 (]: On model.uber.rate_code_dim: /* {"app": "dbt", "dbt_version": "1.5.9", "profile_name": "uber", "target_name": "dev", "node_id": "model.uber.rate_code_dim"} */

  
    

    create or replace table `uber-data-engineering-407103`.`uber`.`rate_code_dim`
    
    

    OPTIONS()
    as (
      WITH numbered_rows AS (
  SELECT
    GENERATE_UUID() as rate_code_id,
    RatecodeID AS RatecodeID,
    ROW_NUMBER() OVER (ORDER BY RatecodeID) as row_num
  FROM `uber-data-engineering-407103`.`uber`.`uber_tlc_trip_recrord_data`
  WHERE RatecodeID IS NOT NULL
)
SELECT
  rate_code_id,
  RatecodeID
FROM numbered_rows
    );
  
[0m01:05:10.490702 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=uber-data-engineering-407103&j=bq:US:e8a02a56-2c83-4d56-945e-d752ac6b7635&page=queryresults
[0m01:05:10.503333 [debug] [Thread-1 (]: Timing info for model.uber.rate_code_dim (execute): 01:05:06.208908 => 01:05:10.502717
[0m01:05:10.506079 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '976ef1f6-f5a8-40a4-82b5-681e25a99a8d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff98c81010>]}
[0m01:05:10.508067 [info ] [Thread-1 (]: 6 of 8 OK created sql table model uber.rate_code_dim ........................... [[32mCREATE TABLE (100.0k rows, 781.2 KiB processed)[0m in 4.33s]
[0m01:05:10.509818 [debug] [Thread-1 (]: Finished running node model.uber.rate_code_dim
[0m01:05:10.511449 [debug] [Thread-1 (]: Began running node model.uber.trip_distance
[0m01:05:10.512922 [info ] [Thread-1 (]: 7 of 8 START sql table model uber.trip_distance ................................ [RUN]
[0m01:05:10.514159 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.uber.rate_code_dim, now model.uber.trip_distance)
[0m01:05:10.514843 [debug] [Thread-1 (]: Began compiling node model.uber.trip_distance
[0m01:05:10.522694 [debug] [Thread-1 (]: Writing injected SQL for node "model.uber.trip_distance"
[0m01:05:10.526248 [debug] [Thread-1 (]: Timing info for model.uber.trip_distance (compile): 01:05:10.515355 => 01:05:10.526067
[0m01:05:10.527076 [debug] [Thread-1 (]: Began executing node model.uber.trip_distance
[0m01:05:10.529889 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m01:05:11.998095 [debug] [Thread-1 (]: Writing runtime sql for node "model.uber.trip_distance"
[0m01:05:12.004558 [debug] [Thread-1 (]: On model.uber.trip_distance: /* {"app": "dbt", "dbt_version": "1.5.9", "profile_name": "uber", "target_name": "dev", "node_id": "model.uber.trip_distance"} */

  
    

    create or replace table `uber-data-engineering-407103`.`uber`.`trip_distance`
    
    

    OPTIONS()
    as (
      WITH numbered_rows AS (
  SELECT
    GENERATE_UUID() as trip_distance_id,
    trip_distance AS trip_distance,
    ROW_NUMBER() OVER (ORDER BY trip_distance) as row_num
  FROM `uber-data-engineering-407103`.`uber`.`uber_tlc_trip_recrord_data`
  WHERE trip_distance IS NOT NULL
)
SELECT
  trip_distance_id,
  trip_distance
FROM numbered_rows
    );
  
[0m01:05:14.739549 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=uber-data-engineering-407103&j=bq:US:c45b04cc-e497-4d1c-9809-45ade96fedc6&page=queryresults
[0m01:05:14.748429 [debug] [Thread-1 (]: Timing info for model.uber.trip_distance (execute): 01:05:10.527515 => 01:05:14.748062
[0m01:05:14.750426 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '976ef1f6-f5a8-40a4-82b5-681e25a99a8d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff9c03bb90>]}
[0m01:05:14.751898 [info ] [Thread-1 (]: 7 of 8 OK created sql table model uber.trip_distance ........................... [[32mCREATE TABLE (100.0k rows, 781.2 KiB processed)[0m in 4.24s]
[0m01:05:14.753545 [debug] [Thread-1 (]: Finished running node model.uber.trip_distance
[0m01:05:14.756354 [debug] [Thread-1 (]: Began running node model.uber.fact_trip
[0m01:05:14.757104 [info ] [Thread-1 (]: 8 of 8 START sql table model uber.fact_trip .................................... [RUN]
[0m01:05:14.758370 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.uber.trip_distance, now model.uber.fact_trip)
[0m01:05:14.758974 [debug] [Thread-1 (]: Began compiling node model.uber.fact_trip
[0m01:05:14.768434 [debug] [Thread-1 (]: Writing injected SQL for node "model.uber.fact_trip"
[0m01:05:14.770987 [debug] [Thread-1 (]: Timing info for model.uber.fact_trip (compile): 01:05:14.759545 => 01:05:14.770814
[0m01:05:14.771522 [debug] [Thread-1 (]: Began executing node model.uber.fact_trip
[0m01:05:14.774690 [debug] [Thread-1 (]: Writing runtime sql for node "model.uber.fact_trip"
[0m01:05:14.776235 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m01:05:14.779031 [debug] [Thread-1 (]: On model.uber.fact_trip: /* {"app": "dbt", "dbt_version": "1.5.9", "profile_name": "uber", "target_name": "dev", "node_id": "model.uber.fact_trip"} */

  
    

    create or replace table `uber-data-engineering-407103`.`uber`.`fact_trip`
    
    

    OPTIONS()
    as (
      WITH fct_invoices_cte AS (
    SELECT
        CAST(ROW_NUMBER() OVER () AS INT64) as trip_id,
        VendorID AS VendorID,
        trip_distance_id AS trip_distance_id,
        rate_code_id AS rate_code_id,
        store_and_fwd_flag AS store_and_fwd_flag,
        pickup_location_id AS pickup_location_id,
        dropoff_location_id AS dropoff_location_id,
        payment_type_id AS payment_type_id,
        fare_amount AS fare_amount,
        extra AS extra,
        mta_tax AS mta_tax,
        tip_amount AS tip_amount,
        tolls_amount AS tolls_amount,
        improvement_surcharge AS improvement_surcharge,
        total_amount AS total_amount
    FROM `uber-data-engineering-407103`.`uber`.`uber_tlc_trip_recrord_data`
)
SELECT
    trip_id,
    VendorID,
    datetime_id,
    do.dropoff_location_id,
    pu.pickup_location_id,
    pc.passenger_count_id,
    pt.payment_type_id,
    rc.rate_code_id,
    store_and_fwd_flag,
    td.trip_distance_id,
    fare_amount,
    extra,
    mta_tax,
    tip_amount,
    tolls_amount,
    improvement_surcharge_amount,
    tolls_amount
FROM fct_invoices_cte fi
INNER JOIN `uber-data-engineering-407103`.`uber`.`datetime_dim` dt ON fi.datetime_id = dt.datetime_id
INNER JOIN `uber-data-engineering-407103`.`uber`.`dropoff_location_dim` do ON fi.dropoff_location_id = do.dropoff_location_id
INNER JOIN `uber-data-engineering-407103`.`uber`.`pickup_location_dim` pu ON fi.pickup_location_id = pu.pickup_location_id
INNER JOIN `uber-data-engineering-407103`.`uber`.`passenger_count_dim` pc ON fi.passenger_count_id = pc.passenger_count_id
INNER JOIN `uber-data-engineering-407103`.`uber`.`payment_type_dim` pt ON fi.payment_type_id = pt.payment_type_id
INNER JOIN `uber-data-engineering-407103`.`uber`.`rate_code_dim` rc ON fi.rate_code_id = rc.rate_code_id
INNER JOIN `uber-data-engineering-407103`.`uber`.`trip_distance` td ON fi.trip_distance_id = td.trip_distance_id
    );
  
[0m01:05:16.199038 [debug] [Thread-1 (]: BigQuery adapter: Retry attempt 1 of 1 after error: BadRequest('Unrecognized name: trip_distance_id; Did you mean trip_distance? at [16:9]')
[0m01:05:18.799436 [error] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=uber-data-engineering-407103&j=bq:US:cd87934b-8bdf-40c4-8c9a-a43c5c8a191e&page=queryresults
[0m01:05:18.801559 [debug] [Thread-1 (]: Timing info for model.uber.fact_trip (execute): 01:05:14.771954 => 01:05:18.801303
[0m01:05:18.811204 [debug] [Thread-1 (]: Database Error in model fact_trip (models/transform/fact_trip.sql)
  Unrecognized name: trip_distance_id; Did you mean trip_distance? at [16:9]
  compiled Code at target/run/uber/models/transform/fact_trip.sql
[0m01:05:18.811985 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '976ef1f6-f5a8-40a4-82b5-681e25a99a8d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff98c469d0>]}
[0m01:05:18.812754 [error] [Thread-1 (]: 8 of 8 ERROR creating sql table model uber.fact_trip ........................... [[31mERROR[0m in 4.05s]
[0m01:05:18.813478 [debug] [Thread-1 (]: Finished running node model.uber.fact_trip
[0m01:05:18.816341 [debug] [MainThread]: Connection 'master' was properly closed.
[0m01:05:18.816846 [debug] [MainThread]: Connection 'model.uber.fact_trip' was properly closed.
[0m01:05:18.817490 [info ] [MainThread]: 
[0m01:05:18.818145 [info ] [MainThread]: Finished running 8 table models in 0 hours 0 minutes and 40.03 seconds (40.03s).
[0m01:05:18.820444 [debug] [MainThread]: Command end result
[0m01:05:18.850107 [info ] [MainThread]: 
[0m01:05:18.852531 [info ] [MainThread]: [31mCompleted with 1 error and 0 warnings:[0m
[0m01:05:18.853478 [info ] [MainThread]: 
[0m01:05:18.854714 [error] [MainThread]: [33mDatabase Error in model fact_trip (models/transform/fact_trip.sql)[0m
[0m01:05:18.856133 [error] [MainThread]:   Unrecognized name: trip_distance_id; Did you mean trip_distance? at [16:9]
[0m01:05:18.860052 [error] [MainThread]:   compiled Code at target/run/uber/models/transform/fact_trip.sql
[0m01:05:18.862399 [info ] [MainThread]: 
[0m01:05:18.864247 [info ] [MainThread]: Done. PASS=7 WARN=0 ERROR=1 SKIP=0 TOTAL=8
[0m01:05:18.867010 [debug] [MainThread]: Command `dbt run` failed at 01:05:18.866641 after 40.76 seconds
[0m01:05:18.869136 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff9c30f950>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff9c1f0c90>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff9bbabfd0>]}
[0m01:05:18.870227 [debug] [MainThread]: Flushing usage events
[0m01:05:45.588568 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff869f8610>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff869f8990>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff869c3590>]}


============================== 01:05:45.594191 | be7397cd-8571-4b87-aa32-ddef96720097 ==============================
[0m01:05:45.594191 [info ] [MainThread]: Running with dbt=1.5.9
[0m01:05:45.595084 [debug] [MainThread]: running dbt with arguments {'write_json': 'True', 'partial_parse': 'True', 'printer_width': '80', 'log_cache_events': 'False', 'use_colors': 'True', 'profiles_dir': '/usr/local/airflow/include/dbt/', 'static_parser': 'True', 'fail_fast': 'False', 'debug': 'False', 'use_experimental_parser': 'False', 'log_format': 'default', 'no_print': 'None', 'indirect_selection': 'eager', 'quiet': 'False', 'version_check': 'True', 'log_path': '/usr/local/airflow/include/dbt/logs', 'warn_error': 'None', 'introspect': 'True', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'send_anonymous_usage_stats': 'True', 'target_path': 'None', 'cache_selected_only': 'False'}
[0m01:05:46.019825 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'be7397cd-8571-4b87-aa32-ddef96720097', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff84964790>]}
[0m01:05:46.031531 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'be7397cd-8571-4b87-aa32-ddef96720097', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff86cf8c10>]}
[0m01:05:46.032401 [info ] [MainThread]: Registered adapter: bigquery=1.5.3
[0m01:05:46.047395 [debug] [MainThread]: checksum: dd837546c89c9d03f3c2cb0ca6165266a30da6076d5d44e9991f7c5a8e5f5831, vars: {}, profile: , target: , version: 1.5.9
[0m01:05:46.110669 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m01:05:46.111446 [debug] [MainThread]: Partial parsing: updated file: uber://models/transform/fact_trip.sql
[0m01:05:46.130592 [debug] [MainThread]: 1699: static parser successfully parsed transform/fact_trip.sql
[0m01:05:46.157413 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'be7397cd-8571-4b87-aa32-ddef96720097', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff84768710>]}
[0m01:05:46.179524 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'be7397cd-8571-4b87-aa32-ddef96720097', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff84959490>]}
[0m01:05:46.180567 [info ] [MainThread]: Found 8 models, 0 tests, 0 snapshots, 0 analyses, 474 macros, 0 operations, 0 seed files, 1 source, 0 exposures, 0 metrics, 0 groups
[0m01:05:46.183606 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'be7397cd-8571-4b87-aa32-ddef96720097', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff8984f790>]}
[0m01:05:46.209526 [info ] [MainThread]: 
[0m01:05:46.212113 [debug] [MainThread]: Acquiring new bigquery connection 'master'
[0m01:05:46.223514 [debug] [ThreadPool]: Acquiring new bigquery connection 'list_uber-data-engineering-407103'
[0m01:05:46.224424 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m01:05:47.208741 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_uber-data-engineering-407103, now list_uber-data-engineering-407103_uber)
[0m01:05:47.211911 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m01:05:48.367172 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'be7397cd-8571-4b87-aa32-ddef96720097', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff848447d0>]}
[0m01:05:48.368747 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m01:05:48.369558 [info ] [MainThread]: 
[0m01:05:48.386146 [debug] [Thread-1 (]: Began running node model.uber.datetime_dim
[0m01:05:48.387060 [info ] [Thread-1 (]: 1 of 8 START sql table model uber.datetime_dim ................................. [RUN]
[0m01:05:48.388055 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_uber-data-engineering-407103_uber, now model.uber.datetime_dim)
[0m01:05:48.388624 [debug] [Thread-1 (]: Began compiling node model.uber.datetime_dim
[0m01:05:48.406835 [debug] [Thread-1 (]: Writing injected SQL for node "model.uber.datetime_dim"
[0m01:05:48.409340 [debug] [Thread-1 (]: Timing info for model.uber.datetime_dim (compile): 01:05:48.389048 => 01:05:48.409110
[0m01:05:48.409935 [debug] [Thread-1 (]: Began executing node model.uber.datetime_dim
[0m01:05:48.424915 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m01:05:49.303772 [debug] [Thread-1 (]: Writing runtime sql for node "model.uber.datetime_dim"
[0m01:05:49.307212 [debug] [Thread-1 (]: On model.uber.datetime_dim: /* {"app": "dbt", "dbt_version": "1.5.9", "profile_name": "uber", "target_name": "dev", "node_id": "model.uber.datetime_dim"} */

  
    

    create or replace table `uber-data-engineering-407103`.`uber`.`datetime_dim`
    
    

    OPTIONS()
    as (
      WITH datetime_cte AS (  
  SELECT DISTINCT 
    to_hex(md5(cast(coalesce(cast(tpep_pickup_datetime as STRING), '_dbt_utils_surrogate_key_null_') || '-' || coalesce(cast(tpep_dropoff_datetime as STRING), '_dbt_utils_surrogate_key_null_') as STRING))) AS datetime_id,
    CASE
      WHEN LENGTH(tpep_pickup_datetime) = 16 THEN
        -- Date format: "DD/MM/YYYY HH:MM"
        PARSE_DATETIME('%m/%d/%Y %H:%M', tpep_pickup_datetime)
      WHEN LENGTH(tpep_pickup_datetime) <= 14 THEN
        -- Date format: "MM/DD/YY HH:MM"
        PARSE_DATETIME('%m/%d/%y %H:%M', tpep_pickup_datetime)
      ELSE
        NULL
    END AS pick_date_part,
    tpep_dropoff_datetime AS drop_datetime_id,
    CASE
      WHEN LENGTH(tpep_dropoff_datetime) = 16 THEN
        -- Date format: "DD/MM/YYYY HH:MM"
        PARSE_DATETIME('%m/%d/%Y %H:%M', tpep_dropoff_datetime)
      WHEN LENGTH(tpep_dropoff_datetime) <= 14 THEN
        -- Date format: "MM/DD/YY HH:MM"
        PARSE_DATETIME('%m/%d/%y %H:%M', tpep_dropoff_datetime)
      ELSE
        NULL
    END AS drop_date_part
  FROM `uber-data-engineering-407103`.`uber`.`uber_tlc_trip_recrord_data`
  WHERE tpep_pickup_datetime IS NOT NULL
    AND tpep_dropoff_datetime IS NOT NULL
)
SELECT
  datetime_id,
  pick_date_part AS tpep_pickup_datetime,
  drop_date_part AS tpep_dropoff_datetime,
  EXTRACT(HOUR FROM pick_date_part) AS pick_hour,
  EXTRACT(DAY FROM pick_date_part) AS pick_day,
  EXTRACT(MONTH FROM pick_date_part) AS pick_month,
  EXTRACT(YEAR FROM pick_date_part) AS pick_year,
  EXTRACT(DAYOFWEEK FROM pick_date_part) AS pick_weekday,
  EXTRACT(HOUR FROM drop_date_part) AS drop_hour,
  EXTRACT(DAY FROM drop_date_part) AS drop_day,
  EXTRACT(MONTH FROM drop_date_part) AS drop_month,
  EXTRACT(YEAR FROM drop_date_part) AS drop_year,
  EXTRACT(DAYOFWEEK FROM drop_date_part) AS drop_weekday
FROM datetime_cte
    );
  
[0m01:05:52.494500 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=uber-data-engineering-407103&j=bq:US:5d37cf80-2383-4143-b641-5f72f6bc0b24&page=queryresults
[0m01:05:52.523666 [debug] [Thread-1 (]: Timing info for model.uber.datetime_dim (execute): 01:05:48.410369 => 01:05:52.523391
[0m01:05:52.525200 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'be7397cd-8571-4b87-aa32-ddef96720097', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff847429d0>]}
[0m01:05:52.526534 [info ] [Thread-1 (]: 1 of 8 OK created sql table model uber.datetime_dim ............................ [[32mCREATE TABLE (99.9k rows, 4.0 MiB processed)[0m in 4.14s]
[0m01:05:52.527884 [debug] [Thread-1 (]: Finished running node model.uber.datetime_dim
[0m01:05:52.528636 [debug] [Thread-1 (]: Began running node model.uber.dropoff_location_dim
[0m01:05:52.529553 [info ] [Thread-1 (]: 2 of 8 START sql table model uber.dropoff_location_dim ......................... [RUN]
[0m01:05:52.530575 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.uber.datetime_dim, now model.uber.dropoff_location_dim)
[0m01:05:52.531081 [debug] [Thread-1 (]: Began compiling node model.uber.dropoff_location_dim
[0m01:05:52.536674 [debug] [Thread-1 (]: Writing injected SQL for node "model.uber.dropoff_location_dim"
[0m01:05:52.539679 [debug] [Thread-1 (]: Timing info for model.uber.dropoff_location_dim (compile): 01:05:52.531470 => 01:05:52.539514
[0m01:05:52.540160 [debug] [Thread-1 (]: Began executing node model.uber.dropoff_location_dim
[0m01:05:52.542563 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m01:05:54.048001 [debug] [Thread-1 (]: Writing runtime sql for node "model.uber.dropoff_location_dim"
[0m01:05:54.054743 [debug] [Thread-1 (]: On model.uber.dropoff_location_dim: /* {"app": "dbt", "dbt_version": "1.5.9", "profile_name": "uber", "target_name": "dev", "node_id": "model.uber.dropoff_location_dim"} */

  
    

    create or replace table `uber-data-engineering-407103`.`uber`.`dropoff_location_dim`
    
    

    OPTIONS()
    as (
      WITH numbered_rows AS (
  SELECT
    to_hex(md5(cast(coalesce(cast(dropoff_latitude as STRING), '_dbt_utils_surrogate_key_null_') || '-' || coalesce(cast(dropoff_longitude as STRING), '_dbt_utils_surrogate_key_null_') as STRING))) as dropoff_location_id,
    dropoff_latitude AS dropoff_latitude,
    dropoff_longitude AS dropoff_longitude,
    ROW_NUMBER() OVER (ORDER BY dropoff_latitude, dropoff_longitude) as row_num
  FROM `uber-data-engineering-407103`.`uber`.`uber_tlc_trip_recrord_data`
)
SELECT
  dropoff_location_id,
  dropoff_latitude,
  dropoff_longitude
FROM numbered_rows
    );
  
[0m01:05:58.300534 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=uber-data-engineering-407103&j=bq:US:93788d96-2915-43fb-87c6-6b471a9983c6&page=queryresults
[0m01:05:58.316231 [debug] [Thread-1 (]: Timing info for model.uber.dropoff_location_dim (execute): 01:05:52.540581 => 01:05:58.315576
[0m01:05:58.319051 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'be7397cd-8571-4b87-aa32-ddef96720097', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff84743a50>]}
[0m01:05:58.321243 [info ] [Thread-1 (]: 2 of 8 OK created sql table model uber.dropoff_location_dim .................... [[32mCREATE TABLE (100.0k rows, 1.5 MiB processed)[0m in 5.79s]
[0m01:05:58.323157 [debug] [Thread-1 (]: Finished running node model.uber.dropoff_location_dim
[0m01:05:58.324455 [debug] [Thread-1 (]: Began running node model.uber.passenger_count_dim
[0m01:05:58.326010 [info ] [Thread-1 (]: 3 of 8 START sql table model uber.passenger_count_dim .......................... [RUN]
[0m01:05:58.327376 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.uber.dropoff_location_dim, now model.uber.passenger_count_dim)
[0m01:05:58.328054 [debug] [Thread-1 (]: Began compiling node model.uber.passenger_count_dim
[0m01:05:58.336295 [debug] [Thread-1 (]: Writing injected SQL for node "model.uber.passenger_count_dim"
[0m01:05:58.339375 [debug] [Thread-1 (]: Timing info for model.uber.passenger_count_dim (compile): 01:05:58.328488 => 01:05:58.339044
[0m01:05:58.341250 [debug] [Thread-1 (]: Began executing node model.uber.passenger_count_dim
[0m01:05:58.347959 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m01:06:00.163951 [debug] [Thread-1 (]: Writing runtime sql for node "model.uber.passenger_count_dim"
[0m01:06:00.171471 [debug] [Thread-1 (]: On model.uber.passenger_count_dim: /* {"app": "dbt", "dbt_version": "1.5.9", "profile_name": "uber", "target_name": "dev", "node_id": "model.uber.passenger_count_dim"} */

  
    

    create or replace table `uber-data-engineering-407103`.`uber`.`passenger_count_dim`
    
    

    OPTIONS()
    as (
      SELECT DISTINCT
        GENERATE_UUID() as passenger_count_id,
		passenger_count AS passenger_count,
FROM `uber-data-engineering-407103`.`uber`.`uber_tlc_trip_recrord_data`
WHERE passenger_count IS NOT NULL
    );
  
[0m01:06:03.970737 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=uber-data-engineering-407103&j=bq:US:74087f6f-6210-4017-bdb7-e6d2d2a8702d&page=queryresults
[0m01:06:03.983606 [debug] [Thread-1 (]: Timing info for model.uber.passenger_count_dim (execute): 01:05:58.342313 => 01:06:03.982806
[0m01:06:03.991202 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'be7397cd-8571-4b87-aa32-ddef96720097', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff847da490>]}
[0m01:06:03.993801 [info ] [Thread-1 (]: 3 of 8 OK created sql table model uber.passenger_count_dim ..................... [[32mCREATE TABLE (100.0k rows, 781.2 KiB processed)[0m in 5.66s]
[0m01:06:03.997954 [debug] [Thread-1 (]: Finished running node model.uber.passenger_count_dim
[0m01:06:04.000319 [debug] [Thread-1 (]: Began running node model.uber.payment_type_dim
[0m01:06:04.003837 [info ] [Thread-1 (]: 4 of 8 START sql table model uber.payment_type_dim ............................. [RUN]
[0m01:06:04.006626 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.uber.passenger_count_dim, now model.uber.payment_type_dim)
[0m01:06:04.008031 [debug] [Thread-1 (]: Began compiling node model.uber.payment_type_dim
[0m01:06:04.027140 [debug] [Thread-1 (]: Writing injected SQL for node "model.uber.payment_type_dim"
[0m01:06:04.032631 [debug] [Thread-1 (]: Timing info for model.uber.payment_type_dim (compile): 01:06:04.009191 => 01:06:04.032009
[0m01:06:04.033960 [debug] [Thread-1 (]: Began executing node model.uber.payment_type_dim
[0m01:06:04.039706 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m01:06:05.469734 [debug] [Thread-1 (]: Writing runtime sql for node "model.uber.payment_type_dim"
[0m01:06:05.472717 [debug] [Thread-1 (]: On model.uber.payment_type_dim: /* {"app": "dbt", "dbt_version": "1.5.9", "profile_name": "uber", "target_name": "dev", "node_id": "model.uber.payment_type_dim"} */

  
    

    create or replace table `uber-data-engineering-407103`.`uber`.`payment_type_dim`
    
    

    OPTIONS()
    as (
      WITH numbered_rows AS (
  SELECT
    GENERATE_UUID() as payment_type_id,
    payment_type AS payment_type,
    ROW_NUMBER() OVER (ORDER BY payment_type) as row_num
  FROM `uber-data-engineering-407103`.`uber`.`uber_tlc_trip_recrord_data`
  WHERE payment_type IS NOT NULL
)
SELECT
  payment_type_id,
  payment_type
FROM numbered_rows
    );
  
[0m01:06:08.025932 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=uber-data-engineering-407103&j=bq:US:9d00a36f-5aff-421f-8c66-5ff61848be4a&page=queryresults
[0m01:06:08.040902 [debug] [Thread-1 (]: Timing info for model.uber.payment_type_dim (execute): 01:06:04.035014 => 01:06:08.040070
[0m01:06:08.045505 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'be7397cd-8571-4b87-aa32-ddef96720097', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff847ae850>]}
[0m01:06:08.049712 [info ] [Thread-1 (]: 4 of 8 OK created sql table model uber.payment_type_dim ........................ [[32mCREATE TABLE (100.0k rows, 781.2 KiB processed)[0m in 4.04s]
[0m01:06:08.053792 [debug] [Thread-1 (]: Finished running node model.uber.payment_type_dim
[0m01:06:08.055551 [debug] [Thread-1 (]: Began running node model.uber.pickup_location_dim
[0m01:06:08.058121 [info ] [Thread-1 (]: 5 of 8 START sql table model uber.pickup_location_dim .......................... [RUN]
[0m01:06:08.060370 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.uber.payment_type_dim, now model.uber.pickup_location_dim)
[0m01:06:08.061382 [debug] [Thread-1 (]: Began compiling node model.uber.pickup_location_dim
[0m01:06:08.088252 [debug] [Thread-1 (]: Writing injected SQL for node "model.uber.pickup_location_dim"
[0m01:06:08.092808 [debug] [Thread-1 (]: Timing info for model.uber.pickup_location_dim (compile): 01:06:08.062305 => 01:06:08.092472
[0m01:06:08.093787 [debug] [Thread-1 (]: Began executing node model.uber.pickup_location_dim
[0m01:06:08.097327 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m01:06:08.803204 [debug] [Thread-1 (]: Writing runtime sql for node "model.uber.pickup_location_dim"
[0m01:06:08.809296 [debug] [Thread-1 (]: On model.uber.pickup_location_dim: /* {"app": "dbt", "dbt_version": "1.5.9", "profile_name": "uber", "target_name": "dev", "node_id": "model.uber.pickup_location_dim"} */

  
    

    create or replace table `uber-data-engineering-407103`.`uber`.`pickup_location_dim`
    
    

    OPTIONS()
    as (
      WITH numbered_rows AS (
  SELECT
    to_hex(md5(cast(coalesce(cast(pickup_latitude as STRING), '_dbt_utils_surrogate_key_null_') || '-' || coalesce(cast(pickup_longitude as STRING), '_dbt_utils_surrogate_key_null_') as STRING))) as pickup_location_id,
    pickup_latitude AS pickup_latitude,
    pickup_longitude AS pickup_longitude,
    ROW_NUMBER() OVER (ORDER BY pickup_latitude, pickup_longitude) as row_num
  FROM `uber-data-engineering-407103`.`uber`.`uber_tlc_trip_recrord_data`
)
SELECT
  pickup_location_id,
  pickup_latitude,
  pickup_longitude
FROM numbered_rows
    );
  
[0m01:06:12.295133 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=uber-data-engineering-407103&j=bq:US:23ec4111-b973-4b94-85f9-b4fe97d8130d&page=queryresults
[0m01:06:12.307217 [debug] [Thread-1 (]: Timing info for model.uber.pickup_location_dim (execute): 01:06:08.094345 => 01:06:12.306572
[0m01:06:12.310358 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'be7397cd-8571-4b87-aa32-ddef96720097', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff7f594290>]}
[0m01:06:12.312624 [info ] [Thread-1 (]: 5 of 8 OK created sql table model uber.pickup_location_dim ..................... [[32mCREATE TABLE (100.0k rows, 1.5 MiB processed)[0m in 4.25s]
[0m01:06:12.315012 [debug] [Thread-1 (]: Finished running node model.uber.pickup_location_dim
[0m01:06:12.316790 [debug] [Thread-1 (]: Began running node model.uber.rate_code_dim
[0m01:06:12.318145 [info ] [Thread-1 (]: 6 of 8 START sql table model uber.rate_code_dim ................................ [RUN]
[0m01:06:12.320451 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.uber.pickup_location_dim, now model.uber.rate_code_dim)
[0m01:06:12.322092 [debug] [Thread-1 (]: Began compiling node model.uber.rate_code_dim
[0m01:06:12.344672 [debug] [Thread-1 (]: Writing injected SQL for node "model.uber.rate_code_dim"
[0m01:06:12.348022 [debug] [Thread-1 (]: Timing info for model.uber.rate_code_dim (compile): 01:06:12.323236 => 01:06:12.347748
[0m01:06:12.348657 [debug] [Thread-1 (]: Began executing node model.uber.rate_code_dim
[0m01:06:12.351577 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m01:06:13.827248 [debug] [Thread-1 (]: Writing runtime sql for node "model.uber.rate_code_dim"
[0m01:06:13.836778 [debug] [Thread-1 (]: On model.uber.rate_code_dim: /* {"app": "dbt", "dbt_version": "1.5.9", "profile_name": "uber", "target_name": "dev", "node_id": "model.uber.rate_code_dim"} */

  
    

    create or replace table `uber-data-engineering-407103`.`uber`.`rate_code_dim`
    
    

    OPTIONS()
    as (
      WITH numbered_rows AS (
  SELECT
    GENERATE_UUID() as rate_code_id,
    RatecodeID AS RatecodeID,
    ROW_NUMBER() OVER (ORDER BY RatecodeID) as row_num
  FROM `uber-data-engineering-407103`.`uber`.`uber_tlc_trip_recrord_data`
  WHERE RatecodeID IS NOT NULL
)
SELECT
  rate_code_id,
  RatecodeID
FROM numbered_rows
    );
  
[0m01:06:16.922223 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=uber-data-engineering-407103&j=bq:US:43c9b0ec-cf0d-4534-b435-47447dbb038c&page=queryresults
[0m01:06:16.933752 [debug] [Thread-1 (]: Timing info for model.uber.rate_code_dim (execute): 01:06:12.349133 => 01:06:16.932778
[0m01:06:16.937767 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'be7397cd-8571-4b87-aa32-ddef96720097', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff7f594ad0>]}
[0m01:06:16.940494 [info ] [Thread-1 (]: 6 of 8 OK created sql table model uber.rate_code_dim ........................... [[32mCREATE TABLE (100.0k rows, 781.2 KiB processed)[0m in 4.62s]
[0m01:06:16.943783 [debug] [Thread-1 (]: Finished running node model.uber.rate_code_dim
[0m01:06:16.947125 [debug] [Thread-1 (]: Began running node model.uber.trip_distance
[0m01:06:16.949674 [info ] [Thread-1 (]: 7 of 8 START sql table model uber.trip_distance ................................ [RUN]
[0m01:06:16.951871 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.uber.rate_code_dim, now model.uber.trip_distance)
[0m01:06:16.952977 [debug] [Thread-1 (]: Began compiling node model.uber.trip_distance
[0m01:06:16.963053 [debug] [Thread-1 (]: Writing injected SQL for node "model.uber.trip_distance"
[0m01:06:16.966106 [debug] [Thread-1 (]: Timing info for model.uber.trip_distance (compile): 01:06:16.953972 => 01:06:16.965856
[0m01:06:16.967272 [debug] [Thread-1 (]: Began executing node model.uber.trip_distance
[0m01:06:16.970829 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m01:06:17.786055 [debug] [Thread-1 (]: Writing runtime sql for node "model.uber.trip_distance"
[0m01:06:17.789332 [debug] [Thread-1 (]: On model.uber.trip_distance: /* {"app": "dbt", "dbt_version": "1.5.9", "profile_name": "uber", "target_name": "dev", "node_id": "model.uber.trip_distance"} */

  
    

    create or replace table `uber-data-engineering-407103`.`uber`.`trip_distance`
    
    

    OPTIONS()
    as (
      WITH numbered_rows AS (
  SELECT
    GENERATE_UUID() as trip_distance_id,
    trip_distance AS trip_distance,
    ROW_NUMBER() OVER (ORDER BY trip_distance) as row_num
  FROM `uber-data-engineering-407103`.`uber`.`uber_tlc_trip_recrord_data`
  WHERE trip_distance IS NOT NULL
)
SELECT
  trip_distance_id,
  trip_distance
FROM numbered_rows
    );
  
[0m01:06:21.270879 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=uber-data-engineering-407103&j=bq:US:3f1bd413-891d-4c3c-a4dc-becb62e1aec3&page=queryresults
[0m01:06:21.283032 [debug] [Thread-1 (]: Timing info for model.uber.trip_distance (execute): 01:06:16.967936 => 01:06:21.282453
[0m01:06:21.285861 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'be7397cd-8571-4b87-aa32-ddef96720097', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff86359bd0>]}
[0m01:06:21.287961 [info ] [Thread-1 (]: 7 of 8 OK created sql table model uber.trip_distance ........................... [[32mCREATE TABLE (100.0k rows, 781.2 KiB processed)[0m in 4.33s]
[0m01:06:21.290020 [debug] [Thread-1 (]: Finished running node model.uber.trip_distance
[0m01:06:21.294784 [debug] [Thread-1 (]: Began running node model.uber.fact_trip
[0m01:06:21.296797 [info ] [Thread-1 (]: 8 of 8 START sql table model uber.fact_trip .................................... [RUN]
[0m01:06:21.298716 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.uber.trip_distance, now model.uber.fact_trip)
[0m01:06:21.299770 [debug] [Thread-1 (]: Began compiling node model.uber.fact_trip
[0m01:06:21.310269 [debug] [Thread-1 (]: Writing injected SQL for node "model.uber.fact_trip"
[0m01:06:21.314836 [debug] [Thread-1 (]: Timing info for model.uber.fact_trip (compile): 01:06:21.300573 => 01:06:21.314574
[0m01:06:21.315692 [debug] [Thread-1 (]: Began executing node model.uber.fact_trip
[0m01:06:21.320731 [debug] [Thread-1 (]: Writing runtime sql for node "model.uber.fact_trip"
[0m01:06:21.323891 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m01:06:21.335043 [debug] [Thread-1 (]: On model.uber.fact_trip: /* {"app": "dbt", "dbt_version": "1.5.9", "profile_name": "uber", "target_name": "dev", "node_id": "model.uber.fact_trip"} */

  
    

    create or replace table `uber-data-engineering-407103`.`uber`.`fact_trip`
    
    

    OPTIONS()
    as (
      WITH fct_invoices_cte AS (
    SELECT
        CAST(ROW_NUMBER() OVER () AS INT64) as trip_id,
        VendorID AS VendorID,
        store_and_fwd_flag AS store_and_fwd_flag,
        fare_amount AS fare_amount,
        extra AS extra,
        mta_tax AS mta_tax,
        tip_amount AS tip_amount,
        tolls_amount AS tolls_amount,
        improvement_surcharge AS improvement_surcharge,
        total_amount AS total_amount
    FROM `uber-data-engineering-407103`.`uber`.`uber_tlc_trip_recrord_data`
)
SELECT
    trip_id,
    VendorID,
    datetime_id,
    do.dropoff_location_id,
    pu.pickup_location_id,
    pc.passenger_count_id,
    pt.payment_type_id,
    rc.rate_code_id,
    store_and_fwd_flag,
    td.trip_distance_id,
    fare_amount,
    extra,
    mta_tax,
    tip_amount,
    tolls_amount,
    improvement_surcharge_amount,
    tolls_amount
FROM fct_invoices_cte fi
INNER JOIN `uber-data-engineering-407103`.`uber`.`datetime_dim` dt ON fi.datetime_id = dt.datetime_id
INNER JOIN `uber-data-engineering-407103`.`uber`.`dropoff_location_dim` do ON fi.dropoff_location_id = do.dropoff_location_id
INNER JOIN `uber-data-engineering-407103`.`uber`.`pickup_location_dim` pu ON fi.pickup_location_id = pu.pickup_location_id
INNER JOIN `uber-data-engineering-407103`.`uber`.`passenger_count_dim` pc ON fi.passenger_count_id = pc.passenger_count_id
INNER JOIN `uber-data-engineering-407103`.`uber`.`payment_type_dim` pt ON fi.payment_type_id = pt.payment_type_id
INNER JOIN `uber-data-engineering-407103`.`uber`.`rate_code_dim` rc ON fi.rate_code_id = rc.rate_code_id
INNER JOIN `uber-data-engineering-407103`.`uber`.`trip_distance` td ON fi.trip_distance_id = td.trip_distance_id
    );
  
[0m01:06:22.840489 [debug] [Thread-1 (]: BigQuery adapter: Retry attempt 1 of 1 after error: BadRequest('Name datetime_id not found inside fi at [45:74]')
[0m01:06:24.604454 [error] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=uber-data-engineering-407103&j=bq:US:259eedb9-80b3-4b5a-8b4c-5050406f2bb5&page=queryresults
[0m01:06:24.610253 [debug] [Thread-1 (]: Timing info for model.uber.fact_trip (execute): 01:06:21.316380 => 01:06:24.609141
[0m01:06:24.631656 [debug] [Thread-1 (]: Database Error in model fact_trip (models/transform/fact_trip.sql)
  Name datetime_id not found inside fi at [45:74]
  compiled Code at target/run/uber/models/transform/fact_trip.sql
[0m01:06:24.633996 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'be7397cd-8571-4b87-aa32-ddef96720097', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff7f565310>]}
[0m01:06:24.636285 [error] [Thread-1 (]: 8 of 8 ERROR creating sql table model uber.fact_trip ........................... [[31mERROR[0m in 3.33s]
[0m01:06:24.638030 [debug] [Thread-1 (]: Finished running node model.uber.fact_trip
[0m01:06:24.643794 [debug] [MainThread]: Connection 'master' was properly closed.
[0m01:06:24.644537 [debug] [MainThread]: Connection 'model.uber.fact_trip' was properly closed.
[0m01:06:24.645481 [info ] [MainThread]: 
[0m01:06:24.646580 [info ] [MainThread]: Finished running 8 table models in 0 hours 0 minutes and 38.43 seconds (38.43s).
[0m01:06:24.651297 [debug] [MainThread]: Command end result
[0m01:06:24.711542 [info ] [MainThread]: 
[0m01:06:24.713345 [info ] [MainThread]: [31mCompleted with 1 error and 0 warnings:[0m
[0m01:06:24.714393 [info ] [MainThread]: 
[0m01:06:24.715716 [error] [MainThread]: [33mDatabase Error in model fact_trip (models/transform/fact_trip.sql)[0m
[0m01:06:24.718142 [error] [MainThread]:   Name datetime_id not found inside fi at [45:74]
[0m01:06:24.723532 [error] [MainThread]:   compiled Code at target/run/uber/models/transform/fact_trip.sql
[0m01:06:24.726619 [info ] [MainThread]: 
[0m01:06:24.728499 [info ] [MainThread]: Done. PASS=7 WARN=0 ERROR=1 SKIP=0 TOTAL=8
[0m01:06:24.730746 [debug] [MainThread]: Command `dbt run` failed at 01:06:24.730506 after 39.15 seconds
[0m01:06:24.731868 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff869f8390>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff86e4bc50>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff8a9ac810>]}
[0m01:06:24.732596 [debug] [MainThread]: Flushing usage events
[0m19:32:02.077014 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff7f35d350>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff7f6e8f90>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff7f65e790>]}


============================== 19:32:02.086485 | 25ee994c-6043-41d3-af7c-3aae04102cd6 ==============================
[0m19:32:02.086485 [info ] [MainThread]: Running with dbt=1.5.9
[0m19:32:02.087626 [debug] [MainThread]: running dbt with arguments {'quiet': 'False', 'write_json': 'True', 'use_experimental_parser': 'False', 'indirect_selection': 'eager', 'fail_fast': 'False', 'printer_width': '80', 'send_anonymous_usage_stats': 'True', 'log_format': 'default', 'cache_selected_only': 'False', 'use_colors': 'True', 'partial_parse': 'True', 'profiles_dir': '/usr/local/airflow/include/dbt/', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'version_check': 'True', 'introspect': 'True', 'target_path': 'None', 'static_parser': 'True', 'log_cache_events': 'False', 'log_path': '/usr/local/airflow/include/dbt/logs', 'no_print': 'None', 'warn_error': 'None', 'debug': 'False'}
[0m19:32:02.886537 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '25ee994c-6043-41d3-af7c-3aae04102cd6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff7f66ef50>]}
[0m19:32:02.899240 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '25ee994c-6043-41d3-af7c-3aae04102cd6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff7f66e190>]}
[0m19:32:02.900444 [info ] [MainThread]: Registered adapter: bigquery=1.5.3
[0m19:32:02.918900 [debug] [MainThread]: checksum: dd837546c89c9d03f3c2cb0ca6165266a30da6076d5d44e9991f7c5a8e5f5831, vars: {}, profile: , target: , version: 1.5.9
[0m19:32:03.048648 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m19:32:03.049461 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m19:32:03.059378 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '25ee994c-6043-41d3-af7c-3aae04102cd6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff7d1e49d0>]}
[0m19:32:03.090359 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '25ee994c-6043-41d3-af7c-3aae04102cd6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff7d327910>]}
[0m19:32:03.091621 [info ] [MainThread]: Found 8 models, 0 tests, 0 snapshots, 0 analyses, 474 macros, 0 operations, 0 seed files, 1 source, 0 exposures, 0 metrics, 0 groups
[0m19:32:03.092866 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '25ee994c-6043-41d3-af7c-3aae04102cd6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff821f76d0>]}
[0m19:32:03.095643 [info ] [MainThread]: 
[0m19:32:03.096624 [debug] [MainThread]: Acquiring new bigquery connection 'master'
[0m19:32:03.099414 [debug] [ThreadPool]: Acquiring new bigquery connection 'list_uber-data-engineering-407103'
[0m19:32:03.099910 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m19:32:03.708300 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_uber-data-engineering-407103, now list_uber-data-engineering-407103_uber)
[0m19:32:03.710618 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m19:32:04.326076 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '25ee994c-6043-41d3-af7c-3aae04102cd6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff7fdf6a50>]}
[0m19:32:04.329867 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m19:32:04.331557 [info ] [MainThread]: 
[0m19:32:04.357019 [debug] [Thread-1 (]: Began running node model.uber.datetime_dim
[0m19:32:04.358098 [info ] [Thread-1 (]: 1 of 8 START sql table model uber.datetime_dim ................................. [RUN]
[0m19:32:04.359366 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_uber-data-engineering-407103_uber, now model.uber.datetime_dim)
[0m19:32:04.360084 [debug] [Thread-1 (]: Began compiling node model.uber.datetime_dim
[0m19:32:04.399389 [debug] [Thread-1 (]: Writing injected SQL for node "model.uber.datetime_dim"
[0m19:32:04.405871 [debug] [Thread-1 (]: Timing info for model.uber.datetime_dim (compile): 19:32:04.360637 => 19:32:04.404759
[0m19:32:04.407140 [debug] [Thread-1 (]: Began executing node model.uber.datetime_dim
[0m19:32:04.431833 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m19:32:05.099420 [debug] [Thread-1 (]: Writing runtime sql for node "model.uber.datetime_dim"
[0m19:32:05.102640 [debug] [Thread-1 (]: On model.uber.datetime_dim: /* {"app": "dbt", "dbt_version": "1.5.9", "profile_name": "uber", "target_name": "dev", "node_id": "model.uber.datetime_dim"} */

  
    

    create or replace table `uber-data-engineering-407103`.`uber`.`datetime_dim`
    
    

    OPTIONS()
    as (
      WITH datetime_cte AS (  
  SELECT DISTINCT 
    to_hex(md5(cast(coalesce(cast(tpep_pickup_datetime as STRING), '_dbt_utils_surrogate_key_null_') || '-' || coalesce(cast(tpep_dropoff_datetime as STRING), '_dbt_utils_surrogate_key_null_') as STRING))) AS datetime_id,
    CASE
      WHEN LENGTH(tpep_pickup_datetime) = 16 THEN
        -- Date format: "DD/MM/YYYY HH:MM"
        PARSE_DATETIME('%m/%d/%Y %H:%M', tpep_pickup_datetime)
      WHEN LENGTH(tpep_pickup_datetime) <= 14 THEN
        -- Date format: "MM/DD/YY HH:MM"
        PARSE_DATETIME('%m/%d/%y %H:%M', tpep_pickup_datetime)
      ELSE
        NULL
    END AS pick_date_part,
    tpep_dropoff_datetime AS drop_datetime_id,
    CASE
      WHEN LENGTH(tpep_dropoff_datetime) = 16 THEN
        -- Date format: "DD/MM/YYYY HH:MM"
        PARSE_DATETIME('%m/%d/%Y %H:%M', tpep_dropoff_datetime)
      WHEN LENGTH(tpep_dropoff_datetime) <= 14 THEN
        -- Date format: "MM/DD/YY HH:MM"
        PARSE_DATETIME('%m/%d/%y %H:%M', tpep_dropoff_datetime)
      ELSE
        NULL
    END AS drop_date_part
  FROM `uber-data-engineering-407103`.`uber`.`uber_tlc_trip_recrord_data`
  WHERE tpep_pickup_datetime IS NOT NULL
    AND tpep_dropoff_datetime IS NOT NULL
)
SELECT
  datetime_id,
  pick_date_part AS tpep_pickup_datetime,
  drop_date_part AS tpep_dropoff_datetime,
  EXTRACT(HOUR FROM pick_date_part) AS pick_hour,
  EXTRACT(DAY FROM pick_date_part) AS pick_day,
  EXTRACT(MONTH FROM pick_date_part) AS pick_month,
  EXTRACT(YEAR FROM pick_date_part) AS pick_year,
  EXTRACT(DAYOFWEEK FROM pick_date_part) AS pick_weekday,
  EXTRACT(HOUR FROM drop_date_part) AS drop_hour,
  EXTRACT(DAY FROM drop_date_part) AS drop_day,
  EXTRACT(MONTH FROM drop_date_part) AS drop_month,
  EXTRACT(YEAR FROM drop_date_part) AS drop_year,
  EXTRACT(DAYOFWEEK FROM drop_date_part) AS drop_weekday
FROM datetime_cte
    );
  
[0m19:32:08.554269 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=uber-data-engineering-407103&j=bq:US:f10c6cb0-af91-4cfd-98be-120fb5757f3b&page=queryresults
[0m19:32:08.591134 [debug] [Thread-1 (]: Timing info for model.uber.datetime_dim (execute): 19:32:04.407795 => 19:32:08.590467
[0m19:32:08.593466 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '25ee994c-6043-41d3-af7c-3aae04102cd6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff7d20df50>]}
[0m19:32:08.595365 [info ] [Thread-1 (]: 1 of 8 OK created sql table model uber.datetime_dim ............................ [[32mCREATE TABLE (99.9k rows, 4.0 MiB processed)[0m in 4.23s]
[0m19:32:08.597246 [debug] [Thread-1 (]: Finished running node model.uber.datetime_dim
[0m19:32:08.598307 [debug] [Thread-1 (]: Began running node model.uber.dropoff_location_dim
[0m19:32:08.599594 [info ] [Thread-1 (]: 2 of 8 START sql table model uber.dropoff_location_dim ......................... [RUN]
[0m19:32:08.600724 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.uber.datetime_dim, now model.uber.dropoff_location_dim)
[0m19:32:08.601464 [debug] [Thread-1 (]: Began compiling node model.uber.dropoff_location_dim
[0m19:32:08.608938 [debug] [Thread-1 (]: Writing injected SQL for node "model.uber.dropoff_location_dim"
[0m19:32:08.612584 [debug] [Thread-1 (]: Timing info for model.uber.dropoff_location_dim (compile): 19:32:08.602001 => 19:32:08.612381
[0m19:32:08.613174 [debug] [Thread-1 (]: Began executing node model.uber.dropoff_location_dim
[0m19:32:08.615991 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m19:32:09.113011 [debug] [Thread-1 (]: Writing runtime sql for node "model.uber.dropoff_location_dim"
[0m19:32:09.116007 [debug] [Thread-1 (]: On model.uber.dropoff_location_dim: /* {"app": "dbt", "dbt_version": "1.5.9", "profile_name": "uber", "target_name": "dev", "node_id": "model.uber.dropoff_location_dim"} */

  
    

    create or replace table `uber-data-engineering-407103`.`uber`.`dropoff_location_dim`
    
    

    OPTIONS()
    as (
      WITH numbered_rows AS (
  SELECT
    to_hex(md5(cast(coalesce(cast(dropoff_latitude as STRING), '_dbt_utils_surrogate_key_null_') || '-' || coalesce(cast(dropoff_longitude as STRING), '_dbt_utils_surrogate_key_null_') as STRING))) as dropoff_location_id,
    dropoff_latitude AS dropoff_latitude,
    dropoff_longitude AS dropoff_longitude,
    ROW_NUMBER() OVER (ORDER BY dropoff_latitude, dropoff_longitude) as row_num
  FROM `uber-data-engineering-407103`.`uber`.`uber_tlc_trip_recrord_data`
)
SELECT
  dropoff_location_id,
  dropoff_latitude,
  dropoff_longitude
FROM numbered_rows
    );
  
[0m19:32:13.942346 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=uber-data-engineering-407103&j=bq:US:b91241f6-c312-49fc-96c3-06bb68bf4b31&page=queryresults
[0m19:32:13.960487 [debug] [Thread-1 (]: Timing info for model.uber.dropoff_location_dim (execute): 19:32:08.613610 => 19:32:13.959383
[0m19:32:13.963447 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '25ee994c-6043-41d3-af7c-3aae04102cd6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff7f66dbd0>]}
[0m19:32:13.965509 [info ] [Thread-1 (]: 2 of 8 OK created sql table model uber.dropoff_location_dim .................... [[32mCREATE TABLE (100.0k rows, 1.5 MiB processed)[0m in 5.36s]
[0m19:32:13.967412 [debug] [Thread-1 (]: Finished running node model.uber.dropoff_location_dim
[0m19:32:13.968519 [debug] [Thread-1 (]: Began running node model.uber.passenger_count_dim
[0m19:32:13.969910 [info ] [Thread-1 (]: 3 of 8 START sql table model uber.passenger_count_dim .......................... [RUN]
[0m19:32:13.971217 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.uber.dropoff_location_dim, now model.uber.passenger_count_dim)
[0m19:32:13.971890 [debug] [Thread-1 (]: Began compiling node model.uber.passenger_count_dim
[0m19:32:13.979887 [debug] [Thread-1 (]: Writing injected SQL for node "model.uber.passenger_count_dim"
[0m19:32:13.983107 [debug] [Thread-1 (]: Timing info for model.uber.passenger_count_dim (compile): 19:32:13.972407 => 19:32:13.982903
[0m19:32:13.983861 [debug] [Thread-1 (]: Began executing node model.uber.passenger_count_dim
[0m19:32:13.986740 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m19:32:14.490140 [debug] [Thread-1 (]: Writing runtime sql for node "model.uber.passenger_count_dim"
[0m19:32:14.495621 [debug] [Thread-1 (]: On model.uber.passenger_count_dim: /* {"app": "dbt", "dbt_version": "1.5.9", "profile_name": "uber", "target_name": "dev", "node_id": "model.uber.passenger_count_dim"} */

  
    

    create or replace table `uber-data-engineering-407103`.`uber`.`passenger_count_dim`
    
    

    OPTIONS()
    as (
      SELECT DISTINCT
        GENERATE_UUID() as passenger_count_id,
		passenger_count AS passenger_count,
FROM `uber-data-engineering-407103`.`uber`.`uber_tlc_trip_recrord_data`
WHERE passenger_count IS NOT NULL
    );
  
[0m19:32:17.694727 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=uber-data-engineering-407103&j=bq:US:9830980e-0db5-4e8b-b113-4b4fe9807702&page=queryresults
[0m19:32:17.714613 [debug] [Thread-1 (]: Timing info for model.uber.passenger_count_dim (execute): 19:32:13.984312 => 19:32:17.713456
[0m19:32:17.718688 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '25ee994c-6043-41d3-af7c-3aae04102cd6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff7d0bbb90>]}
[0m19:32:17.721896 [info ] [Thread-1 (]: 3 of 8 OK created sql table model uber.passenger_count_dim ..................... [[32mCREATE TABLE (100.0k rows, 781.2 KiB processed)[0m in 3.75s]
[0m19:32:17.723605 [debug] [Thread-1 (]: Finished running node model.uber.passenger_count_dim
[0m19:32:17.724623 [debug] [Thread-1 (]: Began running node model.uber.payment_type_dim
[0m19:32:17.725913 [info ] [Thread-1 (]: 4 of 8 START sql table model uber.payment_type_dim ............................. [RUN]
[0m19:32:17.727295 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.uber.passenger_count_dim, now model.uber.payment_type_dim)
[0m19:32:17.727917 [debug] [Thread-1 (]: Began compiling node model.uber.payment_type_dim
[0m19:32:17.755564 [debug] [Thread-1 (]: Writing injected SQL for node "model.uber.payment_type_dim"
[0m19:32:17.758244 [debug] [Thread-1 (]: Timing info for model.uber.payment_type_dim (compile): 19:32:17.728388 => 19:32:17.758030
[0m19:32:17.758829 [debug] [Thread-1 (]: Began executing node model.uber.payment_type_dim
[0m19:32:17.762208 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m19:32:18.247291 [debug] [Thread-1 (]: Writing runtime sql for node "model.uber.payment_type_dim"
[0m19:32:18.252383 [debug] [Thread-1 (]: On model.uber.payment_type_dim: /* {"app": "dbt", "dbt_version": "1.5.9", "profile_name": "uber", "target_name": "dev", "node_id": "model.uber.payment_type_dim"} */

  
    

    create or replace table `uber-data-engineering-407103`.`uber`.`payment_type_dim`
    
    

    OPTIONS()
    as (
      WITH numbered_rows AS (
  SELECT
    GENERATE_UUID() as payment_type_id,
    payment_type AS payment_type,
    ROW_NUMBER() OVER (ORDER BY payment_type) as row_num
  FROM `uber-data-engineering-407103`.`uber`.`uber_tlc_trip_recrord_data`
  WHERE payment_type IS NOT NULL
)
SELECT
  payment_type_id,
  payment_type
FROM numbered_rows
    );
  
[0m19:32:21.194373 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=uber-data-engineering-407103&j=bq:US:3584829b-57f8-4fa0-8acb-1d5c7c4f0463&page=queryresults
[0m19:32:21.210218 [debug] [Thread-1 (]: Timing info for model.uber.payment_type_dim (execute): 19:32:17.759293 => 19:32:21.209114
[0m19:32:21.213622 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '25ee994c-6043-41d3-af7c-3aae04102cd6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff7fdf6a50>]}
[0m19:32:21.215184 [info ] [Thread-1 (]: 4 of 8 OK created sql table model uber.payment_type_dim ........................ [[32mCREATE TABLE (100.0k rows, 781.2 KiB processed)[0m in 3.49s]
[0m19:32:21.216579 [debug] [Thread-1 (]: Finished running node model.uber.payment_type_dim
[0m19:32:21.217436 [debug] [Thread-1 (]: Began running node model.uber.pickup_location_dim
[0m19:32:21.218412 [info ] [Thread-1 (]: 5 of 8 START sql table model uber.pickup_location_dim .......................... [RUN]
[0m19:32:21.219627 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.uber.payment_type_dim, now model.uber.pickup_location_dim)
[0m19:32:21.220173 [debug] [Thread-1 (]: Began compiling node model.uber.pickup_location_dim
[0m19:32:21.227812 [debug] [Thread-1 (]: Writing injected SQL for node "model.uber.pickup_location_dim"
[0m19:32:21.230645 [debug] [Thread-1 (]: Timing info for model.uber.pickup_location_dim (compile): 19:32:21.220561 => 19:32:21.230456
[0m19:32:21.231115 [debug] [Thread-1 (]: Began executing node model.uber.pickup_location_dim
[0m19:32:21.233857 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m19:32:22.172709 [debug] [Thread-1 (]: Writing runtime sql for node "model.uber.pickup_location_dim"
[0m19:32:22.177818 [debug] [Thread-1 (]: On model.uber.pickup_location_dim: /* {"app": "dbt", "dbt_version": "1.5.9", "profile_name": "uber", "target_name": "dev", "node_id": "model.uber.pickup_location_dim"} */

  
    

    create or replace table `uber-data-engineering-407103`.`uber`.`pickup_location_dim`
    
    

    OPTIONS()
    as (
      WITH numbered_rows AS (
  SELECT
    to_hex(md5(cast(coalesce(cast(pickup_latitude as STRING), '_dbt_utils_surrogate_key_null_') || '-' || coalesce(cast(pickup_longitude as STRING), '_dbt_utils_surrogate_key_null_') as STRING))) as pickup_location_id,
    pickup_latitude AS pickup_latitude,
    pickup_longitude AS pickup_longitude,
    ROW_NUMBER() OVER (ORDER BY pickup_latitude, pickup_longitude) as row_num
  FROM `uber-data-engineering-407103`.`uber`.`uber_tlc_trip_recrord_data`
)
SELECT
  pickup_location_id,
  pickup_latitude,
  pickup_longitude
FROM numbered_rows
    );
  
[0m19:32:25.602800 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=uber-data-engineering-407103&j=bq:US:b2cc7c98-aadd-4415-82aa-84a456d41634&page=queryresults
[0m19:32:25.614000 [debug] [Thread-1 (]: Timing info for model.uber.pickup_location_dim (execute): 19:32:21.231476 => 19:32:25.613419
[0m19:32:25.617215 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '25ee994c-6043-41d3-af7c-3aae04102cd6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff7cfaa450>]}
[0m19:32:25.618893 [info ] [Thread-1 (]: 5 of 8 OK created sql table model uber.pickup_location_dim ..................... [[32mCREATE TABLE (100.0k rows, 1.5 MiB processed)[0m in 4.40s]
[0m19:32:25.620393 [debug] [Thread-1 (]: Finished running node model.uber.pickup_location_dim
[0m19:32:25.621505 [debug] [Thread-1 (]: Began running node model.uber.rate_code_dim
[0m19:32:25.622512 [info ] [Thread-1 (]: 6 of 8 START sql table model uber.rate_code_dim ................................ [RUN]
[0m19:32:25.623612 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.uber.pickup_location_dim, now model.uber.rate_code_dim)
[0m19:32:25.624196 [debug] [Thread-1 (]: Began compiling node model.uber.rate_code_dim
[0m19:32:25.628196 [debug] [Thread-1 (]: Writing injected SQL for node "model.uber.rate_code_dim"
[0m19:32:25.630635 [debug] [Thread-1 (]: Timing info for model.uber.rate_code_dim (compile): 19:32:25.624565 => 19:32:25.630469
[0m19:32:25.631115 [debug] [Thread-1 (]: Began executing node model.uber.rate_code_dim
[0m19:32:25.633118 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m19:32:26.509181 [debug] [Thread-1 (]: Writing runtime sql for node "model.uber.rate_code_dim"
[0m19:32:26.512682 [debug] [Thread-1 (]: On model.uber.rate_code_dim: /* {"app": "dbt", "dbt_version": "1.5.9", "profile_name": "uber", "target_name": "dev", "node_id": "model.uber.rate_code_dim"} */

  
    

    create or replace table `uber-data-engineering-407103`.`uber`.`rate_code_dim`
    
    

    OPTIONS()
    as (
      WITH numbered_rows AS (
  SELECT
    GENERATE_UUID() as rate_code_id,
    RatecodeID AS RatecodeID,
    ROW_NUMBER() OVER (ORDER BY RatecodeID) as row_num
  FROM `uber-data-engineering-407103`.`uber`.`uber_tlc_trip_recrord_data`
  WHERE RatecodeID IS NOT NULL
)
SELECT
  rate_code_id,
  RatecodeID
FROM numbered_rows
    );
  
[0m19:32:29.576414 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=uber-data-engineering-407103&j=bq:US:bc0329a3-8df0-4e4d-9cd6-b9ad0cbdb618&page=queryresults
[0m19:32:29.763089 [debug] [Thread-1 (]: Timing info for model.uber.rate_code_dim (execute): 19:32:25.631422 => 19:32:29.759011
[0m19:32:29.795101 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '25ee994c-6043-41d3-af7c-3aae04102cd6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff7d2fa590>]}
[0m19:32:29.809762 [info ] [Thread-1 (]: 6 of 8 OK created sql table model uber.rate_code_dim ........................... [[32mCREATE TABLE (100.0k rows, 781.2 KiB processed)[0m in 4.16s]
[0m19:32:29.817633 [debug] [Thread-1 (]: Finished running node model.uber.rate_code_dim
[0m19:32:29.844182 [debug] [Thread-1 (]: Began running node model.uber.trip_distance
[0m19:32:29.885143 [info ] [Thread-1 (]: 7 of 8 START sql table model uber.trip_distance ................................ [RUN]
[0m19:32:29.908194 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.uber.rate_code_dim, now model.uber.trip_distance)
[0m19:32:29.919874 [debug] [Thread-1 (]: Began compiling node model.uber.trip_distance
[0m19:32:29.988383 [debug] [Thread-1 (]: Writing injected SQL for node "model.uber.trip_distance"
[0m19:32:30.002628 [debug] [Thread-1 (]: Timing info for model.uber.trip_distance (compile): 19:32:29.925598 => 19:32:30.001791
[0m19:32:30.006516 [debug] [Thread-1 (]: Began executing node model.uber.trip_distance
[0m19:32:30.036545 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m19:32:32.106853 [debug] [Thread-1 (]: Writing runtime sql for node "model.uber.trip_distance"
[0m19:32:32.250603 [debug] [Thread-1 (]: On model.uber.trip_distance: /* {"app": "dbt", "dbt_version": "1.5.9", "profile_name": "uber", "target_name": "dev", "node_id": "model.uber.trip_distance"} */

  
    

    create or replace table `uber-data-engineering-407103`.`uber`.`trip_distance`
    
    

    OPTIONS()
    as (
      WITH numbered_rows AS (
  SELECT
    GENERATE_UUID() as trip_distance_id,
    trip_distance AS trip_distance,
    ROW_NUMBER() OVER (ORDER BY trip_distance) as row_num
  FROM `uber-data-engineering-407103`.`uber`.`uber_tlc_trip_recrord_data`
  WHERE trip_distance IS NOT NULL
)
SELECT
  trip_distance_id,
  trip_distance
FROM numbered_rows
    );
  
[0m19:32:35.128965 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=uber-data-engineering-407103&j=bq:US:58f9537c-398a-42a9-9592-ee3658da92d2&page=queryresults
[0m19:32:35.159831 [debug] [Thread-1 (]: Timing info for model.uber.trip_distance (execute): 19:32:30.010139 => 19:32:35.155586
[0m19:32:35.172559 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '25ee994c-6043-41d3-af7c-3aae04102cd6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff7d1a45d0>]}
[0m19:32:35.176950 [info ] [Thread-1 (]: 7 of 8 OK created sql table model uber.trip_distance ........................... [[32mCREATE TABLE (100.0k rows, 781.2 KiB processed)[0m in 5.28s]
[0m19:32:35.179924 [debug] [Thread-1 (]: Finished running node model.uber.trip_distance
[0m19:32:35.186779 [debug] [Thread-1 (]: Began running node model.uber.fact_trip
[0m19:32:35.187954 [info ] [Thread-1 (]: 8 of 8 START sql table model uber.fact_trip .................................... [RUN]
[0m19:32:35.189945 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.uber.trip_distance, now model.uber.fact_trip)
[0m19:32:35.191269 [debug] [Thread-1 (]: Began compiling node model.uber.fact_trip
[0m19:32:35.219059 [debug] [Thread-1 (]: Writing injected SQL for node "model.uber.fact_trip"
[0m19:32:35.223488 [debug] [Thread-1 (]: Timing info for model.uber.fact_trip (compile): 19:32:35.191845 => 19:32:35.222984
[0m19:32:35.224306 [debug] [Thread-1 (]: Began executing node model.uber.fact_trip
[0m19:32:35.232420 [debug] [Thread-1 (]: Writing runtime sql for node "model.uber.fact_trip"
[0m19:32:35.243216 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m19:32:35.260962 [debug] [Thread-1 (]: On model.uber.fact_trip: /* {"app": "dbt", "dbt_version": "1.5.9", "profile_name": "uber", "target_name": "dev", "node_id": "model.uber.fact_trip"} */

  
    

    create or replace table `uber-data-engineering-407103`.`uber`.`fact_trip`
    
    

    OPTIONS()
    as (
      WITH fct_invoices_cte AS (
    SELECT
        CAST(ROW_NUMBER() OVER () AS INT64) as trip_id,
        VendorID AS VendorID,
        store_and_fwd_flag AS store_and_fwd_flag,
        fare_amount AS fare_amount,
        extra AS extra,
        mta_tax AS mta_tax,
        tip_amount AS tip_amount,
        tolls_amount AS tolls_amount,
        improvement_surcharge AS improvement_surcharge,
        total_amount AS total_amount
    FROM `uber-data-engineering-407103`.`uber`.`uber_tlc_trip_recrord_data`
)
SELECT
    trip_id,
    VendorID,
    datetime_id,
    do.dropoff_location_id,
    pu.pickup_location_id,
    pc.passenger_count_id,
    pt.payment_type_id,
    rc.rate_code_id,
    store_and_fwd_flag,
    td.trip_distance_id,
    fare_amount,
    extra,
    mta_tax,
    tip_amount,
    tolls_amount,
    improvement_surcharge_amount,
    tolls_amount
FROM fct_invoices_cte fi
INNER JOIN `uber-data-engineering-407103`.`uber`.`datetime_dim` dt ON fi.datetime_id = dt.datetime_id
INNER JOIN `uber-data-engineering-407103`.`uber`.`dropoff_location_dim` do ON fi.dropoff_location_id = do.dropoff_location_id
INNER JOIN `uber-data-engineering-407103`.`uber`.`pickup_location_dim` pu ON fi.pickup_location_id = pu.pickup_location_id
INNER JOIN `uber-data-engineering-407103`.`uber`.`passenger_count_dim` pc ON fi.passenger_count_id = pc.passenger_count_id
INNER JOIN `uber-data-engineering-407103`.`uber`.`payment_type_dim` pt ON fi.payment_type_id = pt.payment_type_id
INNER JOIN `uber-data-engineering-407103`.`uber`.`rate_code_dim` rc ON fi.rate_code_id = rc.rate_code_id
INNER JOIN `uber-data-engineering-407103`.`uber`.`trip_distance` td ON fi.trip_distance_id = td.trip_distance_id
    );
  
[0m19:32:36.508045 [debug] [Thread-1 (]: BigQuery adapter: Retry attempt 1 of 1 after error: BadRequest('Name datetime_id not found inside fi at [45:74]')
[0m19:32:37.445978 [error] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=uber-data-engineering-407103&j=bq:US:427153ad-9dbd-4df6-8295-6a79a63ecb4c&page=queryresults
[0m19:32:37.450473 [debug] [Thread-1 (]: Timing info for model.uber.fact_trip (execute): 19:32:35.224866 => 19:32:37.449765
[0m19:32:37.479208 [debug] [Thread-1 (]: Database Error in model fact_trip (models/transform/fact_trip.sql)
  Name datetime_id not found inside fi at [45:74]
  compiled Code at target/run/uber/models/transform/fact_trip.sql
[0m19:32:37.480140 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '25ee994c-6043-41d3-af7c-3aae04102cd6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff7cf88b10>]}
[0m19:32:37.480929 [error] [Thread-1 (]: 8 of 8 ERROR creating sql table model uber.fact_trip ........................... [[31mERROR[0m in 2.29s]
[0m19:32:37.483853 [debug] [Thread-1 (]: Finished running node model.uber.fact_trip
[0m19:32:37.492700 [debug] [MainThread]: Connection 'master' was properly closed.
[0m19:32:37.493712 [debug] [MainThread]: Connection 'model.uber.fact_trip' was properly closed.
[0m19:32:37.496814 [info ] [MainThread]: 
[0m19:32:37.499308 [info ] [MainThread]: Finished running 8 table models in 0 hours 0 minutes and 34.40 seconds (34.40s).
[0m19:32:37.504816 [debug] [MainThread]: Command end result
[0m19:32:37.549327 [info ] [MainThread]: 
[0m19:32:37.551349 [info ] [MainThread]: [31mCompleted with 1 error and 0 warnings:[0m
[0m19:32:37.552540 [info ] [MainThread]: 
[0m19:32:37.553704 [error] [MainThread]: [33mDatabase Error in model fact_trip (models/transform/fact_trip.sql)[0m
[0m19:32:37.554550 [error] [MainThread]:   Name datetime_id not found inside fi at [45:74]
[0m19:32:37.555338 [error] [MainThread]:   compiled Code at target/run/uber/models/transform/fact_trip.sql
[0m19:32:37.556337 [info ] [MainThread]: 
[0m19:32:37.559551 [info ] [MainThread]: Done. PASS=7 WARN=0 ERROR=1 SKIP=0 TOTAL=8
[0m19:32:37.564289 [debug] [MainThread]: Command `dbt run` failed at 19:32:37.563647 after 35.50 seconds
[0m19:32:37.565923 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff7cf9c310>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff7f1d3590>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff7d2ffc90>]}
[0m19:32:37.566857 [debug] [MainThread]: Flushing usage events
[0m19:33:36.235909 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff7dff45d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff7dff4b50>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff7e2f8650>]}


============================== 19:33:36.243142 | cfbdc8d3-f18a-40c6-8d0c-702ae8a8740a ==============================
[0m19:33:36.243142 [info ] [MainThread]: Running with dbt=1.5.9
[0m19:33:36.244121 [debug] [MainThread]: running dbt with arguments {'log_cache_events': 'False', 'target_path': 'None', 'profiles_dir': '/usr/local/airflow/include/dbt/', 'cache_selected_only': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'fail_fast': 'False', 'use_colors': 'True', 'static_parser': 'True', 'warn_error': 'None', 'log_path': '/usr/local/airflow/include/dbt/logs', 'indirect_selection': 'eager', 'printer_width': '80', 'log_format': 'default', 'no_print': 'None', 'debug': 'False', 'partial_parse': 'True', 'version_check': 'True', 'quiet': 'False', 'send_anonymous_usage_stats': 'True', 'introspect': 'True', 'use_experimental_parser': 'False', 'write_json': 'True'}
[0m19:33:36.786846 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'cfbdc8d3-f18a-40c6-8d0c-702ae8a8740a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff7e341390>]}
[0m19:33:36.798237 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'cfbdc8d3-f18a-40c6-8d0c-702ae8a8740a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff7bfb3650>]}
[0m19:33:36.799001 [info ] [MainThread]: Registered adapter: bigquery=1.5.3
[0m19:33:36.815019 [debug] [MainThread]: checksum: dd837546c89c9d03f3c2cb0ca6165266a30da6076d5d44e9991f7c5a8e5f5831, vars: {}, profile: , target: , version: 1.5.9
[0m19:33:36.889671 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m19:33:36.891236 [debug] [MainThread]: Partial parsing: updated file: uber://models/transform/fact_trip.sql
[0m19:33:36.914989 [debug] [MainThread]: 1699: static parser successfully parsed transform/fact_trip.sql
[0m19:33:36.925889 [error] [MainThread]: Encountered an error:
Compilation Error
  Model 'model.uber.fact_trip' (models/transform/fact_trip.sql) depends on a node named 'trip_distance_dim' which was not found
[0m19:33:36.927229 [debug] [MainThread]: Command `dbt run` failed at 19:33:36.926985 after 0.71 seconds
[0m19:33:36.927815 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff7e32c690>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff7d9866d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff7bea4950>]}
[0m19:33:36.928393 [debug] [MainThread]: Flushing usage events
[0m19:34:16.622833 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff8eb04b90>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff8ead0a90>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff8eb04b50>]}


============================== 19:34:16.832912 | f74f7b04-78ad-4198-9ccc-8c6fc597725b ==============================
[0m19:34:16.832912 [info ] [MainThread]: Running with dbt=1.5.9
[0m19:34:16.836933 [debug] [MainThread]: running dbt with arguments {'target_path': 'None', 'quiet': 'False', 'indirect_selection': 'eager', 'partial_parse': 'True', 'static_parser': 'True', 'debug': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'use_experimental_parser': 'False', 'introspect': 'True', 'printer_width': '80', 'no_print': 'None', 'warn_error': 'None', 'log_format': 'default', 'version_check': 'True', 'fail_fast': 'False', 'send_anonymous_usage_stats': 'True', 'write_json': 'True', 'use_colors': 'True', 'log_path': '/usr/local/airflow/include/dbt/logs', 'cache_selected_only': 'False', 'profiles_dir': '/usr/local/airflow/include/dbt/', 'log_cache_events': 'False'}
[0m19:34:17.567891 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'f74f7b04-78ad-4198-9ccc-8c6fc597725b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff8c763710>]}
[0m19:34:17.579696 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'f74f7b04-78ad-4198-9ccc-8c6fc597725b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff8e9b2010>]}
[0m19:34:17.580461 [info ] [MainThread]: Registered adapter: bigquery=1.5.3
[0m19:34:17.596707 [debug] [MainThread]: checksum: dd837546c89c9d03f3c2cb0ca6165266a30da6076d5d44e9991f7c5a8e5f5831, vars: {}, profile: , target: , version: 1.5.9
[0m19:34:17.731444 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m19:34:17.733582 [debug] [MainThread]: Partial parsing: updated file: uber://models/transform/fact_trip.sql
[0m19:34:17.766423 [debug] [MainThread]: 1603: static parser failed on transform/fact_trip.sql
[0m19:34:17.807217 [debug] [MainThread]: 1602: parser fallback to jinja rendering on transform/fact_trip.sql
[0m19:34:17.808432 [error] [MainThread]: Encountered an error:
Compilation Error
  Model 'model.uber.fact_trip' (models/transform/fact_trip.sql) depends on a node named 'trip_distance_dim' which was not found
[0m19:34:17.809714 [debug] [MainThread]: Command `dbt run` failed at 19:34:17.809516 after 1.23 seconds
[0m19:34:17.810344 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff8e65ff10>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff8e7cd9d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff8e728b90>]}
[0m19:34:17.811130 [debug] [MainThread]: Flushing usage events
[0m19:34:57.935344 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff80f27e10>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff8253d350>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff80f27350>]}


============================== 19:34:57.943025 | 86f56682-230a-497c-8877-ed53ef7a72b2 ==============================
[0m19:34:57.943025 [info ] [MainThread]: Running with dbt=1.5.9
[0m19:34:57.944304 [debug] [MainThread]: running dbt with arguments {'cache_selected_only': 'False', 'warn_error': 'None', 'static_parser': 'True', 'target_path': 'None', 'profiles_dir': '/usr/local/airflow/include/dbt/', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'no_print': 'None', 'partial_parse': 'True', 'write_json': 'True', 'version_check': 'True', 'log_cache_events': 'False', 'indirect_selection': 'eager', 'log_format': 'default', 'send_anonymous_usage_stats': 'True', 'use_experimental_parser': 'False', 'use_colors': 'True', 'quiet': 'False', 'debug': 'False', 'log_path': '/usr/local/airflow/include/dbt/logs', 'introspect': 'True', 'printer_width': '80', 'fail_fast': 'False'}
[0m19:34:58.432304 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '86f56682-230a-497c-8877-ed53ef7a72b2', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff80c3b790>]}
[0m19:34:58.444138 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '86f56682-230a-497c-8877-ed53ef7a72b2', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff80c07f90>]}
[0m19:34:58.444997 [info ] [MainThread]: Registered adapter: bigquery=1.5.3
[0m19:34:58.460540 [debug] [MainThread]: checksum: dd837546c89c9d03f3c2cb0ca6165266a30da6076d5d44e9991f7c5a8e5f5831, vars: {}, profile: , target: , version: 1.5.9
[0m19:34:58.544274 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m19:34:58.545429 [debug] [MainThread]: Partial parsing: updated file: uber://models/transform/fact_trip.sql
[0m19:34:58.564665 [debug] [MainThread]: 1603: static parser failed on transform/fact_trip.sql
[0m19:34:58.590663 [debug] [MainThread]: 1602: parser fallback to jinja rendering on transform/fact_trip.sql
[0m19:34:58.603854 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '86f56682-230a-497c-8877-ed53ef7a72b2', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff7eb9dc10>]}
[0m19:34:58.617107 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '86f56682-230a-497c-8877-ed53ef7a72b2', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff7ea86950>]}
[0m19:34:58.617791 [info ] [MainThread]: Found 8 models, 0 tests, 0 snapshots, 0 analyses, 474 macros, 0 operations, 0 seed files, 1 source, 0 exposures, 0 metrics, 0 groups
[0m19:34:58.618437 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '86f56682-230a-497c-8877-ed53ef7a72b2', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff83a8f790>]}
[0m19:34:58.620126 [info ] [MainThread]: 
[0m19:34:58.621106 [debug] [MainThread]: Acquiring new bigquery connection 'master'
[0m19:34:58.622715 [debug] [ThreadPool]: Acquiring new bigquery connection 'list_uber-data-engineering-407103'
[0m19:34:58.623289 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m19:34:59.103918 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_uber-data-engineering-407103, now list_uber-data-engineering-407103_uber)
[0m19:34:59.106475 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m19:34:59.566662 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '86f56682-230a-497c-8877-ed53ef7a72b2', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff81692b10>]}
[0m19:34:59.569191 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m19:34:59.570307 [info ] [MainThread]: 
[0m19:34:59.590707 [debug] [Thread-1 (]: Began running node model.uber.datetime_dim
[0m19:34:59.591652 [info ] [Thread-1 (]: 1 of 8 START sql table model uber.datetime_dim ................................. [RUN]
[0m19:34:59.592679 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_uber-data-engineering-407103_uber, now model.uber.datetime_dim)
[0m19:34:59.593275 [debug] [Thread-1 (]: Began compiling node model.uber.datetime_dim
[0m19:34:59.602658 [debug] [Thread-1 (]: Writing injected SQL for node "model.uber.datetime_dim"
[0m19:34:59.604787 [debug] [Thread-1 (]: Timing info for model.uber.datetime_dim (compile): 19:34:59.593768 => 19:34:59.604527
[0m19:34:59.605501 [debug] [Thread-1 (]: Began executing node model.uber.datetime_dim
[0m19:34:59.618911 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m19:35:00.086414 [debug] [Thread-1 (]: Writing runtime sql for node "model.uber.datetime_dim"
[0m19:35:00.089102 [debug] [Thread-1 (]: On model.uber.datetime_dim: /* {"app": "dbt", "dbt_version": "1.5.9", "profile_name": "uber", "target_name": "dev", "node_id": "model.uber.datetime_dim"} */

  
    

    create or replace table `uber-data-engineering-407103`.`uber`.`datetime_dim`
    
    

    OPTIONS()
    as (
      WITH datetime_cte AS (  
  SELECT DISTINCT 
    to_hex(md5(cast(coalesce(cast(tpep_pickup_datetime as STRING), '_dbt_utils_surrogate_key_null_') || '-' || coalesce(cast(tpep_dropoff_datetime as STRING), '_dbt_utils_surrogate_key_null_') as STRING))) AS datetime_id,
    CASE
      WHEN LENGTH(tpep_pickup_datetime) = 16 THEN
        -- Date format: "DD/MM/YYYY HH:MM"
        PARSE_DATETIME('%m/%d/%Y %H:%M', tpep_pickup_datetime)
      WHEN LENGTH(tpep_pickup_datetime) <= 14 THEN
        -- Date format: "MM/DD/YY HH:MM"
        PARSE_DATETIME('%m/%d/%y %H:%M', tpep_pickup_datetime)
      ELSE
        NULL
    END AS pick_date_part,
    tpep_dropoff_datetime AS drop_datetime_id,
    CASE
      WHEN LENGTH(tpep_dropoff_datetime) = 16 THEN
        -- Date format: "DD/MM/YYYY HH:MM"
        PARSE_DATETIME('%m/%d/%Y %H:%M', tpep_dropoff_datetime)
      WHEN LENGTH(tpep_dropoff_datetime) <= 14 THEN
        -- Date format: "MM/DD/YY HH:MM"
        PARSE_DATETIME('%m/%d/%y %H:%M', tpep_dropoff_datetime)
      ELSE
        NULL
    END AS drop_date_part
  FROM `uber-data-engineering-407103`.`uber`.`uber_tlc_trip_recrord_data`
  WHERE tpep_pickup_datetime IS NOT NULL
    AND tpep_dropoff_datetime IS NOT NULL
)
SELECT
  datetime_id,
  pick_date_part AS tpep_pickup_datetime,
  drop_date_part AS tpep_dropoff_datetime,
  EXTRACT(HOUR FROM pick_date_part) AS pick_hour,
  EXTRACT(DAY FROM pick_date_part) AS pick_day,
  EXTRACT(MONTH FROM pick_date_part) AS pick_month,
  EXTRACT(YEAR FROM pick_date_part) AS pick_year,
  EXTRACT(DAYOFWEEK FROM pick_date_part) AS pick_weekday,
  EXTRACT(HOUR FROM drop_date_part) AS drop_hour,
  EXTRACT(DAY FROM drop_date_part) AS drop_day,
  EXTRACT(MONTH FROM drop_date_part) AS drop_month,
  EXTRACT(YEAR FROM drop_date_part) AS drop_year,
  EXTRACT(DAYOFWEEK FROM drop_date_part) AS drop_weekday
FROM datetime_cte
    );
  
[0m19:35:03.166181 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=uber-data-engineering-407103&j=bq:US:9c2cd8b6-43e6-47fb-9456-4a3f4c7f403f&page=queryresults
[0m19:35:03.200252 [debug] [Thread-1 (]: Timing info for model.uber.datetime_dim (execute): 19:34:59.605955 => 19:35:03.199792
[0m19:35:03.202040 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '86f56682-230a-497c-8877-ed53ef7a72b2', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff7e9148d0>]}
[0m19:35:03.203416 [info ] [Thread-1 (]: 1 of 8 OK created sql table model uber.datetime_dim ............................ [[32mCREATE TABLE (99.9k rows, 4.0 MiB processed)[0m in 3.61s]
[0m19:35:03.204925 [debug] [Thread-1 (]: Finished running node model.uber.datetime_dim
[0m19:35:03.206235 [debug] [Thread-1 (]: Began running node model.uber.dropoff_location_dim
[0m19:35:03.207629 [info ] [Thread-1 (]: 2 of 8 START sql table model uber.dropoff_location_dim ......................... [RUN]
[0m19:35:03.208659 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.uber.datetime_dim, now model.uber.dropoff_location_dim)
[0m19:35:03.209250 [debug] [Thread-1 (]: Began compiling node model.uber.dropoff_location_dim
[0m19:35:03.217075 [debug] [Thread-1 (]: Writing injected SQL for node "model.uber.dropoff_location_dim"
[0m19:35:03.220627 [debug] [Thread-1 (]: Timing info for model.uber.dropoff_location_dim (compile): 19:35:03.209763 => 19:35:03.220446
[0m19:35:03.221181 [debug] [Thread-1 (]: Began executing node model.uber.dropoff_location_dim
[0m19:35:03.223956 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m19:35:03.704855 [debug] [Thread-1 (]: Writing runtime sql for node "model.uber.dropoff_location_dim"
[0m19:35:03.711739 [debug] [Thread-1 (]: On model.uber.dropoff_location_dim: /* {"app": "dbt", "dbt_version": "1.5.9", "profile_name": "uber", "target_name": "dev", "node_id": "model.uber.dropoff_location_dim"} */

  
    

    create or replace table `uber-data-engineering-407103`.`uber`.`dropoff_location_dim`
    
    

    OPTIONS()
    as (
      WITH numbered_rows AS (
  SELECT
    to_hex(md5(cast(coalesce(cast(dropoff_latitude as STRING), '_dbt_utils_surrogate_key_null_') || '-' || coalesce(cast(dropoff_longitude as STRING), '_dbt_utils_surrogate_key_null_') as STRING))) as dropoff_location_id,
    dropoff_latitude AS dropoff_latitude,
    dropoff_longitude AS dropoff_longitude,
    ROW_NUMBER() OVER (ORDER BY dropoff_latitude, dropoff_longitude) as row_num
  FROM `uber-data-engineering-407103`.`uber`.`uber_tlc_trip_recrord_data`
)
SELECT
  dropoff_location_id,
  dropoff_latitude,
  dropoff_longitude
FROM numbered_rows
    );
  
[0m19:35:07.044384 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=uber-data-engineering-407103&j=bq:US:551edc84-ed2b-44c2-b402-bf05b665ede1&page=queryresults
[0m19:35:07.059916 [debug] [Thread-1 (]: Timing info for model.uber.dropoff_location_dim (execute): 19:35:03.221593 => 19:35:07.059173
[0m19:35:07.064617 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '86f56682-230a-497c-8877-ed53ef7a72b2', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff7eabe710>]}
[0m19:35:07.066606 [info ] [Thread-1 (]: 2 of 8 OK created sql table model uber.dropoff_location_dim .................... [[32mCREATE TABLE (100.0k rows, 1.5 MiB processed)[0m in 3.86s]
[0m19:35:07.068700 [debug] [Thread-1 (]: Finished running node model.uber.dropoff_location_dim
[0m19:35:07.070193 [debug] [Thread-1 (]: Began running node model.uber.passenger_count_dim
[0m19:35:07.072182 [info ] [Thread-1 (]: 3 of 8 START sql table model uber.passenger_count_dim .......................... [RUN]
[0m19:35:07.074994 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.uber.dropoff_location_dim, now model.uber.passenger_count_dim)
[0m19:35:07.076500 [debug] [Thread-1 (]: Began compiling node model.uber.passenger_count_dim
[0m19:35:07.093601 [debug] [Thread-1 (]: Writing injected SQL for node "model.uber.passenger_count_dim"
[0m19:35:07.097299 [debug] [Thread-1 (]: Timing info for model.uber.passenger_count_dim (compile): 19:35:07.078138 => 19:35:07.096906
[0m19:35:07.098611 [debug] [Thread-1 (]: Began executing node model.uber.passenger_count_dim
[0m19:35:07.107287 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m19:35:07.569750 [debug] [Thread-1 (]: Writing runtime sql for node "model.uber.passenger_count_dim"
[0m19:35:07.572217 [debug] [Thread-1 (]: On model.uber.passenger_count_dim: /* {"app": "dbt", "dbt_version": "1.5.9", "profile_name": "uber", "target_name": "dev", "node_id": "model.uber.passenger_count_dim"} */

  
    

    create or replace table `uber-data-engineering-407103`.`uber`.`passenger_count_dim`
    
    

    OPTIONS()
    as (
      SELECT DISTINCT
        GENERATE_UUID() as passenger_count_id,
		passenger_count AS passenger_count,
FROM `uber-data-engineering-407103`.`uber`.`uber_tlc_trip_recrord_data`
WHERE passenger_count IS NOT NULL
    );
  
[0m19:35:10.551392 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=uber-data-engineering-407103&j=bq:US:fbfa7962-1c65-4519-92c4-664fe7f838ab&page=queryresults
[0m19:35:10.572694 [debug] [Thread-1 (]: Timing info for model.uber.passenger_count_dim (execute): 19:35:07.099343 => 19:35:10.570275
[0m19:35:10.578766 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '86f56682-230a-497c-8877-ed53ef7a72b2', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff7e9a8b50>]}
[0m19:35:10.580666 [info ] [Thread-1 (]: 3 of 8 OK created sql table model uber.passenger_count_dim ..................... [[32mCREATE TABLE (100.0k rows, 781.2 KiB processed)[0m in 3.50s]
[0m19:35:10.582644 [debug] [Thread-1 (]: Finished running node model.uber.passenger_count_dim
[0m19:35:10.583783 [debug] [Thread-1 (]: Began running node model.uber.payment_type_dim
[0m19:35:10.585253 [info ] [Thread-1 (]: 4 of 8 START sql table model uber.payment_type_dim ............................. [RUN]
[0m19:35:10.586567 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.uber.passenger_count_dim, now model.uber.payment_type_dim)
[0m19:35:10.587251 [debug] [Thread-1 (]: Began compiling node model.uber.payment_type_dim
[0m19:35:10.598525 [debug] [Thread-1 (]: Writing injected SQL for node "model.uber.payment_type_dim"
[0m19:35:10.601465 [debug] [Thread-1 (]: Timing info for model.uber.payment_type_dim (compile): 19:35:10.587761 => 19:35:10.601265
[0m19:35:10.602056 [debug] [Thread-1 (]: Began executing node model.uber.payment_type_dim
[0m19:35:10.604950 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m19:35:11.027304 [debug] [Thread-1 (]: Writing runtime sql for node "model.uber.payment_type_dim"
[0m19:35:11.032421 [debug] [Thread-1 (]: On model.uber.payment_type_dim: /* {"app": "dbt", "dbt_version": "1.5.9", "profile_name": "uber", "target_name": "dev", "node_id": "model.uber.payment_type_dim"} */

  
    

    create or replace table `uber-data-engineering-407103`.`uber`.`payment_type_dim`
    
    

    OPTIONS()
    as (
      WITH numbered_rows AS (
  SELECT
    GENERATE_UUID() as payment_type_id,
    payment_type AS payment_type,
    ROW_NUMBER() OVER (ORDER BY payment_type) as row_num
  FROM `uber-data-engineering-407103`.`uber`.`uber_tlc_trip_recrord_data`
  WHERE payment_type IS NOT NULL
)
SELECT
  payment_type_id,
  payment_type
FROM numbered_rows
    );
  
[0m19:35:14.003872 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=uber-data-engineering-407103&j=bq:US:f4099d4a-524a-466c-b809-71b8eb074705&page=queryresults
[0m19:35:14.009514 [debug] [Thread-1 (]: Timing info for model.uber.payment_type_dim (execute): 19:35:10.602531 => 19:35:14.009085
[0m19:35:14.011872 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '86f56682-230a-497c-8877-ed53ef7a72b2', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff7ea8e750>]}
[0m19:35:14.013081 [info ] [Thread-1 (]: 4 of 8 OK created sql table model uber.payment_type_dim ........................ [[32mCREATE TABLE (100.0k rows, 781.2 KiB processed)[0m in 3.43s]
[0m19:35:14.014264 [debug] [Thread-1 (]: Finished running node model.uber.payment_type_dim
[0m19:35:14.014988 [debug] [Thread-1 (]: Began running node model.uber.pickup_location_dim
[0m19:35:14.015668 [info ] [Thread-1 (]: 5 of 8 START sql table model uber.pickup_location_dim .......................... [RUN]
[0m19:35:14.017905 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.uber.payment_type_dim, now model.uber.pickup_location_dim)
[0m19:35:14.018498 [debug] [Thread-1 (]: Began compiling node model.uber.pickup_location_dim
[0m19:35:14.023354 [debug] [Thread-1 (]: Writing injected SQL for node "model.uber.pickup_location_dim"
[0m19:35:14.025293 [debug] [Thread-1 (]: Timing info for model.uber.pickup_location_dim (compile): 19:35:14.018896 => 19:35:14.025084
[0m19:35:14.025798 [debug] [Thread-1 (]: Began executing node model.uber.pickup_location_dim
[0m19:35:14.028148 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m19:35:14.482557 [debug] [Thread-1 (]: Writing runtime sql for node "model.uber.pickup_location_dim"
[0m19:35:14.486168 [debug] [Thread-1 (]: On model.uber.pickup_location_dim: /* {"app": "dbt", "dbt_version": "1.5.9", "profile_name": "uber", "target_name": "dev", "node_id": "model.uber.pickup_location_dim"} */

  
    

    create or replace table `uber-data-engineering-407103`.`uber`.`pickup_location_dim`
    
    

    OPTIONS()
    as (
      WITH numbered_rows AS (
  SELECT
    to_hex(md5(cast(coalesce(cast(pickup_latitude as STRING), '_dbt_utils_surrogate_key_null_') || '-' || coalesce(cast(pickup_longitude as STRING), '_dbt_utils_surrogate_key_null_') as STRING))) as pickup_location_id,
    pickup_latitude AS pickup_latitude,
    pickup_longitude AS pickup_longitude,
    ROW_NUMBER() OVER (ORDER BY pickup_latitude, pickup_longitude) as row_num
  FROM `uber-data-engineering-407103`.`uber`.`uber_tlc_trip_recrord_data`
)
SELECT
  pickup_location_id,
  pickup_latitude,
  pickup_longitude
FROM numbered_rows
    );
  
[0m19:35:18.418729 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=uber-data-engineering-407103&j=bq:US:cc1c6bfa-0c2c-473d-a486-95fbccaabd37&page=queryresults
[0m19:35:18.430005 [debug] [Thread-1 (]: Timing info for model.uber.pickup_location_dim (execute): 19:35:14.026202 => 19:35:18.429139
[0m19:35:18.434078 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '86f56682-230a-497c-8877-ed53ef7a72b2', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff7e887150>]}
[0m19:35:18.436280 [info ] [Thread-1 (]: 5 of 8 OK created sql table model uber.pickup_location_dim ..................... [[32mCREATE TABLE (100.0k rows, 1.5 MiB processed)[0m in 4.42s]
[0m19:35:18.438789 [debug] [Thread-1 (]: Finished running node model.uber.pickup_location_dim
[0m19:35:18.440358 [debug] [Thread-1 (]: Began running node model.uber.rate_code_dim
[0m19:35:18.442451 [info ] [Thread-1 (]: 6 of 8 START sql table model uber.rate_code_dim ................................ [RUN]
[0m19:35:18.444468 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.uber.pickup_location_dim, now model.uber.rate_code_dim)
[0m19:35:18.445344 [debug] [Thread-1 (]: Began compiling node model.uber.rate_code_dim
[0m19:35:18.452195 [debug] [Thread-1 (]: Writing injected SQL for node "model.uber.rate_code_dim"
[0m19:35:18.454427 [debug] [Thread-1 (]: Timing info for model.uber.rate_code_dim (compile): 19:35:18.445779 => 19:35:18.454242
[0m19:35:18.454884 [debug] [Thread-1 (]: Began executing node model.uber.rate_code_dim
[0m19:35:18.457699 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m19:35:18.889766 [debug] [Thread-1 (]: Writing runtime sql for node "model.uber.rate_code_dim"
[0m19:35:18.894622 [debug] [Thread-1 (]: On model.uber.rate_code_dim: /* {"app": "dbt", "dbt_version": "1.5.9", "profile_name": "uber", "target_name": "dev", "node_id": "model.uber.rate_code_dim"} */

  
    

    create or replace table `uber-data-engineering-407103`.`uber`.`rate_code_dim`
    
    

    OPTIONS()
    as (
      WITH numbered_rows AS (
  SELECT
    GENERATE_UUID() as rate_code_id,
    RatecodeID AS RatecodeID,
    ROW_NUMBER() OVER (ORDER BY RatecodeID) as row_num
  FROM `uber-data-engineering-407103`.`uber`.`uber_tlc_trip_recrord_data`
  WHERE RatecodeID IS NOT NULL
)
SELECT
  rate_code_id,
  RatecodeID
FROM numbered_rows
    );
  
[0m19:35:22.073481 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=uber-data-engineering-407103&j=bq:US:9bf30641-0dbc-441d-8aab-786ebe649b44&page=queryresults
[0m19:35:22.083307 [debug] [Thread-1 (]: Timing info for model.uber.rate_code_dim (execute): 19:35:18.455280 => 19:35:22.082780
[0m19:35:22.085787 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '86f56682-230a-497c-8877-ed53ef7a72b2', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff7e886b90>]}
[0m19:35:22.087365 [info ] [Thread-1 (]: 6 of 8 OK created sql table model uber.rate_code_dim ........................... [[32mCREATE TABLE (100.0k rows, 781.2 KiB processed)[0m in 3.64s]
[0m19:35:22.089130 [debug] [Thread-1 (]: Finished running node model.uber.rate_code_dim
[0m19:35:22.090872 [debug] [Thread-1 (]: Began running node model.uber.trip_distance
[0m19:35:22.092226 [info ] [Thread-1 (]: 7 of 8 START sql table model uber.trip_distance ................................ [RUN]
[0m19:35:22.093307 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.uber.rate_code_dim, now model.uber.trip_distance)
[0m19:35:22.093958 [debug] [Thread-1 (]: Began compiling node model.uber.trip_distance
[0m19:35:22.100872 [debug] [Thread-1 (]: Writing injected SQL for node "model.uber.trip_distance"
[0m19:35:22.103703 [debug] [Thread-1 (]: Timing info for model.uber.trip_distance (compile): 19:35:22.094453 => 19:35:22.103526
[0m19:35:22.104498 [debug] [Thread-1 (]: Began executing node model.uber.trip_distance
[0m19:35:22.106969 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m19:35:23.036374 [debug] [Thread-1 (]: Writing runtime sql for node "model.uber.trip_distance"
[0m19:35:23.043226 [debug] [Thread-1 (]: On model.uber.trip_distance: /* {"app": "dbt", "dbt_version": "1.5.9", "profile_name": "uber", "target_name": "dev", "node_id": "model.uber.trip_distance"} */

  
    

    create or replace table `uber-data-engineering-407103`.`uber`.`trip_distance`
    
    

    OPTIONS()
    as (
      WITH numbered_rows AS (
  SELECT
    GENERATE_UUID() as trip_distance_id,
    trip_distance AS trip_distance,
    ROW_NUMBER() OVER (ORDER BY trip_distance) as row_num
  FROM `uber-data-engineering-407103`.`uber`.`uber_tlc_trip_recrord_data`
  WHERE trip_distance IS NOT NULL
)
SELECT
  trip_distance_id,
  trip_distance
FROM numbered_rows
    );
  
[0m19:35:25.644948 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=uber-data-engineering-407103&j=bq:US:b2a2e986-5399-4dc1-a536-a8a949df2e84&page=queryresults
[0m19:35:25.650635 [debug] [Thread-1 (]: Timing info for model.uber.trip_distance (execute): 19:35:22.104922 => 19:35:25.650196
[0m19:35:25.652150 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '86f56682-230a-497c-8877-ed53ef7a72b2', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff7ea0d790>]}
[0m19:35:25.653436 [info ] [Thread-1 (]: 7 of 8 OK created sql table model uber.trip_distance ........................... [[32mCREATE TABLE (100.0k rows, 781.2 KiB processed)[0m in 3.56s]
[0m19:35:25.654877 [debug] [Thread-1 (]: Finished running node model.uber.trip_distance
[0m19:35:25.657257 [debug] [Thread-1 (]: Began running node model.uber.fact_trip
[0m19:35:25.658067 [info ] [Thread-1 (]: 8 of 8 START sql table model uber.fact_trip .................................... [RUN]
[0m19:35:25.659211 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.uber.trip_distance, now model.uber.fact_trip)
[0m19:35:25.659807 [debug] [Thread-1 (]: Began compiling node model.uber.fact_trip
[0m19:35:25.671445 [debug] [Thread-1 (]: Writing injected SQL for node "model.uber.fact_trip"
[0m19:35:25.674197 [debug] [Thread-1 (]: Timing info for model.uber.fact_trip (compile): 19:35:25.660299 => 19:35:25.673987
[0m19:35:25.674716 [debug] [Thread-1 (]: Began executing node model.uber.fact_trip
[0m19:35:25.677838 [debug] [Thread-1 (]: Writing runtime sql for node "model.uber.fact_trip"
[0m19:35:25.679354 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m19:35:25.682236 [debug] [Thread-1 (]: On model.uber.fact_trip: /* {"app": "dbt", "dbt_version": "1.5.9", "profile_name": "uber", "target_name": "dev", "node_id": "model.uber.fact_trip"} */

  
    

    create or replace table `uber-data-engineering-407103`.`uber`.`fact_trip`
    
    

    OPTIONS()
    as (
      WITH fct_invoices_cte AS (
    SELECT
        CAST(ROW_NUMBER() OVER () AS INT64) as trip_id,
        VendorID,
        to_hex(md5(cast(coalesce(cast(tpep_pickup_datetime as STRING), '_dbt_utils_surrogate_key_null_') || '-' || coalesce(cast(tpep_dropoff_datetime as STRING), '_dbt_utils_surrogate_key_null_') as STRING))) AS datetime_id,
        passenger_count_id,
        trip_distance_id,
        rate_code_id,
        store_and_fwd_flag,
        pickup_location_id,
        to_hex(md5(cast(coalesce(cast(dropoff_latitude as STRING), '_dbt_utils_surrogate_key_null_') || '-' || coalesce(cast(dropoff_longitude as STRING), '_dbt_utils_surrogate_key_null_') as STRING))) as dropoff_location_id,
        payment_type_id,
        fare_amount,
        extra,
        mta_tax,
        tip_amount,
        tolls_amount,
        improvement_surcharge,
        total_amount
    FROM `uber-data-engineering-407103`.`uber`.`uber_tlc_trip_recrord_data`
)
SELECT
    trip_id,
    VendorID,
    datetime_id,
    do.dropoff_location_id,
    pu.pickup_location_id,
    pc.passenger_count_id,
    pt.payment_type_id,
    rc.rate_code_id,
    store_and_fwd_flag,
    td.trip_distance_id,
    fare_amount,
    extra,
    mta_tax,
    tip_amount,
    tolls_amount,
    improvement_surcharge AS improvement_surcharge_amount,  -- Added alias
    total_amount
FROM fct_invoices_cte fi
INNER JOIN `uber-data-engineering-407103`.`uber`.`datetime_dim` dt ON fi.datetime_id = dt.datetime_id
INNER JOIN `uber-data-engineering-407103`.`uber`.`dropoff_location_dim` do ON fi.dropoff_location_id = do.dropoff_location_id
INNER JOIN `uber-data-engineering-407103`.`uber`.`pickup_location_dim` pu ON fi.pickup_location_id = pu.pickup_location_id
INNER JOIN `uber-data-engineering-407103`.`uber`.`passenger_count_dim` pc ON fi.passenger_count_id = pc.passenger_count_id
INNER JOIN `uber-data-engineering-407103`.`uber`.`payment_type_dim` pt ON fi.payment_type_id = pt.payment_type_id
INNER JOIN `uber-data-engineering-407103`.`uber`.`rate_code_dim` rc ON fi.rate_code_id = rc.rate_code_id
INNER JOIN `uber-data-engineering-407103`.`uber`.`trip_distance` td ON fi.trip_distance_id = td.trip_distance_id;
    );
  
[0m19:35:26.179955 [debug] [Thread-1 (]: BigQuery adapter: Retry attempt 1 of 1 after error: BadRequest('Syntax error: Expected ")" but got ";" at [58:113]')
[0m19:35:27.131695 [error] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=uber-data-engineering-407103&j=bq:US:dff87cfe-06c0-4b17-af5c-3a45befdee22&page=queryresults
[0m19:35:27.136867 [debug] [Thread-1 (]: Timing info for model.uber.fact_trip (execute): 19:35:25.675228 => 19:35:27.136166
[0m19:35:27.158868 [debug] [Thread-1 (]: Database Error in model fact_trip (models/transform/fact_trip.sql)
  Syntax error: Expected ")" but got ";" at [58:113]
  compiled Code at target/run/uber/models/transform/fact_trip.sql
[0m19:35:27.160317 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '86f56682-230a-497c-8877-ed53ef7a72b2', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff7e9c65d0>]}
[0m19:35:27.161296 [error] [Thread-1 (]: 8 of 8 ERROR creating sql table model uber.fact_trip ........................... [[31mERROR[0m in 1.50s]
[0m19:35:27.162071 [debug] [Thread-1 (]: Finished running node model.uber.fact_trip
[0m19:35:27.165740 [debug] [MainThread]: Connection 'master' was properly closed.
[0m19:35:27.166483 [debug] [MainThread]: Connection 'model.uber.fact_trip' was properly closed.
[0m19:35:27.167427 [info ] [MainThread]: 
[0m19:35:27.169284 [info ] [MainThread]: Finished running 8 table models in 0 hours 0 minutes and 28.55 seconds (28.55s).
[0m19:35:27.172320 [debug] [MainThread]: Command end result
[0m19:35:27.194524 [info ] [MainThread]: 
[0m19:35:27.195672 [info ] [MainThread]: [31mCompleted with 1 error and 0 warnings:[0m
[0m19:35:27.196539 [info ] [MainThread]: 
[0m19:35:27.197317 [error] [MainThread]: [33mDatabase Error in model fact_trip (models/transform/fact_trip.sql)[0m
[0m19:35:27.197891 [error] [MainThread]:   Syntax error: Expected ")" but got ";" at [58:113]
[0m19:35:27.198491 [error] [MainThread]:   compiled Code at target/run/uber/models/transform/fact_trip.sql
[0m19:35:27.199202 [info ] [MainThread]: 
[0m19:35:27.200040 [info ] [MainThread]: Done. PASS=7 WARN=0 ERROR=1 SKIP=0 TOTAL=8
[0m19:35:27.202227 [debug] [MainThread]: Command `dbt run` failed at 19:35:27.201717 after 29.28 seconds
[0m19:35:27.203936 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff80dd8e50>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff80edb5d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff7eb63dd0>]}
[0m19:35:27.204744 [debug] [MainThread]: Flushing usage events
[0m19:35:46.394875 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffa3b08a10>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffa50c5550>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffa3b09050>]}


============================== 19:35:46.399955 | 78795724-d183-4ba1-93ab-f4ed0c82c239 ==============================
[0m19:35:46.399955 [info ] [MainThread]: Running with dbt=1.5.9
[0m19:35:46.400830 [debug] [MainThread]: running dbt with arguments {'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'printer_width': '80', 'log_format': 'default', 'log_path': '/usr/local/airflow/include/dbt/logs', 'static_parser': 'True', 'use_colors': 'True', 'indirect_selection': 'eager', 'version_check': 'True', 'fail_fast': 'False', 'warn_error': 'None', 'log_cache_events': 'False', 'no_print': 'None', 'debug': 'False', 'target_path': 'None', 'write_json': 'True', 'use_experimental_parser': 'False', 'cache_selected_only': 'False', 'quiet': 'False', 'send_anonymous_usage_stats': 'True', 'introspect': 'True', 'profiles_dir': '/usr/local/airflow/include/dbt/', 'partial_parse': 'True'}
[0m19:35:46.810631 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '78795724-d183-4ba1-93ab-f4ed0c82c239', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffa18dced0>]}
[0m19:35:46.823649 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '78795724-d183-4ba1-93ab-f4ed0c82c239', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffa18dd590>]}
[0m19:35:46.825123 [info ] [MainThread]: Registered adapter: bigquery=1.5.3
[0m19:35:46.849176 [debug] [MainThread]: checksum: dd837546c89c9d03f3c2cb0ca6165266a30da6076d5d44e9991f7c5a8e5f5831, vars: {}, profile: , target: , version: 1.5.9
[0m19:35:46.964877 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m19:35:46.965682 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m19:35:46.973263 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '78795724-d183-4ba1-93ab-f4ed0c82c239', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffa1654ad0>]}
[0m19:35:46.997491 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '78795724-d183-4ba1-93ab-f4ed0c82c239', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffa173b990>]}
[0m19:35:46.998871 [info ] [MainThread]: Found 8 models, 0 tests, 0 snapshots, 0 analyses, 474 macros, 0 operations, 0 seed files, 1 source, 0 exposures, 0 metrics, 0 groups
[0m19:35:47.000112 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '78795724-d183-4ba1-93ab-f4ed0c82c239', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffa67fb6d0>]}
[0m19:35:47.003657 [info ] [MainThread]: 
[0m19:35:47.005181 [debug] [MainThread]: Acquiring new bigquery connection 'master'
[0m19:35:47.007292 [debug] [ThreadPool]: Acquiring new bigquery connection 'list_uber-data-engineering-407103'
[0m19:35:47.007947 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m19:35:47.777279 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_uber-data-engineering-407103, now list_uber-data-engineering-407103_uber)
[0m19:35:47.789197 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m19:35:48.243366 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '78795724-d183-4ba1-93ab-f4ed0c82c239', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffa190a390>]}
[0m19:35:48.245596 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m19:35:48.247006 [info ] [MainThread]: 
[0m19:35:48.289657 [debug] [Thread-1 (]: Began running node model.uber.datetime_dim
[0m19:35:48.292033 [info ] [Thread-1 (]: 1 of 8 START sql table model uber.datetime_dim ................................. [RUN]
[0m19:35:48.294472 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_uber-data-engineering-407103_uber, now model.uber.datetime_dim)
[0m19:35:48.295673 [debug] [Thread-1 (]: Began compiling node model.uber.datetime_dim
[0m19:35:48.337360 [debug] [Thread-1 (]: Writing injected SQL for node "model.uber.datetime_dim"
[0m19:35:48.340777 [debug] [Thread-1 (]: Timing info for model.uber.datetime_dim (compile): 19:35:48.296900 => 19:35:48.340296
[0m19:35:48.341480 [debug] [Thread-1 (]: Began executing node model.uber.datetime_dim
[0m19:35:48.365058 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m19:35:48.883119 [debug] [Thread-1 (]: Writing runtime sql for node "model.uber.datetime_dim"
[0m19:35:48.886469 [debug] [Thread-1 (]: On model.uber.datetime_dim: /* {"app": "dbt", "dbt_version": "1.5.9", "profile_name": "uber", "target_name": "dev", "node_id": "model.uber.datetime_dim"} */

  
    

    create or replace table `uber-data-engineering-407103`.`uber`.`datetime_dim`
    
    

    OPTIONS()
    as (
      WITH datetime_cte AS (  
  SELECT DISTINCT 
    to_hex(md5(cast(coalesce(cast(tpep_pickup_datetime as STRING), '_dbt_utils_surrogate_key_null_') || '-' || coalesce(cast(tpep_dropoff_datetime as STRING), '_dbt_utils_surrogate_key_null_') as STRING))) AS datetime_id,
    CASE
      WHEN LENGTH(tpep_pickup_datetime) = 16 THEN
        -- Date format: "DD/MM/YYYY HH:MM"
        PARSE_DATETIME('%m/%d/%Y %H:%M', tpep_pickup_datetime)
      WHEN LENGTH(tpep_pickup_datetime) <= 14 THEN
        -- Date format: "MM/DD/YY HH:MM"
        PARSE_DATETIME('%m/%d/%y %H:%M', tpep_pickup_datetime)
      ELSE
        NULL
    END AS pick_date_part,
    tpep_dropoff_datetime AS drop_datetime_id,
    CASE
      WHEN LENGTH(tpep_dropoff_datetime) = 16 THEN
        -- Date format: "DD/MM/YYYY HH:MM"
        PARSE_DATETIME('%m/%d/%Y %H:%M', tpep_dropoff_datetime)
      WHEN LENGTH(tpep_dropoff_datetime) <= 14 THEN
        -- Date format: "MM/DD/YY HH:MM"
        PARSE_DATETIME('%m/%d/%y %H:%M', tpep_dropoff_datetime)
      ELSE
        NULL
    END AS drop_date_part
  FROM `uber-data-engineering-407103`.`uber`.`uber_tlc_trip_recrord_data`
  WHERE tpep_pickup_datetime IS NOT NULL
    AND tpep_dropoff_datetime IS NOT NULL
)
SELECT
  datetime_id,
  pick_date_part AS tpep_pickup_datetime,
  drop_date_part AS tpep_dropoff_datetime,
  EXTRACT(HOUR FROM pick_date_part) AS pick_hour,
  EXTRACT(DAY FROM pick_date_part) AS pick_day,
  EXTRACT(MONTH FROM pick_date_part) AS pick_month,
  EXTRACT(YEAR FROM pick_date_part) AS pick_year,
  EXTRACT(DAYOFWEEK FROM pick_date_part) AS pick_weekday,
  EXTRACT(HOUR FROM drop_date_part) AS drop_hour,
  EXTRACT(DAY FROM drop_date_part) AS drop_day,
  EXTRACT(MONTH FROM drop_date_part) AS drop_month,
  EXTRACT(YEAR FROM drop_date_part) AS drop_year,
  EXTRACT(DAYOFWEEK FROM drop_date_part) AS drop_weekday
FROM datetime_cte
    );
  
[0m19:35:52.085791 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=uber-data-engineering-407103&j=bq:US:2c2e71a0-18d4-4432-9815-88b92009f34c&page=queryresults
[0m19:35:52.126313 [debug] [Thread-1 (]: Timing info for model.uber.datetime_dim (execute): 19:35:48.342005 => 19:35:52.125970
[0m19:35:52.128585 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '78795724-d183-4ba1-93ab-f4ed0c82c239', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffa1901050>]}
[0m19:35:52.130032 [info ] [Thread-1 (]: 1 of 8 OK created sql table model uber.datetime_dim ............................ [[32mCREATE TABLE (99.9k rows, 4.0 MiB processed)[0m in 3.83s]
[0m19:35:52.131903 [debug] [Thread-1 (]: Finished running node model.uber.datetime_dim
[0m19:35:52.132991 [debug] [Thread-1 (]: Began running node model.uber.dropoff_location_dim
[0m19:35:52.134178 [info ] [Thread-1 (]: 2 of 8 START sql table model uber.dropoff_location_dim ......................... [RUN]
[0m19:35:52.135605 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.uber.datetime_dim, now model.uber.dropoff_location_dim)
[0m19:35:52.136232 [debug] [Thread-1 (]: Began compiling node model.uber.dropoff_location_dim
[0m19:35:52.143480 [debug] [Thread-1 (]: Writing injected SQL for node "model.uber.dropoff_location_dim"
[0m19:35:52.146329 [debug] [Thread-1 (]: Timing info for model.uber.dropoff_location_dim (compile): 19:35:52.136731 => 19:35:52.146122
[0m19:35:52.146959 [debug] [Thread-1 (]: Began executing node model.uber.dropoff_location_dim
[0m19:35:52.149652 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m19:35:52.706576 [debug] [Thread-1 (]: Writing runtime sql for node "model.uber.dropoff_location_dim"
[0m19:35:52.713493 [debug] [Thread-1 (]: On model.uber.dropoff_location_dim: /* {"app": "dbt", "dbt_version": "1.5.9", "profile_name": "uber", "target_name": "dev", "node_id": "model.uber.dropoff_location_dim"} */

  
    

    create or replace table `uber-data-engineering-407103`.`uber`.`dropoff_location_dim`
    
    

    OPTIONS()
    as (
      WITH numbered_rows AS (
  SELECT
    to_hex(md5(cast(coalesce(cast(dropoff_latitude as STRING), '_dbt_utils_surrogate_key_null_') || '-' || coalesce(cast(dropoff_longitude as STRING), '_dbt_utils_surrogate_key_null_') as STRING))) as dropoff_location_id,
    dropoff_latitude AS dropoff_latitude,
    dropoff_longitude AS dropoff_longitude,
    ROW_NUMBER() OVER (ORDER BY dropoff_latitude, dropoff_longitude) as row_num
  FROM `uber-data-engineering-407103`.`uber`.`uber_tlc_trip_recrord_data`
)
SELECT
  dropoff_location_id,
  dropoff_latitude,
  dropoff_longitude
FROM numbered_rows
    );
  
[0m19:35:56.372205 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=uber-data-engineering-407103&j=bq:US:8eda2fdd-daf5-48bc-93d7-c81c83f7921d&page=queryresults
[0m19:35:56.395029 [debug] [Thread-1 (]: Timing info for model.uber.dropoff_location_dim (execute): 19:35:52.147403 => 19:35:56.394435
[0m19:35:56.397731 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '78795724-d183-4ba1-93ab-f4ed0c82c239', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffa18fa450>]}
[0m19:35:56.399644 [info ] [Thread-1 (]: 2 of 8 OK created sql table model uber.dropoff_location_dim .................... [[32mCREATE TABLE (100.0k rows, 1.5 MiB processed)[0m in 4.26s]
[0m19:35:56.401734 [debug] [Thread-1 (]: Finished running node model.uber.dropoff_location_dim
[0m19:35:56.402926 [debug] [Thread-1 (]: Began running node model.uber.passenger_count_dim
[0m19:35:56.404434 [info ] [Thread-1 (]: 3 of 8 START sql table model uber.passenger_count_dim .......................... [RUN]
[0m19:35:56.405619 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.uber.dropoff_location_dim, now model.uber.passenger_count_dim)
[0m19:35:56.406326 [debug] [Thread-1 (]: Began compiling node model.uber.passenger_count_dim
[0m19:35:56.413926 [debug] [Thread-1 (]: Writing injected SQL for node "model.uber.passenger_count_dim"
[0m19:35:56.416504 [debug] [Thread-1 (]: Timing info for model.uber.passenger_count_dim (compile): 19:35:56.406854 => 19:35:56.416309
[0m19:35:56.417248 [debug] [Thread-1 (]: Began executing node model.uber.passenger_count_dim
[0m19:35:56.420040 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m19:35:56.926034 [debug] [Thread-1 (]: Writing runtime sql for node "model.uber.passenger_count_dim"
[0m19:35:56.931853 [debug] [Thread-1 (]: On model.uber.passenger_count_dim: /* {"app": "dbt", "dbt_version": "1.5.9", "profile_name": "uber", "target_name": "dev", "node_id": "model.uber.passenger_count_dim"} */

  
    

    create or replace table `uber-data-engineering-407103`.`uber`.`passenger_count_dim`
    
    

    OPTIONS()
    as (
      SELECT DISTINCT
        GENERATE_UUID() as passenger_count_id,
		passenger_count AS passenger_count,
FROM `uber-data-engineering-407103`.`uber`.`uber_tlc_trip_recrord_data`
WHERE passenger_count IS NOT NULL
    );
  
[0m19:35:59.728672 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=uber-data-engineering-407103&j=bq:US:ee70ca41-03a2-491a-aed7-998e8f8ab322&page=queryresults
[0m19:35:59.749712 [debug] [Thread-1 (]: Timing info for model.uber.passenger_count_dim (execute): 19:35:56.417706 => 19:35:59.749039
[0m19:35:59.753180 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '78795724-d183-4ba1-93ab-f4ed0c82c239', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffa18d26d0>]}
[0m19:35:59.756169 [info ] [Thread-1 (]: 3 of 8 OK created sql table model uber.passenger_count_dim ..................... [[32mCREATE TABLE (100.0k rows, 781.2 KiB processed)[0m in 3.35s]
[0m19:35:59.758889 [debug] [Thread-1 (]: Finished running node model.uber.passenger_count_dim
[0m19:35:59.760912 [debug] [Thread-1 (]: Began running node model.uber.payment_type_dim
[0m19:35:59.762904 [info ] [Thread-1 (]: 4 of 8 START sql table model uber.payment_type_dim ............................. [RUN]
[0m19:35:59.764877 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.uber.passenger_count_dim, now model.uber.payment_type_dim)
[0m19:35:59.765948 [debug] [Thread-1 (]: Began compiling node model.uber.payment_type_dim
[0m19:35:59.781958 [debug] [Thread-1 (]: Writing injected SQL for node "model.uber.payment_type_dim"
[0m19:35:59.789198 [debug] [Thread-1 (]: Timing info for model.uber.payment_type_dim (compile): 19:35:59.766526 => 19:35:59.788051
[0m19:35:59.790771 [debug] [Thread-1 (]: Began executing node model.uber.payment_type_dim
[0m19:35:59.813712 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m19:36:00.336341 [debug] [Thread-1 (]: Writing runtime sql for node "model.uber.payment_type_dim"
[0m19:36:00.342278 [debug] [Thread-1 (]: On model.uber.payment_type_dim: /* {"app": "dbt", "dbt_version": "1.5.9", "profile_name": "uber", "target_name": "dev", "node_id": "model.uber.payment_type_dim"} */

  
    

    create or replace table `uber-data-engineering-407103`.`uber`.`payment_type_dim`
    
    

    OPTIONS()
    as (
      WITH numbered_rows AS (
  SELECT
    GENERATE_UUID() as payment_type_id,
    payment_type AS payment_type,
    ROW_NUMBER() OVER (ORDER BY payment_type) as row_num
  FROM `uber-data-engineering-407103`.`uber`.`uber_tlc_trip_recrord_data`
  WHERE payment_type IS NOT NULL
)
SELECT
  payment_type_id,
  payment_type
FROM numbered_rows
    );
  
[0m19:36:02.901456 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=uber-data-engineering-407103&j=bq:US:c8cbd615-5e56-4d0b-af6c-41f21ada0c2e&page=queryresults
[0m19:36:02.911518 [debug] [Thread-1 (]: Timing info for model.uber.payment_type_dim (execute): 19:35:59.792235 => 19:36:02.910837
[0m19:36:02.915103 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '78795724-d183-4ba1-93ab-f4ed0c82c239', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffa18b2a90>]}
[0m19:36:02.917571 [info ] [Thread-1 (]: 4 of 8 OK created sql table model uber.payment_type_dim ........................ [[32mCREATE TABLE (100.0k rows, 781.2 KiB processed)[0m in 3.15s]
[0m19:36:02.920011 [debug] [Thread-1 (]: Finished running node model.uber.payment_type_dim
[0m19:36:02.921616 [debug] [Thread-1 (]: Began running node model.uber.pickup_location_dim
[0m19:36:02.922850 [info ] [Thread-1 (]: 5 of 8 START sql table model uber.pickup_location_dim .......................... [RUN]
[0m19:36:02.925287 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.uber.payment_type_dim, now model.uber.pickup_location_dim)
[0m19:36:02.926667 [debug] [Thread-1 (]: Began compiling node model.uber.pickup_location_dim
[0m19:36:02.931808 [debug] [Thread-1 (]: Writing injected SQL for node "model.uber.pickup_location_dim"
[0m19:36:02.933932 [debug] [Thread-1 (]: Timing info for model.uber.pickup_location_dim (compile): 19:36:02.927144 => 19:36:02.933751
[0m19:36:02.934460 [debug] [Thread-1 (]: Began executing node model.uber.pickup_location_dim
[0m19:36:02.937472 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m19:36:03.529026 [debug] [Thread-1 (]: Writing runtime sql for node "model.uber.pickup_location_dim"
[0m19:36:03.533790 [debug] [Thread-1 (]: On model.uber.pickup_location_dim: /* {"app": "dbt", "dbt_version": "1.5.9", "profile_name": "uber", "target_name": "dev", "node_id": "model.uber.pickup_location_dim"} */

  
    

    create or replace table `uber-data-engineering-407103`.`uber`.`pickup_location_dim`
    
    

    OPTIONS()
    as (
      WITH numbered_rows AS (
  SELECT
    to_hex(md5(cast(coalesce(cast(pickup_latitude as STRING), '_dbt_utils_surrogate_key_null_') || '-' || coalesce(cast(pickup_longitude as STRING), '_dbt_utils_surrogate_key_null_') as STRING))) as pickup_location_id,
    pickup_latitude AS pickup_latitude,
    pickup_longitude AS pickup_longitude,
    ROW_NUMBER() OVER (ORDER BY pickup_latitude, pickup_longitude) as row_num
  FROM `uber-data-engineering-407103`.`uber`.`uber_tlc_trip_recrord_data`
)
SELECT
  pickup_location_id,
  pickup_latitude,
  pickup_longitude
FROM numbered_rows
    );
  
[0m19:36:07.557789 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=uber-data-engineering-407103&j=bq:US:b7b714c8-d67c-44f4-af32-96c554635dda&page=queryresults
[0m19:36:07.574315 [debug] [Thread-1 (]: Timing info for model.uber.pickup_location_dim (execute): 19:36:02.934875 => 19:36:07.573657
[0m19:36:07.577032 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '78795724-d183-4ba1-93ab-f4ed0c82c239', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffa15b1e50>]}
[0m19:36:07.578797 [info ] [Thread-1 (]: 5 of 8 OK created sql table model uber.pickup_location_dim ..................... [[32mCREATE TABLE (100.0k rows, 1.5 MiB processed)[0m in 4.65s]
[0m19:36:07.580478 [debug] [Thread-1 (]: Finished running node model.uber.pickup_location_dim
[0m19:36:07.581937 [debug] [Thread-1 (]: Began running node model.uber.rate_code_dim
[0m19:36:07.586568 [info ] [Thread-1 (]: 6 of 8 START sql table model uber.rate_code_dim ................................ [RUN]
[0m19:36:07.588255 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.uber.pickup_location_dim, now model.uber.rate_code_dim)
[0m19:36:07.589492 [debug] [Thread-1 (]: Began compiling node model.uber.rate_code_dim
[0m19:36:07.613114 [debug] [Thread-1 (]: Writing injected SQL for node "model.uber.rate_code_dim"
[0m19:36:07.617631 [debug] [Thread-1 (]: Timing info for model.uber.rate_code_dim (compile): 19:36:07.590086 => 19:36:07.617054
[0m19:36:07.618552 [debug] [Thread-1 (]: Began executing node model.uber.rate_code_dim
[0m19:36:07.623298 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m19:36:08.176377 [debug] [Thread-1 (]: Writing runtime sql for node "model.uber.rate_code_dim"
[0m19:36:08.181294 [debug] [Thread-1 (]: On model.uber.rate_code_dim: /* {"app": "dbt", "dbt_version": "1.5.9", "profile_name": "uber", "target_name": "dev", "node_id": "model.uber.rate_code_dim"} */

  
    

    create or replace table `uber-data-engineering-407103`.`uber`.`rate_code_dim`
    
    

    OPTIONS()
    as (
      WITH numbered_rows AS (
  SELECT
    GENERATE_UUID() as rate_code_id,
    RatecodeID AS RatecodeID,
    ROW_NUMBER() OVER (ORDER BY RatecodeID) as row_num
  FROM `uber-data-engineering-407103`.`uber`.`uber_tlc_trip_recrord_data`
  WHERE RatecodeID IS NOT NULL
)
SELECT
  rate_code_id,
  RatecodeID
FROM numbered_rows
    );
  
[0m19:36:10.982665 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=uber-data-engineering-407103&j=bq:US:b57fd242-b89d-47fe-8dad-1a82ce64fdb2&page=queryresults
[0m19:36:11.001850 [debug] [Thread-1 (]: Timing info for model.uber.rate_code_dim (execute): 19:36:07.619277 => 19:36:11.000801
[0m19:36:11.004910 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '78795724-d183-4ba1-93ab-f4ed0c82c239', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffa17afa90>]}
[0m19:36:11.006807 [info ] [Thread-1 (]: 6 of 8 OK created sql table model uber.rate_code_dim ........................... [[32mCREATE TABLE (100.0k rows, 781.2 KiB processed)[0m in 3.42s]
[0m19:36:11.008467 [debug] [Thread-1 (]: Finished running node model.uber.rate_code_dim
[0m19:36:11.010130 [debug] [Thread-1 (]: Began running node model.uber.trip_distance
[0m19:36:11.011599 [info ] [Thread-1 (]: 7 of 8 START sql table model uber.trip_distance ................................ [RUN]
[0m19:36:11.012839 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.uber.rate_code_dim, now model.uber.trip_distance)
[0m19:36:11.013517 [debug] [Thread-1 (]: Began compiling node model.uber.trip_distance
[0m19:36:11.021433 [debug] [Thread-1 (]: Writing injected SQL for node "model.uber.trip_distance"
[0m19:36:11.024179 [debug] [Thread-1 (]: Timing info for model.uber.trip_distance (compile): 19:36:11.014023 => 19:36:11.024009
[0m19:36:11.024959 [debug] [Thread-1 (]: Began executing node model.uber.trip_distance
[0m19:36:11.028273 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m19:36:11.610334 [debug] [Thread-1 (]: Writing runtime sql for node "model.uber.trip_distance"
[0m19:36:11.616831 [debug] [Thread-1 (]: On model.uber.trip_distance: /* {"app": "dbt", "dbt_version": "1.5.9", "profile_name": "uber", "target_name": "dev", "node_id": "model.uber.trip_distance"} */

  
    

    create or replace table `uber-data-engineering-407103`.`uber`.`trip_distance`
    
    

    OPTIONS()
    as (
      WITH numbered_rows AS (
  SELECT
    GENERATE_UUID() as trip_distance_id,
    trip_distance AS trip_distance,
    ROW_NUMBER() OVER (ORDER BY trip_distance) as row_num
  FROM `uber-data-engineering-407103`.`uber`.`uber_tlc_trip_recrord_data`
  WHERE trip_distance IS NOT NULL
)
SELECT
  trip_distance_id,
  trip_distance
FROM numbered_rows
    );
  
[0m19:36:14.832142 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=uber-data-engineering-407103&j=bq:US:5e0871b9-cab2-4c3f-9c5d-6cb6fa1a80df&page=queryresults
[0m19:36:14.840297 [debug] [Thread-1 (]: Timing info for model.uber.trip_distance (execute): 19:36:11.025405 => 19:36:14.839677
[0m19:36:14.842782 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '78795724-d183-4ba1-93ab-f4ed0c82c239', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffa1915050>]}
[0m19:36:14.843979 [info ] [Thread-1 (]: 7 of 8 OK created sql table model uber.trip_distance ........................... [[32mCREATE TABLE (100.0k rows, 781.2 KiB processed)[0m in 3.83s]
[0m19:36:14.845479 [debug] [Thread-1 (]: Finished running node model.uber.trip_distance
[0m19:36:14.848411 [debug] [Thread-1 (]: Began running node model.uber.fact_trip
[0m19:36:14.849112 [info ] [Thread-1 (]: 8 of 8 START sql table model uber.fact_trip .................................... [RUN]
[0m19:36:14.850559 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.uber.trip_distance, now model.uber.fact_trip)
[0m19:36:14.851362 [debug] [Thread-1 (]: Began compiling node model.uber.fact_trip
[0m19:36:14.864141 [debug] [Thread-1 (]: Writing injected SQL for node "model.uber.fact_trip"
[0m19:36:14.866944 [debug] [Thread-1 (]: Timing info for model.uber.fact_trip (compile): 19:36:14.852012 => 19:36:14.866715
[0m19:36:14.867600 [debug] [Thread-1 (]: Began executing node model.uber.fact_trip
[0m19:36:14.870890 [debug] [Thread-1 (]: Writing runtime sql for node "model.uber.fact_trip"
[0m19:36:14.872782 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m19:36:14.875898 [debug] [Thread-1 (]: On model.uber.fact_trip: /* {"app": "dbt", "dbt_version": "1.5.9", "profile_name": "uber", "target_name": "dev", "node_id": "model.uber.fact_trip"} */

  
    

    create or replace table `uber-data-engineering-407103`.`uber`.`fact_trip`
    
    

    OPTIONS()
    as (
      WITH fct_invoices_cte AS (
    SELECT
        CAST(ROW_NUMBER() OVER () AS INT64) as trip_id,
        VendorID,
        to_hex(md5(cast(coalesce(cast(tpep_pickup_datetime as STRING), '_dbt_utils_surrogate_key_null_') || '-' || coalesce(cast(tpep_dropoff_datetime as STRING), '_dbt_utils_surrogate_key_null_') as STRING))) AS datetime_id,
        passenger_count_id,
        trip_distance_id,
        rate_code_id,
        store_and_fwd_flag,
        pickup_location_id,
        to_hex(md5(cast(coalesce(cast(dropoff_latitude as STRING), '_dbt_utils_surrogate_key_null_') || '-' || coalesce(cast(dropoff_longitude as STRING), '_dbt_utils_surrogate_key_null_') as STRING))) as dropoff_location_id,
        payment_type_id,
        fare_amount,
        extra,
        mta_tax,
        tip_amount,
        tolls_amount,
        improvement_surcharge,
        total_amount
    FROM `uber-data-engineering-407103`.`uber`.`uber_tlc_trip_recrord_data`
)
SELECT
    trip_id,
    VendorID,
    datetime_id,
    do.dropoff_location_id,
    pu.pickup_location_id,
    pc.passenger_count_id,
    pt.payment_type_id,
    rc.rate_code_id,
    store_and_fwd_flag,
    td.trip_distance_id,
    fare_amount,
    extra,
    mta_tax,
    tip_amount,
    tolls_amount,
    improvement_surcharge AS improvement_surcharge_amount,  -- Added alias
    total_amount
FROM fct_invoices_cte fi
INNER JOIN `uber-data-engineering-407103`.`uber`.`datetime_dim` dt ON fi.datetime_id = dt.datetime_id
INNER JOIN `uber-data-engineering-407103`.`uber`.`dropoff_location_dim` do ON fi.dropoff_location_id = do.dropoff_location_id
INNER JOIN `uber-data-engineering-407103`.`uber`.`pickup_location_dim` pu ON fi.pickup_location_id = pu.pickup_location_id
INNER JOIN `uber-data-engineering-407103`.`uber`.`passenger_count_dim` pc ON fi.passenger_count_id = pc.passenger_count_id
INNER JOIN `uber-data-engineering-407103`.`uber`.`payment_type_dim` pt ON fi.payment_type_id = pt.payment_type_id
INNER JOIN `uber-data-engineering-407103`.`uber`.`rate_code_dim` rc ON fi.rate_code_id = rc.rate_code_id
INNER JOIN `uber-data-engineering-407103`.`uber`.`trip_distance` td ON fi.trip_distance_id = td.trip_distance_id;
    );
  
[0m19:36:15.328484 [debug] [Thread-1 (]: BigQuery adapter: Retry attempt 1 of 1 after error: BadRequest('Syntax error: Expected ")" but got ";" at [58:113]')
[0m19:36:16.151704 [error] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=uber-data-engineering-407103&j=bq:US:5d15354d-1317-4589-9191-82cbb5ceeb2f&page=queryresults
[0m19:36:16.156889 [debug] [Thread-1 (]: Timing info for model.uber.fact_trip (execute): 19:36:14.868052 => 19:36:16.156301
[0m19:36:16.176159 [debug] [Thread-1 (]: Database Error in model fact_trip (models/transform/fact_trip.sql)
  Syntax error: Expected ")" but got ";" at [58:113]
  compiled Code at target/run/uber/models/transform/fact_trip.sql
[0m19:36:16.177138 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '78795724-d183-4ba1-93ab-f4ed0c82c239', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffa15778d0>]}
[0m19:36:16.177929 [error] [Thread-1 (]: 8 of 8 ERROR creating sql table model uber.fact_trip ........................... [[31mERROR[0m in 1.33s]
[0m19:36:16.178871 [debug] [Thread-1 (]: Finished running node model.uber.fact_trip
[0m19:36:16.182444 [debug] [MainThread]: Connection 'master' was properly closed.
[0m19:36:16.183268 [debug] [MainThread]: Connection 'model.uber.fact_trip' was properly closed.
[0m19:36:16.184044 [info ] [MainThread]: 
[0m19:36:16.184897 [info ] [MainThread]: Finished running 8 table models in 0 hours 0 minutes and 29.18 seconds (29.18s).
[0m19:36:16.187674 [debug] [MainThread]: Command end result
[0m19:36:16.231764 [info ] [MainThread]: 
[0m19:36:16.232816 [info ] [MainThread]: [31mCompleted with 1 error and 0 warnings:[0m
[0m19:36:16.233531 [info ] [MainThread]: 
[0m19:36:16.234177 [error] [MainThread]: [33mDatabase Error in model fact_trip (models/transform/fact_trip.sql)[0m
[0m19:36:16.234820 [error] [MainThread]:   Syntax error: Expected ")" but got ";" at [58:113]
[0m19:36:16.235506 [error] [MainThread]:   compiled Code at target/run/uber/models/transform/fact_trip.sql
[0m19:36:16.236055 [info ] [MainThread]: 
[0m19:36:16.236829 [info ] [MainThread]: Done. PASS=7 WARN=0 ERROR=1 SKIP=0 TOTAL=8
[0m19:36:16.239037 [debug] [MainThread]: Command `dbt run` failed at 19:36:16.238743 after 29.85 seconds
[0m19:36:16.240930 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffa394d250>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffa77a62d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffa7943b90>]}
[0m19:36:16.242319 [debug] [MainThread]: Flushing usage events
[0m19:36:28.642580 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff9da23510>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff9da04b50>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff9d970bd0>]}


============================== 19:36:28.648181 | f7e9d30c-7d75-4cef-898a-fe961d48f196 ==============================
[0m19:36:28.648181 [info ] [MainThread]: Running with dbt=1.5.9
[0m19:36:28.649563 [debug] [MainThread]: running dbt with arguments {'version_check': 'True', 'printer_width': '80', 'write_json': 'True', 'indirect_selection': 'eager', 'log_path': '/usr/local/airflow/include/dbt/logs', 'log_format': 'default', 'target_path': 'None', 'use_colors': 'True', 'warn_error': 'None', 'introspect': 'True', 'log_cache_events': 'False', 'profiles_dir': '/usr/local/airflow/include/dbt/', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'cache_selected_only': 'False', 'static_parser': 'True', 'debug': 'False', 'send_anonymous_usage_stats': 'True', 'no_print': 'None', 'partial_parse': 'True', 'quiet': 'False', 'fail_fast': 'False', 'use_experimental_parser': 'False'}
[0m19:36:29.062712 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'f7e9d30c-7d75-4cef-898a-fe961d48f196', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff9b6973d0>]}
[0m19:36:29.074493 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'f7e9d30c-7d75-4cef-898a-fe961d48f196', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff9c4d0510>]}
[0m19:36:29.075579 [info ] [MainThread]: Registered adapter: bigquery=1.5.3
[0m19:36:29.093596 [debug] [MainThread]: checksum: dd837546c89c9d03f3c2cb0ca6165266a30da6076d5d44e9991f7c5a8e5f5831, vars: {}, profile: , target: , version: 1.5.9
[0m19:36:29.189264 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m19:36:29.190504 [debug] [MainThread]: Partial parsing: updated file: uber://models/transform/fact_trip.sql
[0m19:36:29.210243 [debug] [MainThread]: 1603: static parser failed on transform/fact_trip.sql
[0m19:36:29.235850 [debug] [MainThread]: 1602: parser fallback to jinja rendering on transform/fact_trip.sql
[0m19:36:29.248501 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'f7e9d30c-7d75-4cef-898a-fe961d48f196', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff9b4dcc90>]}
[0m19:36:29.260676 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'f7e9d30c-7d75-4cef-898a-fe961d48f196', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff9b5900d0>]}
[0m19:36:29.261362 [info ] [MainThread]: Found 8 models, 0 tests, 0 snapshots, 0 analyses, 474 macros, 0 operations, 0 seed files, 1 source, 0 exposures, 0 metrics, 0 groups
[0m19:36:29.262039 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'f7e9d30c-7d75-4cef-898a-fe961d48f196', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffa0583a10>]}
[0m19:36:29.263733 [info ] [MainThread]: 
[0m19:36:29.264720 [debug] [MainThread]: Acquiring new bigquery connection 'master'
[0m19:36:29.266212 [debug] [ThreadPool]: Acquiring new bigquery connection 'list_uber-data-engineering-407103'
[0m19:36:29.266753 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m19:36:29.776141 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_uber-data-engineering-407103, now list_uber-data-engineering-407103_uber)
[0m19:36:29.777628 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m19:36:30.276693 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'f7e9d30c-7d75-4cef-898a-fe961d48f196', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff9d17e390>]}
[0m19:36:30.280843 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m19:36:30.281924 [info ] [MainThread]: 
[0m19:36:30.302051 [debug] [Thread-1 (]: Began running node model.uber.datetime_dim
[0m19:36:30.303137 [info ] [Thread-1 (]: 1 of 8 START sql table model uber.datetime_dim ................................. [RUN]
[0m19:36:30.304369 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_uber-data-engineering-407103_uber, now model.uber.datetime_dim)
[0m19:36:30.304994 [debug] [Thread-1 (]: Began compiling node model.uber.datetime_dim
[0m19:36:30.339785 [debug] [Thread-1 (]: Writing injected SQL for node "model.uber.datetime_dim"
[0m19:36:30.365053 [debug] [Thread-1 (]: Timing info for model.uber.datetime_dim (compile): 19:36:30.305589 => 19:36:30.352764
[0m19:36:30.375170 [debug] [Thread-1 (]: Began executing node model.uber.datetime_dim
[0m19:36:30.392667 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m19:36:30.890481 [debug] [Thread-1 (]: Writing runtime sql for node "model.uber.datetime_dim"
[0m19:36:30.892873 [debug] [Thread-1 (]: On model.uber.datetime_dim: /* {"app": "dbt", "dbt_version": "1.5.9", "profile_name": "uber", "target_name": "dev", "node_id": "model.uber.datetime_dim"} */

  
    

    create or replace table `uber-data-engineering-407103`.`uber`.`datetime_dim`
    
    

    OPTIONS()
    as (
      WITH datetime_cte AS (  
  SELECT DISTINCT 
    to_hex(md5(cast(coalesce(cast(tpep_pickup_datetime as STRING), '_dbt_utils_surrogate_key_null_') || '-' || coalesce(cast(tpep_dropoff_datetime as STRING), '_dbt_utils_surrogate_key_null_') as STRING))) AS datetime_id,
    CASE
      WHEN LENGTH(tpep_pickup_datetime) = 16 THEN
        -- Date format: "DD/MM/YYYY HH:MM"
        PARSE_DATETIME('%m/%d/%Y %H:%M', tpep_pickup_datetime)
      WHEN LENGTH(tpep_pickup_datetime) <= 14 THEN
        -- Date format: "MM/DD/YY HH:MM"
        PARSE_DATETIME('%m/%d/%y %H:%M', tpep_pickup_datetime)
      ELSE
        NULL
    END AS pick_date_part,
    tpep_dropoff_datetime AS drop_datetime_id,
    CASE
      WHEN LENGTH(tpep_dropoff_datetime) = 16 THEN
        -- Date format: "DD/MM/YYYY HH:MM"
        PARSE_DATETIME('%m/%d/%Y %H:%M', tpep_dropoff_datetime)
      WHEN LENGTH(tpep_dropoff_datetime) <= 14 THEN
        -- Date format: "MM/DD/YY HH:MM"
        PARSE_DATETIME('%m/%d/%y %H:%M', tpep_dropoff_datetime)
      ELSE
        NULL
    END AS drop_date_part
  FROM `uber-data-engineering-407103`.`uber`.`uber_tlc_trip_recrord_data`
  WHERE tpep_pickup_datetime IS NOT NULL
    AND tpep_dropoff_datetime IS NOT NULL
)
SELECT
  datetime_id,
  pick_date_part AS tpep_pickup_datetime,
  drop_date_part AS tpep_dropoff_datetime,
  EXTRACT(HOUR FROM pick_date_part) AS pick_hour,
  EXTRACT(DAY FROM pick_date_part) AS pick_day,
  EXTRACT(MONTH FROM pick_date_part) AS pick_month,
  EXTRACT(YEAR FROM pick_date_part) AS pick_year,
  EXTRACT(DAYOFWEEK FROM pick_date_part) AS pick_weekday,
  EXTRACT(HOUR FROM drop_date_part) AS drop_hour,
  EXTRACT(DAY FROM drop_date_part) AS drop_day,
  EXTRACT(MONTH FROM drop_date_part) AS drop_month,
  EXTRACT(YEAR FROM drop_date_part) AS drop_year,
  EXTRACT(DAYOFWEEK FROM drop_date_part) AS drop_weekday
FROM datetime_cte
    );
  
[0m19:36:34.383385 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=uber-data-engineering-407103&j=bq:US:a3b4fd52-968a-48ea-b0a8-c3d3bc046df8&page=queryresults
[0m19:36:34.432849 [debug] [Thread-1 (]: Timing info for model.uber.datetime_dim (execute): 19:36:30.376239 => 19:36:34.429114
[0m19:36:34.437772 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'f7e9d30c-7d75-4cef-898a-fe961d48f196', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff9b590e10>]}
[0m19:36:34.441824 [info ] [Thread-1 (]: 1 of 8 OK created sql table model uber.datetime_dim ............................ [[32mCREATE TABLE (99.9k rows, 4.0 MiB processed)[0m in 4.13s]
[0m19:36:34.447398 [debug] [Thread-1 (]: Finished running node model.uber.datetime_dim
[0m19:36:34.448726 [debug] [Thread-1 (]: Began running node model.uber.dropoff_location_dim
[0m19:36:34.450202 [info ] [Thread-1 (]: 2 of 8 START sql table model uber.dropoff_location_dim ......................... [RUN]
[0m19:36:34.451522 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.uber.datetime_dim, now model.uber.dropoff_location_dim)
[0m19:36:34.452146 [debug] [Thread-1 (]: Began compiling node model.uber.dropoff_location_dim
[0m19:36:34.461068 [debug] [Thread-1 (]: Writing injected SQL for node "model.uber.dropoff_location_dim"
[0m19:36:34.464374 [debug] [Thread-1 (]: Timing info for model.uber.dropoff_location_dim (compile): 19:36:34.452630 => 19:36:34.463979
[0m19:36:34.465136 [debug] [Thread-1 (]: Began executing node model.uber.dropoff_location_dim
[0m19:36:34.469180 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m19:36:35.005619 [debug] [Thread-1 (]: Writing runtime sql for node "model.uber.dropoff_location_dim"
[0m19:36:35.009946 [debug] [Thread-1 (]: On model.uber.dropoff_location_dim: /* {"app": "dbt", "dbt_version": "1.5.9", "profile_name": "uber", "target_name": "dev", "node_id": "model.uber.dropoff_location_dim"} */

  
    

    create or replace table `uber-data-engineering-407103`.`uber`.`dropoff_location_dim`
    
    

    OPTIONS()
    as (
      WITH numbered_rows AS (
  SELECT
    to_hex(md5(cast(coalesce(cast(dropoff_latitude as STRING), '_dbt_utils_surrogate_key_null_') || '-' || coalesce(cast(dropoff_longitude as STRING), '_dbt_utils_surrogate_key_null_') as STRING))) as dropoff_location_id,
    dropoff_latitude AS dropoff_latitude,
    dropoff_longitude AS dropoff_longitude,
    ROW_NUMBER() OVER (ORDER BY dropoff_latitude, dropoff_longitude) as row_num
  FROM `uber-data-engineering-407103`.`uber`.`uber_tlc_trip_recrord_data`
)
SELECT
  dropoff_location_id,
  dropoff_latitude,
  dropoff_longitude
FROM numbered_rows
    );
  
[0m19:36:38.576225 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=uber-data-engineering-407103&j=bq:US:9973dbaf-747a-4ba7-be26-2cb135451177&page=queryresults
[0m19:36:38.590795 [debug] [Thread-1 (]: Timing info for model.uber.dropoff_location_dim (execute): 19:36:34.465739 => 19:36:38.590317
[0m19:36:38.593188 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'f7e9d30c-7d75-4cef-898a-fe961d48f196', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff9b4f4290>]}
[0m19:36:38.594917 [info ] [Thread-1 (]: 2 of 8 OK created sql table model uber.dropoff_location_dim .................... [[32mCREATE TABLE (100.0k rows, 1.5 MiB processed)[0m in 4.14s]
[0m19:36:38.596722 [debug] [Thread-1 (]: Finished running node model.uber.dropoff_location_dim
[0m19:36:38.598385 [debug] [Thread-1 (]: Began running node model.uber.passenger_count_dim
[0m19:36:38.600096 [info ] [Thread-1 (]: 3 of 8 START sql table model uber.passenger_count_dim .......................... [RUN]
[0m19:36:38.601280 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.uber.dropoff_location_dim, now model.uber.passenger_count_dim)
[0m19:36:38.601970 [debug] [Thread-1 (]: Began compiling node model.uber.passenger_count_dim
[0m19:36:38.609395 [debug] [Thread-1 (]: Writing injected SQL for node "model.uber.passenger_count_dim"
[0m19:36:38.611691 [debug] [Thread-1 (]: Timing info for model.uber.passenger_count_dim (compile): 19:36:38.602469 => 19:36:38.611521
[0m19:36:38.612438 [debug] [Thread-1 (]: Began executing node model.uber.passenger_count_dim
[0m19:36:38.615156 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m19:36:39.222541 [debug] [Thread-1 (]: Writing runtime sql for node "model.uber.passenger_count_dim"
[0m19:36:39.224846 [debug] [Thread-1 (]: On model.uber.passenger_count_dim: /* {"app": "dbt", "dbt_version": "1.5.9", "profile_name": "uber", "target_name": "dev", "node_id": "model.uber.passenger_count_dim"} */

  
    

    create or replace table `uber-data-engineering-407103`.`uber`.`passenger_count_dim`
    
    

    OPTIONS()
    as (
      SELECT DISTINCT
        GENERATE_UUID() as passenger_count_id,
		passenger_count AS passenger_count,
FROM `uber-data-engineering-407103`.`uber`.`uber_tlc_trip_recrord_data`
WHERE passenger_count IS NOT NULL
    );
  
[0m19:36:42.166670 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=uber-data-engineering-407103&j=bq:US:d8706e05-0c71-4710-9b73-83d2f2a31de7&page=queryresults
[0m19:36:42.186970 [debug] [Thread-1 (]: Timing info for model.uber.passenger_count_dim (execute): 19:36:38.612869 => 19:36:42.186398
[0m19:36:42.190794 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'f7e9d30c-7d75-4cef-898a-fe961d48f196', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff9b587f50>]}
[0m19:36:42.193765 [info ] [Thread-1 (]: 3 of 8 OK created sql table model uber.passenger_count_dim ..................... [[32mCREATE TABLE (100.0k rows, 781.2 KiB processed)[0m in 3.59s]
[0m19:36:42.196469 [debug] [Thread-1 (]: Finished running node model.uber.passenger_count_dim
[0m19:36:42.198353 [debug] [Thread-1 (]: Began running node model.uber.payment_type_dim
[0m19:36:42.200488 [info ] [Thread-1 (]: 4 of 8 START sql table model uber.payment_type_dim ............................. [RUN]
[0m19:36:42.201747 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.uber.passenger_count_dim, now model.uber.payment_type_dim)
[0m19:36:42.202376 [debug] [Thread-1 (]: Began compiling node model.uber.payment_type_dim
[0m19:36:42.216927 [debug] [Thread-1 (]: Writing injected SQL for node "model.uber.payment_type_dim"
[0m19:36:42.219497 [debug] [Thread-1 (]: Timing info for model.uber.payment_type_dim (compile): 19:36:42.202746 => 19:36:42.219287
[0m19:36:42.219977 [debug] [Thread-1 (]: Began executing node model.uber.payment_type_dim
[0m19:36:42.223060 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m19:36:42.727864 [debug] [Thread-1 (]: Writing runtime sql for node "model.uber.payment_type_dim"
[0m19:36:42.730827 [debug] [Thread-1 (]: On model.uber.payment_type_dim: /* {"app": "dbt", "dbt_version": "1.5.9", "profile_name": "uber", "target_name": "dev", "node_id": "model.uber.payment_type_dim"} */

  
    

    create or replace table `uber-data-engineering-407103`.`uber`.`payment_type_dim`
    
    

    OPTIONS()
    as (
      WITH numbered_rows AS (
  SELECT
    GENERATE_UUID() as payment_type_id,
    payment_type AS payment_type,
    ROW_NUMBER() OVER (ORDER BY payment_type) as row_num
  FROM `uber-data-engineering-407103`.`uber`.`uber_tlc_trip_recrord_data`
  WHERE payment_type IS NOT NULL
)
SELECT
  payment_type_id,
  payment_type
FROM numbered_rows
    );
  
[0m19:36:45.541372 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=uber-data-engineering-407103&j=bq:US:45fad46b-2830-45ab-93e6-4a9bb35c6db3&page=queryresults
[0m19:36:45.553035 [debug] [Thread-1 (]: Timing info for model.uber.payment_type_dim (execute): 19:36:42.220550 => 19:36:45.552327
[0m19:36:45.555672 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'f7e9d30c-7d75-4cef-898a-fe961d48f196', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff9b348d90>]}
[0m19:36:45.557577 [info ] [Thread-1 (]: 4 of 8 OK created sql table model uber.payment_type_dim ........................ [[32mCREATE TABLE (100.0k rows, 781.2 KiB processed)[0m in 3.35s]
[0m19:36:45.559849 [debug] [Thread-1 (]: Finished running node model.uber.payment_type_dim
[0m19:36:45.561612 [debug] [Thread-1 (]: Began running node model.uber.pickup_location_dim
[0m19:36:45.563149 [info ] [Thread-1 (]: 5 of 8 START sql table model uber.pickup_location_dim .......................... [RUN]
[0m19:36:45.564432 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.uber.payment_type_dim, now model.uber.pickup_location_dim)
[0m19:36:45.565020 [debug] [Thread-1 (]: Began compiling node model.uber.pickup_location_dim
[0m19:36:45.572101 [debug] [Thread-1 (]: Writing injected SQL for node "model.uber.pickup_location_dim"
[0m19:36:45.574081 [debug] [Thread-1 (]: Timing info for model.uber.pickup_location_dim (compile): 19:36:45.565428 => 19:36:45.573860
[0m19:36:45.574588 [debug] [Thread-1 (]: Began executing node model.uber.pickup_location_dim
[0m19:36:45.577360 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m19:36:46.003614 [debug] [Thread-1 (]: Writing runtime sql for node "model.uber.pickup_location_dim"
[0m19:36:46.006158 [debug] [Thread-1 (]: On model.uber.pickup_location_dim: /* {"app": "dbt", "dbt_version": "1.5.9", "profile_name": "uber", "target_name": "dev", "node_id": "model.uber.pickup_location_dim"} */

  
    

    create or replace table `uber-data-engineering-407103`.`uber`.`pickup_location_dim`
    
    

    OPTIONS()
    as (
      WITH numbered_rows AS (
  SELECT
    to_hex(md5(cast(coalesce(cast(pickup_latitude as STRING), '_dbt_utils_surrogate_key_null_') || '-' || coalesce(cast(pickup_longitude as STRING), '_dbt_utils_surrogate_key_null_') as STRING))) as pickup_location_id,
    pickup_latitude AS pickup_latitude,
    pickup_longitude AS pickup_longitude,
    ROW_NUMBER() OVER (ORDER BY pickup_latitude, pickup_longitude) as row_num
  FROM `uber-data-engineering-407103`.`uber`.`uber_tlc_trip_recrord_data`
)
SELECT
  pickup_location_id,
  pickup_latitude,
  pickup_longitude
FROM numbered_rows
    );
  
[0m19:36:49.102650 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=uber-data-engineering-407103&j=bq:US:413159eb-d1f9-4236-bd79-bc0c3ceb4fb8&page=queryresults
[0m19:36:49.107896 [debug] [Thread-1 (]: Timing info for model.uber.pickup_location_dim (execute): 19:36:45.574950 => 19:36:49.107615
[0m19:36:49.109160 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'f7e9d30c-7d75-4cef-898a-fe961d48f196', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff9b38df90>]}
[0m19:36:49.110132 [info ] [Thread-1 (]: 5 of 8 OK created sql table model uber.pickup_location_dim ..................... [[32mCREATE TABLE (100.0k rows, 1.5 MiB processed)[0m in 3.55s]
[0m19:36:49.111803 [debug] [Thread-1 (]: Finished running node model.uber.pickup_location_dim
[0m19:36:49.112647 [debug] [Thread-1 (]: Began running node model.uber.rate_code_dim
[0m19:36:49.113654 [info ] [Thread-1 (]: 6 of 8 START sql table model uber.rate_code_dim ................................ [RUN]
[0m19:36:49.114782 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.uber.pickup_location_dim, now model.uber.rate_code_dim)
[0m19:36:49.115410 [debug] [Thread-1 (]: Began compiling node model.uber.rate_code_dim
[0m19:36:49.121071 [debug] [Thread-1 (]: Writing injected SQL for node "model.uber.rate_code_dim"
[0m19:36:49.123742 [debug] [Thread-1 (]: Timing info for model.uber.rate_code_dim (compile): 19:36:49.115897 => 19:36:49.123476
[0m19:36:49.124388 [debug] [Thread-1 (]: Began executing node model.uber.rate_code_dim
[0m19:36:49.128089 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m19:36:49.645764 [debug] [Thread-1 (]: Writing runtime sql for node "model.uber.rate_code_dim"
[0m19:36:49.652576 [debug] [Thread-1 (]: On model.uber.rate_code_dim: /* {"app": "dbt", "dbt_version": "1.5.9", "profile_name": "uber", "target_name": "dev", "node_id": "model.uber.rate_code_dim"} */

  
    

    create or replace table `uber-data-engineering-407103`.`uber`.`rate_code_dim`
    
    

    OPTIONS()
    as (
      WITH numbered_rows AS (
  SELECT
    GENERATE_UUID() as rate_code_id,
    RatecodeID AS RatecodeID,
    ROW_NUMBER() OVER (ORDER BY RatecodeID) as row_num
  FROM `uber-data-engineering-407103`.`uber`.`uber_tlc_trip_recrord_data`
  WHERE RatecodeID IS NOT NULL
)
SELECT
  rate_code_id,
  RatecodeID
FROM numbered_rows
    );
  
[0m19:36:52.254227 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=uber-data-engineering-407103&j=bq:US:75e8780d-8819-4ab2-b097-23ae995f2350&page=queryresults
[0m19:36:52.262971 [debug] [Thread-1 (]: Timing info for model.uber.rate_code_dim (execute): 19:36:49.124774 => 19:36:52.262448
[0m19:36:52.265534 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'f7e9d30c-7d75-4cef-898a-fe961d48f196', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff9b4bf810>]}
[0m19:36:52.267594 [info ] [Thread-1 (]: 6 of 8 OK created sql table model uber.rate_code_dim ........................... [[32mCREATE TABLE (100.0k rows, 781.2 KiB processed)[0m in 3.15s]
[0m19:36:52.269802 [debug] [Thread-1 (]: Finished running node model.uber.rate_code_dim
[0m19:36:52.272197 [debug] [Thread-1 (]: Began running node model.uber.trip_distance
[0m19:36:52.273712 [info ] [Thread-1 (]: 7 of 8 START sql table model uber.trip_distance ................................ [RUN]
[0m19:36:52.275727 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.uber.rate_code_dim, now model.uber.trip_distance)
[0m19:36:52.277042 [debug] [Thread-1 (]: Began compiling node model.uber.trip_distance
[0m19:36:52.280390 [debug] [Thread-1 (]: Writing injected SQL for node "model.uber.trip_distance"
[0m19:36:52.284048 [debug] [Thread-1 (]: Timing info for model.uber.trip_distance (compile): 19:36:52.277676 => 19:36:52.283715
[0m19:36:52.285425 [debug] [Thread-1 (]: Began executing node model.uber.trip_distance
[0m19:36:52.287505 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m19:36:53.023286 [debug] [Thread-1 (]: Writing runtime sql for node "model.uber.trip_distance"
[0m19:36:53.025603 [debug] [Thread-1 (]: On model.uber.trip_distance: /* {"app": "dbt", "dbt_version": "1.5.9", "profile_name": "uber", "target_name": "dev", "node_id": "model.uber.trip_distance"} */

  
    

    create or replace table `uber-data-engineering-407103`.`uber`.`trip_distance`
    
    

    OPTIONS()
    as (
      WITH numbered_rows AS (
  SELECT
    GENERATE_UUID() as trip_distance_id,
    trip_distance AS trip_distance,
    ROW_NUMBER() OVER (ORDER BY trip_distance) as row_num
  FROM `uber-data-engineering-407103`.`uber`.`uber_tlc_trip_recrord_data`
  WHERE trip_distance IS NOT NULL
)
SELECT
  trip_distance_id,
  trip_distance
FROM numbered_rows
    );
  
[0m19:36:55.827990 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=uber-data-engineering-407103&j=bq:US:83bf2f9f-a725-4818-8185-b3be36e13c57&page=queryresults
[0m19:36:55.841077 [debug] [Thread-1 (]: Timing info for model.uber.trip_distance (execute): 19:36:52.285857 => 19:36:55.840574
[0m19:36:55.843584 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'f7e9d30c-7d75-4cef-898a-fe961d48f196', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff9d17d610>]}
[0m19:36:55.845402 [info ] [Thread-1 (]: 7 of 8 OK created sql table model uber.trip_distance ........................... [[32mCREATE TABLE (100.0k rows, 781.2 KiB processed)[0m in 3.57s]
[0m19:36:55.847300 [debug] [Thread-1 (]: Finished running node model.uber.trip_distance
[0m19:36:55.850532 [debug] [Thread-1 (]: Began running node model.uber.fact_trip
[0m19:36:55.851347 [info ] [Thread-1 (]: 8 of 8 START sql table model uber.fact_trip .................................... [RUN]
[0m19:36:55.852595 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.uber.trip_distance, now model.uber.fact_trip)
[0m19:36:55.853278 [debug] [Thread-1 (]: Began compiling node model.uber.fact_trip
[0m19:36:55.870641 [debug] [Thread-1 (]: Writing injected SQL for node "model.uber.fact_trip"
[0m19:36:55.873351 [debug] [Thread-1 (]: Timing info for model.uber.fact_trip (compile): 19:36:55.853753 => 19:36:55.873119
[0m19:36:55.873916 [debug] [Thread-1 (]: Began executing node model.uber.fact_trip
[0m19:36:55.883425 [debug] [Thread-1 (]: Writing runtime sql for node "model.uber.fact_trip"
[0m19:36:55.902999 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m19:36:55.916919 [debug] [Thread-1 (]: On model.uber.fact_trip: /* {"app": "dbt", "dbt_version": "1.5.9", "profile_name": "uber", "target_name": "dev", "node_id": "model.uber.fact_trip"} */

  
    

    create or replace table `uber-data-engineering-407103`.`uber`.`fact_trip`
    
    

    OPTIONS()
    as (
      WITH fct_invoices_cte AS (
    SELECT
        CAST(ROW_NUMBER() OVER () AS INT64) as trip_id,
        VendorID,
        to_hex(md5(cast(coalesce(cast(tpep_pickup_datetime as STRING), '_dbt_utils_surrogate_key_null_') || '-' || coalesce(cast(tpep_dropoff_datetime as STRING), '_dbt_utils_surrogate_key_null_') as STRING))) AS datetime_id,
        passenger_count_id,
        trip_distance_id,
        rate_code_id,
        store_and_fwd_flag,
        pickup_location_id,
        to_hex(md5(cast(coalesce(cast(dropoff_latitude as STRING), '_dbt_utils_surrogate_key_null_') || '-' || coalesce(cast(dropoff_longitude as STRING), '_dbt_utils_surrogate_key_null_') as STRING))) as dropoff_location_id,
        payment_type_id,
        fare_amount,
        extra,
        mta_tax,
        tip_amount,
        tolls_amount,
        improvement_surcharge,
        total_amount
    FROM `uber-data-engineering-407103`.`uber`.`uber_tlc_trip_recrord_data`
)
SELECT
    trip_id,
    VendorID,
    datetime_id,
    do.dropoff_location_id,
    pu.pickup_location_id,
    pc.passenger_count_id,
    pt.payment_type_id,
    rc.rate_code_id,
    store_and_fwd_flag,
    td.trip_distance_id,
    fare_amount,
    extra,
    mta_tax,
    tip_amount,
    tolls_amount,
    improvement_surcharge AS improvement_surcharge_amount,  -- Added alias
    total_amount
FROM fct_invoices_cte fi
INNER JOIN `uber-data-engineering-407103`.`uber`.`datetime_dim` dt ON fi.datetime_id = dt.datetime_id
INNER JOIN `uber-data-engineering-407103`.`uber`.`dropoff_location_dim` do ON fi.dropoff_location_id = do.dropoff_location_id
INNER JOIN `uber-data-engineering-407103`.`uber`.`pickup_location_dim` pu ON fi.pickup_location_id = pu.pickup_location_id
INNER JOIN `uber-data-engineering-407103`.`uber`.`passenger_count_dim` pc ON fi.passenger_count_id = pc.passenger_count_id
INNER JOIN `uber-data-engineering-407103`.`uber`.`payment_type_dim` pt ON fi.payment_type_id = pt.payment_type_id
INNER JOIN `uber-data-engineering-407103`.`uber`.`rate_code_dim` rc ON fi.rate_code_id = rc.rate_code_id
INNER JOIN `uber-data-engineering-407103`.`uber`.`trip_distance` td ON fi.trip_distance_id = td.trip_distance_id
    );
  
[0m19:36:57.056352 [debug] [Thread-1 (]: BigQuery adapter: Retry attempt 1 of 1 after error: BadRequest('Unrecognized name: passenger_count_id; Did you mean passenger_count? at [17:9]')
[0m19:36:58.058754 [error] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=uber-data-engineering-407103&j=bq:US:bf4bbc7f-be98-459b-af7a-76873302b2f0&page=queryresults
[0m19:36:58.069627 [debug] [Thread-1 (]: Timing info for model.uber.fact_trip (execute): 19:36:55.874367 => 19:36:58.067975
[0m19:36:58.085858 [debug] [Thread-1 (]: Database Error in model fact_trip (models/transform/fact_trip.sql)
  Unrecognized name: passenger_count_id; Did you mean passenger_count? at [17:9]
  compiled Code at target/run/uber/models/transform/fact_trip.sql
[0m19:36:58.087079 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'f7e9d30c-7d75-4cef-898a-fe961d48f196', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff9b5a3d50>]}
[0m19:36:58.088392 [error] [Thread-1 (]: 8 of 8 ERROR creating sql table model uber.fact_trip ........................... [[31mERROR[0m in 2.23s]
[0m19:36:58.089392 [debug] [Thread-1 (]: Finished running node model.uber.fact_trip
[0m19:36:58.093156 [debug] [MainThread]: Connection 'master' was properly closed.
[0m19:36:58.093781 [debug] [MainThread]: Connection 'model.uber.fact_trip' was properly closed.
[0m19:36:58.094576 [info ] [MainThread]: 
[0m19:36:58.095495 [info ] [MainThread]: Finished running 8 table models in 0 hours 0 minutes and 28.83 seconds (28.83s).
[0m19:36:58.098421 [debug] [MainThread]: Command end result
[0m19:36:58.158242 [info ] [MainThread]: 
[0m19:36:58.159637 [info ] [MainThread]: [31mCompleted with 1 error and 0 warnings:[0m
[0m19:36:58.160454 [info ] [MainThread]: 
[0m19:36:58.161483 [error] [MainThread]: [33mDatabase Error in model fact_trip (models/transform/fact_trip.sql)[0m
[0m19:36:58.162306 [error] [MainThread]:   Unrecognized name: passenger_count_id; Did you mean passenger_count? at [17:9]
[0m19:36:58.164692 [error] [MainThread]:   compiled Code at target/run/uber/models/transform/fact_trip.sql
[0m19:36:58.166775 [info ] [MainThread]: 
[0m19:36:58.168433 [info ] [MainThread]: Done. PASS=7 WARN=0 ERROR=1 SKIP=0 TOTAL=8
[0m19:36:58.170920 [debug] [MainThread]: Command `dbt run` failed at 19:36:58.170570 after 29.54 seconds
[0m19:36:58.172526 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff9d8e3290>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff9d8cf990>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff9b553bd0>]}
[0m19:36:58.173663 [debug] [MainThread]: Flushing usage events
[0m19:38:30.209994 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffb8d9b1d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffb8c2da50>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffb8a64090>]}


============================== 19:38:30.215375 | fd5413e5-26dc-4c62-b597-4461beb1dc66 ==============================
[0m19:38:30.215375 [info ] [MainThread]: Running with dbt=1.5.9
[0m19:38:30.216494 [debug] [MainThread]: running dbt with arguments {'no_print': 'None', 'quiet': 'False', 'warn_error': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'debug': 'False', 'target_path': 'None', 'use_experimental_parser': 'False', 'version_check': 'True', 'fail_fast': 'False', 'partial_parse': 'True', 'use_colors': 'True', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'send_anonymous_usage_stats': 'True', 'cache_selected_only': 'False', 'introspect': 'True', 'write_json': 'True', 'profiles_dir': '/usr/local/airflow/include/dbt/', 'static_parser': 'True', 'printer_width': '80', 'log_path': '/usr/local/airflow/include/dbt/logs', 'log_format': 'default'}
[0m19:38:30.663711 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'fd5413e5-26dc-4c62-b597-4461beb1dc66', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffb89bcad0>]}
[0m19:38:30.675141 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'fd5413e5-26dc-4c62-b597-4461beb1dc66', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffb89bcad0>]}
[0m19:38:30.675897 [info ] [MainThread]: Registered adapter: bigquery=1.5.3
[0m19:38:30.690647 [debug] [MainThread]: checksum: dd837546c89c9d03f3c2cb0ca6165266a30da6076d5d44e9991f7c5a8e5f5831, vars: {}, profile: , target: , version: 1.5.9
[0m19:38:30.773667 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m19:38:30.774503 [debug] [MainThread]: Partial parsing: updated file: uber://models/transform/passenger_count_dim.sql
[0m19:38:30.794799 [debug] [MainThread]: 1699: static parser successfully parsed transform/passenger_count_dim.sql
[0m19:38:30.817285 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'fd5413e5-26dc-4c62-b597-4461beb1dc66', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffb6877790>]}
[0m19:38:30.829926 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'fd5413e5-26dc-4c62-b597-4461beb1dc66', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffb69fc390>]}
[0m19:38:30.830550 [info ] [MainThread]: Found 8 models, 0 tests, 0 snapshots, 0 analyses, 474 macros, 0 operations, 0 seed files, 1 source, 0 exposures, 0 metrics, 0 groups
[0m19:38:30.831163 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'fd5413e5-26dc-4c62-b597-4461beb1dc66', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffbb8e3a10>]}
[0m19:38:30.832658 [info ] [MainThread]: 
[0m19:38:30.833648 [debug] [MainThread]: Acquiring new bigquery connection 'master'
[0m19:38:30.835543 [debug] [ThreadPool]: Acquiring new bigquery connection 'list_uber-data-engineering-407103'
[0m19:38:30.836035 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m19:38:31.456137 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_uber-data-engineering-407103, now list_uber-data-engineering-407103_uber)
[0m19:38:31.459526 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m19:38:31.929070 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'fd5413e5-26dc-4c62-b597-4461beb1dc66', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffb94eeb10>]}
[0m19:38:31.930522 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m19:38:31.931505 [info ] [MainThread]: 
[0m19:38:31.950126 [debug] [Thread-1 (]: Began running node model.uber.datetime_dim
[0m19:38:31.951182 [info ] [Thread-1 (]: 1 of 8 START sql table model uber.datetime_dim ................................. [RUN]
[0m19:38:31.952325 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_uber-data-engineering-407103_uber, now model.uber.datetime_dim)
[0m19:38:31.952890 [debug] [Thread-1 (]: Began compiling node model.uber.datetime_dim
[0m19:38:31.981685 [debug] [Thread-1 (]: Writing injected SQL for node "model.uber.datetime_dim"
[0m19:38:31.984689 [debug] [Thread-1 (]: Timing info for model.uber.datetime_dim (compile): 19:38:31.953417 => 19:38:31.984233
[0m19:38:31.985433 [debug] [Thread-1 (]: Began executing node model.uber.datetime_dim
[0m19:38:32.000765 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m19:38:32.505719 [debug] [Thread-1 (]: Writing runtime sql for node "model.uber.datetime_dim"
[0m19:38:32.508963 [debug] [Thread-1 (]: On model.uber.datetime_dim: /* {"app": "dbt", "dbt_version": "1.5.9", "profile_name": "uber", "target_name": "dev", "node_id": "model.uber.datetime_dim"} */

  
    

    create or replace table `uber-data-engineering-407103`.`uber`.`datetime_dim`
    
    

    OPTIONS()
    as (
      WITH datetime_cte AS (  
  SELECT DISTINCT 
    to_hex(md5(cast(coalesce(cast(tpep_pickup_datetime as STRING), '_dbt_utils_surrogate_key_null_') || '-' || coalesce(cast(tpep_dropoff_datetime as STRING), '_dbt_utils_surrogate_key_null_') as STRING))) AS datetime_id,
    CASE
      WHEN LENGTH(tpep_pickup_datetime) = 16 THEN
        -- Date format: "DD/MM/YYYY HH:MM"
        PARSE_DATETIME('%m/%d/%Y %H:%M', tpep_pickup_datetime)
      WHEN LENGTH(tpep_pickup_datetime) <= 14 THEN
        -- Date format: "MM/DD/YY HH:MM"
        PARSE_DATETIME('%m/%d/%y %H:%M', tpep_pickup_datetime)
      ELSE
        NULL
    END AS pick_date_part,
    tpep_dropoff_datetime AS drop_datetime_id,
    CASE
      WHEN LENGTH(tpep_dropoff_datetime) = 16 THEN
        -- Date format: "DD/MM/YYYY HH:MM"
        PARSE_DATETIME('%m/%d/%Y %H:%M', tpep_dropoff_datetime)
      WHEN LENGTH(tpep_dropoff_datetime) <= 14 THEN
        -- Date format: "MM/DD/YY HH:MM"
        PARSE_DATETIME('%m/%d/%y %H:%M', tpep_dropoff_datetime)
      ELSE
        NULL
    END AS drop_date_part
  FROM `uber-data-engineering-407103`.`uber`.`uber_tlc_trip_recrord_data`
  WHERE tpep_pickup_datetime IS NOT NULL
    AND tpep_dropoff_datetime IS NOT NULL
)
SELECT
  datetime_id,
  pick_date_part AS tpep_pickup_datetime,
  drop_date_part AS tpep_dropoff_datetime,
  EXTRACT(HOUR FROM pick_date_part) AS pick_hour,
  EXTRACT(DAY FROM pick_date_part) AS pick_day,
  EXTRACT(MONTH FROM pick_date_part) AS pick_month,
  EXTRACT(YEAR FROM pick_date_part) AS pick_year,
  EXTRACT(DAYOFWEEK FROM pick_date_part) AS pick_weekday,
  EXTRACT(HOUR FROM drop_date_part) AS drop_hour,
  EXTRACT(DAY FROM drop_date_part) AS drop_day,
  EXTRACT(MONTH FROM drop_date_part) AS drop_month,
  EXTRACT(YEAR FROM drop_date_part) AS drop_year,
  EXTRACT(DAYOFWEEK FROM drop_date_part) AS drop_weekday
FROM datetime_cte
    );
  
[0m19:38:35.676901 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=uber-data-engineering-407103&j=bq:US:61aaa185-feea-4205-90a7-b734f7aabad2&page=queryresults
[0m19:38:35.725500 [debug] [Thread-1 (]: Timing info for model.uber.datetime_dim (execute): 19:38:31.985922 => 19:38:35.724986
[0m19:38:35.727546 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'fd5413e5-26dc-4c62-b597-4461beb1dc66', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffb67620d0>]}
[0m19:38:35.729180 [info ] [Thread-1 (]: 1 of 8 OK created sql table model uber.datetime_dim ............................ [[32mCREATE TABLE (99.9k rows, 4.0 MiB processed)[0m in 3.77s]
[0m19:38:35.730764 [debug] [Thread-1 (]: Finished running node model.uber.datetime_dim
[0m19:38:35.731752 [debug] [Thread-1 (]: Began running node model.uber.dropoff_location_dim
[0m19:38:35.733094 [info ] [Thread-1 (]: 2 of 8 START sql table model uber.dropoff_location_dim ......................... [RUN]
[0m19:38:35.734666 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.uber.datetime_dim, now model.uber.dropoff_location_dim)
[0m19:38:35.735560 [debug] [Thread-1 (]: Began compiling node model.uber.dropoff_location_dim
[0m19:38:35.746456 [debug] [Thread-1 (]: Writing injected SQL for node "model.uber.dropoff_location_dim"
[0m19:38:35.751676 [debug] [Thread-1 (]: Timing info for model.uber.dropoff_location_dim (compile): 19:38:35.736210 => 19:38:35.751147
[0m19:38:35.752549 [debug] [Thread-1 (]: Began executing node model.uber.dropoff_location_dim
[0m19:38:35.759367 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m19:38:36.245450 [debug] [Thread-1 (]: Writing runtime sql for node "model.uber.dropoff_location_dim"
[0m19:38:36.252169 [debug] [Thread-1 (]: On model.uber.dropoff_location_dim: /* {"app": "dbt", "dbt_version": "1.5.9", "profile_name": "uber", "target_name": "dev", "node_id": "model.uber.dropoff_location_dim"} */

  
    

    create or replace table `uber-data-engineering-407103`.`uber`.`dropoff_location_dim`
    
    

    OPTIONS()
    as (
      WITH numbered_rows AS (
  SELECT
    to_hex(md5(cast(coalesce(cast(dropoff_latitude as STRING), '_dbt_utils_surrogate_key_null_') || '-' || coalesce(cast(dropoff_longitude as STRING), '_dbt_utils_surrogate_key_null_') as STRING))) as dropoff_location_id,
    dropoff_latitude AS dropoff_latitude,
    dropoff_longitude AS dropoff_longitude,
    ROW_NUMBER() OVER (ORDER BY dropoff_latitude, dropoff_longitude) as row_num
  FROM `uber-data-engineering-407103`.`uber`.`uber_tlc_trip_recrord_data`
)
SELECT
  dropoff_location_id,
  dropoff_latitude,
  dropoff_longitude
FROM numbered_rows
    );
  
[0m19:38:39.701159 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=uber-data-engineering-407103&j=bq:US:7104fd9c-1482-4afc-b7da-f58eafa01367&page=queryresults
[0m19:38:39.716701 [debug] [Thread-1 (]: Timing info for model.uber.dropoff_location_dim (execute): 19:38:35.753102 => 19:38:39.715916
[0m19:38:39.719664 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'fd5413e5-26dc-4c62-b597-4461beb1dc66', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffb688c2d0>]}
[0m19:38:39.722231 [info ] [Thread-1 (]: 2 of 8 OK created sql table model uber.dropoff_location_dim .................... [[32mCREATE TABLE (100.0k rows, 1.5 MiB processed)[0m in 3.98s]
[0m19:38:39.724540 [debug] [Thread-1 (]: Finished running node model.uber.dropoff_location_dim
[0m19:38:39.726181 [debug] [Thread-1 (]: Began running node model.uber.passenger_count_dim
[0m19:38:39.727566 [info ] [Thread-1 (]: 3 of 8 START sql table model uber.passenger_count_dim .......................... [RUN]
[0m19:38:39.729625 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.uber.dropoff_location_dim, now model.uber.passenger_count_dim)
[0m19:38:39.730434 [debug] [Thread-1 (]: Began compiling node model.uber.passenger_count_dim
[0m19:38:39.734874 [debug] [Thread-1 (]: Writing injected SQL for node "model.uber.passenger_count_dim"
[0m19:38:39.737598 [debug] [Thread-1 (]: Timing info for model.uber.passenger_count_dim (compile): 19:38:39.730954 => 19:38:39.737329
[0m19:38:39.738636 [debug] [Thread-1 (]: Began executing node model.uber.passenger_count_dim
[0m19:38:39.741963 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m19:38:40.272636 [debug] [Thread-1 (]: Writing runtime sql for node "model.uber.passenger_count_dim"
[0m19:38:40.276224 [debug] [Thread-1 (]: On model.uber.passenger_count_dim: /* {"app": "dbt", "dbt_version": "1.5.9", "profile_name": "uber", "target_name": "dev", "node_id": "model.uber.passenger_count_dim"} */

  
    

    create or replace table `uber-data-engineering-407103`.`uber`.`passenger_count_dim`
    
    

    OPTIONS()
    as (
      WITH numbered_rows AS (
  SELECT
    GENERATE_UUID() as passenger_count_id,
    passenger_count AS passenger_count,
    ROW_NUMBER() OVER (ORDER BY passenger_count) as row_num
  FROM `uber-data-engineering-407103`.`uber`.`uber_tlc_trip_recrord_data`
  WHERE passenger_count IS NOT NULL
)
SELECT
  passenger_count_id,
  passenger_count
FROM numbered_rows
    );
  
[0m19:38:42.940637 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=uber-data-engineering-407103&j=bq:US:5b86472f-3619-4e19-a103-6f80b1ff5c86&page=queryresults
[0m19:38:42.956151 [debug] [Thread-1 (]: Timing info for model.uber.passenger_count_dim (execute): 19:38:39.739254 => 19:38:42.955411
[0m19:38:42.960499 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'fd5413e5-26dc-4c62-b597-4461beb1dc66', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffb68c5e10>]}
[0m19:38:42.964035 [info ] [Thread-1 (]: 3 of 8 OK created sql table model uber.passenger_count_dim ..................... [[32mCREATE TABLE (100.0k rows, 781.2 KiB processed)[0m in 3.23s]
[0m19:38:42.967532 [debug] [Thread-1 (]: Finished running node model.uber.passenger_count_dim
[0m19:38:42.969346 [debug] [Thread-1 (]: Began running node model.uber.payment_type_dim
[0m19:38:42.971018 [info ] [Thread-1 (]: 4 of 8 START sql table model uber.payment_type_dim ............................. [RUN]
[0m19:38:42.972900 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.uber.passenger_count_dim, now model.uber.payment_type_dim)
[0m19:38:42.974018 [debug] [Thread-1 (]: Began compiling node model.uber.payment_type_dim
[0m19:38:43.000583 [debug] [Thread-1 (]: Writing injected SQL for node "model.uber.payment_type_dim"
[0m19:38:43.007256 [debug] [Thread-1 (]: Timing info for model.uber.payment_type_dim (compile): 19:38:42.974898 => 19:38:43.006678
[0m19:38:43.008713 [debug] [Thread-1 (]: Began executing node model.uber.payment_type_dim
[0m19:38:43.019713 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m19:38:43.419598 [debug] [Thread-1 (]: Writing runtime sql for node "model.uber.payment_type_dim"
[0m19:38:43.426209 [debug] [Thread-1 (]: On model.uber.payment_type_dim: /* {"app": "dbt", "dbt_version": "1.5.9", "profile_name": "uber", "target_name": "dev", "node_id": "model.uber.payment_type_dim"} */

  
    

    create or replace table `uber-data-engineering-407103`.`uber`.`payment_type_dim`
    
    

    OPTIONS()
    as (
      WITH numbered_rows AS (
  SELECT
    GENERATE_UUID() as payment_type_id,
    payment_type AS payment_type,
    ROW_NUMBER() OVER (ORDER BY payment_type) as row_num
  FROM `uber-data-engineering-407103`.`uber`.`uber_tlc_trip_recrord_data`
  WHERE payment_type IS NOT NULL
)
SELECT
  payment_type_id,
  payment_type
FROM numbered_rows
    );
  
[0m19:38:45.772149 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=uber-data-engineering-407103&j=bq:US:577fc7ad-1328-437c-b998-f43bc711e872&page=queryresults
[0m19:38:45.779710 [debug] [Thread-1 (]: Timing info for model.uber.payment_type_dim (execute): 19:38:43.009831 => 19:38:45.779200
[0m19:38:45.782208 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'fd5413e5-26dc-4c62-b597-4461beb1dc66', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffb68326d0>]}
[0m19:38:45.784110 [info ] [Thread-1 (]: 4 of 8 OK created sql table model uber.payment_type_dim ........................ [[32mCREATE TABLE (100.0k rows, 781.2 KiB processed)[0m in 2.81s]
[0m19:38:45.786591 [debug] [Thread-1 (]: Finished running node model.uber.payment_type_dim
[0m19:38:45.787998 [debug] [Thread-1 (]: Began running node model.uber.pickup_location_dim
[0m19:38:45.789246 [info ] [Thread-1 (]: 5 of 8 START sql table model uber.pickup_location_dim .......................... [RUN]
[0m19:38:45.790443 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.uber.payment_type_dim, now model.uber.pickup_location_dim)
[0m19:38:45.791021 [debug] [Thread-1 (]: Began compiling node model.uber.pickup_location_dim
[0m19:38:45.796954 [debug] [Thread-1 (]: Writing injected SQL for node "model.uber.pickup_location_dim"
[0m19:38:45.799929 [debug] [Thread-1 (]: Timing info for model.uber.pickup_location_dim (compile): 19:38:45.791515 => 19:38:45.799736
[0m19:38:45.800634 [debug] [Thread-1 (]: Began executing node model.uber.pickup_location_dim
[0m19:38:45.803589 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m19:38:46.253883 [debug] [Thread-1 (]: Writing runtime sql for node "model.uber.pickup_location_dim"
[0m19:38:46.260972 [debug] [Thread-1 (]: On model.uber.pickup_location_dim: /* {"app": "dbt", "dbt_version": "1.5.9", "profile_name": "uber", "target_name": "dev", "node_id": "model.uber.pickup_location_dim"} */

  
    

    create or replace table `uber-data-engineering-407103`.`uber`.`pickup_location_dim`
    
    

    OPTIONS()
    as (
      WITH numbered_rows AS (
  SELECT
    to_hex(md5(cast(coalesce(cast(pickup_latitude as STRING), '_dbt_utils_surrogate_key_null_') || '-' || coalesce(cast(pickup_longitude as STRING), '_dbt_utils_surrogate_key_null_') as STRING))) as pickup_location_id,
    pickup_latitude AS pickup_latitude,
    pickup_longitude AS pickup_longitude,
    ROW_NUMBER() OVER (ORDER BY pickup_latitude, pickup_longitude) as row_num
  FROM `uber-data-engineering-407103`.`uber`.`uber_tlc_trip_recrord_data`
)
SELECT
  pickup_location_id,
  pickup_latitude,
  pickup_longitude
FROM numbered_rows
    );
  
[0m19:38:49.312010 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=uber-data-engineering-407103&j=bq:US:fb1856c8-7ac7-44f8-bfc9-21d1893eac50&page=queryresults
[0m19:38:49.321264 [debug] [Thread-1 (]: Timing info for model.uber.pickup_location_dim (execute): 19:38:45.801548 => 19:38:49.320266
[0m19:38:49.326787 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'fd5413e5-26dc-4c62-b597-4461beb1dc66', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffb5631790>]}
[0m19:38:49.329691 [info ] [Thread-1 (]: 5 of 8 OK created sql table model uber.pickup_location_dim ..................... [[32mCREATE TABLE (100.0k rows, 1.5 MiB processed)[0m in 3.54s]
[0m19:38:49.332601 [debug] [Thread-1 (]: Finished running node model.uber.pickup_location_dim
[0m19:38:49.334418 [debug] [Thread-1 (]: Began running node model.uber.rate_code_dim
[0m19:38:49.336213 [info ] [Thread-1 (]: 6 of 8 START sql table model uber.rate_code_dim ................................ [RUN]
[0m19:38:49.337691 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.uber.pickup_location_dim, now model.uber.rate_code_dim)
[0m19:38:49.338456 [debug] [Thread-1 (]: Began compiling node model.uber.rate_code_dim
[0m19:38:49.360211 [debug] [Thread-1 (]: Writing injected SQL for node "model.uber.rate_code_dim"
[0m19:38:49.362760 [debug] [Thread-1 (]: Timing info for model.uber.rate_code_dim (compile): 19:38:49.339006 => 19:38:49.362506
[0m19:38:49.363399 [debug] [Thread-1 (]: Began executing node model.uber.rate_code_dim
[0m19:38:49.366662 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m19:38:49.757280 [debug] [Thread-1 (]: Writing runtime sql for node "model.uber.rate_code_dim"
[0m19:38:49.762115 [debug] [Thread-1 (]: On model.uber.rate_code_dim: /* {"app": "dbt", "dbt_version": "1.5.9", "profile_name": "uber", "target_name": "dev", "node_id": "model.uber.rate_code_dim"} */

  
    

    create or replace table `uber-data-engineering-407103`.`uber`.`rate_code_dim`
    
    

    OPTIONS()
    as (
      WITH numbered_rows AS (
  SELECT
    GENERATE_UUID() as rate_code_id,
    RatecodeID AS RatecodeID,
    ROW_NUMBER() OVER (ORDER BY RatecodeID) as row_num
  FROM `uber-data-engineering-407103`.`uber`.`uber_tlc_trip_recrord_data`
  WHERE RatecodeID IS NOT NULL
)
SELECT
  rate_code_id,
  RatecodeID
FROM numbered_rows
    );
  
[0m19:38:52.635387 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=uber-data-engineering-407103&j=bq:US:f73b7ee6-ffe9-4e5d-bfd0-26901a219add&page=queryresults
[0m19:38:52.643712 [debug] [Thread-1 (]: Timing info for model.uber.rate_code_dim (execute): 19:38:49.363855 => 19:38:52.643182
[0m19:38:52.646394 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'fd5413e5-26dc-4c62-b597-4461beb1dc66', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffb6a03050>]}
[0m19:38:52.648480 [info ] [Thread-1 (]: 6 of 8 OK created sql table model uber.rate_code_dim ........................... [[32mCREATE TABLE (100.0k rows, 781.2 KiB processed)[0m in 3.31s]
[0m19:38:52.650902 [debug] [Thread-1 (]: Finished running node model.uber.rate_code_dim
[0m19:38:52.653339 [debug] [Thread-1 (]: Began running node model.uber.trip_distance
[0m19:38:52.654720 [info ] [Thread-1 (]: 7 of 8 START sql table model uber.trip_distance ................................ [RUN]
[0m19:38:52.656516 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.uber.rate_code_dim, now model.uber.trip_distance)
[0m19:38:52.657970 [debug] [Thread-1 (]: Began compiling node model.uber.trip_distance
[0m19:38:52.662021 [debug] [Thread-1 (]: Writing injected SQL for node "model.uber.trip_distance"
[0m19:38:52.665264 [debug] [Thread-1 (]: Timing info for model.uber.trip_distance (compile): 19:38:52.658577 => 19:38:52.664776
[0m19:38:52.666692 [debug] [Thread-1 (]: Began executing node model.uber.trip_distance
[0m19:38:52.669366 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m19:38:53.141235 [debug] [Thread-1 (]: Writing runtime sql for node "model.uber.trip_distance"
[0m19:38:53.145614 [debug] [Thread-1 (]: On model.uber.trip_distance: /* {"app": "dbt", "dbt_version": "1.5.9", "profile_name": "uber", "target_name": "dev", "node_id": "model.uber.trip_distance"} */

  
    

    create or replace table `uber-data-engineering-407103`.`uber`.`trip_distance`
    
    

    OPTIONS()
    as (
      WITH numbered_rows AS (
  SELECT
    GENERATE_UUID() as trip_distance_id,
    trip_distance AS trip_distance,
    ROW_NUMBER() OVER (ORDER BY trip_distance) as row_num
  FROM `uber-data-engineering-407103`.`uber`.`uber_tlc_trip_recrord_data`
  WHERE trip_distance IS NOT NULL
)
SELECT
  trip_distance_id,
  trip_distance
FROM numbered_rows
    );
  
[0m19:38:56.448855 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=uber-data-engineering-407103&j=bq:US:3312a1d6-34d1-46ad-93ad-193ecd8026d7&page=queryresults
[0m19:38:56.469394 [debug] [Thread-1 (]: Timing info for model.uber.trip_distance (execute): 19:38:52.667555 => 19:38:56.468559
[0m19:38:56.472426 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'fd5413e5-26dc-4c62-b597-4461beb1dc66', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffb8813a10>]}
[0m19:38:56.474669 [info ] [Thread-1 (]: 7 of 8 OK created sql table model uber.trip_distance ........................... [[32mCREATE TABLE (100.0k rows, 781.2 KiB processed)[0m in 3.82s]
[0m19:38:56.480368 [debug] [Thread-1 (]: Finished running node model.uber.trip_distance
[0m19:38:56.499403 [debug] [Thread-1 (]: Began running node model.uber.fact_trip
[0m19:38:56.500494 [info ] [Thread-1 (]: 8 of 8 START sql table model uber.fact_trip .................................... [RUN]
[0m19:38:56.502085 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.uber.trip_distance, now model.uber.fact_trip)
[0m19:38:56.502961 [debug] [Thread-1 (]: Began compiling node model.uber.fact_trip
[0m19:38:56.522320 [debug] [Thread-1 (]: Writing injected SQL for node "model.uber.fact_trip"
[0m19:38:56.525202 [debug] [Thread-1 (]: Timing info for model.uber.fact_trip (compile): 19:38:56.503640 => 19:38:56.524917
[0m19:38:56.525859 [debug] [Thread-1 (]: Began executing node model.uber.fact_trip
[0m19:38:56.530406 [debug] [Thread-1 (]: Writing runtime sql for node "model.uber.fact_trip"
[0m19:38:56.538382 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m19:38:56.566347 [debug] [Thread-1 (]: On model.uber.fact_trip: /* {"app": "dbt", "dbt_version": "1.5.9", "profile_name": "uber", "target_name": "dev", "node_id": "model.uber.fact_trip"} */

  
    

    create or replace table `uber-data-engineering-407103`.`uber`.`fact_trip`
    
    

    OPTIONS()
    as (
      WITH fct_invoices_cte AS (
    SELECT
        CAST(ROW_NUMBER() OVER () AS INT64) as trip_id,
        VendorID,
        to_hex(md5(cast(coalesce(cast(tpep_pickup_datetime as STRING), '_dbt_utils_surrogate_key_null_') || '-' || coalesce(cast(tpep_dropoff_datetime as STRING), '_dbt_utils_surrogate_key_null_') as STRING))) AS datetime_id,
        passenger_count_id,
        trip_distance_id,
        rate_code_id,
        store_and_fwd_flag,
        pickup_location_id,
        to_hex(md5(cast(coalesce(cast(dropoff_latitude as STRING), '_dbt_utils_surrogate_key_null_') || '-' || coalesce(cast(dropoff_longitude as STRING), '_dbt_utils_surrogate_key_null_') as STRING))) as dropoff_location_id,
        payment_type_id,
        fare_amount,
        extra,
        mta_tax,
        tip_amount,
        tolls_amount,
        improvement_surcharge,
        total_amount
    FROM `uber-data-engineering-407103`.`uber`.`uber_tlc_trip_recrord_data`
)
SELECT
    trip_id,
    VendorID,
    datetime_id,
    do.dropoff_location_id,
    pu.pickup_location_id,
    pc.passenger_count_id,
    pt.payment_type_id,
    rc.rate_code_id,
    store_and_fwd_flag,
    td.trip_distance_id,
    fare_amount,
    extra,
    mta_tax,
    tip_amount,
    tolls_amount,
    improvement_surcharge AS improvement_surcharge_amount,  -- Added alias
    total_amount
FROM fct_invoices_cte fi
INNER JOIN `uber-data-engineering-407103`.`uber`.`datetime_dim` dt ON fi.datetime_id = dt.datetime_id
INNER JOIN `uber-data-engineering-407103`.`uber`.`dropoff_location_dim` do ON fi.dropoff_location_id = do.dropoff_location_id
INNER JOIN `uber-data-engineering-407103`.`uber`.`pickup_location_dim` pu ON fi.pickup_location_id = pu.pickup_location_id
INNER JOIN `uber-data-engineering-407103`.`uber`.`passenger_count_dim` pc ON fi.passenger_count_id = pc.passenger_count_id
INNER JOIN `uber-data-engineering-407103`.`uber`.`payment_type_dim` pt ON fi.payment_type_id = pt.payment_type_id
INNER JOIN `uber-data-engineering-407103`.`uber`.`rate_code_dim` rc ON fi.rate_code_id = rc.rate_code_id
INNER JOIN `uber-data-engineering-407103`.`uber`.`trip_distance` td ON fi.trip_distance_id = td.trip_distance_id
    );
  
[0m19:38:57.719515 [debug] [Thread-1 (]: BigQuery adapter: Retry attempt 1 of 1 after error: BadRequest('Unrecognized name: passenger_count_id; Did you mean passenger_count? at [17:9]')
[0m19:38:59.260572 [error] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=uber-data-engineering-407103&j=bq:US:38fff2bc-348b-4e67-9e39-7882894cdca4&page=queryresults
[0m19:38:59.263944 [debug] [Thread-1 (]: Timing info for model.uber.fact_trip (execute): 19:38:56.526364 => 19:38:59.263664
[0m19:38:59.285246 [debug] [Thread-1 (]: Database Error in model fact_trip (models/transform/fact_trip.sql)
  Unrecognized name: passenger_count_id; Did you mean passenger_count? at [17:9]
  compiled Code at target/run/uber/models/transform/fact_trip.sql
[0m19:38:59.286250 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'fd5413e5-26dc-4c62-b597-4461beb1dc66', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffb687c5d0>]}
[0m19:38:59.287300 [error] [Thread-1 (]: 8 of 8 ERROR creating sql table model uber.fact_trip ........................... [[31mERROR[0m in 2.78s]
[0m19:38:59.288105 [debug] [Thread-1 (]: Finished running node model.uber.fact_trip
[0m19:38:59.299070 [debug] [MainThread]: Connection 'master' was properly closed.
[0m19:38:59.299836 [debug] [MainThread]: Connection 'model.uber.fact_trip' was properly closed.
[0m19:38:59.301333 [info ] [MainThread]: 
[0m19:38:59.302262 [info ] [MainThread]: Finished running 8 table models in 0 hours 0 minutes and 28.47 seconds (28.47s).
[0m19:38:59.306384 [debug] [MainThread]: Command end result
[0m19:38:59.373193 [info ] [MainThread]: 
[0m19:38:59.375134 [info ] [MainThread]: [31mCompleted with 1 error and 0 warnings:[0m
[0m19:38:59.376736 [info ] [MainThread]: 
[0m19:38:59.379186 [error] [MainThread]: [33mDatabase Error in model fact_trip (models/transform/fact_trip.sql)[0m
[0m19:38:59.381816 [error] [MainThread]:   Unrecognized name: passenger_count_id; Did you mean passenger_count? at [17:9]
[0m19:38:59.383168 [error] [MainThread]:   compiled Code at target/run/uber/models/transform/fact_trip.sql
[0m19:38:59.384474 [info ] [MainThread]: 
[0m19:38:59.386387 [info ] [MainThread]: Done. PASS=7 WARN=0 ERROR=1 SKIP=0 TOTAL=8
[0m19:38:59.392772 [debug] [MainThread]: Command `dbt run` failed at 19:38:59.392316 after 29.19 seconds
[0m19:38:59.394443 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffb8c15290>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffb8d994d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffbc8ac490>]}
[0m19:38:59.395197 [debug] [MainThread]: Flushing usage events
[0m19:41:43.238873 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff9289f150>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff92e21a10>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff92f60250>]}


============================== 19:41:43.244462 | 3c11966e-48a5-4e76-b42b-2931a404d6a2 ==============================
[0m19:41:43.244462 [info ] [MainThread]: Running with dbt=1.5.9
[0m19:41:43.245528 [debug] [MainThread]: running dbt with arguments {'version_check': 'True', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'cache_selected_only': 'False', 'profiles_dir': '/usr/local/airflow/include/dbt/', 'use_colors': 'True', 'debug': 'False', 'write_json': 'True', 'introspect': 'True', 'log_cache_events': 'False', 'target_path': 'None', 'fail_fast': 'False', 'indirect_selection': 'eager', 'log_format': 'default', 'warn_error': 'None', 'no_print': 'None', 'quiet': 'False', 'static_parser': 'True', 'log_path': '/usr/local/airflow/include/dbt/logs', 'send_anonymous_usage_stats': 'True', 'partial_parse': 'True', 'printer_width': '80', 'use_experimental_parser': 'False'}
[0m19:41:43.727218 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '3c11966e-48a5-4e76-b42b-2931a404d6a2', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff90e49f90>]}
[0m19:41:43.738638 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '3c11966e-48a5-4e76-b42b-2931a404d6a2', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff91ce7d50>]}
[0m19:41:43.739384 [info ] [MainThread]: Registered adapter: bigquery=1.5.3
[0m19:41:43.754753 [debug] [MainThread]: checksum: dd837546c89c9d03f3c2cb0ca6165266a30da6076d5d44e9991f7c5a8e5f5831, vars: {}, profile: , target: , version: 1.5.9
[0m19:41:43.838431 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m19:41:43.839404 [debug] [MainThread]: Partial parsing: updated file: uber://models/transform/passenger_count_dim.sql
[0m19:41:43.862083 [debug] [MainThread]: 1699: static parser successfully parsed transform/passenger_count_dim.sql
[0m19:41:43.883283 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '3c11966e-48a5-4e76-b42b-2931a404d6a2', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff90ebe750>]}
[0m19:41:43.896668 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '3c11966e-48a5-4e76-b42b-2931a404d6a2', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff90d91110>]}
[0m19:41:43.897369 [info ] [MainThread]: Found 8 models, 0 tests, 0 snapshots, 0 analyses, 474 macros, 0 operations, 0 seed files, 1 source, 0 exposures, 0 metrics, 0 groups
[0m19:41:43.898104 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '3c11966e-48a5-4e76-b42b-2931a404d6a2', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff95d9f4d0>]}
[0m19:41:43.899798 [info ] [MainThread]: 
[0m19:41:43.900720 [debug] [MainThread]: Acquiring new bigquery connection 'master'
[0m19:41:43.902383 [debug] [ThreadPool]: Acquiring new bigquery connection 'list_uber-data-engineering-407103'
[0m19:41:43.902908 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m19:41:46.194965 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_uber-data-engineering-407103, now list_uber-data-engineering-407103_uber)
[0m19:41:46.199952 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m19:41:48.799388 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '3c11966e-48a5-4e76-b42b-2931a404d6a2', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff939aae10>]}
[0m19:41:48.805328 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m19:41:48.807449 [info ] [MainThread]: 
[0m19:41:48.844520 [debug] [Thread-1 (]: Began running node model.uber.datetime_dim
[0m19:41:48.849837 [info ] [Thread-1 (]: 1 of 8 START sql table model uber.datetime_dim ................................. [RUN]
[0m19:41:48.851860 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_uber-data-engineering-407103_uber, now model.uber.datetime_dim)
[0m19:41:48.852908 [debug] [Thread-1 (]: Began compiling node model.uber.datetime_dim
[0m19:41:48.903826 [debug] [Thread-1 (]: Writing injected SQL for node "model.uber.datetime_dim"
[0m19:41:48.906627 [debug] [Thread-1 (]: Timing info for model.uber.datetime_dim (compile): 19:41:48.854157 => 19:41:48.906269
[0m19:41:48.907256 [debug] [Thread-1 (]: Began executing node model.uber.datetime_dim
[0m19:41:48.923004 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m19:41:49.599446 [debug] [Thread-1 (]: Writing runtime sql for node "model.uber.datetime_dim"
[0m19:41:49.602014 [debug] [Thread-1 (]: On model.uber.datetime_dim: /* {"app": "dbt", "dbt_version": "1.5.9", "profile_name": "uber", "target_name": "dev", "node_id": "model.uber.datetime_dim"} */

  
    

    create or replace table `uber-data-engineering-407103`.`uber`.`datetime_dim`
    
    

    OPTIONS()
    as (
      WITH datetime_cte AS (  
  SELECT DISTINCT 
    to_hex(md5(cast(coalesce(cast(tpep_pickup_datetime as STRING), '_dbt_utils_surrogate_key_null_') || '-' || coalesce(cast(tpep_dropoff_datetime as STRING), '_dbt_utils_surrogate_key_null_') as STRING))) AS datetime_id,
    CASE
      WHEN LENGTH(tpep_pickup_datetime) = 16 THEN
        -- Date format: "DD/MM/YYYY HH:MM"
        PARSE_DATETIME('%m/%d/%Y %H:%M', tpep_pickup_datetime)
      WHEN LENGTH(tpep_pickup_datetime) <= 14 THEN
        -- Date format: "MM/DD/YY HH:MM"
        PARSE_DATETIME('%m/%d/%y %H:%M', tpep_pickup_datetime)
      ELSE
        NULL
    END AS pick_date_part,
    tpep_dropoff_datetime AS drop_datetime_id,
    CASE
      WHEN LENGTH(tpep_dropoff_datetime) = 16 THEN
        -- Date format: "DD/MM/YYYY HH:MM"
        PARSE_DATETIME('%m/%d/%Y %H:%M', tpep_dropoff_datetime)
      WHEN LENGTH(tpep_dropoff_datetime) <= 14 THEN
        -- Date format: "MM/DD/YY HH:MM"
        PARSE_DATETIME('%m/%d/%y %H:%M', tpep_dropoff_datetime)
      ELSE
        NULL
    END AS drop_date_part
  FROM `uber-data-engineering-407103`.`uber`.`uber_tlc_trip_recrord_data`
  WHERE tpep_pickup_datetime IS NOT NULL
    AND tpep_dropoff_datetime IS NOT NULL
)
SELECT
  datetime_id,
  pick_date_part AS tpep_pickup_datetime,
  drop_date_part AS tpep_dropoff_datetime,
  EXTRACT(HOUR FROM pick_date_part) AS pick_hour,
  EXTRACT(DAY FROM pick_date_part) AS pick_day,
  EXTRACT(MONTH FROM pick_date_part) AS pick_month,
  EXTRACT(YEAR FROM pick_date_part) AS pick_year,
  EXTRACT(DAYOFWEEK FROM pick_date_part) AS pick_weekday,
  EXTRACT(HOUR FROM drop_date_part) AS drop_hour,
  EXTRACT(DAY FROM drop_date_part) AS drop_day,
  EXTRACT(MONTH FROM drop_date_part) AS drop_month,
  EXTRACT(YEAR FROM drop_date_part) AS drop_year,
  EXTRACT(DAYOFWEEK FROM drop_date_part) AS drop_weekday
FROM datetime_cte
    );
  
[0m19:41:52.737146 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=uber-data-engineering-407103&j=bq:US:64982712-25c0-4d8e-bff5-793a64476305&page=queryresults
[0m19:41:52.776774 [debug] [Thread-1 (]: Timing info for model.uber.datetime_dim (execute): 19:41:48.907784 => 19:41:52.776496
[0m19:41:52.778250 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '3c11966e-48a5-4e76-b42b-2931a404d6a2', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff90db9210>]}
[0m19:41:52.779369 [info ] [Thread-1 (]: 1 of 8 OK created sql table model uber.datetime_dim ............................ [[32mCREATE TABLE (99.9k rows, 4.0 MiB processed)[0m in 3.93s]
[0m19:41:52.780835 [debug] [Thread-1 (]: Finished running node model.uber.datetime_dim
[0m19:41:52.781750 [debug] [Thread-1 (]: Began running node model.uber.dropoff_location_dim
[0m19:41:52.782594 [info ] [Thread-1 (]: 2 of 8 START sql table model uber.dropoff_location_dim ......................... [RUN]
[0m19:41:52.783543 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.uber.datetime_dim, now model.uber.dropoff_location_dim)
[0m19:41:52.784030 [debug] [Thread-1 (]: Began compiling node model.uber.dropoff_location_dim
[0m19:41:52.789158 [debug] [Thread-1 (]: Writing injected SQL for node "model.uber.dropoff_location_dim"
[0m19:41:52.791901 [debug] [Thread-1 (]: Timing info for model.uber.dropoff_location_dim (compile): 19:41:52.784420 => 19:41:52.791746
[0m19:41:52.792431 [debug] [Thread-1 (]: Began executing node model.uber.dropoff_location_dim
[0m19:41:52.794913 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m19:41:54.665821 [debug] [Thread-1 (]: Writing runtime sql for node "model.uber.dropoff_location_dim"
[0m19:41:54.673109 [debug] [Thread-1 (]: On model.uber.dropoff_location_dim: /* {"app": "dbt", "dbt_version": "1.5.9", "profile_name": "uber", "target_name": "dev", "node_id": "model.uber.dropoff_location_dim"} */

  
    

    create or replace table `uber-data-engineering-407103`.`uber`.`dropoff_location_dim`
    
    

    OPTIONS()
    as (
      WITH numbered_rows AS (
  SELECT
    to_hex(md5(cast(coalesce(cast(dropoff_latitude as STRING), '_dbt_utils_surrogate_key_null_') || '-' || coalesce(cast(dropoff_longitude as STRING), '_dbt_utils_surrogate_key_null_') as STRING))) as dropoff_location_id,
    dropoff_latitude AS dropoff_latitude,
    dropoff_longitude AS dropoff_longitude,
    ROW_NUMBER() OVER (ORDER BY dropoff_latitude, dropoff_longitude) as row_num
  FROM `uber-data-engineering-407103`.`uber`.`uber_tlc_trip_recrord_data`
)
SELECT
  dropoff_location_id,
  dropoff_latitude,
  dropoff_longitude
FROM numbered_rows
    );
  
[0m19:41:58.180146 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=uber-data-engineering-407103&j=bq:US:cc6029fe-2b1b-43d9-930a-5d30b7118828&page=queryresults
[0m19:41:58.190086 [debug] [Thread-1 (]: Timing info for model.uber.dropoff_location_dim (execute): 19:41:52.792874 => 19:41:58.189639
[0m19:41:58.192122 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '3c11966e-48a5-4e76-b42b-2931a404d6a2', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff91ce5a10>]}
[0m19:41:58.193755 [info ] [Thread-1 (]: 2 of 8 OK created sql table model uber.dropoff_location_dim .................... [[32mCREATE TABLE (100.0k rows, 1.5 MiB processed)[0m in 5.41s]
[0m19:41:58.195385 [debug] [Thread-1 (]: Finished running node model.uber.dropoff_location_dim
[0m19:41:58.196394 [debug] [Thread-1 (]: Began running node model.uber.passenger_count_dim
[0m19:41:58.197612 [info ] [Thread-1 (]: 3 of 8 START sql table model uber.passenger_count_dim .......................... [RUN]
[0m19:41:58.198912 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.uber.dropoff_location_dim, now model.uber.passenger_count_dim)
[0m19:41:58.199602 [debug] [Thread-1 (]: Began compiling node model.uber.passenger_count_dim
[0m19:41:58.207665 [debug] [Thread-1 (]: Writing injected SQL for node "model.uber.passenger_count_dim"
[0m19:41:58.209874 [debug] [Thread-1 (]: Timing info for model.uber.passenger_count_dim (compile): 19:41:58.200147 => 19:41:58.209707
[0m19:41:58.210607 [debug] [Thread-1 (]: Began executing node model.uber.passenger_count_dim
[0m19:41:58.213068 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m19:41:58.707102 [debug] [Thread-1 (]: Writing runtime sql for node "model.uber.passenger_count_dim"
[0m19:41:58.712806 [debug] [Thread-1 (]: On model.uber.passenger_count_dim: /* {"app": "dbt", "dbt_version": "1.5.9", "profile_name": "uber", "target_name": "dev", "node_id": "model.uber.passenger_count_dim"} */

  
    

    create or replace table `uber-data-engineering-407103`.`uber`.`passenger_count_dim`
    
    

    OPTIONS()
    as (
      WITH numbered_rows AS (
  SELECT
    GENERATE_UUID() as passenger_count_id,
    passenger_count,
    ROW_NUMBER() OVER () as row_num
  FROM `uber-data-engineering-407103`.`uber`.`uber_tlc_trip_recrord_data`
  WHERE passenger_count IS NOT NULL
)
SELECT
  passenger_count_id,
  passenger_count
FROM numbered_rows;
    );
  
[0m19:41:58.917678 [debug] [Thread-1 (]: BigQuery adapter: Retry attempt 1 of 1 after error: BadRequest('Syntax error: Expected ")" but got ";" at [23:19]')
[0m19:42:00.027283 [error] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=uber-data-engineering-407103&j=bq:US:d580aad0-f3a4-4c6b-87a8-5f108d4fbfbc&page=queryresults
[0m19:42:00.030092 [debug] [Thread-1 (]: Timing info for model.uber.passenger_count_dim (execute): 19:41:58.211043 => 19:42:00.029796
[0m19:42:00.045867 [debug] [Thread-1 (]: Database Error in model passenger_count_dim (models/transform/passenger_count_dim.sql)
  Syntax error: Expected ")" but got ";" at [23:19]
  compiled Code at target/run/uber/models/transform/passenger_count_dim.sql
[0m19:42:00.047547 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '3c11966e-48a5-4e76-b42b-2931a404d6a2', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff90e7bad0>]}
[0m19:42:00.050848 [error] [Thread-1 (]: 3 of 8 ERROR creating sql table model uber.passenger_count_dim ................. [[31mERROR[0m in 1.85s]
[0m19:42:00.053025 [debug] [Thread-1 (]: Finished running node model.uber.passenger_count_dim
[0m19:42:00.054835 [debug] [Thread-1 (]: Began running node model.uber.payment_type_dim
[0m19:42:00.056806 [info ] [Thread-1 (]: 4 of 8 START sql table model uber.payment_type_dim ............................. [RUN]
[0m19:42:00.062717 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.uber.passenger_count_dim, now model.uber.payment_type_dim)
[0m19:42:00.064415 [debug] [Thread-1 (]: Began compiling node model.uber.payment_type_dim
[0m19:42:00.078519 [debug] [Thread-1 (]: Writing injected SQL for node "model.uber.payment_type_dim"
[0m19:42:00.086303 [debug] [Thread-1 (]: Timing info for model.uber.payment_type_dim (compile): 19:42:00.065269 => 19:42:00.085964
[0m19:42:00.087381 [debug] [Thread-1 (]: Began executing node model.uber.payment_type_dim
[0m19:42:00.092369 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m19:42:00.511296 [debug] [Thread-1 (]: Writing runtime sql for node "model.uber.payment_type_dim"
[0m19:42:00.514400 [debug] [Thread-1 (]: On model.uber.payment_type_dim: /* {"app": "dbt", "dbt_version": "1.5.9", "profile_name": "uber", "target_name": "dev", "node_id": "model.uber.payment_type_dim"} */

  
    

    create or replace table `uber-data-engineering-407103`.`uber`.`payment_type_dim`
    
    

    OPTIONS()
    as (
      WITH numbered_rows AS (
  SELECT
    GENERATE_UUID() as payment_type_id,
    payment_type AS payment_type,
    ROW_NUMBER() OVER (ORDER BY payment_type) as row_num
  FROM `uber-data-engineering-407103`.`uber`.`uber_tlc_trip_recrord_data`
  WHERE payment_type IS NOT NULL
)
SELECT
  payment_type_id,
  payment_type
FROM numbered_rows
    );
  
[0m19:42:03.130615 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=uber-data-engineering-407103&j=bq:US:5d5e5c4e-20dd-44ec-80ba-b6ce6c7342c9&page=queryresults
[0m19:42:03.145017 [debug] [Thread-1 (]: Timing info for model.uber.payment_type_dim (execute): 19:42:00.088023 => 19:42:03.144207
[0m19:42:03.147813 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '3c11966e-48a5-4e76-b42b-2931a404d6a2', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff90dc5290>]}
[0m19:42:03.149677 [info ] [Thread-1 (]: 4 of 8 OK created sql table model uber.payment_type_dim ........................ [[32mCREATE TABLE (100.0k rows, 781.2 KiB processed)[0m in 3.09s]
[0m19:42:03.151609 [debug] [Thread-1 (]: Finished running node model.uber.payment_type_dim
[0m19:42:03.152896 [debug] [Thread-1 (]: Began running node model.uber.pickup_location_dim
[0m19:42:03.154581 [info ] [Thread-1 (]: 5 of 8 START sql table model uber.pickup_location_dim .......................... [RUN]
[0m19:42:03.156116 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.uber.payment_type_dim, now model.uber.pickup_location_dim)
[0m19:42:03.156825 [debug] [Thread-1 (]: Began compiling node model.uber.pickup_location_dim
[0m19:42:03.167246 [debug] [Thread-1 (]: Writing injected SQL for node "model.uber.pickup_location_dim"
[0m19:42:03.169678 [debug] [Thread-1 (]: Timing info for model.uber.pickup_location_dim (compile): 19:42:03.157330 => 19:42:03.169491
[0m19:42:03.170263 [debug] [Thread-1 (]: Began executing node model.uber.pickup_location_dim
[0m19:42:03.173379 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m19:42:03.587542 [debug] [Thread-1 (]: Writing runtime sql for node "model.uber.pickup_location_dim"
[0m19:42:03.592585 [debug] [Thread-1 (]: On model.uber.pickup_location_dim: /* {"app": "dbt", "dbt_version": "1.5.9", "profile_name": "uber", "target_name": "dev", "node_id": "model.uber.pickup_location_dim"} */

  
    

    create or replace table `uber-data-engineering-407103`.`uber`.`pickup_location_dim`
    
    

    OPTIONS()
    as (
      WITH numbered_rows AS (
  SELECT
    to_hex(md5(cast(coalesce(cast(pickup_latitude as STRING), '_dbt_utils_surrogate_key_null_') || '-' || coalesce(cast(pickup_longitude as STRING), '_dbt_utils_surrogate_key_null_') as STRING))) as pickup_location_id,
    pickup_latitude AS pickup_latitude,
    pickup_longitude AS pickup_longitude,
    ROW_NUMBER() OVER (ORDER BY pickup_latitude, pickup_longitude) as row_num
  FROM `uber-data-engineering-407103`.`uber`.`uber_tlc_trip_recrord_data`
)
SELECT
  pickup_location_id,
  pickup_latitude,
  pickup_longitude
FROM numbered_rows
    );
  
[0m19:42:07.119422 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=uber-data-engineering-407103&j=bq:US:7952e156-0e37-4343-8c32-5c1f90cdb77f&page=queryresults
[0m19:42:07.136223 [debug] [Thread-1 (]: Timing info for model.uber.pickup_location_dim (execute): 19:42:03.170733 => 19:42:07.135660
[0m19:42:07.139178 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '3c11966e-48a5-4e76-b42b-2931a404d6a2', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff90d82b50>]}
[0m19:42:07.140948 [info ] [Thread-1 (]: 5 of 8 OK created sql table model uber.pickup_location_dim ..................... [[32mCREATE TABLE (100.0k rows, 1.5 MiB processed)[0m in 3.98s]
[0m19:42:07.143069 [debug] [Thread-1 (]: Finished running node model.uber.pickup_location_dim
[0m19:42:07.144480 [debug] [Thread-1 (]: Began running node model.uber.rate_code_dim
[0m19:42:07.145923 [info ] [Thread-1 (]: 6 of 8 START sql table model uber.rate_code_dim ................................ [RUN]
[0m19:42:07.147240 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.uber.pickup_location_dim, now model.uber.rate_code_dim)
[0m19:42:07.147911 [debug] [Thread-1 (]: Began compiling node model.uber.rate_code_dim
[0m19:42:07.170169 [debug] [Thread-1 (]: Writing injected SQL for node "model.uber.rate_code_dim"
[0m19:42:07.172825 [debug] [Thread-1 (]: Timing info for model.uber.rate_code_dim (compile): 19:42:07.148403 => 19:42:07.172629
[0m19:42:07.173348 [debug] [Thread-1 (]: Began executing node model.uber.rate_code_dim
[0m19:42:07.176178 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m19:42:07.636429 [debug] [Thread-1 (]: Writing runtime sql for node "model.uber.rate_code_dim"
[0m19:42:07.641487 [debug] [Thread-1 (]: On model.uber.rate_code_dim: /* {"app": "dbt", "dbt_version": "1.5.9", "profile_name": "uber", "target_name": "dev", "node_id": "model.uber.rate_code_dim"} */

  
    

    create or replace table `uber-data-engineering-407103`.`uber`.`rate_code_dim`
    
    

    OPTIONS()
    as (
      WITH numbered_rows AS (
  SELECT
    GENERATE_UUID() as rate_code_id,
    RatecodeID AS RatecodeID,
    ROW_NUMBER() OVER (ORDER BY RatecodeID) as row_num
  FROM `uber-data-engineering-407103`.`uber`.`uber_tlc_trip_recrord_data`
  WHERE RatecodeID IS NOT NULL
)
SELECT
  rate_code_id,
  RatecodeID
FROM numbered_rows
    );
  
[0m19:42:11.813138 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=uber-data-engineering-407103&j=bq:US:8a4642be-13b6-4620-9905-03755da49117&page=queryresults
[0m19:42:11.831832 [debug] [Thread-1 (]: Timing info for model.uber.rate_code_dim (execute): 19:42:07.173802 => 19:42:11.830961
[0m19:42:11.836010 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '3c11966e-48a5-4e76-b42b-2931a404d6a2', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff81916750>]}
[0m19:42:11.839209 [info ] [Thread-1 (]: 6 of 8 OK created sql table model uber.rate_code_dim ........................... [[32mCREATE TABLE (100.0k rows, 781.2 KiB processed)[0m in 4.69s]
[0m19:42:11.842540 [debug] [Thread-1 (]: Finished running node model.uber.rate_code_dim
[0m19:42:11.845134 [debug] [Thread-1 (]: Began running node model.uber.trip_distance
[0m19:42:11.847651 [info ] [Thread-1 (]: 7 of 8 START sql table model uber.trip_distance ................................ [RUN]
[0m19:42:11.850151 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.uber.rate_code_dim, now model.uber.trip_distance)
[0m19:42:11.851961 [debug] [Thread-1 (]: Began compiling node model.uber.trip_distance
[0m19:42:11.872294 [debug] [Thread-1 (]: Writing injected SQL for node "model.uber.trip_distance"
[0m19:42:11.876673 [debug] [Thread-1 (]: Timing info for model.uber.trip_distance (compile): 19:42:11.853759 => 19:42:11.876034
[0m19:42:11.878241 [debug] [Thread-1 (]: Began executing node model.uber.trip_distance
[0m19:42:11.882000 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m19:42:12.559033 [debug] [Thread-1 (]: Writing runtime sql for node "model.uber.trip_distance"
[0m19:42:12.563428 [debug] [Thread-1 (]: On model.uber.trip_distance: /* {"app": "dbt", "dbt_version": "1.5.9", "profile_name": "uber", "target_name": "dev", "node_id": "model.uber.trip_distance"} */

  
    

    create or replace table `uber-data-engineering-407103`.`uber`.`trip_distance`
    
    

    OPTIONS()
    as (
      WITH numbered_rows AS (
  SELECT
    GENERATE_UUID() as trip_distance_id,
    trip_distance AS trip_distance,
    ROW_NUMBER() OVER (ORDER BY trip_distance) as row_num
  FROM `uber-data-engineering-407103`.`uber`.`uber_tlc_trip_recrord_data`
  WHERE trip_distance IS NOT NULL
)
SELECT
  trip_distance_id,
  trip_distance
FROM numbered_rows
    );
  
[0m19:42:15.256685 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=uber-data-engineering-407103&j=bq:US:d3a2ac93-0e4e-4017-8e59-0cbfa606c543&page=queryresults
[0m19:42:15.276658 [debug] [Thread-1 (]: Timing info for model.uber.trip_distance (execute): 19:42:11.878884 => 19:42:15.275531
[0m19:42:15.279750 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '3c11966e-48a5-4e76-b42b-2931a404d6a2', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff81971150>]}
[0m19:42:15.281659 [info ] [Thread-1 (]: 7 of 8 OK created sql table model uber.trip_distance ........................... [[32mCREATE TABLE (100.0k rows, 781.2 KiB processed)[0m in 3.43s]
[0m19:42:15.283441 [debug] [Thread-1 (]: Finished running node model.uber.trip_distance
[0m19:42:15.286864 [debug] [Thread-1 (]: Began running node model.uber.fact_trip
[0m19:42:15.287567 [info ] [Thread-1 (]: 8 of 8 SKIP relation uber.fact_trip ............................................ [[33mSKIP[0m]
[0m19:42:15.288361 [debug] [Thread-1 (]: Finished running node model.uber.fact_trip
[0m19:42:15.293264 [debug] [MainThread]: Connection 'master' was properly closed.
[0m19:42:15.293781 [debug] [MainThread]: Connection 'model.uber.trip_distance' was properly closed.
[0m19:42:15.294646 [info ] [MainThread]: 
[0m19:42:15.295638 [info ] [MainThread]: Finished running 8 table models in 0 hours 0 minutes and 31.39 seconds (31.39s).
[0m19:42:15.305590 [debug] [MainThread]: Command end result
[0m19:42:15.345098 [info ] [MainThread]: 
[0m19:42:15.346440 [info ] [MainThread]: [31mCompleted with 1 error and 0 warnings:[0m
[0m19:42:15.347570 [info ] [MainThread]: 
[0m19:42:15.348397 [error] [MainThread]: [33mDatabase Error in model passenger_count_dim (models/transform/passenger_count_dim.sql)[0m
[0m19:42:15.349200 [error] [MainThread]:   Syntax error: Expected ")" but got ";" at [23:19]
[0m19:42:15.349913 [error] [MainThread]:   compiled Code at target/run/uber/models/transform/passenger_count_dim.sql
[0m19:42:15.350643 [info ] [MainThread]: 
[0m19:42:15.351762 [info ] [MainThread]: Done. PASS=6 WARN=0 ERROR=1 SKIP=1 TOTAL=8
[0m19:42:15.374353 [debug] [MainThread]: Command `dbt run` failed at 19:42:15.373647 after 32.15 seconds
[0m19:42:15.377197 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff93237b10>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff928b5cd0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff96e2c450>]}
[0m19:42:15.379785 [debug] [MainThread]: Flushing usage events
[0m19:42:30.810149 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffa81122d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffa8121190>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffa954d090>]}


============================== 19:42:30.815385 | 8b3fc8c5-79f9-444f-8b37-a9daf6c4613b ==============================
[0m19:42:30.815385 [info ] [MainThread]: Running with dbt=1.5.9
[0m19:42:30.816316 [debug] [MainThread]: running dbt with arguments {'use_colors': 'True', 'partial_parse': 'True', 'profiles_dir': '/usr/local/airflow/include/dbt/', 'indirect_selection': 'eager', 'static_parser': 'True', 'warn_error': 'None', 'cache_selected_only': 'False', 'debug': 'False', 'target_path': 'None', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'send_anonymous_usage_stats': 'True', 'write_json': 'True', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'log_path': '/usr/local/airflow/include/dbt/logs', 'printer_width': '80', 'log_cache_events': 'False', 'introspect': 'True', 'fail_fast': 'False', 'log_format': 'default', 'version_check': 'True'}
[0m19:42:31.260016 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '8b3fc8c5-79f9-444f-8b37-a9daf6c4613b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffa7dec750>]}
[0m19:42:31.271402 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '8b3fc8c5-79f9-444f-8b37-a9daf6c4613b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffa7847450>]}
[0m19:42:31.272134 [info ] [MainThread]: Registered adapter: bigquery=1.5.3
[0m19:42:31.287030 [debug] [MainThread]: checksum: dd837546c89c9d03f3c2cb0ca6165266a30da6076d5d44e9991f7c5a8e5f5831, vars: {}, profile: , target: , version: 1.5.9
[0m19:42:31.359179 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m19:42:31.359998 [debug] [MainThread]: Partial parsing: updated file: uber://models/transform/passenger_count_dim.sql
[0m19:42:31.378628 [debug] [MainThread]: 1699: static parser successfully parsed transform/passenger_count_dim.sql
[0m19:42:31.408125 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '8b3fc8c5-79f9-444f-8b37-a9daf6c4613b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffa5b4a1d0>]}
[0m19:42:31.420865 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '8b3fc8c5-79f9-444f-8b37-a9daf6c4613b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffa5c75110>]}
[0m19:42:31.421523 [info ] [MainThread]: Found 8 models, 0 tests, 0 snapshots, 0 analyses, 474 macros, 0 operations, 0 seed files, 1 source, 0 exposures, 0 metrics, 0 groups
[0m19:42:31.422362 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '8b3fc8c5-79f9-444f-8b37-a9daf6c4613b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffa5d6c710>]}
[0m19:42:31.423969 [info ] [MainThread]: 
[0m19:42:31.425158 [debug] [MainThread]: Acquiring new bigquery connection 'master'
[0m19:42:31.426909 [debug] [ThreadPool]: Acquiring new bigquery connection 'list_uber-data-engineering-407103'
[0m19:42:31.427398 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m19:42:31.986028 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_uber-data-engineering-407103, now list_uber-data-engineering-407103_uber)
[0m19:42:31.988239 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m19:42:32.414516 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '8b3fc8c5-79f9-444f-8b37-a9daf6c4613b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffa5c4f590>]}
[0m19:42:32.416637 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m19:42:32.417573 [info ] [MainThread]: 
[0m19:42:32.441100 [debug] [Thread-1 (]: Began running node model.uber.datetime_dim
[0m19:42:32.442133 [info ] [Thread-1 (]: 1 of 8 START sql table model uber.datetime_dim ................................. [RUN]
[0m19:42:32.443232 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_uber-data-engineering-407103_uber, now model.uber.datetime_dim)
[0m19:42:32.443827 [debug] [Thread-1 (]: Began compiling node model.uber.datetime_dim
[0m19:42:32.465316 [debug] [Thread-1 (]: Writing injected SQL for node "model.uber.datetime_dim"
[0m19:42:32.467599 [debug] [Thread-1 (]: Timing info for model.uber.datetime_dim (compile): 19:42:32.444307 => 19:42:32.467357
[0m19:42:32.468210 [debug] [Thread-1 (]: Began executing node model.uber.datetime_dim
[0m19:42:32.488438 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m19:42:33.129613 [debug] [Thread-1 (]: Writing runtime sql for node "model.uber.datetime_dim"
[0m19:42:33.132371 [debug] [Thread-1 (]: On model.uber.datetime_dim: /* {"app": "dbt", "dbt_version": "1.5.9", "profile_name": "uber", "target_name": "dev", "node_id": "model.uber.datetime_dim"} */

  
    

    create or replace table `uber-data-engineering-407103`.`uber`.`datetime_dim`
    
    

    OPTIONS()
    as (
      WITH datetime_cte AS (  
  SELECT DISTINCT 
    to_hex(md5(cast(coalesce(cast(tpep_pickup_datetime as STRING), '_dbt_utils_surrogate_key_null_') || '-' || coalesce(cast(tpep_dropoff_datetime as STRING), '_dbt_utils_surrogate_key_null_') as STRING))) AS datetime_id,
    CASE
      WHEN LENGTH(tpep_pickup_datetime) = 16 THEN
        -- Date format: "DD/MM/YYYY HH:MM"
        PARSE_DATETIME('%m/%d/%Y %H:%M', tpep_pickup_datetime)
      WHEN LENGTH(tpep_pickup_datetime) <= 14 THEN
        -- Date format: "MM/DD/YY HH:MM"
        PARSE_DATETIME('%m/%d/%y %H:%M', tpep_pickup_datetime)
      ELSE
        NULL
    END AS pick_date_part,
    tpep_dropoff_datetime AS drop_datetime_id,
    CASE
      WHEN LENGTH(tpep_dropoff_datetime) = 16 THEN
        -- Date format: "DD/MM/YYYY HH:MM"
        PARSE_DATETIME('%m/%d/%Y %H:%M', tpep_dropoff_datetime)
      WHEN LENGTH(tpep_dropoff_datetime) <= 14 THEN
        -- Date format: "MM/DD/YY HH:MM"
        PARSE_DATETIME('%m/%d/%y %H:%M', tpep_dropoff_datetime)
      ELSE
        NULL
    END AS drop_date_part
  FROM `uber-data-engineering-407103`.`uber`.`uber_tlc_trip_recrord_data`
  WHERE tpep_pickup_datetime IS NOT NULL
    AND tpep_dropoff_datetime IS NOT NULL
)
SELECT
  datetime_id,
  pick_date_part AS tpep_pickup_datetime,
  drop_date_part AS tpep_dropoff_datetime,
  EXTRACT(HOUR FROM pick_date_part) AS pick_hour,
  EXTRACT(DAY FROM pick_date_part) AS pick_day,
  EXTRACT(MONTH FROM pick_date_part) AS pick_month,
  EXTRACT(YEAR FROM pick_date_part) AS pick_year,
  EXTRACT(DAYOFWEEK FROM pick_date_part) AS pick_weekday,
  EXTRACT(HOUR FROM drop_date_part) AS drop_hour,
  EXTRACT(DAY FROM drop_date_part) AS drop_day,
  EXTRACT(MONTH FROM drop_date_part) AS drop_month,
  EXTRACT(YEAR FROM drop_date_part) AS drop_year,
  EXTRACT(DAYOFWEEK FROM drop_date_part) AS drop_weekday
FROM datetime_cte
    );
  
[0m19:42:36.190922 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=uber-data-engineering-407103&j=bq:US:054e6702-1e1c-4667-9896-f97b73f34918&page=queryresults
[0m19:42:36.224378 [debug] [Thread-1 (]: Timing info for model.uber.datetime_dim (execute): 19:42:32.468656 => 19:42:36.223912
[0m19:42:36.226462 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '8b3fc8c5-79f9-444f-8b37-a9daf6c4613b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffa5bfda90>]}
[0m19:42:36.228108 [info ] [Thread-1 (]: 1 of 8 OK created sql table model uber.datetime_dim ............................ [[32mCREATE TABLE (99.9k rows, 4.0 MiB processed)[0m in 3.78s]
[0m19:42:36.229814 [debug] [Thread-1 (]: Finished running node model.uber.datetime_dim
[0m19:42:36.230911 [debug] [Thread-1 (]: Began running node model.uber.dropoff_location_dim
[0m19:42:36.232067 [info ] [Thread-1 (]: 2 of 8 START sql table model uber.dropoff_location_dim ......................... [RUN]
[0m19:42:36.233240 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.uber.datetime_dim, now model.uber.dropoff_location_dim)
[0m19:42:36.233938 [debug] [Thread-1 (]: Began compiling node model.uber.dropoff_location_dim
[0m19:42:36.241575 [debug] [Thread-1 (]: Writing injected SQL for node "model.uber.dropoff_location_dim"
[0m19:42:36.244595 [debug] [Thread-1 (]: Timing info for model.uber.dropoff_location_dim (compile): 19:42:36.234680 => 19:42:36.244421
[0m19:42:36.245137 [debug] [Thread-1 (]: Began executing node model.uber.dropoff_location_dim
[0m19:42:36.247975 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m19:42:36.847641 [debug] [Thread-1 (]: Writing runtime sql for node "model.uber.dropoff_location_dim"
[0m19:42:36.852621 [debug] [Thread-1 (]: On model.uber.dropoff_location_dim: /* {"app": "dbt", "dbt_version": "1.5.9", "profile_name": "uber", "target_name": "dev", "node_id": "model.uber.dropoff_location_dim"} */

  
    

    create or replace table `uber-data-engineering-407103`.`uber`.`dropoff_location_dim`
    
    

    OPTIONS()
    as (
      WITH numbered_rows AS (
  SELECT
    to_hex(md5(cast(coalesce(cast(dropoff_latitude as STRING), '_dbt_utils_surrogate_key_null_') || '-' || coalesce(cast(dropoff_longitude as STRING), '_dbt_utils_surrogate_key_null_') as STRING))) as dropoff_location_id,
    dropoff_latitude AS dropoff_latitude,
    dropoff_longitude AS dropoff_longitude,
    ROW_NUMBER() OVER (ORDER BY dropoff_latitude, dropoff_longitude) as row_num
  FROM `uber-data-engineering-407103`.`uber`.`uber_tlc_trip_recrord_data`
)
SELECT
  dropoff_location_id,
  dropoff_latitude,
  dropoff_longitude
FROM numbered_rows
    );
  
[0m19:42:40.377630 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=uber-data-engineering-407103&j=bq:US:5d7f9ba3-840d-43a1-8e31-bb1977d3d5c2&page=queryresults
[0m19:42:40.399085 [debug] [Thread-1 (]: Timing info for model.uber.dropoff_location_dim (execute): 19:42:36.245544 => 19:42:40.398451
[0m19:42:40.401538 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '8b3fc8c5-79f9-444f-8b37-a9daf6c4613b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffa5d6c150>]}
[0m19:42:40.403538 [info ] [Thread-1 (]: 2 of 8 OK created sql table model uber.dropoff_location_dim .................... [[32mCREATE TABLE (100.0k rows, 1.5 MiB processed)[0m in 4.17s]
[0m19:42:40.405929 [debug] [Thread-1 (]: Finished running node model.uber.dropoff_location_dim
[0m19:42:40.407684 [debug] [Thread-1 (]: Began running node model.uber.passenger_count_dim
[0m19:42:40.409837 [info ] [Thread-1 (]: 3 of 8 START sql table model uber.passenger_count_dim .......................... [RUN]
[0m19:42:40.411540 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.uber.dropoff_location_dim, now model.uber.passenger_count_dim)
[0m19:42:40.412679 [debug] [Thread-1 (]: Began compiling node model.uber.passenger_count_dim
[0m19:42:40.423594 [debug] [Thread-1 (]: Writing injected SQL for node "model.uber.passenger_count_dim"
[0m19:42:40.428573 [debug] [Thread-1 (]: Timing info for model.uber.passenger_count_dim (compile): 19:42:40.413648 => 19:42:40.428238
[0m19:42:40.430188 [debug] [Thread-1 (]: Began executing node model.uber.passenger_count_dim
[0m19:42:40.441475 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m19:42:41.021493 [debug] [Thread-1 (]: Writing runtime sql for node "model.uber.passenger_count_dim"
[0m19:42:41.027643 [debug] [Thread-1 (]: On model.uber.passenger_count_dim: /* {"app": "dbt", "dbt_version": "1.5.9", "profile_name": "uber", "target_name": "dev", "node_id": "model.uber.passenger_count_dim"} */

  
    

    create or replace table `uber-data-engineering-407103`.`uber`.`passenger_count_dim`
    
    

    OPTIONS()
    as (
      WITH numbered_rows AS (
  SELECT
    GENERATE_UUID() as passenger_count_id,
    passenger_count AS passenger_count,
    ROW_NUMBER() OVER () as row_num
  FROM `uber-data-engineering-407103`.`uber`.`uber_tlc_trip_recrord_data`
  WHERE passenger_count IS NOT NULL
)
SELECT
  passenger_count_id,
  passenger_count
FROM numbered_rows
    );
  
[0m19:42:43.688412 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=uber-data-engineering-407103&j=bq:US:09aedd7f-f587-4038-87fb-2efb5c810f20&page=queryresults
[0m19:42:43.708314 [debug] [Thread-1 (]: Timing info for model.uber.passenger_count_dim (execute): 19:42:40.431101 => 19:42:43.707383
[0m19:42:43.711297 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '8b3fc8c5-79f9-444f-8b37-a9daf6c4613b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffa5da6610>]}
[0m19:42:43.713226 [info ] [Thread-1 (]: 3 of 8 OK created sql table model uber.passenger_count_dim ..................... [[32mCREATE TABLE (100.0k rows, 781.2 KiB processed)[0m in 3.30s]
[0m19:42:43.715010 [debug] [Thread-1 (]: Finished running node model.uber.passenger_count_dim
[0m19:42:43.716266 [debug] [Thread-1 (]: Began running node model.uber.payment_type_dim
[0m19:42:43.717800 [info ] [Thread-1 (]: 4 of 8 START sql table model uber.payment_type_dim ............................. [RUN]
[0m19:42:43.719022 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.uber.passenger_count_dim, now model.uber.payment_type_dim)
[0m19:42:43.719665 [debug] [Thread-1 (]: Began compiling node model.uber.payment_type_dim
[0m19:42:43.732323 [debug] [Thread-1 (]: Writing injected SQL for node "model.uber.payment_type_dim"
[0m19:42:43.735375 [debug] [Thread-1 (]: Timing info for model.uber.payment_type_dim (compile): 19:42:43.720172 => 19:42:43.735164
[0m19:42:43.735961 [debug] [Thread-1 (]: Began executing node model.uber.payment_type_dim
[0m19:42:43.739281 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m19:42:44.180684 [debug] [Thread-1 (]: Writing runtime sql for node "model.uber.payment_type_dim"
[0m19:42:44.187648 [debug] [Thread-1 (]: On model.uber.payment_type_dim: /* {"app": "dbt", "dbt_version": "1.5.9", "profile_name": "uber", "target_name": "dev", "node_id": "model.uber.payment_type_dim"} */

  
    

    create or replace table `uber-data-engineering-407103`.`uber`.`payment_type_dim`
    
    

    OPTIONS()
    as (
      WITH numbered_rows AS (
  SELECT
    GENERATE_UUID() as payment_type_id,
    payment_type AS payment_type,
    ROW_NUMBER() OVER (ORDER BY payment_type) as row_num
  FROM `uber-data-engineering-407103`.`uber`.`uber_tlc_trip_recrord_data`
  WHERE payment_type IS NOT NULL
)
SELECT
  payment_type_id,
  payment_type
FROM numbered_rows
    );
  
[0m19:42:46.732190 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=uber-data-engineering-407103&j=bq:US:06827440-0c23-4293-bb37-2eed2b3e9d31&page=queryresults
[0m19:42:46.734474 [debug] [Thread-1 (]: Timing info for model.uber.payment_type_dim (execute): 19:42:43.736478 => 19:42:46.734318
[0m19:42:46.735415 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '8b3fc8c5-79f9-444f-8b37-a9daf6c4613b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffa5d6c150>]}
[0m19:42:46.736143 [info ] [Thread-1 (]: 4 of 8 OK created sql table model uber.payment_type_dim ........................ [[32mCREATE TABLE (100.0k rows, 781.2 KiB processed)[0m in 3.02s]
[0m19:42:46.737201 [debug] [Thread-1 (]: Finished running node model.uber.payment_type_dim
[0m19:42:46.737886 [debug] [Thread-1 (]: Began running node model.uber.pickup_location_dim
[0m19:42:46.738562 [info ] [Thread-1 (]: 5 of 8 START sql table model uber.pickup_location_dim .......................... [RUN]
[0m19:42:46.739549 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.uber.payment_type_dim, now model.uber.pickup_location_dim)
[0m19:42:46.740177 [debug] [Thread-1 (]: Began compiling node model.uber.pickup_location_dim
[0m19:42:46.744875 [debug] [Thread-1 (]: Writing injected SQL for node "model.uber.pickup_location_dim"
[0m19:42:46.746788 [debug] [Thread-1 (]: Timing info for model.uber.pickup_location_dim (compile): 19:42:46.740581 => 19:42:46.746600
[0m19:42:46.747278 [debug] [Thread-1 (]: Began executing node model.uber.pickup_location_dim
[0m19:42:46.749424 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m19:42:47.160465 [debug] [Thread-1 (]: Writing runtime sql for node "model.uber.pickup_location_dim"
[0m19:42:47.165158 [debug] [Thread-1 (]: On model.uber.pickup_location_dim: /* {"app": "dbt", "dbt_version": "1.5.9", "profile_name": "uber", "target_name": "dev", "node_id": "model.uber.pickup_location_dim"} */

  
    

    create or replace table `uber-data-engineering-407103`.`uber`.`pickup_location_dim`
    
    

    OPTIONS()
    as (
      WITH numbered_rows AS (
  SELECT
    to_hex(md5(cast(coalesce(cast(pickup_latitude as STRING), '_dbt_utils_surrogate_key_null_') || '-' || coalesce(cast(pickup_longitude as STRING), '_dbt_utils_surrogate_key_null_') as STRING))) as pickup_location_id,
    pickup_latitude AS pickup_latitude,
    pickup_longitude AS pickup_longitude,
    ROW_NUMBER() OVER (ORDER BY pickup_latitude, pickup_longitude) as row_num
  FROM `uber-data-engineering-407103`.`uber`.`uber_tlc_trip_recrord_data`
)
SELECT
  pickup_location_id,
  pickup_latitude,
  pickup_longitude
FROM numbered_rows
    );
  
[0m19:42:50.615611 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=uber-data-engineering-407103&j=bq:US:b690b9a2-b90c-4bbb-a3fb-1c9fe41df504&page=queryresults
[0m19:42:50.629826 [debug] [Thread-1 (]: Timing info for model.uber.pickup_location_dim (execute): 19:42:46.747636 => 19:42:50.628549
[0m19:42:50.633551 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '8b3fc8c5-79f9-444f-8b37-a9daf6c4613b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffa4a0ba10>]}
[0m19:42:50.635499 [info ] [Thread-1 (]: 5 of 8 OK created sql table model uber.pickup_location_dim ..................... [[32mCREATE TABLE (100.0k rows, 1.5 MiB processed)[0m in 3.89s]
[0m19:42:50.637071 [debug] [Thread-1 (]: Finished running node model.uber.pickup_location_dim
[0m19:42:50.638162 [debug] [Thread-1 (]: Began running node model.uber.rate_code_dim
[0m19:42:50.640069 [info ] [Thread-1 (]: 6 of 8 START sql table model uber.rate_code_dim ................................ [RUN]
[0m19:42:50.641380 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.uber.pickup_location_dim, now model.uber.rate_code_dim)
[0m19:42:50.642082 [debug] [Thread-1 (]: Began compiling node model.uber.rate_code_dim
[0m19:42:50.660421 [debug] [Thread-1 (]: Writing injected SQL for node "model.uber.rate_code_dim"
[0m19:42:50.665985 [debug] [Thread-1 (]: Timing info for model.uber.rate_code_dim (compile): 19:42:50.642685 => 19:42:50.665487
[0m19:42:50.667066 [debug] [Thread-1 (]: Began executing node model.uber.rate_code_dim
[0m19:42:50.673250 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m19:42:51.313863 [debug] [Thread-1 (]: Writing runtime sql for node "model.uber.rate_code_dim"
[0m19:42:51.320468 [debug] [Thread-1 (]: On model.uber.rate_code_dim: /* {"app": "dbt", "dbt_version": "1.5.9", "profile_name": "uber", "target_name": "dev", "node_id": "model.uber.rate_code_dim"} */

  
    

    create or replace table `uber-data-engineering-407103`.`uber`.`rate_code_dim`
    
    

    OPTIONS()
    as (
      WITH numbered_rows AS (
  SELECT
    GENERATE_UUID() as rate_code_id,
    RatecodeID AS RatecodeID,
    ROW_NUMBER() OVER (ORDER BY RatecodeID) as row_num
  FROM `uber-data-engineering-407103`.`uber`.`uber_tlc_trip_recrord_data`
  WHERE RatecodeID IS NOT NULL
)
SELECT
  rate_code_id,
  RatecodeID
FROM numbered_rows
    );
  
[0m19:42:53.947100 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=uber-data-engineering-407103&j=bq:US:3b2b116f-aea9-44f7-896f-39284e030766&page=queryresults
[0m19:42:53.956566 [debug] [Thread-1 (]: Timing info for model.uber.rate_code_dim (execute): 19:42:50.668650 => 19:42:53.955978
[0m19:42:53.959053 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '8b3fc8c5-79f9-444f-8b37-a9daf6c4613b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffa4a35dd0>]}
[0m19:42:53.960836 [info ] [Thread-1 (]: 6 of 8 OK created sql table model uber.rate_code_dim ........................... [[32mCREATE TABLE (100.0k rows, 781.2 KiB processed)[0m in 3.32s]
[0m19:42:53.962739 [debug] [Thread-1 (]: Finished running node model.uber.rate_code_dim
[0m19:42:53.965641 [debug] [Thread-1 (]: Began running node model.uber.trip_distance
[0m19:42:53.967773 [info ] [Thread-1 (]: 7 of 8 START sql table model uber.trip_distance ................................ [RUN]
[0m19:42:53.969151 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.uber.rate_code_dim, now model.uber.trip_distance)
[0m19:42:53.969763 [debug] [Thread-1 (]: Began compiling node model.uber.trip_distance
[0m19:42:53.974839 [debug] [Thread-1 (]: Writing injected SQL for node "model.uber.trip_distance"
[0m19:42:53.977414 [debug] [Thread-1 (]: Timing info for model.uber.trip_distance (compile): 19:42:53.970342 => 19:42:53.977185
[0m19:42:53.978304 [debug] [Thread-1 (]: Began executing node model.uber.trip_distance
[0m19:42:53.980500 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m19:42:54.632203 [debug] [Thread-1 (]: Writing runtime sql for node "model.uber.trip_distance"
[0m19:42:54.638815 [debug] [Thread-1 (]: On model.uber.trip_distance: /* {"app": "dbt", "dbt_version": "1.5.9", "profile_name": "uber", "target_name": "dev", "node_id": "model.uber.trip_distance"} */

  
    

    create or replace table `uber-data-engineering-407103`.`uber`.`trip_distance`
    
    

    OPTIONS()
    as (
      WITH numbered_rows AS (
  SELECT
    GENERATE_UUID() as trip_distance_id,
    trip_distance AS trip_distance,
    ROW_NUMBER() OVER (ORDER BY trip_distance) as row_num
  FROM `uber-data-engineering-407103`.`uber`.`uber_tlc_trip_recrord_data`
  WHERE trip_distance IS NOT NULL
)
SELECT
  trip_distance_id,
  trip_distance
FROM numbered_rows
    );
  
[0m19:42:57.073204 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=uber-data-engineering-407103&j=bq:US:ce365792-a780-4f8b-b2a2-4a5f001188f5&page=queryresults
[0m19:42:57.101188 [debug] [Thread-1 (]: Timing info for model.uber.trip_distance (execute): 19:42:53.978764 => 19:42:57.100137
[0m19:42:57.105005 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '8b3fc8c5-79f9-444f-8b37-a9daf6c4613b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffa5b6cc10>]}
[0m19:42:57.106999 [info ] [Thread-1 (]: 7 of 8 OK created sql table model uber.trip_distance ........................... [[32mCREATE TABLE (100.0k rows, 781.2 KiB processed)[0m in 3.14s]
[0m19:42:57.109099 [debug] [Thread-1 (]: Finished running node model.uber.trip_distance
[0m19:42:57.112889 [debug] [Thread-1 (]: Began running node model.uber.fact_trip
[0m19:42:57.113882 [info ] [Thread-1 (]: 8 of 8 START sql table model uber.fact_trip .................................... [RUN]
[0m19:42:57.115270 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.uber.trip_distance, now model.uber.fact_trip)
[0m19:42:57.116019 [debug] [Thread-1 (]: Began compiling node model.uber.fact_trip
[0m19:42:57.136537 [debug] [Thread-1 (]: Writing injected SQL for node "model.uber.fact_trip"
[0m19:42:57.143799 [debug] [Thread-1 (]: Timing info for model.uber.fact_trip (compile): 19:42:57.116526 => 19:42:57.143435
[0m19:42:57.144909 [debug] [Thread-1 (]: Began executing node model.uber.fact_trip
[0m19:42:57.155779 [debug] [Thread-1 (]: Writing runtime sql for node "model.uber.fact_trip"
[0m19:42:57.160794 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m19:42:57.164199 [debug] [Thread-1 (]: On model.uber.fact_trip: /* {"app": "dbt", "dbt_version": "1.5.9", "profile_name": "uber", "target_name": "dev", "node_id": "model.uber.fact_trip"} */

  
    

    create or replace table `uber-data-engineering-407103`.`uber`.`fact_trip`
    
    

    OPTIONS()
    as (
      WITH fct_invoices_cte AS (
    SELECT
        CAST(ROW_NUMBER() OVER () AS INT64) as trip_id,
        VendorID,
        to_hex(md5(cast(coalesce(cast(tpep_pickup_datetime as STRING), '_dbt_utils_surrogate_key_null_') || '-' || coalesce(cast(tpep_dropoff_datetime as STRING), '_dbt_utils_surrogate_key_null_') as STRING))) AS datetime_id,
        passenger_count_id,
        trip_distance_id,
        rate_code_id,
        store_and_fwd_flag,
        pickup_location_id,
        to_hex(md5(cast(coalesce(cast(dropoff_latitude as STRING), '_dbt_utils_surrogate_key_null_') || '-' || coalesce(cast(dropoff_longitude as STRING), '_dbt_utils_surrogate_key_null_') as STRING))) as dropoff_location_id,
        payment_type_id,
        fare_amount,
        extra,
        mta_tax,
        tip_amount,
        tolls_amount,
        improvement_surcharge,
        total_amount
    FROM `uber-data-engineering-407103`.`uber`.`uber_tlc_trip_recrord_data`
)
SELECT
    trip_id,
    VendorID,
    datetime_id,
    do.dropoff_location_id,
    pu.pickup_location_id,
    pc.passenger_count_id,
    pt.payment_type_id,
    rc.rate_code_id,
    store_and_fwd_flag,
    td.trip_distance_id,
    fare_amount,
    extra,
    mta_tax,
    tip_amount,
    tolls_amount,
    improvement_surcharge AS improvement_surcharge_amount,  -- Added alias
    total_amount
FROM fct_invoices_cte fi
INNER JOIN `uber-data-engineering-407103`.`uber`.`datetime_dim` dt ON fi.datetime_id = dt.datetime_id
INNER JOIN `uber-data-engineering-407103`.`uber`.`dropoff_location_dim` do ON fi.dropoff_location_id = do.dropoff_location_id
INNER JOIN `uber-data-engineering-407103`.`uber`.`pickup_location_dim` pu ON fi.pickup_location_id = pu.pickup_location_id
INNER JOIN `uber-data-engineering-407103`.`uber`.`passenger_count_dim` pc ON fi.passenger_count_id = pc.passenger_count_id
INNER JOIN `uber-data-engineering-407103`.`uber`.`payment_type_dim` pt ON fi.payment_type_id = pt.payment_type_id
INNER JOIN `uber-data-engineering-407103`.`uber`.`rate_code_dim` rc ON fi.rate_code_id = rc.rate_code_id
INNER JOIN `uber-data-engineering-407103`.`uber`.`trip_distance` td ON fi.trip_distance_id = td.trip_distance_id
    );
  
[0m19:42:58.215290 [debug] [Thread-1 (]: BigQuery adapter: Retry attempt 1 of 1 after error: BadRequest('Unrecognized name: passenger_count_id; Did you mean passenger_count? at [17:9]')
[0m19:42:59.592142 [error] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=uber-data-engineering-407103&j=bq:US:62153ef3-24c4-47fa-a4b6-f8ad10291312&page=queryresults
[0m19:42:59.595926 [debug] [Thread-1 (]: Timing info for model.uber.fact_trip (execute): 19:42:57.145681 => 19:42:59.595422
[0m19:42:59.607327 [debug] [Thread-1 (]: Database Error in model fact_trip (models/transform/fact_trip.sql)
  Unrecognized name: passenger_count_id; Did you mean passenger_count? at [17:9]
  compiled Code at target/run/uber/models/transform/fact_trip.sql
[0m19:42:59.608533 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '8b3fc8c5-79f9-444f-8b37-a9daf6c4613b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffa49cef10>]}
[0m19:42:59.609761 [error] [Thread-1 (]: 8 of 8 ERROR creating sql table model uber.fact_trip ........................... [[31mERROR[0m in 2.49s]
[0m19:42:59.610747 [debug] [Thread-1 (]: Finished running node model.uber.fact_trip
[0m19:42:59.614907 [debug] [MainThread]: Connection 'master' was properly closed.
[0m19:42:59.616002 [debug] [MainThread]: Connection 'model.uber.fact_trip' was properly closed.
[0m19:42:59.616924 [info ] [MainThread]: 
[0m19:42:59.617753 [info ] [MainThread]: Finished running 8 table models in 0 hours 0 minutes and 28.19 seconds (28.19s).
[0m19:42:59.620423 [debug] [MainThread]: Command end result
[0m19:42:59.646297 [info ] [MainThread]: 
[0m19:42:59.647721 [info ] [MainThread]: [31mCompleted with 1 error and 0 warnings:[0m
[0m19:42:59.648563 [info ] [MainThread]: 
[0m19:42:59.649385 [error] [MainThread]: [33mDatabase Error in model fact_trip (models/transform/fact_trip.sql)[0m
[0m19:42:59.650144 [error] [MainThread]:   Unrecognized name: passenger_count_id; Did you mean passenger_count? at [17:9]
[0m19:42:59.650760 [error] [MainThread]:   compiled Code at target/run/uber/models/transform/fact_trip.sql
[0m19:42:59.651513 [info ] [MainThread]: 
[0m19:42:59.660338 [info ] [MainThread]: Done. PASS=7 WARN=0 ERROR=1 SKIP=0 TOTAL=8
[0m19:42:59.662514 [debug] [MainThread]: Command `dbt run` failed at 19:42:59.662287 after 28.86 seconds
[0m19:42:59.663354 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffa81201d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffa7dec490>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffa82f8150>]}
[0m19:42:59.664291 [debug] [MainThread]: Flushing usage events
[0m19:44:04.861306 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff903e05d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff90586d50>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff905907d0>]}


============================== 19:44:04.866559 | b75c7a70-a932-4395-8820-b8592fc4b0ad ==============================
[0m19:44:04.866559 [info ] [MainThread]: Running with dbt=1.5.9
[0m19:44:04.867351 [debug] [MainThread]: running dbt with arguments {'version_check': 'True', 'use_experimental_parser': 'False', 'use_colors': 'True', 'log_cache_events': 'False', 'send_anonymous_usage_stats': 'True', 'no_print': 'None', 'cache_selected_only': 'False', 'quiet': 'False', 'log_format': 'default', 'printer_width': '80', 'target_path': 'None', 'write_json': 'True', 'profiles_dir': '/usr/local/airflow/include/dbt/', 'static_parser': 'True', 'debug': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'warn_error': 'None', 'log_path': '/usr/local/airflow/include/dbt/logs', 'fail_fast': 'False', 'partial_parse': 'True', 'introspect': 'True', 'indirect_selection': 'eager'}
[0m19:44:05.279776 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'b75c7a70-a932-4395-8820-b8592fc4b0ad', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff8e37ef90>]}
[0m19:44:05.291053 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'b75c7a70-a932-4395-8820-b8592fc4b0ad', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff8e35cf90>]}
[0m19:44:05.291792 [info ] [MainThread]: Registered adapter: bigquery=1.5.3
[0m19:44:05.307075 [debug] [MainThread]: checksum: dd837546c89c9d03f3c2cb0ca6165266a30da6076d5d44e9991f7c5a8e5f5831, vars: {}, profile: , target: , version: 1.5.9
[0m19:44:05.402769 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m19:44:05.403641 [debug] [MainThread]: Partial parsing: updated file: uber://models/transform/fact_trip.sql
[0m19:44:05.421475 [debug] [MainThread]: 1603: static parser failed on transform/fact_trip.sql
[0m19:44:05.445972 [debug] [MainThread]: 1602: parser fallback to jinja rendering on transform/fact_trip.sql
[0m19:44:05.460761 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'b75c7a70-a932-4395-8820-b8592fc4b0ad', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff8e1fa310>]}
[0m19:44:05.474795 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'b75c7a70-a932-4395-8820-b8592fc4b0ad', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff8e265310>]}
[0m19:44:05.475488 [info ] [MainThread]: Found 8 models, 0 tests, 0 snapshots, 0 analyses, 474 macros, 0 operations, 0 seed files, 1 source, 0 exposures, 0 metrics, 0 groups
[0m19:44:05.476204 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'b75c7a70-a932-4395-8820-b8592fc4b0ad', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff93243a10>]}
[0m19:44:05.477730 [info ] [MainThread]: 
[0m19:44:05.478868 [debug] [MainThread]: Acquiring new bigquery connection 'master'
[0m19:44:05.480578 [debug] [ThreadPool]: Acquiring new bigquery connection 'list_uber-data-engineering-407103'
[0m19:44:05.483561 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m19:44:06.008446 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_uber-data-engineering-407103, now list_uber-data-engineering-407103_uber)
[0m19:44:06.011240 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m19:44:06.498893 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'b75c7a70-a932-4395-8820-b8592fc4b0ad', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff90e4eb50>]}
[0m19:44:06.501150 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m19:44:06.502451 [info ] [MainThread]: 
[0m19:44:06.521560 [debug] [Thread-1 (]: Began running node model.uber.datetime_dim
[0m19:44:06.522577 [info ] [Thread-1 (]: 1 of 8 START sql table model uber.datetime_dim ................................. [RUN]
[0m19:44:06.523720 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_uber-data-engineering-407103_uber, now model.uber.datetime_dim)
[0m19:44:06.524328 [debug] [Thread-1 (]: Began compiling node model.uber.datetime_dim
[0m19:44:06.541268 [debug] [Thread-1 (]: Writing injected SQL for node "model.uber.datetime_dim"
[0m19:44:06.546995 [debug] [Thread-1 (]: Timing info for model.uber.datetime_dim (compile): 19:44:06.524821 => 19:44:06.546593
[0m19:44:06.548041 [debug] [Thread-1 (]: Began executing node model.uber.datetime_dim
[0m19:44:06.565145 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m19:44:06.985820 [debug] [Thread-1 (]: Writing runtime sql for node "model.uber.datetime_dim"
[0m19:44:06.988525 [debug] [Thread-1 (]: On model.uber.datetime_dim: /* {"app": "dbt", "dbt_version": "1.5.9", "profile_name": "uber", "target_name": "dev", "node_id": "model.uber.datetime_dim"} */

  
    

    create or replace table `uber-data-engineering-407103`.`uber`.`datetime_dim`
    
    

    OPTIONS()
    as (
      WITH datetime_cte AS (  
  SELECT DISTINCT 
    to_hex(md5(cast(coalesce(cast(tpep_pickup_datetime as STRING), '_dbt_utils_surrogate_key_null_') || '-' || coalesce(cast(tpep_dropoff_datetime as STRING), '_dbt_utils_surrogate_key_null_') as STRING))) AS datetime_id,
    CASE
      WHEN LENGTH(tpep_pickup_datetime) = 16 THEN
        -- Date format: "DD/MM/YYYY HH:MM"
        PARSE_DATETIME('%m/%d/%Y %H:%M', tpep_pickup_datetime)
      WHEN LENGTH(tpep_pickup_datetime) <= 14 THEN
        -- Date format: "MM/DD/YY HH:MM"
        PARSE_DATETIME('%m/%d/%y %H:%M', tpep_pickup_datetime)
      ELSE
        NULL
    END AS pick_date_part,
    tpep_dropoff_datetime AS drop_datetime_id,
    CASE
      WHEN LENGTH(tpep_dropoff_datetime) = 16 THEN
        -- Date format: "DD/MM/YYYY HH:MM"
        PARSE_DATETIME('%m/%d/%Y %H:%M', tpep_dropoff_datetime)
      WHEN LENGTH(tpep_dropoff_datetime) <= 14 THEN
        -- Date format: "MM/DD/YY HH:MM"
        PARSE_DATETIME('%m/%d/%y %H:%M', tpep_dropoff_datetime)
      ELSE
        NULL
    END AS drop_date_part
  FROM `uber-data-engineering-407103`.`uber`.`uber_tlc_trip_recrord_data`
  WHERE tpep_pickup_datetime IS NOT NULL
    AND tpep_dropoff_datetime IS NOT NULL
)
SELECT
  datetime_id,
  pick_date_part AS tpep_pickup_datetime,
  drop_date_part AS tpep_dropoff_datetime,
  EXTRACT(HOUR FROM pick_date_part) AS pick_hour,
  EXTRACT(DAY FROM pick_date_part) AS pick_day,
  EXTRACT(MONTH FROM pick_date_part) AS pick_month,
  EXTRACT(YEAR FROM pick_date_part) AS pick_year,
  EXTRACT(DAYOFWEEK FROM pick_date_part) AS pick_weekday,
  EXTRACT(HOUR FROM drop_date_part) AS drop_hour,
  EXTRACT(DAY FROM drop_date_part) AS drop_day,
  EXTRACT(MONTH FROM drop_date_part) AS drop_month,
  EXTRACT(YEAR FROM drop_date_part) AS drop_year,
  EXTRACT(DAYOFWEEK FROM drop_date_part) AS drop_weekday
FROM datetime_cte
    );
  
[0m19:44:10.791628 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=uber-data-engineering-407103&j=bq:US:d85d33bc-c00f-4991-9273-2e0b8293baad&page=queryresults
[0m19:44:10.822666 [debug] [Thread-1 (]: Timing info for model.uber.datetime_dim (execute): 19:44:06.548691 => 19:44:10.822308
[0m19:44:10.827988 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'b75c7a70-a932-4395-8820-b8592fc4b0ad', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff8e1477d0>]}
[0m19:44:10.830411 [info ] [Thread-1 (]: 1 of 8 OK created sql table model uber.datetime_dim ............................ [[32mCREATE TABLE (99.9k rows, 4.0 MiB processed)[0m in 4.30s]
[0m19:44:10.832881 [debug] [Thread-1 (]: Finished running node model.uber.datetime_dim
[0m19:44:10.834657 [debug] [Thread-1 (]: Began running node model.uber.dropoff_location_dim
[0m19:44:10.839894 [info ] [Thread-1 (]: 2 of 8 START sql table model uber.dropoff_location_dim ......................... [RUN]
[0m19:44:10.841092 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.uber.datetime_dim, now model.uber.dropoff_location_dim)
[0m19:44:10.841711 [debug] [Thread-1 (]: Began compiling node model.uber.dropoff_location_dim
[0m19:44:10.848839 [debug] [Thread-1 (]: Writing injected SQL for node "model.uber.dropoff_location_dim"
[0m19:44:10.851758 [debug] [Thread-1 (]: Timing info for model.uber.dropoff_location_dim (compile): 19:44:10.842342 => 19:44:10.851580
[0m19:44:10.852251 [debug] [Thread-1 (]: Began executing node model.uber.dropoff_location_dim
[0m19:44:10.855012 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m19:44:11.304612 [debug] [Thread-1 (]: Writing runtime sql for node "model.uber.dropoff_location_dim"
[0m19:44:11.310441 [debug] [Thread-1 (]: On model.uber.dropoff_location_dim: /* {"app": "dbt", "dbt_version": "1.5.9", "profile_name": "uber", "target_name": "dev", "node_id": "model.uber.dropoff_location_dim"} */

  
    

    create or replace table `uber-data-engineering-407103`.`uber`.`dropoff_location_dim`
    
    

    OPTIONS()
    as (
      WITH numbered_rows AS (
  SELECT
    to_hex(md5(cast(coalesce(cast(dropoff_latitude as STRING), '_dbt_utils_surrogate_key_null_') || '-' || coalesce(cast(dropoff_longitude as STRING), '_dbt_utils_surrogate_key_null_') as STRING))) as dropoff_location_id,
    dropoff_latitude AS dropoff_latitude,
    dropoff_longitude AS dropoff_longitude,
    ROW_NUMBER() OVER (ORDER BY dropoff_latitude, dropoff_longitude) as row_num
  FROM `uber-data-engineering-407103`.`uber`.`uber_tlc_trip_recrord_data`
)
SELECT
  dropoff_location_id,
  dropoff_latitude,
  dropoff_longitude
FROM numbered_rows
    );
  
[0m19:44:14.434333 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=uber-data-engineering-407103&j=bq:US:dc11c486-1788-4ab8-8750-154c1c972300&page=queryresults
[0m19:44:14.452131 [debug] [Thread-1 (]: Timing info for model.uber.dropoff_location_dim (execute): 19:44:10.852660 => 19:44:14.451522
[0m19:44:14.454785 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'b75c7a70-a932-4395-8820-b8592fc4b0ad', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff8e19f810>]}
[0m19:44:14.456865 [info ] [Thread-1 (]: 2 of 8 OK created sql table model uber.dropoff_location_dim .................... [[32mCREATE TABLE (100.0k rows, 1.5 MiB processed)[0m in 3.61s]
[0m19:44:14.458786 [debug] [Thread-1 (]: Finished running node model.uber.dropoff_location_dim
[0m19:44:14.460403 [debug] [Thread-1 (]: Began running node model.uber.passenger_count_dim
[0m19:44:14.465789 [info ] [Thread-1 (]: 3 of 8 START sql table model uber.passenger_count_dim .......................... [RUN]
[0m19:44:14.469162 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.uber.dropoff_location_dim, now model.uber.passenger_count_dim)
[0m19:44:14.470171 [debug] [Thread-1 (]: Began compiling node model.uber.passenger_count_dim
[0m19:44:14.479453 [debug] [Thread-1 (]: Writing injected SQL for node "model.uber.passenger_count_dim"
[0m19:44:14.482365 [debug] [Thread-1 (]: Timing info for model.uber.passenger_count_dim (compile): 19:44:14.470810 => 19:44:14.482136
[0m19:44:14.483259 [debug] [Thread-1 (]: Began executing node model.uber.passenger_count_dim
[0m19:44:14.486444 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m19:44:14.888694 [debug] [Thread-1 (]: Writing runtime sql for node "model.uber.passenger_count_dim"
[0m19:44:14.893725 [debug] [Thread-1 (]: On model.uber.passenger_count_dim: /* {"app": "dbt", "dbt_version": "1.5.9", "profile_name": "uber", "target_name": "dev", "node_id": "model.uber.passenger_count_dim"} */

  
    

    create or replace table `uber-data-engineering-407103`.`uber`.`passenger_count_dim`
    
    

    OPTIONS()
    as (
      WITH numbered_rows AS (
  SELECT
    GENERATE_UUID() as passenger_count_id,
    passenger_count AS passenger_count,
    ROW_NUMBER() OVER () as row_num
  FROM `uber-data-engineering-407103`.`uber`.`uber_tlc_trip_recrord_data`
  WHERE passenger_count IS NOT NULL
)
SELECT
  passenger_count_id,
  passenger_count
FROM numbered_rows
    );
  
[0m19:44:17.615412 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=uber-data-engineering-407103&j=bq:US:bb5a9730-c163-482c-ad12-4ec937bbc4de&page=queryresults
[0m19:44:17.628318 [debug] [Thread-1 (]: Timing info for model.uber.passenger_count_dim (execute): 19:44:14.483734 => 19:44:17.627521
[0m19:44:17.631663 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'b75c7a70-a932-4395-8820-b8592fc4b0ad', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff8e0c0f10>]}
[0m19:44:17.633814 [info ] [Thread-1 (]: 3 of 8 OK created sql table model uber.passenger_count_dim ..................... [[32mCREATE TABLE (100.0k rows, 781.2 KiB processed)[0m in 3.16s]
[0m19:44:17.636530 [debug] [Thread-1 (]: Finished running node model.uber.passenger_count_dim
[0m19:44:17.638820 [debug] [Thread-1 (]: Began running node model.uber.payment_type_dim
[0m19:44:17.640262 [info ] [Thread-1 (]: 4 of 8 START sql table model uber.payment_type_dim ............................. [RUN]
[0m19:44:17.641602 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.uber.passenger_count_dim, now model.uber.payment_type_dim)
[0m19:44:17.642272 [debug] [Thread-1 (]: Began compiling node model.uber.payment_type_dim
[0m19:44:17.650745 [debug] [Thread-1 (]: Writing injected SQL for node "model.uber.payment_type_dim"
[0m19:44:17.654739 [debug] [Thread-1 (]: Timing info for model.uber.payment_type_dim (compile): 19:44:17.642796 => 19:44:17.654414
[0m19:44:17.655621 [debug] [Thread-1 (]: Began executing node model.uber.payment_type_dim
[0m19:44:17.660594 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m19:44:18.115526 [debug] [Thread-1 (]: Writing runtime sql for node "model.uber.payment_type_dim"
[0m19:44:18.119124 [debug] [Thread-1 (]: On model.uber.payment_type_dim: /* {"app": "dbt", "dbt_version": "1.5.9", "profile_name": "uber", "target_name": "dev", "node_id": "model.uber.payment_type_dim"} */

  
    

    create or replace table `uber-data-engineering-407103`.`uber`.`payment_type_dim`
    
    

    OPTIONS()
    as (
      WITH numbered_rows AS (
  SELECT
    GENERATE_UUID() as payment_type_id,
    payment_type AS payment_type,
    ROW_NUMBER() OVER (ORDER BY payment_type) as row_num
  FROM `uber-data-engineering-407103`.`uber`.`uber_tlc_trip_recrord_data`
  WHERE payment_type IS NOT NULL
)
SELECT
  payment_type_id,
  payment_type
FROM numbered_rows
    );
  
[0m19:44:20.970304 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=uber-data-engineering-407103&j=bq:US:5dd9c127-d2e4-47bc-852e-7b2294abc7f6&page=queryresults
[0m19:44:20.983884 [debug] [Thread-1 (]: Timing info for model.uber.payment_type_dim (execute): 19:44:17.656569 => 19:44:20.983117
[0m19:44:20.987527 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'b75c7a70-a932-4395-8820-b8592fc4b0ad', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff8e27e910>]}
[0m19:44:20.989699 [info ] [Thread-1 (]: 4 of 8 OK created sql table model uber.payment_type_dim ........................ [[32mCREATE TABLE (100.0k rows, 781.2 KiB processed)[0m in 3.35s]
[0m19:44:20.991810 [debug] [Thread-1 (]: Finished running node model.uber.payment_type_dim
[0m19:44:20.993504 [debug] [Thread-1 (]: Began running node model.uber.pickup_location_dim
[0m19:44:20.995373 [info ] [Thread-1 (]: 5 of 8 START sql table model uber.pickup_location_dim .......................... [RUN]
[0m19:44:20.996692 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.uber.payment_type_dim, now model.uber.pickup_location_dim)
[0m19:44:20.997319 [debug] [Thread-1 (]: Began compiling node model.uber.pickup_location_dim
[0m19:44:21.004174 [debug] [Thread-1 (]: Writing injected SQL for node "model.uber.pickup_location_dim"
[0m19:44:21.006528 [debug] [Thread-1 (]: Timing info for model.uber.pickup_location_dim (compile): 19:44:20.997785 => 19:44:21.006298
[0m19:44:21.007284 [debug] [Thread-1 (]: Began executing node model.uber.pickup_location_dim
[0m19:44:21.010131 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m19:44:21.440333 [debug] [Thread-1 (]: Writing runtime sql for node "model.uber.pickup_location_dim"
[0m19:44:21.444908 [debug] [Thread-1 (]: On model.uber.pickup_location_dim: /* {"app": "dbt", "dbt_version": "1.5.9", "profile_name": "uber", "target_name": "dev", "node_id": "model.uber.pickup_location_dim"} */

  
    

    create or replace table `uber-data-engineering-407103`.`uber`.`pickup_location_dim`
    
    

    OPTIONS()
    as (
      WITH numbered_rows AS (
  SELECT
    to_hex(md5(cast(coalesce(cast(pickup_latitude as STRING), '_dbt_utils_surrogate_key_null_') || '-' || coalesce(cast(pickup_longitude as STRING), '_dbt_utils_surrogate_key_null_') as STRING))) as pickup_location_id,
    pickup_latitude AS pickup_latitude,
    pickup_longitude AS pickup_longitude,
    ROW_NUMBER() OVER (ORDER BY pickup_latitude, pickup_longitude) as row_num
  FROM `uber-data-engineering-407103`.`uber`.`uber_tlc_trip_recrord_data`
)
SELECT
  pickup_location_id,
  pickup_latitude,
  pickup_longitude
FROM numbered_rows
    );
  
[0m19:44:24.816926 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=uber-data-engineering-407103&j=bq:US:463a3929-df6d-4d84-9ac8-1cd28716035d&page=queryresults
[0m19:44:24.827104 [debug] [Thread-1 (]: Timing info for model.uber.pickup_location_dim (execute): 19:44:21.007859 => 19:44:24.826263
[0m19:44:24.828983 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'b75c7a70-a932-4395-8820-b8592fc4b0ad', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff8e04c310>]}
[0m19:44:24.830182 [info ] [Thread-1 (]: 5 of 8 OK created sql table model uber.pickup_location_dim ..................... [[32mCREATE TABLE (100.0k rows, 1.5 MiB processed)[0m in 3.83s]
[0m19:44:24.832847 [debug] [Thread-1 (]: Finished running node model.uber.pickup_location_dim
[0m19:44:24.833697 [debug] [Thread-1 (]: Began running node model.uber.rate_code_dim
[0m19:44:24.835298 [info ] [Thread-1 (]: 6 of 8 START sql table model uber.rate_code_dim ................................ [RUN]
[0m19:44:24.837245 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.uber.pickup_location_dim, now model.uber.rate_code_dim)
[0m19:44:24.838239 [debug] [Thread-1 (]: Began compiling node model.uber.rate_code_dim
[0m19:44:24.843938 [debug] [Thread-1 (]: Writing injected SQL for node "model.uber.rate_code_dim"
[0m19:44:24.846171 [debug] [Thread-1 (]: Timing info for model.uber.rate_code_dim (compile): 19:44:24.838716 => 19:44:24.845980
[0m19:44:24.846663 [debug] [Thread-1 (]: Began executing node model.uber.rate_code_dim
[0m19:44:24.849121 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m19:44:25.222353 [debug] [Thread-1 (]: Writing runtime sql for node "model.uber.rate_code_dim"
[0m19:44:25.225943 [debug] [Thread-1 (]: On model.uber.rate_code_dim: /* {"app": "dbt", "dbt_version": "1.5.9", "profile_name": "uber", "target_name": "dev", "node_id": "model.uber.rate_code_dim"} */

  
    

    create or replace table `uber-data-engineering-407103`.`uber`.`rate_code_dim`
    
    

    OPTIONS()
    as (
      WITH numbered_rows AS (
  SELECT
    GENERATE_UUID() as rate_code_id,
    RatecodeID AS RatecodeID,
    ROW_NUMBER() OVER (ORDER BY RatecodeID) as row_num
  FROM `uber-data-engineering-407103`.`uber`.`uber_tlc_trip_recrord_data`
  WHERE RatecodeID IS NOT NULL
)
SELECT
  rate_code_id,
  RatecodeID
FROM numbered_rows
    );
  
[0m19:44:27.863183 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=uber-data-engineering-407103&j=bq:US:06579667-42cc-49eb-a107-82c34ac6f88f&page=queryresults
[0m19:44:27.871365 [debug] [Thread-1 (]: Timing info for model.uber.rate_code_dim (execute): 19:44:24.847108 => 19:44:27.870864
[0m19:44:27.873607 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'b75c7a70-a932-4395-8820-b8592fc4b0ad', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff8e04e250>]}
[0m19:44:27.874690 [info ] [Thread-1 (]: 6 of 8 OK created sql table model uber.rate_code_dim ........................... [[32mCREATE TABLE (100.0k rows, 781.2 KiB processed)[0m in 3.04s]
[0m19:44:27.876420 [debug] [Thread-1 (]: Finished running node model.uber.rate_code_dim
[0m19:44:27.877799 [debug] [Thread-1 (]: Began running node model.uber.trip_distance
[0m19:44:27.878756 [info ] [Thread-1 (]: 7 of 8 START sql table model uber.trip_distance ................................ [RUN]
[0m19:44:27.879828 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.uber.rate_code_dim, now model.uber.trip_distance)
[0m19:44:27.880342 [debug] [Thread-1 (]: Began compiling node model.uber.trip_distance
[0m19:44:27.884692 [debug] [Thread-1 (]: Writing injected SQL for node "model.uber.trip_distance"
[0m19:44:27.886941 [debug] [Thread-1 (]: Timing info for model.uber.trip_distance (compile): 19:44:27.880738 => 19:44:27.886775
[0m19:44:27.887724 [debug] [Thread-1 (]: Began executing node model.uber.trip_distance
[0m19:44:27.890227 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m19:44:28.297708 [debug] [Thread-1 (]: Writing runtime sql for node "model.uber.trip_distance"
[0m19:44:28.304537 [debug] [Thread-1 (]: On model.uber.trip_distance: /* {"app": "dbt", "dbt_version": "1.5.9", "profile_name": "uber", "target_name": "dev", "node_id": "model.uber.trip_distance"} */

  
    

    create or replace table `uber-data-engineering-407103`.`uber`.`trip_distance`
    
    

    OPTIONS()
    as (
      WITH numbered_rows AS (
  SELECT
    GENERATE_UUID() as trip_distance_id,
    trip_distance AS trip_distance,
    ROW_NUMBER() OVER (ORDER BY trip_distance) as row_num
  FROM `uber-data-engineering-407103`.`uber`.`uber_tlc_trip_recrord_data`
  WHERE trip_distance IS NOT NULL
)
SELECT
  trip_distance_id,
  trip_distance
FROM numbered_rows
    );
  
[0m19:44:31.376913 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=uber-data-engineering-407103&j=bq:US:8976bd8b-8db1-43fb-91bf-675101131216&page=queryresults
[0m19:44:31.413029 [debug] [Thread-1 (]: Timing info for model.uber.trip_distance (execute): 19:44:27.888284 => 19:44:31.412438
[0m19:44:31.415822 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'b75c7a70-a932-4395-8820-b8592fc4b0ad', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff8e17ff50>]}
[0m19:44:31.417621 [info ] [Thread-1 (]: 7 of 8 OK created sql table model uber.trip_distance ........................... [[32mCREATE TABLE (100.0k rows, 781.2 KiB processed)[0m in 3.54s]
[0m19:44:31.419938 [debug] [Thread-1 (]: Finished running node model.uber.trip_distance
[0m19:44:31.423858 [debug] [Thread-1 (]: Began running node model.uber.fact_trip
[0m19:44:31.424874 [info ] [Thread-1 (]: 8 of 8 START sql table model uber.fact_trip .................................... [RUN]
[0m19:44:31.426168 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.uber.trip_distance, now model.uber.fact_trip)
[0m19:44:31.426796 [debug] [Thread-1 (]: Began compiling node model.uber.fact_trip
[0m19:44:31.445328 [debug] [Thread-1 (]: Writing injected SQL for node "model.uber.fact_trip"
[0m19:44:31.451335 [debug] [Thread-1 (]: Timing info for model.uber.fact_trip (compile): 19:44:31.427260 => 19:44:31.450477
[0m19:44:31.453557 [debug] [Thread-1 (]: Began executing node model.uber.fact_trip
[0m19:44:31.473297 [debug] [Thread-1 (]: Writing runtime sql for node "model.uber.fact_trip"
[0m19:44:31.489552 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m19:44:31.503508 [debug] [Thread-1 (]: On model.uber.fact_trip: /* {"app": "dbt", "dbt_version": "1.5.9", "profile_name": "uber", "target_name": "dev", "node_id": "model.uber.fact_trip"} */

  
    

    create or replace table `uber-data-engineering-407103`.`uber`.`fact_trip`
    
    

    OPTIONS()
    as (
      WITH fct_invoices_cte AS (
    SELECT
        CAST(ROW_NUMBER() OVER () AS INT64) as trip_id,
        VendorID,
        to_hex(md5(cast(coalesce(cast(tpep_pickup_datetime as STRING), '_dbt_utils_surrogate_key_null_') || '-' || coalesce(cast(tpep_dropoff_datetime as STRING), '_dbt_utils_surrogate_key_null_') as STRING))) AS datetime_id,
        trip_distance_id,
        rate_code_id,
        store_and_fwd_flag,
        pickup_location_id,
        to_hex(md5(cast(coalesce(cast(dropoff_latitude as STRING), '_dbt_utils_surrogate_key_null_') || '-' || coalesce(cast(dropoff_longitude as STRING), '_dbt_utils_surrogate_key_null_') as STRING))) as dropoff_location_id,
        payment_type_id,
        fare_amount,
        extra,
        mta_tax,
        tip_amount,
        tolls_amount,
        improvement_surcharge,
        total_amount
    FROM `uber-data-engineering-407103`.`uber`.`uber_tlc_trip_recrord_data`
)
SELECT
    trip_id,
    VendorID,
    datetime_id,
    do.dropoff_location_id,
    pu.pickup_location_id,
    pc.passenger_count_id,
    pt.payment_type_id,
    rc.rate_code_id,
    store_and_fwd_flag,
    td.trip_distance_id,
    fare_amount,
    extra,
    mta_tax,
    tip_amount,
    tolls_amount,
    improvement_surcharge AS improvement_surcharge_amount,  -- Added alias
    total_amount
FROM fct_invoices_cte fi
INNER JOIN `uber-data-engineering-407103`.`uber`.`datetime_dim` dt ON fi.datetime_id = dt.datetime_id
INNER JOIN `uber-data-engineering-407103`.`uber`.`dropoff_location_dim` do ON fi.dropoff_location_id = do.dropoff_location_id
INNER JOIN `uber-data-engineering-407103`.`uber`.`pickup_location_dim` pu ON fi.pickup_location_id = pu.pickup_location_id
INNER JOIN `uber-data-engineering-407103`.`uber`.`passenger_count_dim` pc ON fi.passenger_count_id = pc.passenger_count_id
INNER JOIN `uber-data-engineering-407103`.`uber`.`payment_type_dim` pt ON fi.payment_type_id = pt.payment_type_id
INNER JOIN `uber-data-engineering-407103`.`uber`.`rate_code_dim` rc ON fi.rate_code_id = rc.rate_code_id
INNER JOIN `uber-data-engineering-407103`.`uber`.`trip_distance` td ON fi.trip_distance_id = td.trip_distance_id
    );
  
[0m19:44:32.536203 [debug] [Thread-1 (]: BigQuery adapter: Retry attempt 1 of 1 after error: BadRequest('Unrecognized name: trip_distance_id; Did you mean trip_distance? at [17:9]')
[0m19:44:34.298840 [error] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=uber-data-engineering-407103&j=bq:US:562fcc5d-8d34-43aa-a487-f12b57610417&page=queryresults
[0m19:44:34.307949 [debug] [Thread-1 (]: Timing info for model.uber.fact_trip (execute): 19:44:31.455516 => 19:44:34.307209
[0m19:44:34.329187 [debug] [Thread-1 (]: Database Error in model fact_trip (models/transform/fact_trip.sql)
  Unrecognized name: trip_distance_id; Did you mean trip_distance? at [17:9]
  compiled Code at target/run/uber/models/transform/fact_trip.sql
[0m19:44:34.332428 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'b75c7a70-a932-4395-8820-b8592fc4b0ad', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff8e250250>]}
[0m19:44:34.335323 [error] [Thread-1 (]: 8 of 8 ERROR creating sql table model uber.fact_trip ........................... [[31mERROR[0m in 2.91s]
[0m19:44:34.336984 [debug] [Thread-1 (]: Finished running node model.uber.fact_trip
[0m19:44:34.361428 [debug] [MainThread]: Connection 'master' was properly closed.
[0m19:44:34.363049 [debug] [MainThread]: Connection 'model.uber.fact_trip' was properly closed.
[0m19:44:34.364606 [info ] [MainThread]: 
[0m19:44:34.367588 [info ] [MainThread]: Finished running 8 table models in 0 hours 0 minutes and 28.89 seconds (28.89s).
[0m19:44:34.375241 [debug] [MainThread]: Command end result
[0m19:44:34.445844 [info ] [MainThread]: 
[0m19:44:34.450135 [info ] [MainThread]: [31mCompleted with 1 error and 0 warnings:[0m
[0m19:44:34.453282 [info ] [MainThread]: 
[0m19:44:34.457195 [error] [MainThread]: [33mDatabase Error in model fact_trip (models/transform/fact_trip.sql)[0m
[0m19:44:34.459629 [error] [MainThread]:   Unrecognized name: trip_distance_id; Did you mean trip_distance? at [17:9]
[0m19:44:34.461599 [error] [MainThread]:   compiled Code at target/run/uber/models/transform/fact_trip.sql
[0m19:44:34.463771 [info ] [MainThread]: 
[0m19:44:34.467207 [info ] [MainThread]: Done. PASS=7 WARN=0 ERROR=1 SKIP=0 TOTAL=8
[0m19:44:34.473310 [debug] [MainThread]: Command `dbt run` failed at 19:44:34.472962 after 29.62 seconds
[0m19:44:34.475380 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff906e2910>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff906f8e90>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff9038fd50>]}
[0m19:44:34.476079 [debug] [MainThread]: Flushing usage events
[0m19:49:59.481856 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff95fe9450>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff9487d3d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff946179d0>]}


============================== 19:49:59.488192 | a5d4a4c8-14e4-4b82-86fa-b9e0d706b654 ==============================
[0m19:49:59.488192 [info ] [MainThread]: Running with dbt=1.5.9
[0m19:49:59.489102 [debug] [MainThread]: running dbt with arguments {'partial_parse': 'True', 'printer_width': '80', 'use_experimental_parser': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'log_path': '/usr/local/airflow/include/dbt/logs', 'log_cache_events': 'False', 'quiet': 'False', 'profiles_dir': '/usr/local/airflow/include/dbt/', 'log_format': 'default', 'introspect': 'True', 'send_anonymous_usage_stats': 'True', 'indirect_selection': 'eager', 'fail_fast': 'False', 'warn_error': 'None', 'debug': 'False', 'no_print': 'None', 'use_colors': 'True', 'cache_selected_only': 'False', 'write_json': 'True', 'target_path': 'None', 'static_parser': 'True', 'version_check': 'True'}
[0m19:50:00.000119 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'a5d4a4c8-14e4-4b82-86fa-b9e0d706b654', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff942e3410>]}
[0m19:50:00.011532 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'a5d4a4c8-14e4-4b82-86fa-b9e0d706b654', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff927f74d0>]}
[0m19:50:00.012306 [info ] [MainThread]: Registered adapter: bigquery=1.5.3
[0m19:50:00.028201 [debug] [MainThread]: checksum: dd837546c89c9d03f3c2cb0ca6165266a30da6076d5d44e9991f7c5a8e5f5831, vars: {}, profile: , target: , version: 1.5.9
[0m19:50:00.103208 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 1 files added, 1 files changed.
[0m19:50:00.103956 [debug] [MainThread]: Partial parsing: added file: uber://models/transform/test_fct.sql
[0m19:50:00.104491 [debug] [MainThread]: Partial parsing: updated file: uber://models/transform/fact_trip.sql
[0m19:50:00.123364 [debug] [MainThread]: 1699: static parser successfully parsed transform/test_fct.sql
[0m19:50:00.135128 [debug] [MainThread]: 1603: static parser failed on transform/fact_trip.sql
[0m19:50:00.156861 [debug] [MainThread]: 1602: parser fallback to jinja rendering on transform/fact_trip.sql
[0m19:50:00.157649 [error] [MainThread]: Encountered an error:
Compilation Error
  Model 'model.uber.test_fct' (models/transform/test_fct.sql) depends on a node named 'trip_distance_dim' which was not found
[0m19:50:00.158803 [debug] [MainThread]: Command `dbt run` failed at 19:50:00.158611 after 0.69 seconds
[0m19:50:00.159303 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff94b4fb90>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff987ac0d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff987ac050>]}
[0m19:50:00.159803 [debug] [MainThread]: Flushing usage events
[0m19:50:18.025362 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff8afbbf10>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff8b2a89d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff8ef74850>]}


============================== 19:50:18.030725 | 2073675a-4ebd-4751-9237-629f6c037993 ==============================
[0m19:50:18.030725 [info ] [MainThread]: Running with dbt=1.5.9
[0m19:50:18.031617 [debug] [MainThread]: running dbt with arguments {'write_json': 'True', 'cache_selected_only': 'False', 'introspect': 'True', 'send_anonymous_usage_stats': 'True', 'use_experimental_parser': 'False', 'fail_fast': 'False', 'no_print': 'None', 'printer_width': '80', 'partial_parse': 'True', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'debug': 'False', 'log_path': '/usr/local/airflow/include/dbt/logs', 'target_path': 'None', 'static_parser': 'True', 'use_colors': 'True', 'quiet': 'False', 'log_cache_events': 'False', 'log_format': 'default', 'indirect_selection': 'eager', 'warn_error': 'None', 'profiles_dir': '/usr/local/airflow/include/dbt/', 'version_check': 'True'}
[0m19:50:18.468323 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '2073675a-4ebd-4751-9237-629f6c037993', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff88f088d0>]}
[0m19:50:18.480355 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '2073675a-4ebd-4751-9237-629f6c037993', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff88f08450>]}
[0m19:50:18.481465 [info ] [MainThread]: Registered adapter: bigquery=1.5.3
[0m19:50:18.499282 [debug] [MainThread]: checksum: dd837546c89c9d03f3c2cb0ca6165266a30da6076d5d44e9991f7c5a8e5f5831, vars: {}, profile: , target: , version: 1.5.9
[0m19:50:18.567543 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 1 files added, 1 files changed.
[0m19:50:18.568299 [debug] [MainThread]: Partial parsing: added file: uber://models/transform/test_fct.sql
[0m19:50:18.568866 [debug] [MainThread]: Partial parsing: updated file: uber://models/transform/fact_trip.sql
[0m19:50:18.588828 [debug] [MainThread]: 1699: static parser successfully parsed transform/test_fct.sql
[0m19:50:18.600226 [debug] [MainThread]: 1603: static parser failed on transform/fact_trip.sql
[0m19:50:18.618826 [debug] [MainThread]: 1602: parser fallback to jinja rendering on transform/fact_trip.sql
[0m19:50:18.632515 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '2073675a-4ebd-4751-9237-629f6c037993', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff88c6e750>]}
[0m19:50:18.659293 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '2073675a-4ebd-4751-9237-629f6c037993', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff88dece10>]}
[0m19:50:18.660336 [info ] [MainThread]: Found 9 models, 0 tests, 0 snapshots, 0 analyses, 474 macros, 0 operations, 0 seed files, 1 source, 0 exposures, 0 metrics, 0 groups
[0m19:50:18.661667 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '2073675a-4ebd-4751-9237-629f6c037993', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff8de1f4d0>]}
[0m19:50:18.664374 [info ] [MainThread]: 
[0m19:50:18.665773 [debug] [MainThread]: Acquiring new bigquery connection 'master'
[0m19:50:18.668930 [debug] [ThreadPool]: Acquiring new bigquery connection 'list_uber-data-engineering-407103'
[0m19:50:18.670990 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m19:50:20.420028 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_uber-data-engineering-407103, now list_uber-data-engineering-407103_uber)
[0m19:50:20.422938 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m19:50:20.915454 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '2073675a-4ebd-4751-9237-629f6c037993', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff8ba32a50>]}
[0m19:50:20.919361 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m19:50:20.921217 [info ] [MainThread]: 
[0m19:50:20.956078 [debug] [Thread-1 (]: Began running node model.uber.datetime_dim
[0m19:50:20.957592 [info ] [Thread-1 (]: 1 of 9 START sql table model uber.datetime_dim ................................. [RUN]
[0m19:50:20.959330 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_uber-data-engineering-407103_uber, now model.uber.datetime_dim)
[0m19:50:20.960311 [debug] [Thread-1 (]: Began compiling node model.uber.datetime_dim
[0m19:50:20.973598 [debug] [Thread-1 (]: Writing injected SQL for node "model.uber.datetime_dim"
[0m19:50:20.976366 [debug] [Thread-1 (]: Timing info for model.uber.datetime_dim (compile): 19:50:20.961672 => 19:50:20.976005
[0m19:50:20.977000 [debug] [Thread-1 (]: Began executing node model.uber.datetime_dim
[0m19:50:20.997290 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m19:50:22.114447 [debug] [Thread-1 (]: Writing runtime sql for node "model.uber.datetime_dim"
[0m19:50:22.116760 [debug] [Thread-1 (]: On model.uber.datetime_dim: /* {"app": "dbt", "dbt_version": "1.5.9", "profile_name": "uber", "target_name": "dev", "node_id": "model.uber.datetime_dim"} */

  
    

    create or replace table `uber-data-engineering-407103`.`uber`.`datetime_dim`
    
    

    OPTIONS()
    as (
      WITH datetime_cte AS (  
  SELECT DISTINCT 
    to_hex(md5(cast(coalesce(cast(tpep_pickup_datetime as STRING), '_dbt_utils_surrogate_key_null_') || '-' || coalesce(cast(tpep_dropoff_datetime as STRING), '_dbt_utils_surrogate_key_null_') as STRING))) AS datetime_id,
    CASE
      WHEN LENGTH(tpep_pickup_datetime) = 16 THEN
        -- Date format: "DD/MM/YYYY HH:MM"
        PARSE_DATETIME('%m/%d/%Y %H:%M', tpep_pickup_datetime)
      WHEN LENGTH(tpep_pickup_datetime) <= 14 THEN
        -- Date format: "MM/DD/YY HH:MM"
        PARSE_DATETIME('%m/%d/%y %H:%M', tpep_pickup_datetime)
      ELSE
        NULL
    END AS pick_date_part,
    tpep_dropoff_datetime AS drop_datetime_id,
    CASE
      WHEN LENGTH(tpep_dropoff_datetime) = 16 THEN
        -- Date format: "DD/MM/YYYY HH:MM"
        PARSE_DATETIME('%m/%d/%Y %H:%M', tpep_dropoff_datetime)
      WHEN LENGTH(tpep_dropoff_datetime) <= 14 THEN
        -- Date format: "MM/DD/YY HH:MM"
        PARSE_DATETIME('%m/%d/%y %H:%M', tpep_dropoff_datetime)
      ELSE
        NULL
    END AS drop_date_part
  FROM `uber-data-engineering-407103`.`uber`.`uber_tlc_trip_recrord_data`
  WHERE tpep_pickup_datetime IS NOT NULL
    AND tpep_dropoff_datetime IS NOT NULL
)
SELECT
  datetime_id,
  pick_date_part AS tpep_pickup_datetime,
  drop_date_part AS tpep_dropoff_datetime,
  EXTRACT(HOUR FROM pick_date_part) AS pick_hour,
  EXTRACT(DAY FROM pick_date_part) AS pick_day,
  EXTRACT(MONTH FROM pick_date_part) AS pick_month,
  EXTRACT(YEAR FROM pick_date_part) AS pick_year,
  EXTRACT(DAYOFWEEK FROM pick_date_part) AS pick_weekday,
  EXTRACT(HOUR FROM drop_date_part) AS drop_hour,
  EXTRACT(DAY FROM drop_date_part) AS drop_day,
  EXTRACT(MONTH FROM drop_date_part) AS drop_month,
  EXTRACT(YEAR FROM drop_date_part) AS drop_year,
  EXTRACT(DAYOFWEEK FROM drop_date_part) AS drop_weekday
FROM datetime_cte
    );
  
[0m19:50:24.835788 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=uber-data-engineering-407103&j=bq:US:2a1ec1a2-6686-4870-83d3-620b1cca8501&page=queryresults
[0m19:50:24.868748 [debug] [Thread-1 (]: Timing info for model.uber.datetime_dim (execute): 19:50:20.977463 => 19:50:24.868347
[0m19:50:24.870328 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '2073675a-4ebd-4751-9237-629f6c037993', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff88f2c210>]}
[0m19:50:24.871806 [info ] [Thread-1 (]: 1 of 9 OK created sql table model uber.datetime_dim ............................ [[32mCREATE TABLE (99.9k rows, 4.0 MiB processed)[0m in 3.91s]
[0m19:50:24.873328 [debug] [Thread-1 (]: Finished running node model.uber.datetime_dim
[0m19:50:24.874132 [debug] [Thread-1 (]: Began running node model.uber.dropoff_location_dim
[0m19:50:24.874942 [info ] [Thread-1 (]: 2 of 9 START sql table model uber.dropoff_location_dim ......................... [RUN]
[0m19:50:24.875954 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.uber.datetime_dim, now model.uber.dropoff_location_dim)
[0m19:50:24.876522 [debug] [Thread-1 (]: Began compiling node model.uber.dropoff_location_dim
[0m19:50:24.881540 [debug] [Thread-1 (]: Writing injected SQL for node "model.uber.dropoff_location_dim"
[0m19:50:24.884959 [debug] [Thread-1 (]: Timing info for model.uber.dropoff_location_dim (compile): 19:50:24.877000 => 19:50:24.884787
[0m19:50:24.885459 [debug] [Thread-1 (]: Began executing node model.uber.dropoff_location_dim
[0m19:50:24.888044 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m19:50:25.453067 [debug] [Thread-1 (]: Writing runtime sql for node "model.uber.dropoff_location_dim"
[0m19:50:25.458716 [debug] [Thread-1 (]: On model.uber.dropoff_location_dim: /* {"app": "dbt", "dbt_version": "1.5.9", "profile_name": "uber", "target_name": "dev", "node_id": "model.uber.dropoff_location_dim"} */

  
    

    create or replace table `uber-data-engineering-407103`.`uber`.`dropoff_location_dim`
    
    

    OPTIONS()
    as (
      WITH numbered_rows AS (
  SELECT
    to_hex(md5(cast(coalesce(cast(dropoff_latitude as STRING), '_dbt_utils_surrogate_key_null_') || '-' || coalesce(cast(dropoff_longitude as STRING), '_dbt_utils_surrogate_key_null_') as STRING))) as dropoff_location_id,
    dropoff_latitude AS dropoff_latitude,
    dropoff_longitude AS dropoff_longitude,
    ROW_NUMBER() OVER (ORDER BY dropoff_latitude, dropoff_longitude) as row_num
  FROM `uber-data-engineering-407103`.`uber`.`uber_tlc_trip_recrord_data`
)
SELECT
  dropoff_location_id,
  dropoff_latitude,
  dropoff_longitude
FROM numbered_rows
    );
  
[0m19:50:29.069415 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=uber-data-engineering-407103&j=bq:US:b12224bb-fb78-4711-9b99-c95c02619388&page=queryresults
[0m19:50:29.087019 [debug] [Thread-1 (]: Timing info for model.uber.dropoff_location_dim (execute): 19:50:24.885922 => 19:50:29.086104
[0m19:50:29.090600 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '2073675a-4ebd-4751-9237-629f6c037993', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff88dc8a90>]}
[0m19:50:29.092802 [info ] [Thread-1 (]: 2 of 9 OK created sql table model uber.dropoff_location_dim .................... [[32mCREATE TABLE (100.0k rows, 1.5 MiB processed)[0m in 4.21s]
[0m19:50:29.095876 [debug] [Thread-1 (]: Finished running node model.uber.dropoff_location_dim
[0m19:50:29.097722 [debug] [Thread-1 (]: Began running node model.uber.passenger_count_dim
[0m19:50:29.099707 [info ] [Thread-1 (]: 3 of 9 START sql table model uber.passenger_count_dim .......................... [RUN]
[0m19:50:29.101837 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.uber.dropoff_location_dim, now model.uber.passenger_count_dim)
[0m19:50:29.103038 [debug] [Thread-1 (]: Began compiling node model.uber.passenger_count_dim
[0m19:50:29.109546 [debug] [Thread-1 (]: Writing injected SQL for node "model.uber.passenger_count_dim"
[0m19:50:29.111965 [debug] [Thread-1 (]: Timing info for model.uber.passenger_count_dim (compile): 19:50:29.103524 => 19:50:29.111773
[0m19:50:29.112739 [debug] [Thread-1 (]: Began executing node model.uber.passenger_count_dim
[0m19:50:29.115693 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m19:50:29.514807 [debug] [Thread-1 (]: Writing runtime sql for node "model.uber.passenger_count_dim"
[0m19:50:29.517758 [debug] [Thread-1 (]: On model.uber.passenger_count_dim: /* {"app": "dbt", "dbt_version": "1.5.9", "profile_name": "uber", "target_name": "dev", "node_id": "model.uber.passenger_count_dim"} */

  
    

    create or replace table `uber-data-engineering-407103`.`uber`.`passenger_count_dim`
    
    

    OPTIONS()
    as (
      WITH numbered_rows AS (
  SELECT
    GENERATE_UUID() as passenger_count_id,
    passenger_count AS passenger_count,
    ROW_NUMBER() OVER () as row_num
  FROM `uber-data-engineering-407103`.`uber`.`uber_tlc_trip_recrord_data`
  WHERE passenger_count IS NOT NULL
)
SELECT
  passenger_count_id,
  passenger_count
FROM numbered_rows
    );
  
[0m19:50:32.401929 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=uber-data-engineering-407103&j=bq:US:ccd6ab71-98b0-47da-90a2-baa3c2797e5b&page=queryresults
[0m19:50:32.410069 [debug] [Thread-1 (]: Timing info for model.uber.passenger_count_dim (execute): 19:50:29.113159 => 19:50:32.409518
[0m19:50:32.412746 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '2073675a-4ebd-4751-9237-629f6c037993', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff88f41d10>]}
[0m19:50:32.415415 [info ] [Thread-1 (]: 3 of 9 OK created sql table model uber.passenger_count_dim ..................... [[32mCREATE TABLE (100.0k rows, 781.2 KiB processed)[0m in 3.31s]
[0m19:50:32.418717 [debug] [Thread-1 (]: Finished running node model.uber.passenger_count_dim
[0m19:50:32.420705 [debug] [Thread-1 (]: Began running node model.uber.payment_type_dim
[0m19:50:32.422348 [info ] [Thread-1 (]: 4 of 9 START sql table model uber.payment_type_dim ............................. [RUN]
[0m19:50:32.424050 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.uber.passenger_count_dim, now model.uber.payment_type_dim)
[0m19:50:32.424827 [debug] [Thread-1 (]: Began compiling node model.uber.payment_type_dim
[0m19:50:32.432240 [debug] [Thread-1 (]: Writing injected SQL for node "model.uber.payment_type_dim"
[0m19:50:32.434748 [debug] [Thread-1 (]: Timing info for model.uber.payment_type_dim (compile): 19:50:32.425356 => 19:50:32.434538
[0m19:50:32.435314 [debug] [Thread-1 (]: Began executing node model.uber.payment_type_dim
[0m19:50:32.438168 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m19:50:32.884425 [debug] [Thread-1 (]: Writing runtime sql for node "model.uber.payment_type_dim"
[0m19:50:32.891921 [debug] [Thread-1 (]: On model.uber.payment_type_dim: /* {"app": "dbt", "dbt_version": "1.5.9", "profile_name": "uber", "target_name": "dev", "node_id": "model.uber.payment_type_dim"} */

  
    

    create or replace table `uber-data-engineering-407103`.`uber`.`payment_type_dim`
    
    

    OPTIONS()
    as (
      WITH numbered_rows AS (
  SELECT
    GENERATE_UUID() as payment_type_id,
    payment_type AS payment_type,
    ROW_NUMBER() OVER (ORDER BY payment_type) as row_num
  FROM `uber-data-engineering-407103`.`uber`.`uber_tlc_trip_recrord_data`
  WHERE payment_type IS NOT NULL
)
SELECT
  payment_type_id,
  payment_type
FROM numbered_rows
    );
  
[0m19:50:35.793551 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=uber-data-engineering-407103&j=bq:US:9f091be6-c31c-4739-b300-3414ca8cf84d&page=queryresults
[0m19:50:35.808186 [debug] [Thread-1 (]: Timing info for model.uber.payment_type_dim (execute): 19:50:32.435775 => 19:50:35.807140
[0m19:50:35.812252 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '2073675a-4ebd-4751-9237-629f6c037993', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff7bb39dd0>]}
[0m19:50:35.815143 [info ] [Thread-1 (]: 4 of 9 OK created sql table model uber.payment_type_dim ........................ [[32mCREATE TABLE (100.0k rows, 781.2 KiB processed)[0m in 3.39s]
[0m19:50:35.820113 [debug] [Thread-1 (]: Finished running node model.uber.payment_type_dim
[0m19:50:35.822845 [debug] [Thread-1 (]: Began running node model.uber.pickup_location_dim
[0m19:50:35.828036 [info ] [Thread-1 (]: 5 of 9 START sql table model uber.pickup_location_dim .......................... [RUN]
[0m19:50:35.830058 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.uber.payment_type_dim, now model.uber.pickup_location_dim)
[0m19:50:35.831217 [debug] [Thread-1 (]: Began compiling node model.uber.pickup_location_dim
[0m19:50:35.849092 [debug] [Thread-1 (]: Writing injected SQL for node "model.uber.pickup_location_dim"
[0m19:50:35.852162 [debug] [Thread-1 (]: Timing info for model.uber.pickup_location_dim (compile): 19:50:35.831842 => 19:50:35.851843
[0m19:50:35.852931 [debug] [Thread-1 (]: Began executing node model.uber.pickup_location_dim
[0m19:50:35.856688 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m19:50:36.231151 [debug] [Thread-1 (]: Writing runtime sql for node "model.uber.pickup_location_dim"
[0m19:50:36.236274 [debug] [Thread-1 (]: On model.uber.pickup_location_dim: /* {"app": "dbt", "dbt_version": "1.5.9", "profile_name": "uber", "target_name": "dev", "node_id": "model.uber.pickup_location_dim"} */

  
    

    create or replace table `uber-data-engineering-407103`.`uber`.`pickup_location_dim`
    
    

    OPTIONS()
    as (
      WITH numbered_rows AS (
  SELECT
    to_hex(md5(cast(coalesce(cast(pickup_latitude as STRING), '_dbt_utils_surrogate_key_null_') || '-' || coalesce(cast(pickup_longitude as STRING), '_dbt_utils_surrogate_key_null_') as STRING))) as pickup_location_id,
    pickup_latitude AS pickup_latitude,
    pickup_longitude AS pickup_longitude,
    ROW_NUMBER() OVER (ORDER BY pickup_latitude, pickup_longitude) as row_num
  FROM `uber-data-engineering-407103`.`uber`.`uber_tlc_trip_recrord_data`
)
SELECT
  pickup_location_id,
  pickup_latitude,
  pickup_longitude
FROM numbered_rows
    );
  
[0m19:50:39.686245 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=uber-data-engineering-407103&j=bq:US:0befd263-a50e-49b0-b8cd-c8d296e1c288&page=queryresults
[0m19:50:39.689924 [debug] [Thread-1 (]: Timing info for model.uber.pickup_location_dim (execute): 19:50:35.853430 => 19:50:39.689679
[0m19:50:39.691223 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '2073675a-4ebd-4751-9237-629f6c037993', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff7bb8f910>]}
[0m19:50:39.692279 [info ] [Thread-1 (]: 5 of 9 OK created sql table model uber.pickup_location_dim ..................... [[32mCREATE TABLE (100.0k rows, 1.5 MiB processed)[0m in 3.86s]
[0m19:50:39.693374 [debug] [Thread-1 (]: Finished running node model.uber.pickup_location_dim
[0m19:50:39.694163 [debug] [Thread-1 (]: Began running node model.uber.rate_code_dim
[0m19:50:39.694955 [info ] [Thread-1 (]: 6 of 9 START sql table model uber.rate_code_dim ................................ [RUN]
[0m19:50:39.696197 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.uber.pickup_location_dim, now model.uber.rate_code_dim)
[0m19:50:39.696875 [debug] [Thread-1 (]: Began compiling node model.uber.rate_code_dim
[0m19:50:39.700115 [debug] [Thread-1 (]: Writing injected SQL for node "model.uber.rate_code_dim"
[0m19:50:39.702205 [debug] [Thread-1 (]: Timing info for model.uber.rate_code_dim (compile): 19:50:39.697419 => 19:50:39.702043
[0m19:50:39.702703 [debug] [Thread-1 (]: Began executing node model.uber.rate_code_dim
[0m19:50:39.704813 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m19:50:40.094995 [debug] [Thread-1 (]: Writing runtime sql for node "model.uber.rate_code_dim"
[0m19:50:40.102853 [debug] [Thread-1 (]: On model.uber.rate_code_dim: /* {"app": "dbt", "dbt_version": "1.5.9", "profile_name": "uber", "target_name": "dev", "node_id": "model.uber.rate_code_dim"} */

  
    

    create or replace table `uber-data-engineering-407103`.`uber`.`rate_code_dim`
    
    

    OPTIONS()
    as (
      WITH numbered_rows AS (
  SELECT
    GENERATE_UUID() as rate_code_id,
    RatecodeID AS RatecodeID,
    ROW_NUMBER() OVER (ORDER BY RatecodeID) as row_num
  FROM `uber-data-engineering-407103`.`uber`.`uber_tlc_trip_recrord_data`
  WHERE RatecodeID IS NOT NULL
)
SELECT
  rate_code_id,
  RatecodeID
FROM numbered_rows
    );
  
[0m19:50:42.793310 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=uber-data-engineering-407103&j=bq:US:0df1daf3-ad87-4913-bcc7-6d8ca97d7522&page=queryresults
[0m19:50:42.800939 [debug] [Thread-1 (]: Timing info for model.uber.rate_code_dim (execute): 19:50:39.703124 => 19:50:42.800429
[0m19:50:42.803007 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '2073675a-4ebd-4751-9237-629f6c037993', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff88e0a150>]}
[0m19:50:42.804596 [info ] [Thread-1 (]: 6 of 9 OK created sql table model uber.rate_code_dim ........................... [[32mCREATE TABLE (100.0k rows, 781.2 KiB processed)[0m in 3.11s]
[0m19:50:42.806031 [debug] [Thread-1 (]: Finished running node model.uber.rate_code_dim
[0m19:50:42.807561 [debug] [Thread-1 (]: Began running node model.uber.trip_distance
[0m19:50:42.808839 [info ] [Thread-1 (]: 7 of 9 START sql table model uber.trip_distance ................................ [RUN]
[0m19:50:42.809949 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.uber.rate_code_dim, now model.uber.trip_distance)
[0m19:50:42.810646 [debug] [Thread-1 (]: Began compiling node model.uber.trip_distance
[0m19:50:42.833886 [debug] [Thread-1 (]: Writing injected SQL for node "model.uber.trip_distance"
[0m19:50:42.840216 [debug] [Thread-1 (]: Timing info for model.uber.trip_distance (compile): 19:50:42.811163 => 19:50:42.839884
[0m19:50:42.841596 [debug] [Thread-1 (]: Began executing node model.uber.trip_distance
[0m19:50:42.847417 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m19:50:43.333928 [debug] [Thread-1 (]: Writing runtime sql for node "model.uber.trip_distance"
[0m19:50:43.341129 [debug] [Thread-1 (]: On model.uber.trip_distance: /* {"app": "dbt", "dbt_version": "1.5.9", "profile_name": "uber", "target_name": "dev", "node_id": "model.uber.trip_distance"} */

  
    

    create or replace table `uber-data-engineering-407103`.`uber`.`trip_distance`
    
    

    OPTIONS()
    as (
      WITH numbered_rows AS (
  SELECT
    GENERATE_UUID() as trip_distance_id,
    trip_distance AS trip_distance,
    ROW_NUMBER() OVER (ORDER BY trip_distance) as row_num
  FROM `uber-data-engineering-407103`.`uber`.`uber_tlc_trip_recrord_data`
  WHERE trip_distance IS NOT NULL
)
SELECT
  trip_distance_id,
  trip_distance
FROM numbered_rows
    );
  
[0m19:50:46.309445 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=uber-data-engineering-407103&j=bq:US:f9dc1d23-f01a-463f-b4b6-a4bc74595f63&page=queryresults
[0m19:50:46.313181 [debug] [Thread-1 (]: Timing info for model.uber.trip_distance (execute): 19:50:42.842175 => 19:50:46.312878
[0m19:50:46.314527 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '2073675a-4ebd-4751-9237-629f6c037993', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff7bb7bc10>]}
[0m19:50:46.315652 [info ] [Thread-1 (]: 7 of 9 OK created sql table model uber.trip_distance ........................... [[32mCREATE TABLE (100.0k rows, 781.2 KiB processed)[0m in 3.50s]
[0m19:50:46.316976 [debug] [Thread-1 (]: Finished running node model.uber.trip_distance
[0m19:50:46.319099 [debug] [Thread-1 (]: Began running node model.uber.fact_trip
[0m19:50:46.319769 [info ] [Thread-1 (]: 8 of 9 START sql table model uber.fact_trip .................................... [RUN]
[0m19:50:46.320909 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.uber.trip_distance, now model.uber.fact_trip)
[0m19:50:46.321517 [debug] [Thread-1 (]: Began compiling node model.uber.fact_trip
[0m19:50:46.333261 [debug] [Thread-1 (]: Writing injected SQL for node "model.uber.fact_trip"
[0m19:50:46.335967 [debug] [Thread-1 (]: Timing info for model.uber.fact_trip (compile): 19:50:46.321983 => 19:50:46.335726
[0m19:50:46.336842 [debug] [Thread-1 (]: Began executing node model.uber.fact_trip
[0m19:50:46.343486 [debug] [Thread-1 (]: Writing runtime sql for node "model.uber.fact_trip"
[0m19:50:46.345845 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m19:50:46.349204 [debug] [Thread-1 (]: On model.uber.fact_trip: /* {"app": "dbt", "dbt_version": "1.5.9", "profile_name": "uber", "target_name": "dev", "node_id": "model.uber.fact_trip"} */

  
    

    create or replace table `uber-data-engineering-407103`.`uber`.`fact_trip`
    
    

    OPTIONS()
    as (
      WITH fct_invoices_cte AS (
    SELECT
        CAST(ROW_NUMBER() OVER () AS INT64) as trip_id,
        VendorID,
        to_hex(md5(cast(coalesce(cast(tpep_pickup_datetime as STRING), '_dbt_utils_surrogate_key_null_') || '-' || coalesce(cast(tpep_dropoff_datetime as STRING), '_dbt_utils_surrogate_key_null_') as STRING))) AS datetime_id,
        passenger_count_id,
        trip_distance_id,
        rate_code_id,
        store_and_fwd_flag,
        pickup_location_id,
        to_hex(md5(cast(coalesce(cast(dropoff_latitude as STRING), '_dbt_utils_surrogate_key_null_') || '-' || coalesce(cast(dropoff_longitude as STRING), '_dbt_utils_surrogate_key_null_') as STRING))) as dropoff_location_id,
        payment_type_id,
        fare_amount,
        extra,
        mta_tax,
        tip_amount,
        tolls_amount,
        improvement_surcharge,
        total_amount
    FROM `uber-data-engineering-407103`.`uber`.`uber_tlc_trip_recrord_data`
)
SELECT
    trip_id,
    VendorID,
    datetime_id,
    do.dropoff_location_id,
    pu.pickup_location_id,
    pc.passenger_count_id,
    pt.payment_type_id,
    rc.rate_code_id,
    store_and_fwd_flag,
    td.trip_distance_id,
    fare_amount,
    extra,
    mta_tax,
    tip_amount,
    tolls_amount,
    improvement_surcharge AS improvement_surcharge_amount,  -- Added alias
    total_amount
FROM fct_invoices_cte fi
INNER JOIN `uber-data-engineering-407103`.`uber`.`datetime_dim` dt ON fi.datetime_id = dt.datetime_id
INNER JOIN `uber-data-engineering-407103`.`uber`.`dropoff_location_dim` do ON fi.dropoff_location_id = do.dropoff_location_id
INNER JOIN `uber-data-engineering-407103`.`uber`.`pickup_location_dim` pu ON fi.pickup_location_id = pu.pickup_location_id
INNER JOIN `uber-data-engineering-407103`.`uber`.`passenger_count_dim` pc ON fi.passenger_count_id = pc.passenger_count_id
INNER JOIN `uber-data-engineering-407103`.`uber`.`payment_type_dim` pt ON fi.payment_type_id = pt.payment_type_id
INNER JOIN `uber-data-engineering-407103`.`uber`.`rate_code_dim` rc ON fi.rate_code_id = rc.rate_code_id
INNER JOIN `uber-data-engineering-407103`.`uber`.`trip_distance` td ON fi.trip_distance_id = td.trip_distance_id
    );
  
[0m19:50:47.384715 [debug] [Thread-1 (]: BigQuery adapter: Retry attempt 1 of 1 after error: BadRequest('Unrecognized name: passenger_count_id; Did you mean passenger_count? at [17:9]')
[0m19:50:49.099933 [error] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=uber-data-engineering-407103&j=bq:US:b04010ea-f2f4-4ec2-90b7-91476072f36e&page=queryresults
[0m19:50:49.102328 [debug] [Thread-1 (]: Timing info for model.uber.fact_trip (execute): 19:50:46.337556 => 19:50:49.102006
[0m19:50:49.130921 [debug] [Thread-1 (]: Database Error in model fact_trip (models/transform/fact_trip.sql)
  Unrecognized name: passenger_count_id; Did you mean passenger_count? at [17:9]
  compiled Code at target/run/uber/models/transform/fact_trip.sql
[0m19:50:49.132602 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '2073675a-4ebd-4751-9237-629f6c037993', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff88e20d10>]}
[0m19:50:49.134103 [error] [Thread-1 (]: 8 of 9 ERROR creating sql table model uber.fact_trip ........................... [[31mERROR[0m in 2.81s]
[0m19:50:49.135346 [debug] [Thread-1 (]: Finished running node model.uber.fact_trip
[0m19:50:49.136295 [debug] [Thread-1 (]: Began running node model.uber.test_fct
[0m19:50:49.137502 [info ] [Thread-1 (]: 9 of 9 START sql table model uber.test_fct ..................................... [RUN]
[0m19:50:49.139019 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.uber.fact_trip, now model.uber.test_fct)
[0m19:50:49.139703 [debug] [Thread-1 (]: Began compiling node model.uber.test_fct
[0m19:50:49.143959 [debug] [Thread-1 (]: Writing injected SQL for node "model.uber.test_fct"
[0m19:50:49.146946 [debug] [Thread-1 (]: Timing info for model.uber.test_fct (compile): 19:50:49.140162 => 19:50:49.146652
[0m19:50:49.148119 [debug] [Thread-1 (]: Began executing node model.uber.test_fct
[0m19:50:49.156429 [debug] [Thread-1 (]: Writing runtime sql for node "model.uber.test_fct"
[0m19:50:49.174171 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m19:50:49.189094 [debug] [Thread-1 (]: On model.uber.test_fct: /* {"app": "dbt", "dbt_version": "1.5.9", "profile_name": "uber", "target_name": "dev", "node_id": "model.uber.test_fct"} */

  
    

    create or replace table `uber-data-engineering-407103`.`uber`.`test_fct`
    
    

    OPTIONS()
    as (
      SELECT
    fi.trip_distance_id,
    td.trip_distance
FROM fct_invoices_cte fi
INNER JOIN `uber-data-engineering-407103`.`uber`.`trip_distance` td ON fi.trip_distance_id = td.trip_distance_id;
    );
  
[0m19:50:49.626615 [debug] [Thread-1 (]: BigQuery adapter: Retry attempt 1 of 1 after error: BadRequest('Syntax error: Expected ")" but got ";" at [16:113]')
[0m19:50:50.349409 [error] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=uber-data-engineering-407103&j=bq:US:f6d28a40-6098-46f5-aef7-ba6920eedb9a&page=queryresults
[0m19:50:50.354889 [debug] [Thread-1 (]: Timing info for model.uber.test_fct (execute): 19:50:49.148587 => 19:50:50.353583
[0m19:50:50.365778 [debug] [Thread-1 (]: Database Error in model test_fct (models/transform/test_fct.sql)
  Syntax error: Expected ")" but got ";" at [16:113]
  compiled Code at target/run/uber/models/transform/test_fct.sql
[0m19:50:50.367748 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '2073675a-4ebd-4751-9237-629f6c037993', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff88dd4090>]}
[0m19:50:50.377363 [error] [Thread-1 (]: 9 of 9 ERROR creating sql table model uber.test_fct ............................ [[31mERROR[0m in 1.23s]
[0m19:50:50.386376 [debug] [Thread-1 (]: Finished running node model.uber.test_fct
[0m19:50:50.392735 [debug] [MainThread]: Connection 'master' was properly closed.
[0m19:50:50.393322 [debug] [MainThread]: Connection 'model.uber.test_fct' was properly closed.
[0m19:50:50.394397 [info ] [MainThread]: 
[0m19:50:50.395532 [info ] [MainThread]: Finished running 9 table models in 0 hours 0 minutes and 31.73 seconds (31.73s).
[0m19:50:50.490746 [debug] [MainThread]: Command end result
[0m19:50:50.511629 [info ] [MainThread]: 
[0m19:50:50.512552 [info ] [MainThread]: [31mCompleted with 2 errors and 0 warnings:[0m
[0m19:50:50.513292 [info ] [MainThread]: 
[0m19:50:50.514161 [error] [MainThread]: [33mDatabase Error in model fact_trip (models/transform/fact_trip.sql)[0m
[0m19:50:50.515070 [error] [MainThread]:   Unrecognized name: passenger_count_id; Did you mean passenger_count? at [17:9]
[0m19:50:50.515861 [error] [MainThread]:   compiled Code at target/run/uber/models/transform/fact_trip.sql
[0m19:50:50.516624 [info ] [MainThread]: 
[0m19:50:50.517273 [error] [MainThread]: [33mDatabase Error in model test_fct (models/transform/test_fct.sql)[0m
[0m19:50:50.517995 [error] [MainThread]:   Syntax error: Expected ")" but got ";" at [16:113]
[0m19:50:50.518560 [error] [MainThread]:   compiled Code at target/run/uber/models/transform/test_fct.sql
[0m19:50:50.519880 [info ] [MainThread]: 
[0m19:50:50.524822 [info ] [MainThread]: Done. PASS=7 WARN=0 ERROR=2 SKIP=0 TOTAL=9
[0m19:50:50.528457 [debug] [MainThread]: Command `dbt run` failed at 19:50:50.528101 after 32.52 seconds
[0m19:50:50.530779 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff8a91f490>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff8a91f5d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff8b2a8fd0>]}
[0m19:50:50.531998 [debug] [MainThread]: Flushing usage events
[0m19:51:03.411360 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff81dfd950>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff81ad9110>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff81c7f1d0>]}


============================== 19:51:03.416663 | d2031800-18c2-4db9-82b9-79bf302842c2 ==============================
[0m19:51:03.416663 [info ] [MainThread]: Running with dbt=1.5.9
[0m19:51:03.417856 [debug] [MainThread]: running dbt with arguments {'static_parser': 'True', 'log_path': '/usr/local/airflow/include/dbt/logs', 'no_print': 'None', 'cache_selected_only': 'False', 'version_check': 'True', 'debug': 'False', 'log_cache_events': 'False', 'indirect_selection': 'eager', 'send_anonymous_usage_stats': 'True', 'warn_error': 'None', 'printer_width': '80', 'target_path': 'None', 'use_colors': 'True', 'partial_parse': 'True', 'introspect': 'True', 'log_format': 'default', 'profiles_dir': '/usr/local/airflow/include/dbt/', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'use_experimental_parser': 'False', 'fail_fast': 'False', 'quiet': 'False', 'write_json': 'True'}
[0m19:51:03.826894 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'd2031800-18c2-4db9-82b9-79bf302842c2', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff81dfc690>]}
[0m19:51:03.838521 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'd2031800-18c2-4db9-82b9-79bf302842c2', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff81466c50>]}
[0m19:51:03.839273 [info ] [MainThread]: Registered adapter: bigquery=1.5.3
[0m19:51:03.854856 [debug] [MainThread]: checksum: dd837546c89c9d03f3c2cb0ca6165266a30da6076d5d44e9991f7c5a8e5f5831, vars: {}, profile: , target: , version: 1.5.9
[0m19:51:03.968104 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m19:51:03.969751 [debug] [MainThread]: Partial parsing: updated file: uber://models/transform/test_fct.sql
[0m19:51:04.002005 [debug] [MainThread]: 1699: static parser successfully parsed transform/test_fct.sql
[0m19:51:04.028140 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'd2031800-18c2-4db9-82b9-79bf302842c2', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff7fa699d0>]}
[0m19:51:04.051310 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'd2031800-18c2-4db9-82b9-79bf302842c2', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff7f881dd0>]}
[0m19:51:04.052198 [info ] [MainThread]: Found 9 models, 0 tests, 0 snapshots, 0 analyses, 474 macros, 0 operations, 0 seed files, 1 source, 0 exposures, 0 metrics, 0 groups
[0m19:51:04.052928 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'd2031800-18c2-4db9-82b9-79bf302842c2', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff8494ba10>]}
[0m19:51:04.055091 [info ] [MainThread]: 
[0m19:51:04.060024 [debug] [MainThread]: Acquiring new bigquery connection 'master'
[0m19:51:04.061948 [debug] [ThreadPool]: Acquiring new bigquery connection 'list_uber-data-engineering-407103'
[0m19:51:04.062558 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m19:51:04.508899 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_uber-data-engineering-407103, now list_uber-data-engineering-407103_uber)
[0m19:51:04.512409 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m19:51:04.897739 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'd2031800-18c2-4db9-82b9-79bf302842c2', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff825569d0>]}
[0m19:51:04.900846 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m19:51:04.902692 [info ] [MainThread]: 
[0m19:51:04.929029 [debug] [Thread-1 (]: Began running node model.uber.datetime_dim
[0m19:51:04.929929 [info ] [Thread-1 (]: 1 of 9 START sql table model uber.datetime_dim ................................. [RUN]
[0m19:51:04.930937 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_uber-data-engineering-407103_uber, now model.uber.datetime_dim)
[0m19:51:04.931543 [debug] [Thread-1 (]: Began compiling node model.uber.datetime_dim
[0m19:51:04.949469 [debug] [Thread-1 (]: Writing injected SQL for node "model.uber.datetime_dim"
[0m19:51:04.953164 [debug] [Thread-1 (]: Timing info for model.uber.datetime_dim (compile): 19:51:04.932080 => 19:51:04.952850
[0m19:51:04.954054 [debug] [Thread-1 (]: Began executing node model.uber.datetime_dim
[0m19:51:04.977373 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m19:51:05.587995 [debug] [Thread-1 (]: Writing runtime sql for node "model.uber.datetime_dim"
[0m19:51:05.590812 [debug] [Thread-1 (]: On model.uber.datetime_dim: /* {"app": "dbt", "dbt_version": "1.5.9", "profile_name": "uber", "target_name": "dev", "node_id": "model.uber.datetime_dim"} */

  
    

    create or replace table `uber-data-engineering-407103`.`uber`.`datetime_dim`
    
    

    OPTIONS()
    as (
      WITH datetime_cte AS (  
  SELECT DISTINCT 
    to_hex(md5(cast(coalesce(cast(tpep_pickup_datetime as STRING), '_dbt_utils_surrogate_key_null_') || '-' || coalesce(cast(tpep_dropoff_datetime as STRING), '_dbt_utils_surrogate_key_null_') as STRING))) AS datetime_id,
    CASE
      WHEN LENGTH(tpep_pickup_datetime) = 16 THEN
        -- Date format: "DD/MM/YYYY HH:MM"
        PARSE_DATETIME('%m/%d/%Y %H:%M', tpep_pickup_datetime)
      WHEN LENGTH(tpep_pickup_datetime) <= 14 THEN
        -- Date format: "MM/DD/YY HH:MM"
        PARSE_DATETIME('%m/%d/%y %H:%M', tpep_pickup_datetime)
      ELSE
        NULL
    END AS pick_date_part,
    tpep_dropoff_datetime AS drop_datetime_id,
    CASE
      WHEN LENGTH(tpep_dropoff_datetime) = 16 THEN
        -- Date format: "DD/MM/YYYY HH:MM"
        PARSE_DATETIME('%m/%d/%Y %H:%M', tpep_dropoff_datetime)
      WHEN LENGTH(tpep_dropoff_datetime) <= 14 THEN
        -- Date format: "MM/DD/YY HH:MM"
        PARSE_DATETIME('%m/%d/%y %H:%M', tpep_dropoff_datetime)
      ELSE
        NULL
    END AS drop_date_part
  FROM `uber-data-engineering-407103`.`uber`.`uber_tlc_trip_recrord_data`
  WHERE tpep_pickup_datetime IS NOT NULL
    AND tpep_dropoff_datetime IS NOT NULL
)
SELECT
  datetime_id,
  pick_date_part AS tpep_pickup_datetime,
  drop_date_part AS tpep_dropoff_datetime,
  EXTRACT(HOUR FROM pick_date_part) AS pick_hour,
  EXTRACT(DAY FROM pick_date_part) AS pick_day,
  EXTRACT(MONTH FROM pick_date_part) AS pick_month,
  EXTRACT(YEAR FROM pick_date_part) AS pick_year,
  EXTRACT(DAYOFWEEK FROM pick_date_part) AS pick_weekday,
  EXTRACT(HOUR FROM drop_date_part) AS drop_hour,
  EXTRACT(DAY FROM drop_date_part) AS drop_day,
  EXTRACT(MONTH FROM drop_date_part) AS drop_month,
  EXTRACT(YEAR FROM drop_date_part) AS drop_year,
  EXTRACT(DAYOFWEEK FROM drop_date_part) AS drop_weekday
FROM datetime_cte
    );
  
[0m19:51:08.558808 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=uber-data-engineering-407103&j=bq:US:94e8b8af-7f8e-4b17-bb5d-a797afaf82fd&page=queryresults
[0m19:51:08.599936 [debug] [Thread-1 (]: Timing info for model.uber.datetime_dim (execute): 19:51:04.954502 => 19:51:08.599646
[0m19:51:08.601590 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'd2031800-18c2-4db9-82b9-79bf302842c2', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff7f891f50>]}
[0m19:51:08.603088 [info ] [Thread-1 (]: 1 of 9 OK created sql table model uber.datetime_dim ............................ [[32mCREATE TABLE (99.9k rows, 4.0 MiB processed)[0m in 3.67s]
[0m19:51:08.604763 [debug] [Thread-1 (]: Finished running node model.uber.datetime_dim
[0m19:51:08.605782 [debug] [Thread-1 (]: Began running node model.uber.dropoff_location_dim
[0m19:51:08.607089 [info ] [Thread-1 (]: 2 of 9 START sql table model uber.dropoff_location_dim ......................... [RUN]
[0m19:51:08.608050 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.uber.datetime_dim, now model.uber.dropoff_location_dim)
[0m19:51:08.608623 [debug] [Thread-1 (]: Began compiling node model.uber.dropoff_location_dim
[0m19:51:08.614922 [debug] [Thread-1 (]: Writing injected SQL for node "model.uber.dropoff_location_dim"
[0m19:51:08.617934 [debug] [Thread-1 (]: Timing info for model.uber.dropoff_location_dim (compile): 19:51:08.609107 => 19:51:08.617764
[0m19:51:08.618481 [debug] [Thread-1 (]: Began executing node model.uber.dropoff_location_dim
[0m19:51:08.620914 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m19:51:09.012398 [debug] [Thread-1 (]: Writing runtime sql for node "model.uber.dropoff_location_dim"
[0m19:51:09.015618 [debug] [Thread-1 (]: On model.uber.dropoff_location_dim: /* {"app": "dbt", "dbt_version": "1.5.9", "profile_name": "uber", "target_name": "dev", "node_id": "model.uber.dropoff_location_dim"} */

  
    

    create or replace table `uber-data-engineering-407103`.`uber`.`dropoff_location_dim`
    
    

    OPTIONS()
    as (
      WITH numbered_rows AS (
  SELECT
    to_hex(md5(cast(coalesce(cast(dropoff_latitude as STRING), '_dbt_utils_surrogate_key_null_') || '-' || coalesce(cast(dropoff_longitude as STRING), '_dbt_utils_surrogate_key_null_') as STRING))) as dropoff_location_id,
    dropoff_latitude AS dropoff_latitude,
    dropoff_longitude AS dropoff_longitude,
    ROW_NUMBER() OVER (ORDER BY dropoff_latitude, dropoff_longitude) as row_num
  FROM `uber-data-engineering-407103`.`uber`.`uber_tlc_trip_recrord_data`
)
SELECT
  dropoff_location_id,
  dropoff_latitude,
  dropoff_longitude
FROM numbered_rows
    );
  
[0m19:51:12.164957 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=uber-data-engineering-407103&j=bq:US:f29c3796-e479-4082-8dd8-ecea1c0bb829&page=queryresults
[0m19:51:12.174022 [debug] [Thread-1 (]: Timing info for model.uber.dropoff_location_dim (execute): 19:51:08.618874 => 19:51:12.173509
[0m19:51:12.176039 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'd2031800-18c2-4db9-82b9-79bf302842c2', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff7f8a6150>]}
[0m19:51:12.177572 [info ] [Thread-1 (]: 2 of 9 OK created sql table model uber.dropoff_location_dim .................... [[32mCREATE TABLE (100.0k rows, 1.5 MiB processed)[0m in 3.57s]
[0m19:51:12.179141 [debug] [Thread-1 (]: Finished running node model.uber.dropoff_location_dim
[0m19:51:12.180162 [debug] [Thread-1 (]: Began running node model.uber.passenger_count_dim
[0m19:51:12.181483 [info ] [Thread-1 (]: 3 of 9 START sql table model uber.passenger_count_dim .......................... [RUN]
[0m19:51:12.182619 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.uber.dropoff_location_dim, now model.uber.passenger_count_dim)
[0m19:51:12.183270 [debug] [Thread-1 (]: Began compiling node model.uber.passenger_count_dim
[0m19:51:12.190497 [debug] [Thread-1 (]: Writing injected SQL for node "model.uber.passenger_count_dim"
[0m19:51:12.192775 [debug] [Thread-1 (]: Timing info for model.uber.passenger_count_dim (compile): 19:51:12.183809 => 19:51:12.192604
[0m19:51:12.193617 [debug] [Thread-1 (]: Began executing node model.uber.passenger_count_dim
[0m19:51:12.196353 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m19:51:12.575520 [debug] [Thread-1 (]: Writing runtime sql for node "model.uber.passenger_count_dim"
[0m19:51:12.578584 [debug] [Thread-1 (]: On model.uber.passenger_count_dim: /* {"app": "dbt", "dbt_version": "1.5.9", "profile_name": "uber", "target_name": "dev", "node_id": "model.uber.passenger_count_dim"} */

  
    

    create or replace table `uber-data-engineering-407103`.`uber`.`passenger_count_dim`
    
    

    OPTIONS()
    as (
      WITH numbered_rows AS (
  SELECT
    GENERATE_UUID() as passenger_count_id,
    passenger_count AS passenger_count,
    ROW_NUMBER() OVER () as row_num
  FROM `uber-data-engineering-407103`.`uber`.`uber_tlc_trip_recrord_data`
  WHERE passenger_count IS NOT NULL
)
SELECT
  passenger_count_id,
  passenger_count
FROM numbered_rows
    );
  
[0m19:51:15.094039 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=uber-data-engineering-407103&j=bq:US:7f1dd87a-69e6-45e7-859e-c33a3b7bddb7&page=queryresults
[0m19:51:15.100914 [debug] [Thread-1 (]: Timing info for model.uber.passenger_count_dim (execute): 19:51:12.194085 => 19:51:15.100292
[0m19:51:15.103249 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'd2031800-18c2-4db9-82b9-79bf302842c2', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff7f7e4310>]}
[0m19:51:15.104837 [info ] [Thread-1 (]: 3 of 9 OK created sql table model uber.passenger_count_dim ..................... [[32mCREATE TABLE (100.0k rows, 781.2 KiB processed)[0m in 2.92s]
[0m19:51:15.105920 [debug] [Thread-1 (]: Finished running node model.uber.passenger_count_dim
[0m19:51:15.106695 [debug] [Thread-1 (]: Began running node model.uber.payment_type_dim
[0m19:51:15.107354 [info ] [Thread-1 (]: 4 of 9 START sql table model uber.payment_type_dim ............................. [RUN]
[0m19:51:15.108680 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.uber.passenger_count_dim, now model.uber.payment_type_dim)
[0m19:51:15.109575 [debug] [Thread-1 (]: Began compiling node model.uber.payment_type_dim
[0m19:51:15.116067 [debug] [Thread-1 (]: Writing injected SQL for node "model.uber.payment_type_dim"
[0m19:51:15.119095 [debug] [Thread-1 (]: Timing info for model.uber.payment_type_dim (compile): 19:51:15.110040 => 19:51:15.118834
[0m19:51:15.119898 [debug] [Thread-1 (]: Began executing node model.uber.payment_type_dim
[0m19:51:15.122370 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m19:51:15.497048 [debug] [Thread-1 (]: Writing runtime sql for node "model.uber.payment_type_dim"
[0m19:51:15.502152 [debug] [Thread-1 (]: On model.uber.payment_type_dim: /* {"app": "dbt", "dbt_version": "1.5.9", "profile_name": "uber", "target_name": "dev", "node_id": "model.uber.payment_type_dim"} */

  
    

    create or replace table `uber-data-engineering-407103`.`uber`.`payment_type_dim`
    
    

    OPTIONS()
    as (
      WITH numbered_rows AS (
  SELECT
    GENERATE_UUID() as payment_type_id,
    payment_type AS payment_type,
    ROW_NUMBER() OVER (ORDER BY payment_type) as row_num
  FROM `uber-data-engineering-407103`.`uber`.`uber_tlc_trip_recrord_data`
  WHERE payment_type IS NOT NULL
)
SELECT
  payment_type_id,
  payment_type
FROM numbered_rows
    );
  
[0m19:51:18.505579 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=uber-data-engineering-407103&j=bq:US:fb756f14-2ee3-436a-985d-8506639a28cd&page=queryresults
[0m19:51:18.520167 [debug] [Thread-1 (]: Timing info for model.uber.payment_type_dim (execute): 19:51:15.120401 => 19:51:18.518547
[0m19:51:18.524206 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'd2031800-18c2-4db9-82b9-79bf302842c2', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff7f903810>]}
[0m19:51:18.526021 [info ] [Thread-1 (]: 4 of 9 OK created sql table model uber.payment_type_dim ........................ [[32mCREATE TABLE (100.0k rows, 781.2 KiB processed)[0m in 3.42s]
[0m19:51:18.528298 [debug] [Thread-1 (]: Finished running node model.uber.payment_type_dim
[0m19:51:18.529793 [debug] [Thread-1 (]: Began running node model.uber.pickup_location_dim
[0m19:51:18.531292 [info ] [Thread-1 (]: 5 of 9 START sql table model uber.pickup_location_dim .......................... [RUN]
[0m19:51:18.533401 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.uber.payment_type_dim, now model.uber.pickup_location_dim)
[0m19:51:18.534416 [debug] [Thread-1 (]: Began compiling node model.uber.pickup_location_dim
[0m19:51:18.545147 [debug] [Thread-1 (]: Writing injected SQL for node "model.uber.pickup_location_dim"
[0m19:51:18.547411 [debug] [Thread-1 (]: Timing info for model.uber.pickup_location_dim (compile): 19:51:18.534933 => 19:51:18.547190
[0m19:51:18.548182 [debug] [Thread-1 (]: Began executing node model.uber.pickup_location_dim
[0m19:51:18.551302 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m19:51:19.264271 [debug] [Thread-1 (]: Writing runtime sql for node "model.uber.pickup_location_dim"
[0m19:51:19.270330 [debug] [Thread-1 (]: On model.uber.pickup_location_dim: /* {"app": "dbt", "dbt_version": "1.5.9", "profile_name": "uber", "target_name": "dev", "node_id": "model.uber.pickup_location_dim"} */

  
    

    create or replace table `uber-data-engineering-407103`.`uber`.`pickup_location_dim`
    
    

    OPTIONS()
    as (
      WITH numbered_rows AS (
  SELECT
    to_hex(md5(cast(coalesce(cast(pickup_latitude as STRING), '_dbt_utils_surrogate_key_null_') || '-' || coalesce(cast(pickup_longitude as STRING), '_dbt_utils_surrogate_key_null_') as STRING))) as pickup_location_id,
    pickup_latitude AS pickup_latitude,
    pickup_longitude AS pickup_longitude,
    ROW_NUMBER() OVER (ORDER BY pickup_latitude, pickup_longitude) as row_num
  FROM `uber-data-engineering-407103`.`uber`.`uber_tlc_trip_recrord_data`
)
SELECT
  pickup_location_id,
  pickup_latitude,
  pickup_longitude
FROM numbered_rows
    );
  
[0m19:51:22.890344 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=uber-data-engineering-407103&j=bq:US:58632bf9-9147-4cde-a472-883746cdcc5b&page=queryresults
[0m19:51:22.901268 [debug] [Thread-1 (]: Timing info for model.uber.pickup_location_dim (execute): 19:51:18.548872 => 19:51:22.900697
[0m19:51:22.903832 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'd2031800-18c2-4db9-82b9-79bf302842c2', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff7f97b910>]}
[0m19:51:22.905389 [info ] [Thread-1 (]: 5 of 9 OK created sql table model uber.pickup_location_dim ..................... [[32mCREATE TABLE (100.0k rows, 1.5 MiB processed)[0m in 4.37s]
[0m19:51:22.907038 [debug] [Thread-1 (]: Finished running node model.uber.pickup_location_dim
[0m19:51:22.908351 [debug] [Thread-1 (]: Began running node model.uber.rate_code_dim
[0m19:51:22.909729 [info ] [Thread-1 (]: 6 of 9 START sql table model uber.rate_code_dim ................................ [RUN]
[0m19:51:22.911061 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.uber.pickup_location_dim, now model.uber.rate_code_dim)
[0m19:51:22.911754 [debug] [Thread-1 (]: Began compiling node model.uber.rate_code_dim
[0m19:51:22.942096 [debug] [Thread-1 (]: Writing injected SQL for node "model.uber.rate_code_dim"
[0m19:51:22.949000 [debug] [Thread-1 (]: Timing info for model.uber.rate_code_dim (compile): 19:51:22.912328 => 19:51:22.947875
[0m19:51:22.950323 [debug] [Thread-1 (]: Began executing node model.uber.rate_code_dim
[0m19:51:22.956297 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m19:51:23.324639 [debug] [Thread-1 (]: Writing runtime sql for node "model.uber.rate_code_dim"
[0m19:51:23.330560 [debug] [Thread-1 (]: On model.uber.rate_code_dim: /* {"app": "dbt", "dbt_version": "1.5.9", "profile_name": "uber", "target_name": "dev", "node_id": "model.uber.rate_code_dim"} */

  
    

    create or replace table `uber-data-engineering-407103`.`uber`.`rate_code_dim`
    
    

    OPTIONS()
    as (
      WITH numbered_rows AS (
  SELECT
    GENERATE_UUID() as rate_code_id,
    RatecodeID AS RatecodeID,
    ROW_NUMBER() OVER (ORDER BY RatecodeID) as row_num
  FROM `uber-data-engineering-407103`.`uber`.`uber_tlc_trip_recrord_data`
  WHERE RatecodeID IS NOT NULL
)
SELECT
  rate_code_id,
  RatecodeID
FROM numbered_rows
    );
  
[0m19:51:25.954183 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=uber-data-engineering-407103&j=bq:US:b8fd5a2b-c082-422a-9b07-20d46f249ad3&page=queryresults
[0m19:51:25.963913 [debug] [Thread-1 (]: Timing info for model.uber.rate_code_dim (execute): 19:51:22.951211 => 19:51:25.963174
[0m19:51:25.967315 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'd2031800-18c2-4db9-82b9-79bf302842c2', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff7e771050>]}
[0m19:51:25.969645 [info ] [Thread-1 (]: 6 of 9 OK created sql table model uber.rate_code_dim ........................... [[32mCREATE TABLE (100.0k rows, 781.2 KiB processed)[0m in 3.06s]
[0m19:51:25.972058 [debug] [Thread-1 (]: Finished running node model.uber.rate_code_dim
[0m19:51:25.974611 [debug] [Thread-1 (]: Began running node model.uber.trip_distance
[0m19:51:25.976257 [info ] [Thread-1 (]: 7 of 9 START sql table model uber.trip_distance ................................ [RUN]
[0m19:51:25.978854 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.uber.rate_code_dim, now model.uber.trip_distance)
[0m19:51:25.980178 [debug] [Thread-1 (]: Began compiling node model.uber.trip_distance
[0m19:51:25.984027 [debug] [Thread-1 (]: Writing injected SQL for node "model.uber.trip_distance"
[0m19:51:25.986895 [debug] [Thread-1 (]: Timing info for model.uber.trip_distance (compile): 19:51:25.980676 => 19:51:25.986563
[0m19:51:25.988261 [debug] [Thread-1 (]: Began executing node model.uber.trip_distance
[0m19:51:25.991492 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m19:51:26.348184 [debug] [Thread-1 (]: Writing runtime sql for node "model.uber.trip_distance"
[0m19:51:26.352206 [debug] [Thread-1 (]: On model.uber.trip_distance: /* {"app": "dbt", "dbt_version": "1.5.9", "profile_name": "uber", "target_name": "dev", "node_id": "model.uber.trip_distance"} */

  
    

    create or replace table `uber-data-engineering-407103`.`uber`.`trip_distance`
    
    

    OPTIONS()
    as (
      WITH numbered_rows AS (
  SELECT
    GENERATE_UUID() as trip_distance_id,
    trip_distance AS trip_distance,
    ROW_NUMBER() OVER (ORDER BY trip_distance) as row_num
  FROM `uber-data-engineering-407103`.`uber`.`uber_tlc_trip_recrord_data`
  WHERE trip_distance IS NOT NULL
)
SELECT
  trip_distance_id,
  trip_distance
FROM numbered_rows
    );
  
[0m19:51:28.645362 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=uber-data-engineering-407103&j=bq:US:1bb16178-9ccf-424f-8cfc-49b3bc3a8344&page=queryresults
[0m19:51:28.658501 [debug] [Thread-1 (]: Timing info for model.uber.trip_distance (execute): 19:51:25.989102 => 19:51:28.657559
[0m19:51:28.662272 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'd2031800-18c2-4db9-82b9-79bf302842c2', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff7e6bf8d0>]}
[0m19:51:28.664919 [info ] [Thread-1 (]: 7 of 9 OK created sql table model uber.trip_distance ........................... [[32mCREATE TABLE (100.0k rows, 781.2 KiB processed)[0m in 2.68s]
[0m19:51:28.667514 [debug] [Thread-1 (]: Finished running node model.uber.trip_distance
[0m19:51:28.670106 [debug] [Thread-1 (]: Began running node model.uber.fact_trip
[0m19:51:28.671254 [info ] [Thread-1 (]: 8 of 9 START sql table model uber.fact_trip .................................... [RUN]
[0m19:51:28.672470 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.uber.trip_distance, now model.uber.fact_trip)
[0m19:51:28.673087 [debug] [Thread-1 (]: Began compiling node model.uber.fact_trip
[0m19:51:28.689530 [debug] [Thread-1 (]: Writing injected SQL for node "model.uber.fact_trip"
[0m19:51:28.692712 [debug] [Thread-1 (]: Timing info for model.uber.fact_trip (compile): 19:51:28.673534 => 19:51:28.692541
[0m19:51:28.693247 [debug] [Thread-1 (]: Began executing node model.uber.fact_trip
[0m19:51:28.703702 [debug] [Thread-1 (]: Writing runtime sql for node "model.uber.fact_trip"
[0m19:51:28.712948 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m19:51:28.728727 [debug] [Thread-1 (]: On model.uber.fact_trip: /* {"app": "dbt", "dbt_version": "1.5.9", "profile_name": "uber", "target_name": "dev", "node_id": "model.uber.fact_trip"} */

  
    

    create or replace table `uber-data-engineering-407103`.`uber`.`fact_trip`
    
    

    OPTIONS()
    as (
      WITH fct_invoices_cte AS (
    SELECT
        CAST(ROW_NUMBER() OVER () AS INT64) as trip_id,
        VendorID,
        to_hex(md5(cast(coalesce(cast(tpep_pickup_datetime as STRING), '_dbt_utils_surrogate_key_null_') || '-' || coalesce(cast(tpep_dropoff_datetime as STRING), '_dbt_utils_surrogate_key_null_') as STRING))) AS datetime_id,
        passenger_count_id,
        trip_distance_id,
        rate_code_id,
        store_and_fwd_flag,
        pickup_location_id,
        to_hex(md5(cast(coalesce(cast(dropoff_latitude as STRING), '_dbt_utils_surrogate_key_null_') || '-' || coalesce(cast(dropoff_longitude as STRING), '_dbt_utils_surrogate_key_null_') as STRING))) as dropoff_location_id,
        payment_type_id,
        fare_amount,
        extra,
        mta_tax,
        tip_amount,
        tolls_amount,
        improvement_surcharge,
        total_amount
    FROM `uber-data-engineering-407103`.`uber`.`uber_tlc_trip_recrord_data`
)
SELECT
    trip_id,
    VendorID,
    datetime_id,
    do.dropoff_location_id,
    pu.pickup_location_id,
    pc.passenger_count_id,
    pt.payment_type_id,
    rc.rate_code_id,
    store_and_fwd_flag,
    td.trip_distance_id,
    fare_amount,
    extra,
    mta_tax,
    tip_amount,
    tolls_amount,
    improvement_surcharge AS improvement_surcharge_amount,  -- Added alias
    total_amount
FROM fct_invoices_cte fi
INNER JOIN `uber-data-engineering-407103`.`uber`.`datetime_dim` dt ON fi.datetime_id = dt.datetime_id
INNER JOIN `uber-data-engineering-407103`.`uber`.`dropoff_location_dim` do ON fi.dropoff_location_id = do.dropoff_location_id
INNER JOIN `uber-data-engineering-407103`.`uber`.`pickup_location_dim` pu ON fi.pickup_location_id = pu.pickup_location_id
INNER JOIN `uber-data-engineering-407103`.`uber`.`passenger_count_dim` pc ON fi.passenger_count_id = pc.passenger_count_id
INNER JOIN `uber-data-engineering-407103`.`uber`.`payment_type_dim` pt ON fi.payment_type_id = pt.payment_type_id
INNER JOIN `uber-data-engineering-407103`.`uber`.`rate_code_dim` rc ON fi.rate_code_id = rc.rate_code_id
INNER JOIN `uber-data-engineering-407103`.`uber`.`trip_distance` td ON fi.trip_distance_id = td.trip_distance_id
    );
  
[0m19:51:30.031541 [debug] [Thread-1 (]: BigQuery adapter: Retry attempt 1 of 1 after error: BadRequest('Unrecognized name: passenger_count_id; Did you mean passenger_count? at [17:9]')
[0m19:51:31.070562 [error] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=uber-data-engineering-407103&j=bq:US:f526b31d-25c5-4cf7-b861-f72b8afbd8d4&page=queryresults
[0m19:51:31.078856 [debug] [Thread-1 (]: Timing info for model.uber.fact_trip (execute): 19:51:28.693753 => 19:51:31.077670
[0m19:51:31.102119 [debug] [Thread-1 (]: Database Error in model fact_trip (models/transform/fact_trip.sql)
  Unrecognized name: passenger_count_id; Did you mean passenger_count? at [17:9]
  compiled Code at target/run/uber/models/transform/fact_trip.sql
[0m19:51:31.104086 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'd2031800-18c2-4db9-82b9-79bf302842c2', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff7f853290>]}
[0m19:51:31.106268 [error] [Thread-1 (]: 8 of 9 ERROR creating sql table model uber.fact_trip ........................... [[31mERROR[0m in 2.43s]
[0m19:51:31.108096 [debug] [Thread-1 (]: Finished running node model.uber.fact_trip
[0m19:51:31.109769 [debug] [Thread-1 (]: Began running node model.uber.test_fct
[0m19:51:31.112346 [info ] [Thread-1 (]: 9 of 9 START sql table model uber.test_fct ..................................... [RUN]
[0m19:51:31.114990 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.uber.fact_trip, now model.uber.test_fct)
[0m19:51:31.116028 [debug] [Thread-1 (]: Began compiling node model.uber.test_fct
[0m19:51:31.130029 [debug] [Thread-1 (]: Writing injected SQL for node "model.uber.test_fct"
[0m19:51:31.134644 [debug] [Thread-1 (]: Timing info for model.uber.test_fct (compile): 19:51:31.116807 => 19:51:31.134343
[0m19:51:31.136017 [debug] [Thread-1 (]: Began executing node model.uber.test_fct
[0m19:51:31.140505 [debug] [Thread-1 (]: Writing runtime sql for node "model.uber.test_fct"
[0m19:51:31.142915 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m19:51:31.145861 [debug] [Thread-1 (]: On model.uber.test_fct: /* {"app": "dbt", "dbt_version": "1.5.9", "profile_name": "uber", "target_name": "dev", "node_id": "model.uber.test_fct"} */

  
    

    create or replace table `uber-data-engineering-407103`.`uber`.`test_fct`
    
    

    OPTIONS()
    as (
      SELECT
    fi.trip_distance_id,
    td.trip_distance
FROM fct_invoices_cte fi
INNER JOIN `uber-data-engineering-407103`.`uber`.`trip_distance` td ON fi.trip_distance_id = td.trip_distance_id
    );
  
[0m19:51:31.586637 [debug] [Thread-1 (]: BigQuery adapter: Retry attempt 1 of 1 after error: BadRequest('Table "fct_invoices_cte" must be qualified with a dataset (e.g. dataset.table).')
[0m19:51:32.297445 [error] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=uber-data-engineering-407103&j=bq:US:27147e0a-7eb1-4b61-bc0a-0d1051a3ef55&page=queryresults
[0m19:51:32.298927 [debug] [Thread-1 (]: Timing info for model.uber.test_fct (execute): 19:51:31.136590 => 19:51:32.298717
[0m19:51:32.303143 [debug] [Thread-1 (]: Database Error in model test_fct (models/transform/test_fct.sql)
  Table "fct_invoices_cte" must be qualified with a dataset (e.g. dataset.table).
  compiled Code at target/run/uber/models/transform/test_fct.sql
[0m19:51:32.303810 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'd2031800-18c2-4db9-82b9-79bf302842c2', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff7f8e4290>]}
[0m19:51:32.304767 [error] [Thread-1 (]: 9 of 9 ERROR creating sql table model uber.test_fct ............................ [[31mERROR[0m in 1.19s]
[0m19:51:32.305838 [debug] [Thread-1 (]: Finished running node model.uber.test_fct
[0m19:51:32.310086 [debug] [MainThread]: Connection 'master' was properly closed.
[0m19:51:32.310637 [debug] [MainThread]: Connection 'model.uber.test_fct' was properly closed.
[0m19:51:32.311460 [info ] [MainThread]: 
[0m19:51:32.312335 [info ] [MainThread]: Finished running 9 table models in 0 hours 0 minutes and 28.25 seconds (28.25s).
[0m19:51:32.314947 [debug] [MainThread]: Command end result
[0m19:51:32.348060 [info ] [MainThread]: 
[0m19:51:32.349310 [info ] [MainThread]: [31mCompleted with 2 errors and 0 warnings:[0m
[0m19:51:32.350373 [info ] [MainThread]: 
[0m19:51:32.351638 [error] [MainThread]: [33mDatabase Error in model fact_trip (models/transform/fact_trip.sql)[0m
[0m19:51:32.353211 [error] [MainThread]:   Unrecognized name: passenger_count_id; Did you mean passenger_count? at [17:9]
[0m19:51:32.360509 [error] [MainThread]:   compiled Code at target/run/uber/models/transform/fact_trip.sql
[0m19:51:32.362040 [info ] [MainThread]: 
[0m19:51:32.362770 [error] [MainThread]: [33mDatabase Error in model test_fct (models/transform/test_fct.sql)[0m
[0m19:51:32.363425 [error] [MainThread]:   Table "fct_invoices_cte" must be qualified with a dataset (e.g. dataset.table).
[0m19:51:32.364565 [error] [MainThread]:   compiled Code at target/run/uber/models/transform/test_fct.sql
[0m19:51:32.365866 [info ] [MainThread]: 
[0m19:51:32.367149 [info ] [MainThread]: Done. PASS=7 WARN=0 ERROR=2 SKIP=0 TOTAL=9
[0m19:51:32.369963 [debug] [MainThread]: Command `dbt run` failed at 19:51:32.369451 after 28.97 seconds
[0m19:51:32.371093 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff81ddb490>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff81dd8a50>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff85914490>]}
[0m19:51:32.371887 [debug] [MainThread]: Flushing usage events
[0m19:54:59.253864 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffa0af3150>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffa0af35d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffa0e02110>]}


============================== 19:54:59.259398 | f6331a40-c36c-4314-98bf-b6788a953d45 ==============================
[0m19:54:59.259398 [info ] [MainThread]: Running with dbt=1.5.9
[0m19:54:59.260326 [debug] [MainThread]: running dbt with arguments {'use_experimental_parser': 'False', 'target_path': 'None', 'log_path': '/usr/local/airflow/include/dbt/logs', 'use_colors': 'True', 'static_parser': 'True', 'printer_width': '80', 'introspect': 'True', 'quiet': 'False', 'debug': 'False', 'log_cache_events': 'False', 'no_print': 'None', 'fail_fast': 'False', 'version_check': 'True', 'profiles_dir': '/usr/local/airflow/include/dbt/', 'send_anonymous_usage_stats': 'True', 'warn_error': 'None', 'indirect_selection': 'eager', 'write_json': 'True', 'log_format': 'default', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'partial_parse': 'True', 'cache_selected_only': 'False'}
[0m19:54:59.792374 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'f6331a40-c36c-4314-98bf-b6788a953d45', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff9eecaf50>]}
[0m19:54:59.804008 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'f6331a40-c36c-4314-98bf-b6788a953d45', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffa0b0c650>]}
[0m19:54:59.805003 [info ] [MainThread]: Registered adapter: bigquery=1.5.3
[0m19:54:59.838463 [debug] [MainThread]: checksum: dd837546c89c9d03f3c2cb0ca6165266a30da6076d5d44e9991f7c5a8e5f5831, vars: {}, profile: , target: , version: 1.5.9
[0m19:54:59.945916 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m19:54:59.946998 [debug] [MainThread]: Partial parsing: updated file: uber://models/transform/test_fct.sql
[0m19:54:59.971972 [debug] [MainThread]: 1603: static parser failed on transform/test_fct.sql
[0m19:54:59.997179 [debug] [MainThread]: 1602: parser fallback to jinja rendering on transform/test_fct.sql
[0m19:55:00.009527 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'f6331a40-c36c-4314-98bf-b6788a953d45', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff9ef3ed50>]}
[0m19:55:00.022922 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'f6331a40-c36c-4314-98bf-b6788a953d45', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff9edf5690>]}
[0m19:55:00.023641 [info ] [MainThread]: Found 9 models, 0 tests, 0 snapshots, 0 analyses, 474 macros, 0 operations, 0 seed files, 1 source, 0 exposures, 0 metrics, 0 groups
[0m19:55:00.024318 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'f6331a40-c36c-4314-98bf-b6788a953d45', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffa3e275d0>]}
[0m19:55:00.026198 [info ] [MainThread]: 
[0m19:55:00.027184 [debug] [MainThread]: Acquiring new bigquery connection 'master'
[0m19:55:00.028745 [debug] [ThreadPool]: Acquiring new bigquery connection 'list_uber-data-engineering-407103'
[0m19:55:00.029242 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m19:55:00.446682 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_uber-data-engineering-407103, now list_uber-data-engineering-407103_uber)
[0m19:55:00.448480 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m19:55:01.284316 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'f6331a40-c36c-4314-98bf-b6788a953d45', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffa1a26a50>]}
[0m19:55:01.287061 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m19:55:01.289062 [info ] [MainThread]: 
[0m19:55:01.315828 [debug] [Thread-1 (]: Began running node model.uber.datetime_dim
[0m19:55:01.317461 [info ] [Thread-1 (]: 1 of 9 START sql table model uber.datetime_dim ................................. [RUN]
[0m19:55:01.319405 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_uber-data-engineering-407103_uber, now model.uber.datetime_dim)
[0m19:55:01.320363 [debug] [Thread-1 (]: Began compiling node model.uber.datetime_dim
[0m19:55:01.338970 [debug] [Thread-1 (]: Writing injected SQL for node "model.uber.datetime_dim"
[0m19:55:01.341913 [debug] [Thread-1 (]: Timing info for model.uber.datetime_dim (compile): 19:55:01.320968 => 19:55:01.341558
[0m19:55:01.342628 [debug] [Thread-1 (]: Began executing node model.uber.datetime_dim
[0m19:55:01.356901 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m19:55:01.746781 [debug] [Thread-1 (]: Writing runtime sql for node "model.uber.datetime_dim"
[0m19:55:01.749794 [debug] [Thread-1 (]: On model.uber.datetime_dim: /* {"app": "dbt", "dbt_version": "1.5.9", "profile_name": "uber", "target_name": "dev", "node_id": "model.uber.datetime_dim"} */

  
    

    create or replace table `uber-data-engineering-407103`.`uber`.`datetime_dim`
    
    

    OPTIONS()
    as (
      WITH datetime_cte AS (  
  SELECT DISTINCT 
    to_hex(md5(cast(coalesce(cast(tpep_pickup_datetime as STRING), '_dbt_utils_surrogate_key_null_') || '-' || coalesce(cast(tpep_dropoff_datetime as STRING), '_dbt_utils_surrogate_key_null_') as STRING))) AS datetime_id,
    CASE
      WHEN LENGTH(tpep_pickup_datetime) = 16 THEN
        -- Date format: "DD/MM/YYYY HH:MM"
        PARSE_DATETIME('%m/%d/%Y %H:%M', tpep_pickup_datetime)
      WHEN LENGTH(tpep_pickup_datetime) <= 14 THEN
        -- Date format: "MM/DD/YY HH:MM"
        PARSE_DATETIME('%m/%d/%y %H:%M', tpep_pickup_datetime)
      ELSE
        NULL
    END AS pick_date_part,
    tpep_dropoff_datetime AS drop_datetime_id,
    CASE
      WHEN LENGTH(tpep_dropoff_datetime) = 16 THEN
        -- Date format: "DD/MM/YYYY HH:MM"
        PARSE_DATETIME('%m/%d/%Y %H:%M', tpep_dropoff_datetime)
      WHEN LENGTH(tpep_dropoff_datetime) <= 14 THEN
        -- Date format: "MM/DD/YY HH:MM"
        PARSE_DATETIME('%m/%d/%y %H:%M', tpep_dropoff_datetime)
      ELSE
        NULL
    END AS drop_date_part
  FROM `uber-data-engineering-407103`.`uber`.`uber_tlc_trip_recrord_data`
  WHERE tpep_pickup_datetime IS NOT NULL
    AND tpep_dropoff_datetime IS NOT NULL
)
SELECT
  datetime_id,
  pick_date_part AS tpep_pickup_datetime,
  drop_date_part AS tpep_dropoff_datetime,
  EXTRACT(HOUR FROM pick_date_part) AS pick_hour,
  EXTRACT(DAY FROM pick_date_part) AS pick_day,
  EXTRACT(MONTH FROM pick_date_part) AS pick_month,
  EXTRACT(YEAR FROM pick_date_part) AS pick_year,
  EXTRACT(DAYOFWEEK FROM pick_date_part) AS pick_weekday,
  EXTRACT(HOUR FROM drop_date_part) AS drop_hour,
  EXTRACT(DAY FROM drop_date_part) AS drop_day,
  EXTRACT(MONTH FROM drop_date_part) AS drop_month,
  EXTRACT(YEAR FROM drop_date_part) AS drop_year,
  EXTRACT(DAYOFWEEK FROM drop_date_part) AS drop_weekday
FROM datetime_cte
    );
  
[0m19:55:04.651456 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=uber-data-engineering-407103&j=bq:US:ede40d9d-5f2a-46ae-8f83-12258bef91fd&page=queryresults
[0m19:55:04.686658 [debug] [Thread-1 (]: Timing info for model.uber.datetime_dim (execute): 19:55:01.343034 => 19:55:04.686168
[0m19:55:04.688977 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'f6331a40-c36c-4314-98bf-b6788a953d45', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff9ef23010>]}
[0m19:55:04.690721 [info ] [Thread-1 (]: 1 of 9 OK created sql table model uber.datetime_dim ............................ [[32mCREATE TABLE (99.9k rows, 4.0 MiB processed)[0m in 3.37s]
[0m19:55:04.692499 [debug] [Thread-1 (]: Finished running node model.uber.datetime_dim
[0m19:55:04.693451 [debug] [Thread-1 (]: Began running node model.uber.dropoff_location_dim
[0m19:55:04.695005 [info ] [Thread-1 (]: 2 of 9 START sql table model uber.dropoff_location_dim ......................... [RUN]
[0m19:55:04.696348 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.uber.datetime_dim, now model.uber.dropoff_location_dim)
[0m19:55:04.696991 [debug] [Thread-1 (]: Began compiling node model.uber.dropoff_location_dim
[0m19:55:04.704512 [debug] [Thread-1 (]: Writing injected SQL for node "model.uber.dropoff_location_dim"
[0m19:55:04.707467 [debug] [Thread-1 (]: Timing info for model.uber.dropoff_location_dim (compile): 19:55:04.697486 => 19:55:04.707286
[0m19:55:04.708028 [debug] [Thread-1 (]: Began executing node model.uber.dropoff_location_dim
[0m19:55:04.710802 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m19:55:05.205961 [debug] [Thread-1 (]: Writing runtime sql for node "model.uber.dropoff_location_dim"
[0m19:55:05.212996 [debug] [Thread-1 (]: On model.uber.dropoff_location_dim: /* {"app": "dbt", "dbt_version": "1.5.9", "profile_name": "uber", "target_name": "dev", "node_id": "model.uber.dropoff_location_dim"} */

  
    

    create or replace table `uber-data-engineering-407103`.`uber`.`dropoff_location_dim`
    
    

    OPTIONS()
    as (
      WITH numbered_rows AS (
  SELECT
    to_hex(md5(cast(coalesce(cast(dropoff_latitude as STRING), '_dbt_utils_surrogate_key_null_') || '-' || coalesce(cast(dropoff_longitude as STRING), '_dbt_utils_surrogate_key_null_') as STRING))) as dropoff_location_id,
    dropoff_latitude AS dropoff_latitude,
    dropoff_longitude AS dropoff_longitude,
    ROW_NUMBER() OVER (ORDER BY dropoff_latitude, dropoff_longitude) as row_num
  FROM `uber-data-engineering-407103`.`uber`.`uber_tlc_trip_recrord_data`
)
SELECT
  dropoff_location_id,
  dropoff_latitude,
  dropoff_longitude
FROM numbered_rows
    );
  
[0m19:55:08.522260 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=uber-data-engineering-407103&j=bq:US:b5cf9041-231c-41f0-84b8-b7bf9ee9dc24&page=queryresults
[0m19:55:08.525390 [debug] [Thread-1 (]: Timing info for model.uber.dropoff_location_dim (execute): 19:55:04.708448 => 19:55:08.525203
[0m19:55:08.526317 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'f6331a40-c36c-4314-98bf-b6788a953d45', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff9ec814d0>]}
[0m19:55:08.527102 [info ] [Thread-1 (]: 2 of 9 OK created sql table model uber.dropoff_location_dim .................... [[32mCREATE TABLE (100.0k rows, 1.5 MiB processed)[0m in 3.83s]
[0m19:55:08.528117 [debug] [Thread-1 (]: Finished running node model.uber.dropoff_location_dim
[0m19:55:08.528853 [debug] [Thread-1 (]: Began running node model.uber.passenger_count_dim
[0m19:55:08.529569 [info ] [Thread-1 (]: 3 of 9 START sql table model uber.passenger_count_dim .......................... [RUN]
[0m19:55:08.530478 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.uber.dropoff_location_dim, now model.uber.passenger_count_dim)
[0m19:55:08.531094 [debug] [Thread-1 (]: Began compiling node model.uber.passenger_count_dim
[0m19:55:08.533932 [debug] [Thread-1 (]: Writing injected SQL for node "model.uber.passenger_count_dim"
[0m19:55:08.535969 [debug] [Thread-1 (]: Timing info for model.uber.passenger_count_dim (compile): 19:55:08.531523 => 19:55:08.535766
[0m19:55:08.536717 [debug] [Thread-1 (]: Began executing node model.uber.passenger_count_dim
[0m19:55:08.538853 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m19:55:09.279253 [debug] [Thread-1 (]: Writing runtime sql for node "model.uber.passenger_count_dim"
[0m19:55:09.284228 [debug] [Thread-1 (]: On model.uber.passenger_count_dim: /* {"app": "dbt", "dbt_version": "1.5.9", "profile_name": "uber", "target_name": "dev", "node_id": "model.uber.passenger_count_dim"} */

  
    

    create or replace table `uber-data-engineering-407103`.`uber`.`passenger_count_dim`
    
    

    OPTIONS()
    as (
      WITH numbered_rows AS (
  SELECT
    GENERATE_UUID() as passenger_count_id,
    passenger_count AS passenger_count,
    ROW_NUMBER() OVER () as row_num
  FROM `uber-data-engineering-407103`.`uber`.`uber_tlc_trip_recrord_data`
  WHERE passenger_count IS NOT NULL
)
SELECT
  passenger_count_id,
  passenger_count
FROM numbered_rows
    );
  
[0m19:55:12.325381 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=uber-data-engineering-407103&j=bq:US:ea5685a2-6b91-4683-8623-02aa23c17872&page=queryresults
[0m19:55:12.335734 [debug] [Thread-1 (]: Timing info for model.uber.passenger_count_dim (execute): 19:55:08.537164 => 19:55:12.335257
[0m19:55:12.338353 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'f6331a40-c36c-4314-98bf-b6788a953d45', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff9eb6b850>]}
[0m19:55:12.340215 [info ] [Thread-1 (]: 3 of 9 OK created sql table model uber.passenger_count_dim ..................... [[32mCREATE TABLE (100.0k rows, 781.2 KiB processed)[0m in 3.81s]
[0m19:55:12.341918 [debug] [Thread-1 (]: Finished running node model.uber.passenger_count_dim
[0m19:55:12.342998 [debug] [Thread-1 (]: Began running node model.uber.payment_type_dim
[0m19:55:12.344504 [info ] [Thread-1 (]: 4 of 9 START sql table model uber.payment_type_dim ............................. [RUN]
[0m19:55:12.345949 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.uber.passenger_count_dim, now model.uber.payment_type_dim)
[0m19:55:12.346686 [debug] [Thread-1 (]: Began compiling node model.uber.payment_type_dim
[0m19:55:12.359958 [debug] [Thread-1 (]: Writing injected SQL for node "model.uber.payment_type_dim"
[0m19:55:12.362395 [debug] [Thread-1 (]: Timing info for model.uber.payment_type_dim (compile): 19:55:12.347214 => 19:55:12.362205
[0m19:55:12.362950 [debug] [Thread-1 (]: Began executing node model.uber.payment_type_dim
[0m19:55:12.365990 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m19:55:13.380196 [debug] [Thread-1 (]: Writing runtime sql for node "model.uber.payment_type_dim"
[0m19:55:13.386549 [debug] [Thread-1 (]: On model.uber.payment_type_dim: /* {"app": "dbt", "dbt_version": "1.5.9", "profile_name": "uber", "target_name": "dev", "node_id": "model.uber.payment_type_dim"} */

  
    

    create or replace table `uber-data-engineering-407103`.`uber`.`payment_type_dim`
    
    

    OPTIONS()
    as (
      WITH numbered_rows AS (
  SELECT
    GENERATE_UUID() as payment_type_id,
    payment_type AS payment_type,
    ROW_NUMBER() OVER (ORDER BY payment_type) as row_num
  FROM `uber-data-engineering-407103`.`uber`.`uber_tlc_trip_recrord_data`
  WHERE payment_type IS NOT NULL
)
SELECT
  payment_type_id,
  payment_type
FROM numbered_rows
    );
  
[0m19:55:16.522720 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=uber-data-engineering-407103&j=bq:US:b01108f9-ffd0-40e5-b621-3ce3a9a1fe8f&page=queryresults
[0m19:55:16.530952 [debug] [Thread-1 (]: Timing info for model.uber.payment_type_dim (execute): 19:55:12.363378 => 19:55:16.530458
[0m19:55:16.533406 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'f6331a40-c36c-4314-98bf-b6788a953d45', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff9eb9d6d0>]}
[0m19:55:16.535254 [info ] [Thread-1 (]: 4 of 9 OK created sql table model uber.payment_type_dim ........................ [[32mCREATE TABLE (100.0k rows, 781.2 KiB processed)[0m in 4.19s]
[0m19:55:16.537472 [debug] [Thread-1 (]: Finished running node model.uber.payment_type_dim
[0m19:55:16.539977 [debug] [Thread-1 (]: Began running node model.uber.pickup_location_dim
[0m19:55:16.541890 [info ] [Thread-1 (]: 5 of 9 START sql table model uber.pickup_location_dim .......................... [RUN]
[0m19:55:16.544649 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.uber.payment_type_dim, now model.uber.pickup_location_dim)
[0m19:55:16.546421 [debug] [Thread-1 (]: Began compiling node model.uber.pickup_location_dim
[0m19:55:16.559858 [debug] [Thread-1 (]: Writing injected SQL for node "model.uber.pickup_location_dim"
[0m19:55:16.564101 [debug] [Thread-1 (]: Timing info for model.uber.pickup_location_dim (compile): 19:55:16.547887 => 19:55:16.563715
[0m19:55:16.565209 [debug] [Thread-1 (]: Began executing node model.uber.pickup_location_dim
[0m19:55:16.572035 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m19:55:17.095561 [debug] [Thread-1 (]: Writing runtime sql for node "model.uber.pickup_location_dim"
[0m19:55:17.100602 [debug] [Thread-1 (]: On model.uber.pickup_location_dim: /* {"app": "dbt", "dbt_version": "1.5.9", "profile_name": "uber", "target_name": "dev", "node_id": "model.uber.pickup_location_dim"} */

  
    

    create or replace table `uber-data-engineering-407103`.`uber`.`pickup_location_dim`
    
    

    OPTIONS()
    as (
      WITH numbered_rows AS (
  SELECT
    to_hex(md5(cast(coalesce(cast(pickup_latitude as STRING), '_dbt_utils_surrogate_key_null_') || '-' || coalesce(cast(pickup_longitude as STRING), '_dbt_utils_surrogate_key_null_') as STRING))) as pickup_location_id,
    pickup_latitude AS pickup_latitude,
    pickup_longitude AS pickup_longitude,
    ROW_NUMBER() OVER (ORDER BY pickup_latitude, pickup_longitude) as row_num
  FROM `uber-data-engineering-407103`.`uber`.`uber_tlc_trip_recrord_data`
)
SELECT
  pickup_location_id,
  pickup_latitude,
  pickup_longitude
FROM numbered_rows
    );
  
[0m19:55:20.909939 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=uber-data-engineering-407103&j=bq:US:12837baa-852f-4f76-87c1-3306c6469e29&page=queryresults
[0m19:55:20.921223 [debug] [Thread-1 (]: Timing info for model.uber.pickup_location_dim (execute): 19:55:16.565884 => 19:55:20.920364
[0m19:55:20.924184 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'f6331a40-c36c-4314-98bf-b6788a953d45', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff9ec00290>]}
[0m19:55:20.926011 [info ] [Thread-1 (]: 5 of 9 OK created sql table model uber.pickup_location_dim ..................... [[32mCREATE TABLE (100.0k rows, 1.5 MiB processed)[0m in 4.38s]
[0m19:55:20.928147 [debug] [Thread-1 (]: Finished running node model.uber.pickup_location_dim
[0m19:55:20.929658 [debug] [Thread-1 (]: Began running node model.uber.rate_code_dim
[0m19:55:20.931056 [info ] [Thread-1 (]: 6 of 9 START sql table model uber.rate_code_dim ................................ [RUN]
[0m19:55:20.933545 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.uber.pickup_location_dim, now model.uber.rate_code_dim)
[0m19:55:20.934611 [debug] [Thread-1 (]: Began compiling node model.uber.rate_code_dim
[0m19:55:20.939273 [debug] [Thread-1 (]: Writing injected SQL for node "model.uber.rate_code_dim"
[0m19:55:20.941664 [debug] [Thread-1 (]: Timing info for model.uber.rate_code_dim (compile): 19:55:20.935344 => 19:55:20.941474
[0m19:55:20.942317 [debug] [Thread-1 (]: Began executing node model.uber.rate_code_dim
[0m19:55:20.944639 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m19:55:22.392701 [debug] [Thread-1 (]: Writing runtime sql for node "model.uber.rate_code_dim"
[0m19:55:22.399038 [debug] [Thread-1 (]: On model.uber.rate_code_dim: /* {"app": "dbt", "dbt_version": "1.5.9", "profile_name": "uber", "target_name": "dev", "node_id": "model.uber.rate_code_dim"} */

  
    

    create or replace table `uber-data-engineering-407103`.`uber`.`rate_code_dim`
    
    

    OPTIONS()
    as (
      WITH numbered_rows AS (
  SELECT
    GENERATE_UUID() as rate_code_id,
    RatecodeID AS RatecodeID,
    ROW_NUMBER() OVER (ORDER BY RatecodeID) as row_num
  FROM `uber-data-engineering-407103`.`uber`.`uber_tlc_trip_recrord_data`
  WHERE RatecodeID IS NOT NULL
)
SELECT
  rate_code_id,
  RatecodeID
FROM numbered_rows
    );
  
[0m19:55:25.425164 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=uber-data-engineering-407103&j=bq:US:bccafbb0-78b3-471c-aa95-bb08cd461460&page=queryresults
[0m19:55:25.432452 [debug] [Thread-1 (]: Timing info for model.uber.rate_code_dim (execute): 19:55:20.942725 => 19:55:25.431980
[0m19:55:25.435171 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'f6331a40-c36c-4314-98bf-b6788a953d45', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff9ebec4d0>]}
[0m19:55:25.437304 [info ] [Thread-1 (]: 6 of 9 OK created sql table model uber.rate_code_dim ........................... [[32mCREATE TABLE (100.0k rows, 781.2 KiB processed)[0m in 4.50s]
[0m19:55:25.439298 [debug] [Thread-1 (]: Finished running node model.uber.rate_code_dim
[0m19:55:25.441385 [debug] [Thread-1 (]: Began running node model.uber.trip_distance
[0m19:55:25.443177 [info ] [Thread-1 (]: 7 of 9 START sql table model uber.trip_distance ................................ [RUN]
[0m19:55:25.444586 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.uber.rate_code_dim, now model.uber.trip_distance)
[0m19:55:25.445360 [debug] [Thread-1 (]: Began compiling node model.uber.trip_distance
[0m19:55:25.454476 [debug] [Thread-1 (]: Writing injected SQL for node "model.uber.trip_distance"
[0m19:55:25.456961 [debug] [Thread-1 (]: Timing info for model.uber.trip_distance (compile): 19:55:25.445918 => 19:55:25.456739
[0m19:55:25.457760 [debug] [Thread-1 (]: Began executing node model.uber.trip_distance
[0m19:55:25.460314 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m19:55:26.157430 [debug] [Thread-1 (]: Writing runtime sql for node "model.uber.trip_distance"
[0m19:55:26.162992 [debug] [Thread-1 (]: On model.uber.trip_distance: /* {"app": "dbt", "dbt_version": "1.5.9", "profile_name": "uber", "target_name": "dev", "node_id": "model.uber.trip_distance"} */

  
    

    create or replace table `uber-data-engineering-407103`.`uber`.`trip_distance`
    
    

    OPTIONS()
    as (
      WITH numbered_rows AS (
  SELECT
    GENERATE_UUID() as trip_distance_id,
    trip_distance AS trip_distance,
    ROW_NUMBER() OVER (ORDER BY trip_distance) as row_num
  FROM `uber-data-engineering-407103`.`uber`.`uber_tlc_trip_recrord_data`
  WHERE trip_distance IS NOT NULL
)
SELECT
  trip_distance_id,
  trip_distance
FROM numbered_rows
    );
  
[0m19:55:29.491352 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=uber-data-engineering-407103&j=bq:US:f6cf8f94-d02b-4448-95b5-640634ee3b06&page=queryresults
[0m19:55:29.496519 [debug] [Thread-1 (]: Timing info for model.uber.trip_distance (execute): 19:55:25.458189 => 19:55:29.496278
[0m19:55:29.497953 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'f6331a40-c36c-4314-98bf-b6788a953d45', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff9ed21d10>]}
[0m19:55:29.498842 [info ] [Thread-1 (]: 7 of 9 OK created sql table model uber.trip_distance ........................... [[32mCREATE TABLE (100.0k rows, 781.2 KiB processed)[0m in 4.05s]
[0m19:55:29.499856 [debug] [Thread-1 (]: Finished running node model.uber.trip_distance
[0m19:55:29.501763 [debug] [Thread-1 (]: Began running node model.uber.fact_trip
[0m19:55:29.502392 [info ] [Thread-1 (]: 8 of 9 START sql table model uber.fact_trip .................................... [RUN]
[0m19:55:29.503487 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.uber.trip_distance, now model.uber.fact_trip)
[0m19:55:29.504021 [debug] [Thread-1 (]: Began compiling node model.uber.fact_trip
[0m19:55:29.520102 [debug] [Thread-1 (]: Writing injected SQL for node "model.uber.fact_trip"
[0m19:55:29.524459 [debug] [Thread-1 (]: Timing info for model.uber.fact_trip (compile): 19:55:29.504488 => 19:55:29.523973
[0m19:55:29.525310 [debug] [Thread-1 (]: Began executing node model.uber.fact_trip
[0m19:55:29.529412 [debug] [Thread-1 (]: Writing runtime sql for node "model.uber.fact_trip"
[0m19:55:29.531349 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m19:55:29.534492 [debug] [Thread-1 (]: On model.uber.fact_trip: /* {"app": "dbt", "dbt_version": "1.5.9", "profile_name": "uber", "target_name": "dev", "node_id": "model.uber.fact_trip"} */

  
    

    create or replace table `uber-data-engineering-407103`.`uber`.`fact_trip`
    
    

    OPTIONS()
    as (
      WITH fct_invoices_cte AS (
    SELECT
        CAST(ROW_NUMBER() OVER () AS INT64) as trip_id,
        VendorID,
        to_hex(md5(cast(coalesce(cast(tpep_pickup_datetime as STRING), '_dbt_utils_surrogate_key_null_') || '-' || coalesce(cast(tpep_dropoff_datetime as STRING), '_dbt_utils_surrogate_key_null_') as STRING))) AS datetime_id,
        passenger_count_id,
        trip_distance_id,
        rate_code_id,
        store_and_fwd_flag,
        pickup_location_id,
        to_hex(md5(cast(coalesce(cast(dropoff_latitude as STRING), '_dbt_utils_surrogate_key_null_') || '-' || coalesce(cast(dropoff_longitude as STRING), '_dbt_utils_surrogate_key_null_') as STRING))) as dropoff_location_id,
        payment_type_id,
        fare_amount,
        extra,
        mta_tax,
        tip_amount,
        tolls_amount,
        improvement_surcharge,
        total_amount
    FROM `uber-data-engineering-407103`.`uber`.`uber_tlc_trip_recrord_data`
)
SELECT
    trip_id,
    VendorID,
    datetime_id,
    do.dropoff_location_id,
    pu.pickup_location_id,
    pc.passenger_count_id,
    pt.payment_type_id,
    rc.rate_code_id,
    store_and_fwd_flag,
    td.trip_distance_id,
    fare_amount,
    extra,
    mta_tax,
    tip_amount,
    tolls_amount,
    improvement_surcharge AS improvement_surcharge_amount,  -- Added alias
    total_amount
FROM fct_invoices_cte fi
INNER JOIN `uber-data-engineering-407103`.`uber`.`datetime_dim` dt ON fi.datetime_id = dt.datetime_id
INNER JOIN `uber-data-engineering-407103`.`uber`.`dropoff_location_dim` do ON fi.dropoff_location_id = do.dropoff_location_id
INNER JOIN `uber-data-engineering-407103`.`uber`.`pickup_location_dim` pu ON fi.pickup_location_id = pu.pickup_location_id
INNER JOIN `uber-data-engineering-407103`.`uber`.`passenger_count_dim` pc ON fi.passenger_count_id = pc.passenger_count_id
INNER JOIN `uber-data-engineering-407103`.`uber`.`payment_type_dim` pt ON fi.payment_type_id = pt.payment_type_id
INNER JOIN `uber-data-engineering-407103`.`uber`.`rate_code_dim` rc ON fi.rate_code_id = rc.rate_code_id
INNER JOIN `uber-data-engineering-407103`.`uber`.`trip_distance` td ON fi.trip_distance_id = td.trip_distance_id
    );
  
[0m19:55:30.525151 [debug] [Thread-1 (]: BigQuery adapter: Retry attempt 1 of 1 after error: BadRequest('Unrecognized name: passenger_count_id; Did you mean passenger_count? at [17:9]')
[0m19:55:31.716272 [error] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=uber-data-engineering-407103&j=bq:US:41194e22-0769-43ac-97e1-474622d2de92&page=queryresults
[0m19:55:31.718958 [debug] [Thread-1 (]: Timing info for model.uber.fact_trip (execute): 19:55:29.525905 => 19:55:31.718412
[0m19:55:31.732163 [debug] [Thread-1 (]: Database Error in model fact_trip (models/transform/fact_trip.sql)
  Unrecognized name: passenger_count_id; Did you mean passenger_count? at [17:9]
  compiled Code at target/run/uber/models/transform/fact_trip.sql
[0m19:55:31.733854 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'f6331a40-c36c-4314-98bf-b6788a953d45', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff9ebed810>]}
[0m19:55:31.735600 [error] [Thread-1 (]: 8 of 9 ERROR creating sql table model uber.fact_trip ........................... [[31mERROR[0m in 2.23s]
[0m19:55:31.736792 [debug] [Thread-1 (]: Finished running node model.uber.fact_trip
[0m19:55:31.737607 [debug] [Thread-1 (]: Began running node model.uber.test_fct
[0m19:55:31.739091 [info ] [Thread-1 (]: 9 of 9 START sql table model uber.test_fct ..................................... [RUN]
[0m19:55:31.740440 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.uber.fact_trip, now model.uber.test_fct)
[0m19:55:31.741181 [debug] [Thread-1 (]: Began compiling node model.uber.test_fct
[0m19:55:31.768197 [debug] [Thread-1 (]: Writing injected SQL for node "model.uber.test_fct"
[0m19:55:31.776991 [debug] [Thread-1 (]: Timing info for model.uber.test_fct (compile): 19:55:31.741672 => 19:55:31.776372
[0m19:55:31.777725 [debug] [Thread-1 (]: Began executing node model.uber.test_fct
[0m19:55:31.781829 [debug] [Thread-1 (]: Writing runtime sql for node "model.uber.test_fct"
[0m19:55:31.784064 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m19:55:31.787396 [debug] [Thread-1 (]: On model.uber.test_fct: /* {"app": "dbt", "dbt_version": "1.5.9", "profile_name": "uber", "target_name": "dev", "node_id": "model.uber.test_fct"} */

  
    

    create or replace table `uber-data-engineering-407103`.`uber`.`test_fct`
    
    

    OPTIONS()
    as (
      WITH fct_invoices_cte AS (
    SELECT
        CAST(ROW_NUMBER() OVER () AS INT64) as trip_id,
        VendorID,
        to_hex(md5(cast(coalesce(cast(tpep_pickup_datetime as STRING), '_dbt_utils_surrogate_key_null_') || '-' || coalesce(cast(tpep_dropoff_datetime as STRING), '_dbt_utils_surrogate_key_null_') as STRING))) AS datetime_id,
        passenger_count_id,
        trip_distance_id,
        rate_code_id,
        store_and_fwd_flag,
        pickup_location_id,
        to_hex(md5(cast(coalesce(cast(dropoff_latitude as STRING), '_dbt_utils_surrogate_key_null_') || '-' || coalesce(cast(dropoff_longitude as STRING), '_dbt_utils_surrogate_key_null_') as STRING))) as dropoff_location_id,
        payment_type_id,
        fare_amount,
        extra,
        mta_tax,
        tip_amount,
        tolls_amount,
        improvement_surcharge,
        total_amount
    FROM `uber-data-engineering-407103`.`uber`.`uber_tlc_trip_recrord_data`
)SELECT
    fi.trip_distance_id,
    td.trip_distance
FROM fct_invoices_cte fi
INNER JOIN `uber-data-engineering-407103`.`uber`.`trip_distance` td ON fi.trip_distance_id = td.trip_distance_id
    );
  
[0m19:55:33.420705 [debug] [Thread-1 (]: BigQuery adapter: Retry attempt 1 of 1 after error: BadRequest('Unrecognized name: passenger_count_id; Did you mean passenger_count? at [17:9]')
[0m19:55:35.118677 [error] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=uber-data-engineering-407103&j=bq:US:236fee2d-5a31-404b-8a55-40a0ad481f7b&page=queryresults
[0m19:55:35.129387 [debug] [Thread-1 (]: Timing info for model.uber.test_fct (execute): 19:55:31.778179 => 19:55:35.128023
[0m19:55:35.142084 [debug] [Thread-1 (]: Database Error in model test_fct (models/transform/test_fct.sql)
  Unrecognized name: passenger_count_id; Did you mean passenger_count? at [17:9]
  compiled Code at target/run/uber/models/transform/test_fct.sql
[0m19:55:35.144225 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'f6331a40-c36c-4314-98bf-b6788a953d45', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff9caf6b90>]}
[0m19:55:35.147620 [error] [Thread-1 (]: 9 of 9 ERROR creating sql table model uber.test_fct ............................ [[31mERROR[0m in 3.40s]
[0m19:55:35.149249 [debug] [Thread-1 (]: Finished running node model.uber.test_fct
[0m19:55:35.155966 [debug] [MainThread]: Connection 'master' was properly closed.
[0m19:55:35.156720 [debug] [MainThread]: Connection 'model.uber.test_fct' was properly closed.
[0m19:55:35.157552 [info ] [MainThread]: 
[0m19:55:35.158454 [info ] [MainThread]: Finished running 9 table models in 0 hours 0 minutes and 35.13 seconds (35.13s).
[0m19:55:35.161785 [debug] [MainThread]: Command end result
[0m19:55:35.218074 [info ] [MainThread]: 
[0m19:55:35.219520 [info ] [MainThread]: [31mCompleted with 2 errors and 0 warnings:[0m
[0m19:55:35.220406 [info ] [MainThread]: 
[0m19:55:35.221871 [error] [MainThread]: [33mDatabase Error in model fact_trip (models/transform/fact_trip.sql)[0m
[0m19:55:35.228002 [error] [MainThread]:   Unrecognized name: passenger_count_id; Did you mean passenger_count? at [17:9]
[0m19:55:35.229168 [error] [MainThread]:   compiled Code at target/run/uber/models/transform/fact_trip.sql
[0m19:55:35.230598 [info ] [MainThread]: 
[0m19:55:35.232189 [error] [MainThread]: [33mDatabase Error in model test_fct (models/transform/test_fct.sql)[0m
[0m19:55:35.234041 [error] [MainThread]:   Unrecognized name: passenger_count_id; Did you mean passenger_count? at [17:9]
[0m19:55:35.235900 [error] [MainThread]:   compiled Code at target/run/uber/models/transform/test_fct.sql
[0m19:55:35.237611 [info ] [MainThread]: 
[0m19:55:35.242374 [info ] [MainThread]: Done. PASS=7 WARN=0 ERROR=2 SKIP=0 TOTAL=9
[0m19:55:35.260916 [debug] [MainThread]: Command `dbt run` failed at 19:55:35.259903 after 36.02 seconds
[0m19:55:35.263985 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffa0f5cb50>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff9ed83fd0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff9ef0c9d0>]}
[0m19:55:35.265410 [debug] [MainThread]: Flushing usage events
[0m20:13:01.330559 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff99eb3c10>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff9a343550>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff9a341290>]}


============================== 20:13:01.337171 | 2ffd629a-15a0-46ac-a649-0426e2b569e2 ==============================
[0m20:13:01.337171 [info ] [MainThread]: Running with dbt=1.5.9
[0m20:13:01.338173 [debug] [MainThread]: running dbt with arguments {'log_path': '/usr/local/airflow/include/dbt/logs', 'warn_error': 'None', 'fail_fast': 'False', 'log_format': 'default', 'no_print': 'None', 'target_path': 'None', 'static_parser': 'True', 'use_experimental_parser': 'False', 'indirect_selection': 'eager', 'printer_width': '80', 'write_json': 'True', 'partial_parse': 'True', 'introspect': 'True', 'cache_selected_only': 'False', 'log_cache_events': 'False', 'debug': 'False', 'version_check': 'True', 'profiles_dir': '/usr/local/airflow/include/dbt', 'quiet': 'False', 'send_anonymous_usage_stats': 'True', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'use_colors': 'True'}
[0m20:13:01.823908 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '2ffd629a-15a0-46ac-a649-0426e2b569e2', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff97faff90>]}
[0m20:13:01.835222 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '2ffd629a-15a0-46ac-a649-0426e2b569e2', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff9a1f9ad0>]}
[0m20:13:01.836008 [info ] [MainThread]: Registered adapter: bigquery=1.5.3
[0m20:13:01.852322 [debug] [MainThread]: checksum: dd837546c89c9d03f3c2cb0ca6165266a30da6076d5d44e9991f7c5a8e5f5831, vars: {}, profile: , target: , version: 1.5.9
[0m20:13:01.935240 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m20:13:01.935934 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m20:13:01.942361 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '2ffd629a-15a0-46ac-a649-0426e2b569e2', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff9a3654d0>]}
[0m20:13:01.960562 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '2ffd629a-15a0-46ac-a649-0426e2b569e2', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff9800a310>]}
[0m20:13:01.961247 [info ] [MainThread]: Found 9 models, 0 tests, 0 snapshots, 0 analyses, 474 macros, 0 operations, 0 seed files, 1 source, 0 exposures, 0 metrics, 0 groups
[0m20:13:01.962056 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '2ffd629a-15a0-46ac-a649-0426e2b569e2', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff9ced7510>]}
[0m20:13:01.963740 [info ] [MainThread]: 
[0m20:13:01.964865 [debug] [MainThread]: Acquiring new bigquery connection 'master'
[0m20:13:01.966471 [debug] [ThreadPool]: Acquiring new bigquery connection 'list_uber-data-engineering-407103'
[0m20:13:01.967048 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m20:13:02.956957 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_uber-data-engineering-407103, now list_uber-data-engineering-407103_uber)
[0m20:13:02.958666 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m20:13:03.476179 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '2ffd629a-15a0-46ac-a649-0426e2b569e2', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff9aadac10>]}
[0m20:13:03.478148 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m20:13:03.479129 [info ] [MainThread]: 
[0m20:13:03.498557 [debug] [Thread-1 (]: Began running node model.uber.datetime_dim
[0m20:13:03.499583 [info ] [Thread-1 (]: 1 of 9 START sql table model uber.datetime_dim ................................. [RUN]
[0m20:13:03.500878 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_uber-data-engineering-407103_uber, now model.uber.datetime_dim)
[0m20:13:03.501500 [debug] [Thread-1 (]: Began compiling node model.uber.datetime_dim
[0m20:13:03.540832 [debug] [Thread-1 (]: Writing injected SQL for node "model.uber.datetime_dim"
[0m20:13:03.545858 [debug] [Thread-1 (]: Timing info for model.uber.datetime_dim (compile): 20:13:03.501993 => 20:13:03.545098
[0m20:13:03.547674 [debug] [Thread-1 (]: Began executing node model.uber.datetime_dim
[0m20:13:03.565606 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m20:13:04.306341 [debug] [Thread-1 (]: Writing runtime sql for node "model.uber.datetime_dim"
[0m20:13:04.309027 [debug] [Thread-1 (]: On model.uber.datetime_dim: /* {"app": "dbt", "dbt_version": "1.5.9", "profile_name": "uber", "target_name": "dev", "node_id": "model.uber.datetime_dim"} */

  
    

    create or replace table `uber-data-engineering-407103`.`uber`.`datetime_dim`
    
    

    OPTIONS()
    as (
      WITH datetime_cte AS (  
  SELECT DISTINCT 
    to_hex(md5(cast(coalesce(cast(tpep_pickup_datetime as STRING), '_dbt_utils_surrogate_key_null_') || '-' || coalesce(cast(tpep_dropoff_datetime as STRING), '_dbt_utils_surrogate_key_null_') as STRING))) AS datetime_id,
    CASE
      WHEN LENGTH(tpep_pickup_datetime) = 16 THEN
        -- Date format: "DD/MM/YYYY HH:MM"
        PARSE_DATETIME('%m/%d/%Y %H:%M', tpep_pickup_datetime)
      WHEN LENGTH(tpep_pickup_datetime) <= 14 THEN
        -- Date format: "MM/DD/YY HH:MM"
        PARSE_DATETIME('%m/%d/%y %H:%M', tpep_pickup_datetime)
      ELSE
        NULL
    END AS pick_date_part,
    tpep_dropoff_datetime AS drop_datetime_id,
    CASE
      WHEN LENGTH(tpep_dropoff_datetime) = 16 THEN
        -- Date format: "DD/MM/YYYY HH:MM"
        PARSE_DATETIME('%m/%d/%Y %H:%M', tpep_dropoff_datetime)
      WHEN LENGTH(tpep_dropoff_datetime) <= 14 THEN
        -- Date format: "MM/DD/YY HH:MM"
        PARSE_DATETIME('%m/%d/%y %H:%M', tpep_dropoff_datetime)
      ELSE
        NULL
    END AS drop_date_part
  FROM `uber-data-engineering-407103`.`uber`.`uber_tlc_trip_recrord_data`
  WHERE tpep_pickup_datetime IS NOT NULL
    AND tpep_dropoff_datetime IS NOT NULL
)
SELECT
  datetime_id,
  pick_date_part AS tpep_pickup_datetime,
  drop_date_part AS tpep_dropoff_datetime,
  EXTRACT(HOUR FROM pick_date_part) AS pick_hour,
  EXTRACT(DAY FROM pick_date_part) AS pick_day,
  EXTRACT(MONTH FROM pick_date_part) AS pick_month,
  EXTRACT(YEAR FROM pick_date_part) AS pick_year,
  EXTRACT(DAYOFWEEK FROM pick_date_part) AS pick_weekday,
  EXTRACT(HOUR FROM drop_date_part) AS drop_hour,
  EXTRACT(DAY FROM drop_date_part) AS drop_day,
  EXTRACT(MONTH FROM drop_date_part) AS drop_month,
  EXTRACT(YEAR FROM drop_date_part) AS drop_year,
  EXTRACT(DAYOFWEEK FROM drop_date_part) AS drop_weekday
FROM datetime_cte
    );
  
[0m20:13:07.838734 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=uber-data-engineering-407103&j=bq:US:a9dd1b40-1892-4196-aed3-56b33c4610e8&page=queryresults
[0m20:13:07.873376 [debug] [Thread-1 (]: Timing info for model.uber.datetime_dim (execute): 20:13:03.548464 => 20:13:07.872281
[0m20:13:07.879519 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '2ffd629a-15a0-46ac-a649-0426e2b569e2', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff97faeed0>]}
[0m20:13:07.881684 [info ] [Thread-1 (]: 1 of 9 OK created sql table model uber.datetime_dim ............................ [[32mCREATE TABLE (99.9k rows, 4.0 MiB processed)[0m in 4.38s]
[0m20:13:07.884867 [debug] [Thread-1 (]: Finished running node model.uber.datetime_dim
[0m20:13:07.886363 [debug] [Thread-1 (]: Began running node model.uber.dropoff_location_dim
[0m20:13:07.888553 [info ] [Thread-1 (]: 2 of 9 START sql table model uber.dropoff_location_dim ......................... [RUN]
[0m20:13:07.891223 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.uber.datetime_dim, now model.uber.dropoff_location_dim)
[0m20:13:07.892184 [debug] [Thread-1 (]: Began compiling node model.uber.dropoff_location_dim
[0m20:13:08.022903 [debug] [Thread-1 (]: Writing injected SQL for node "model.uber.dropoff_location_dim"
[0m20:13:08.047694 [debug] [Thread-1 (]: Timing info for model.uber.dropoff_location_dim (compile): 20:13:07.893322 => 20:13:08.046368
[0m20:13:08.050251 [debug] [Thread-1 (]: Began executing node model.uber.dropoff_location_dim
[0m20:13:08.061035 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m20:13:09.238444 [debug] [Thread-1 (]: Writing runtime sql for node "model.uber.dropoff_location_dim"
[0m20:13:09.247387 [debug] [Thread-1 (]: On model.uber.dropoff_location_dim: /* {"app": "dbt", "dbt_version": "1.5.9", "profile_name": "uber", "target_name": "dev", "node_id": "model.uber.dropoff_location_dim"} */

  
    

    create or replace table `uber-data-engineering-407103`.`uber`.`dropoff_location_dim`
    
    

    OPTIONS()
    as (
      WITH numbered_rows AS (
  SELECT
    to_hex(md5(cast(coalesce(cast(dropoff_latitude as STRING), '_dbt_utils_surrogate_key_null_') || '-' || coalesce(cast(dropoff_longitude as STRING), '_dbt_utils_surrogate_key_null_') as STRING))) as dropoff_location_id,
    dropoff_latitude AS dropoff_latitude,
    dropoff_longitude AS dropoff_longitude,
    ROW_NUMBER() OVER (ORDER BY dropoff_latitude, dropoff_longitude) as row_num
  FROM `uber-data-engineering-407103`.`uber`.`uber_tlc_trip_recrord_data`
)
SELECT
  dropoff_location_id,
  dropoff_latitude,
  dropoff_longitude
FROM numbered_rows
    );
  
[0m20:13:12.871083 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=uber-data-engineering-407103&j=bq:US:0b54ba9c-f3e5-48b3-9508-d4c6a181be41&page=queryresults
[0m20:13:12.892343 [debug] [Thread-1 (]: Timing info for model.uber.dropoff_location_dim (execute): 20:13:08.052096 => 20:13:12.888409
[0m20:13:12.915672 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '2ffd629a-15a0-46ac-a649-0426e2b569e2', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff97ef0490>]}
[0m20:13:12.925685 [info ] [Thread-1 (]: 2 of 9 OK created sql table model uber.dropoff_location_dim .................... [[32mCREATE TABLE (100.0k rows, 1.5 MiB processed)[0m in 5.02s]
[0m20:13:12.930271 [debug] [Thread-1 (]: Finished running node model.uber.dropoff_location_dim
[0m20:13:12.931789 [debug] [Thread-1 (]: Began running node model.uber.passenger_count_dim
[0m20:13:12.933504 [info ] [Thread-1 (]: 3 of 9 START sql table model uber.passenger_count_dim .......................... [RUN]
[0m20:13:12.935030 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.uber.dropoff_location_dim, now model.uber.passenger_count_dim)
[0m20:13:12.935787 [debug] [Thread-1 (]: Began compiling node model.uber.passenger_count_dim
[0m20:13:12.944442 [debug] [Thread-1 (]: Writing injected SQL for node "model.uber.passenger_count_dim"
[0m20:13:12.947382 [debug] [Thread-1 (]: Timing info for model.uber.passenger_count_dim (compile): 20:13:12.936323 => 20:13:12.947175
[0m20:13:12.948281 [debug] [Thread-1 (]: Began executing node model.uber.passenger_count_dim
[0m20:13:12.953090 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m20:13:13.892679 [debug] [Thread-1 (]: Writing runtime sql for node "model.uber.passenger_count_dim"
[0m20:13:13.908428 [debug] [Thread-1 (]: On model.uber.passenger_count_dim: /* {"app": "dbt", "dbt_version": "1.5.9", "profile_name": "uber", "target_name": "dev", "node_id": "model.uber.passenger_count_dim"} */

  
    

    create or replace table `uber-data-engineering-407103`.`uber`.`passenger_count_dim`
    
    

    OPTIONS()
    as (
      WITH numbered_rows AS (
  SELECT
    GENERATE_UUID() as passenger_count_id,
    passenger_count AS passenger_count,
    ROW_NUMBER() OVER () as row_num
  FROM `uber-data-engineering-407103`.`uber`.`uber_tlc_trip_recrord_data`
  WHERE passenger_count IS NOT NULL
)
SELECT
  passenger_count_id,
  passenger_count
FROM numbered_rows
    );
  
[0m20:13:16.966803 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=uber-data-engineering-407103&j=bq:US:055f800d-79ed-4435-9755-cc6e5e532b00&page=queryresults
[0m20:13:16.990384 [debug] [Thread-1 (]: Timing info for model.uber.passenger_count_dim (execute): 20:13:12.949180 => 20:13:16.989139
[0m20:13:16.994510 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '2ffd629a-15a0-46ac-a649-0426e2b569e2', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff97e369d0>]}
[0m20:13:16.997572 [info ] [Thread-1 (]: 3 of 9 OK created sql table model uber.passenger_count_dim ..................... [[32mCREATE TABLE (100.0k rows, 781.2 KiB processed)[0m in 4.06s]
[0m20:13:17.000375 [debug] [Thread-1 (]: Finished running node model.uber.passenger_count_dim
[0m20:13:17.002171 [debug] [Thread-1 (]: Began running node model.uber.payment_type_dim
[0m20:13:17.004160 [info ] [Thread-1 (]: 4 of 9 START sql table model uber.payment_type_dim ............................. [RUN]
[0m20:13:17.006298 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.uber.passenger_count_dim, now model.uber.payment_type_dim)
[0m20:13:17.007459 [debug] [Thread-1 (]: Began compiling node model.uber.payment_type_dim
[0m20:13:17.022990 [debug] [Thread-1 (]: Writing injected SQL for node "model.uber.payment_type_dim"
[0m20:13:17.027582 [debug] [Thread-1 (]: Timing info for model.uber.payment_type_dim (compile): 20:13:17.008344 => 20:13:17.027283
[0m20:13:17.028230 [debug] [Thread-1 (]: Began executing node model.uber.payment_type_dim
[0m20:13:17.035716 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m20:13:18.247011 [debug] [Thread-1 (]: Writing runtime sql for node "model.uber.payment_type_dim"
[0m20:13:18.253688 [debug] [Thread-1 (]: On model.uber.payment_type_dim: /* {"app": "dbt", "dbt_version": "1.5.9", "profile_name": "uber", "target_name": "dev", "node_id": "model.uber.payment_type_dim"} */

  
    

    create or replace table `uber-data-engineering-407103`.`uber`.`payment_type_dim`
    
    

    OPTIONS()
    as (
      WITH numbered_rows AS (
  SELECT
    GENERATE_UUID() as payment_type_id,
    payment_type AS payment_type,
    ROW_NUMBER() OVER (ORDER BY payment_type) as row_num
  FROM `uber-data-engineering-407103`.`uber`.`uber_tlc_trip_recrord_data`
  WHERE payment_type IS NOT NULL
)
SELECT
  payment_type_id,
  payment_type
FROM numbered_rows
    );
  
[0m20:13:20.981168 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=uber-data-engineering-407103&j=bq:US:8fede563-0367-444f-9a50-b8f31cdd22e0&page=queryresults
[0m20:13:20.998605 [debug] [Thread-1 (]: Timing info for model.uber.payment_type_dim (execute): 20:13:17.028703 => 20:13:20.997645
[0m20:13:21.001834 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '2ffd629a-15a0-46ac-a649-0426e2b569e2', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff97c282d0>]}
[0m20:13:21.004314 [info ] [Thread-1 (]: 4 of 9 OK created sql table model uber.payment_type_dim ........................ [[32mCREATE TABLE (100.0k rows, 781.2 KiB processed)[0m in 4.00s]
[0m20:13:21.006654 [debug] [Thread-1 (]: Finished running node model.uber.payment_type_dim
[0m20:13:21.008168 [debug] [Thread-1 (]: Began running node model.uber.pickup_location_dim
[0m20:13:21.009839 [info ] [Thread-1 (]: 5 of 9 START sql table model uber.pickup_location_dim .......................... [RUN]
[0m20:13:21.011530 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.uber.payment_type_dim, now model.uber.pickup_location_dim)
[0m20:13:21.012391 [debug] [Thread-1 (]: Began compiling node model.uber.pickup_location_dim
[0m20:13:21.029685 [debug] [Thread-1 (]: Writing injected SQL for node "model.uber.pickup_location_dim"
[0m20:13:21.037629 [debug] [Thread-1 (]: Timing info for model.uber.pickup_location_dim (compile): 20:13:21.013035 => 20:13:21.037027
[0m20:13:21.038819 [debug] [Thread-1 (]: Began executing node model.uber.pickup_location_dim
[0m20:13:21.044788 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m20:13:21.895340 [debug] [Thread-1 (]: Writing runtime sql for node "model.uber.pickup_location_dim"
[0m20:13:21.900385 [debug] [Thread-1 (]: On model.uber.pickup_location_dim: /* {"app": "dbt", "dbt_version": "1.5.9", "profile_name": "uber", "target_name": "dev", "node_id": "model.uber.pickup_location_dim"} */

  
    

    create or replace table `uber-data-engineering-407103`.`uber`.`pickup_location_dim`
    
    

    OPTIONS()
    as (
      WITH numbered_rows AS (
  SELECT
    to_hex(md5(cast(coalesce(cast(pickup_latitude as STRING), '_dbt_utils_surrogate_key_null_') || '-' || coalesce(cast(pickup_longitude as STRING), '_dbt_utils_surrogate_key_null_') as STRING))) as pickup_location_id,
    pickup_latitude AS pickup_latitude,
    pickup_longitude AS pickup_longitude,
    ROW_NUMBER() OVER (ORDER BY pickup_latitude, pickup_longitude) as row_num
  FROM `uber-data-engineering-407103`.`uber`.`uber_tlc_trip_recrord_data`
)
SELECT
  pickup_location_id,
  pickup_latitude,
  pickup_longitude
FROM numbered_rows
    );
  
[0m20:13:25.466017 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=uber-data-engineering-407103&j=bq:US:9fa292e9-cdac-4335-b168-d0fc7b5e74c0&page=queryresults
[0m20:13:25.485828 [debug] [Thread-1 (]: Timing info for model.uber.pickup_location_dim (execute): 20:13:21.039804 => 20:13:25.484454
[0m20:13:25.490455 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '2ffd629a-15a0-46ac-a649-0426e2b569e2', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff97c8f410>]}
[0m20:13:25.493601 [info ] [Thread-1 (]: 5 of 9 OK created sql table model uber.pickup_location_dim ..................... [[32mCREATE TABLE (100.0k rows, 1.5 MiB processed)[0m in 4.48s]
[0m20:13:25.496534 [debug] [Thread-1 (]: Finished running node model.uber.pickup_location_dim
[0m20:13:25.498661 [debug] [Thread-1 (]: Began running node model.uber.rate_code_dim
[0m20:13:25.500698 [info ] [Thread-1 (]: 6 of 9 START sql table model uber.rate_code_dim ................................ [RUN]
[0m20:13:25.502489 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.uber.pickup_location_dim, now model.uber.rate_code_dim)
[0m20:13:25.503561 [debug] [Thread-1 (]: Began compiling node model.uber.rate_code_dim
[0m20:13:25.513852 [debug] [Thread-1 (]: Writing injected SQL for node "model.uber.rate_code_dim"
[0m20:13:25.517123 [debug] [Thread-1 (]: Timing info for model.uber.rate_code_dim (compile): 20:13:25.504397 => 20:13:25.516923
[0m20:13:25.517724 [debug] [Thread-1 (]: Began executing node model.uber.rate_code_dim
[0m20:13:25.521120 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m20:13:27.734025 [debug] [Thread-1 (]: Writing runtime sql for node "model.uber.rate_code_dim"
[0m20:13:27.740960 [debug] [Thread-1 (]: On model.uber.rate_code_dim: /* {"app": "dbt", "dbt_version": "1.5.9", "profile_name": "uber", "target_name": "dev", "node_id": "model.uber.rate_code_dim"} */

  
    

    create or replace table `uber-data-engineering-407103`.`uber`.`rate_code_dim`
    
    

    OPTIONS()
    as (
      WITH numbered_rows AS (
  SELECT
    GENERATE_UUID() as rate_code_id,
    RatecodeID AS RatecodeID,
    ROW_NUMBER() OVER (ORDER BY RatecodeID) as row_num
  FROM `uber-data-engineering-407103`.`uber`.`uber_tlc_trip_recrord_data`
  WHERE RatecodeID IS NOT NULL
)
SELECT
  rate_code_id,
  RatecodeID
FROM numbered_rows
    );
  
[0m20:13:30.893848 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=uber-data-engineering-407103&j=bq:US:5be12021-76f4-4f40-89f9-27ece9d56b65&page=queryresults
[0m20:13:30.921970 [debug] [Thread-1 (]: Timing info for model.uber.rate_code_dim (execute): 20:13:25.518288 => 20:13:30.917181
[0m20:13:30.930036 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '2ffd629a-15a0-46ac-a649-0426e2b569e2', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff97c80250>]}
[0m20:13:30.935194 [info ] [Thread-1 (]: 6 of 9 OK created sql table model uber.rate_code_dim ........................... [[32mCREATE TABLE (100.0k rows, 781.2 KiB processed)[0m in 5.43s]
[0m20:13:30.942175 [debug] [Thread-1 (]: Finished running node model.uber.rate_code_dim
[0m20:13:30.947853 [debug] [Thread-1 (]: Began running node model.uber.trip_distance
[0m20:13:30.950032 [info ] [Thread-1 (]: 7 of 9 START sql table model uber.trip_distance ................................ [RUN]
[0m20:13:30.951629 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.uber.rate_code_dim, now model.uber.trip_distance)
[0m20:13:30.952503 [debug] [Thread-1 (]: Began compiling node model.uber.trip_distance
[0m20:13:30.961658 [debug] [Thread-1 (]: Writing injected SQL for node "model.uber.trip_distance"
[0m20:13:30.964319 [debug] [Thread-1 (]: Timing info for model.uber.trip_distance (compile): 20:13:30.953055 => 20:13:30.964138
[0m20:13:30.965141 [debug] [Thread-1 (]: Began executing node model.uber.trip_distance
[0m20:13:30.968024 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m20:13:32.189981 [debug] [Thread-1 (]: Writing runtime sql for node "model.uber.trip_distance"
[0m20:13:32.196460 [debug] [Thread-1 (]: On model.uber.trip_distance: /* {"app": "dbt", "dbt_version": "1.5.9", "profile_name": "uber", "target_name": "dev", "node_id": "model.uber.trip_distance"} */

  
    

    create or replace table `uber-data-engineering-407103`.`uber`.`trip_distance`
    
    

    OPTIONS()
    as (
      WITH numbered_rows AS (
  SELECT
    GENERATE_UUID() as trip_distance_id,
    trip_distance AS trip_distance,
    ROW_NUMBER() OVER (ORDER BY trip_distance) as row_num
  FROM `uber-data-engineering-407103`.`uber`.`uber_tlc_trip_recrord_data`
  WHERE trip_distance IS NOT NULL
)
SELECT
  trip_distance_id,
  trip_distance
FROM numbered_rows
    );
  
[0m20:13:35.698329 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=uber-data-engineering-407103&j=bq:US:cc51f758-1061-4e2d-8049-62ee7355d4a0&page=queryresults
[0m20:13:35.707391 [debug] [Thread-1 (]: Timing info for model.uber.trip_distance (execute): 20:13:30.965588 => 20:13:35.706850
[0m20:13:35.709532 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '2ffd629a-15a0-46ac-a649-0426e2b569e2', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff97ed5310>]}
[0m20:13:35.711156 [info ] [Thread-1 (]: 7 of 9 OK created sql table model uber.trip_distance ........................... [[32mCREATE TABLE (100.0k rows, 781.2 KiB processed)[0m in 4.76s]
[0m20:13:35.712599 [debug] [Thread-1 (]: Finished running node model.uber.trip_distance
[0m20:13:35.716089 [debug] [Thread-1 (]: Began running node model.uber.fact_trip
[0m20:13:35.716774 [info ] [Thread-1 (]: 8 of 9 START sql table model uber.fact_trip .................................... [RUN]
[0m20:13:35.717945 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.uber.trip_distance, now model.uber.fact_trip)
[0m20:13:35.718611 [debug] [Thread-1 (]: Began compiling node model.uber.fact_trip
[0m20:13:35.734799 [debug] [Thread-1 (]: Writing injected SQL for node "model.uber.fact_trip"
[0m20:13:35.738803 [debug] [Thread-1 (]: Timing info for model.uber.fact_trip (compile): 20:13:35.719100 => 20:13:35.738147
[0m20:13:35.739658 [debug] [Thread-1 (]: Began executing node model.uber.fact_trip
[0m20:13:35.745946 [debug] [Thread-1 (]: Writing runtime sql for node "model.uber.fact_trip"
[0m20:13:35.765990 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m20:13:35.776642 [debug] [Thread-1 (]: On model.uber.fact_trip: /* {"app": "dbt", "dbt_version": "1.5.9", "profile_name": "uber", "target_name": "dev", "node_id": "model.uber.fact_trip"} */

  
    

    create or replace table `uber-data-engineering-407103`.`uber`.`fact_trip`
    
    

    OPTIONS()
    as (
      WITH fct_invoices_cte AS (
    SELECT
        CAST(ROW_NUMBER() OVER () AS INT64) as trip_id,
        VendorID,
        to_hex(md5(cast(coalesce(cast(tpep_pickup_datetime as STRING), '_dbt_utils_surrogate_key_null_') || '-' || coalesce(cast(tpep_dropoff_datetime as STRING), '_dbt_utils_surrogate_key_null_') as STRING))) AS datetime_id,
        passenger_count_id,
        trip_distance_id,
        rate_code_id,
        store_and_fwd_flag,
        pickup_location_id,
        to_hex(md5(cast(coalesce(cast(dropoff_latitude as STRING), '_dbt_utils_surrogate_key_null_') || '-' || coalesce(cast(dropoff_longitude as STRING), '_dbt_utils_surrogate_key_null_') as STRING))) as dropoff_location_id,
        payment_type_id,
        fare_amount,
        extra,
        mta_tax,
        tip_amount,
        tolls_amount,
        improvement_surcharge,
        total_amount
    FROM `uber-data-engineering-407103`.`uber`.`uber_tlc_trip_recrord_data`
)
SELECT
    trip_id,
    VendorID,
    datetime_id,
    do.dropoff_location_id,
    pu.pickup_location_id,
    pc.passenger_count_id,
    pt.payment_type_id,
    rc.rate_code_id,
    store_and_fwd_flag,
    td.trip_distance_id,
    fare_amount,
    extra,
    mta_tax,
    tip_amount,
    tolls_amount,
    improvement_surcharge AS improvement_surcharge_amount,  -- Added alias
    total_amount
FROM fct_invoices_cte fi
INNER JOIN `uber-data-engineering-407103`.`uber`.`datetime_dim` dt ON fi.datetime_id = dt.datetime_id
INNER JOIN `uber-data-engineering-407103`.`uber`.`dropoff_location_dim` do ON fi.dropoff_location_id = do.dropoff_location_id
INNER JOIN `uber-data-engineering-407103`.`uber`.`pickup_location_dim` pu ON fi.pickup_location_id = pu.pickup_location_id
INNER JOIN `uber-data-engineering-407103`.`uber`.`passenger_count_dim` pc ON fi.passenger_count_id = pc.passenger_count_id
INNER JOIN `uber-data-engineering-407103`.`uber`.`payment_type_dim` pt ON fi.payment_type_id = pt.payment_type_id
INNER JOIN `uber-data-engineering-407103`.`uber`.`rate_code_dim` rc ON fi.rate_code_id = rc.rate_code_id
INNER JOIN `uber-data-engineering-407103`.`uber`.`trip_distance` td ON fi.trip_distance_id = td.trip_distance_id
    );
  
[0m20:13:38.781918 [debug] [Thread-1 (]: BigQuery adapter: Retry attempt 1 of 1 after error: BadRequest('Unrecognized name: passenger_count_id; Did you mean passenger_count? at [17:9]')
[0m20:13:41.746958 [error] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=uber-data-engineering-407103&j=bq:US:445904ed-0244-4580-81a7-a23599448a8f&page=queryresults
[0m20:13:41.754747 [debug] [Thread-1 (]: Timing info for model.uber.fact_trip (execute): 20:13:35.740234 => 20:13:41.753216
[0m20:13:41.782285 [debug] [Thread-1 (]: Database Error in model fact_trip (models/transform/fact_trip.sql)
  Unrecognized name: passenger_count_id; Did you mean passenger_count? at [17:9]
  compiled Code at target/run/uber/models/transform/fact_trip.sql
[0m20:13:41.784123 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '2ffd629a-15a0-46ac-a649-0426e2b569e2', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff97d1b490>]}
[0m20:13:41.786512 [error] [Thread-1 (]: 8 of 9 ERROR creating sql table model uber.fact_trip ........................... [[31mERROR[0m in 6.07s]
[0m20:13:41.787952 [debug] [Thread-1 (]: Finished running node model.uber.fact_trip
[0m20:13:41.789169 [debug] [Thread-1 (]: Began running node model.uber.test_fct
[0m20:13:41.798386 [info ] [Thread-1 (]: 9 of 9 START sql table model uber.test_fct ..................................... [RUN]
[0m20:13:41.800724 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.uber.fact_trip, now model.uber.test_fct)
[0m20:13:41.801872 [debug] [Thread-1 (]: Began compiling node model.uber.test_fct
[0m20:13:41.842056 [debug] [Thread-1 (]: Writing injected SQL for node "model.uber.test_fct"
[0m20:13:41.852987 [debug] [Thread-1 (]: Timing info for model.uber.test_fct (compile): 20:13:41.802536 => 20:13:41.852612
[0m20:13:41.854172 [debug] [Thread-1 (]: Began executing node model.uber.test_fct
[0m20:13:41.862530 [debug] [Thread-1 (]: Writing runtime sql for node "model.uber.test_fct"
[0m20:13:41.871646 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m20:13:41.897750 [debug] [Thread-1 (]: On model.uber.test_fct: /* {"app": "dbt", "dbt_version": "1.5.9", "profile_name": "uber", "target_name": "dev", "node_id": "model.uber.test_fct"} */

  
    

    create or replace table `uber-data-engineering-407103`.`uber`.`test_fct`
    
    

    OPTIONS()
    as (
      WITH fct_invoices_cte AS (
    SELECT
        CAST(ROW_NUMBER() OVER () AS INT64) as trip_id,
        VendorID,
        to_hex(md5(cast(coalesce(cast(tpep_pickup_datetime as STRING), '_dbt_utils_surrogate_key_null_') || '-' || coalesce(cast(tpep_dropoff_datetime as STRING), '_dbt_utils_surrogate_key_null_') as STRING))) AS datetime_id,
        passenger_count_id,
        trip_distance_id,
        rate_code_id,
        store_and_fwd_flag,
        pickup_location_id,
        to_hex(md5(cast(coalesce(cast(dropoff_latitude as STRING), '_dbt_utils_surrogate_key_null_') || '-' || coalesce(cast(dropoff_longitude as STRING), '_dbt_utils_surrogate_key_null_') as STRING))) as dropoff_location_id,
        payment_type_id,
        fare_amount,
        extra,
        mta_tax,
        tip_amount,
        tolls_amount,
        improvement_surcharge,
        total_amount
    FROM `uber-data-engineering-407103`.`uber`.`uber_tlc_trip_recrord_data`
)SELECT
    fi.trip_distance_id,
    td.trip_distance
FROM fct_invoices_cte fi
INNER JOIN `uber-data-engineering-407103`.`uber`.`trip_distance` td ON fi.trip_distance_id = td.trip_distance_id
    );
  
[0m20:13:43.887123 [debug] [Thread-1 (]: BigQuery adapter: Retry attempt 1 of 1 after error: BadRequest('Unrecognized name: passenger_count_id; Did you mean passenger_count? at [17:9]')
[0m20:13:45.973246 [error] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=uber-data-engineering-407103&j=bq:US:c22553d7-9f88-48b8-9151-9e67411deede&page=queryresults
[0m20:13:45.976384 [debug] [Thread-1 (]: Timing info for model.uber.test_fct (execute): 20:13:41.854984 => 20:13:45.975775
[0m20:13:45.984323 [debug] [Thread-1 (]: Database Error in model test_fct (models/transform/test_fct.sql)
  Unrecognized name: passenger_count_id; Did you mean passenger_count? at [17:9]
  compiled Code at target/run/uber/models/transform/test_fct.sql
[0m20:13:45.985964 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '2ffd629a-15a0-46ac-a649-0426e2b569e2', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff95b86a10>]}
[0m20:13:45.988208 [error] [Thread-1 (]: 9 of 9 ERROR creating sql table model uber.test_fct ............................ [[31mERROR[0m in 4.19s]
[0m20:13:45.989331 [debug] [Thread-1 (]: Finished running node model.uber.test_fct
[0m20:13:45.995099 [debug] [MainThread]: Connection 'master' was properly closed.
[0m20:13:45.995902 [debug] [MainThread]: Connection 'model.uber.test_fct' was properly closed.
[0m20:13:45.996786 [info ] [MainThread]: 
[0m20:13:45.997725 [info ] [MainThread]: Finished running 9 table models in 0 hours 0 minutes and 44.03 seconds (44.03s).
[0m20:13:46.000747 [debug] [MainThread]: Command end result
[0m20:13:46.034608 [info ] [MainThread]: 
[0m20:13:46.038954 [info ] [MainThread]: [31mCompleted with 2 errors and 0 warnings:[0m
[0m20:13:46.040145 [info ] [MainThread]: 
[0m20:13:46.041819 [error] [MainThread]: [33mDatabase Error in model fact_trip (models/transform/fact_trip.sql)[0m
[0m20:13:46.044465 [error] [MainThread]:   Unrecognized name: passenger_count_id; Did you mean passenger_count? at [17:9]
[0m20:13:46.046482 [error] [MainThread]:   compiled Code at target/run/uber/models/transform/fact_trip.sql
[0m20:13:46.047863 [info ] [MainThread]: 
[0m20:13:46.048664 [error] [MainThread]: [33mDatabase Error in model test_fct (models/transform/test_fct.sql)[0m
[0m20:13:46.049525 [error] [MainThread]:   Unrecognized name: passenger_count_id; Did you mean passenger_count? at [17:9]
[0m20:13:46.050360 [error] [MainThread]:   compiled Code at target/run/uber/models/transform/test_fct.sql
[0m20:13:46.051033 [info ] [MainThread]: 
[0m20:13:46.051932 [info ] [MainThread]: Done. PASS=7 WARN=0 ERROR=2 SKIP=0 TOTAL=9
[0m20:13:46.053478 [debug] [MainThread]: Command `dbt run` failed at 20:13:46.053283 after 44.76 seconds
[0m20:13:46.054310 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff9a0140d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff9a378d50>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff9a352490>]}
[0m20:13:46.054885 [debug] [MainThread]: Flushing usage events
[0m20:40:08.372640 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff8ff1d290>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff900a1fd0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff900d6e10>]}


============================== 20:40:08.384334 | ef374092-4636-402e-a1e6-cd24451e4817 ==============================
[0m20:40:08.384334 [info ] [MainThread]: Running with dbt=1.5.9
[0m20:40:08.385999 [debug] [MainThread]: running dbt with arguments {'target_path': 'None', 'fail_fast': 'False', 'debug': 'False', 'profiles_dir': '/usr/local/airflow/include/dbt/', 'indirect_selection': 'eager', 'cache_selected_only': 'False', 'introspect': 'True', 'warn_error': 'None', 'use_colors': 'True', 'version_check': 'True', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'no_print': 'None', 'printer_width': '80', 'partial_parse': 'True', 'use_experimental_parser': 'False', 'log_cache_events': 'False', 'log_format': 'default', 'write_json': 'True', 'quiet': 'False', 'log_path': '/usr/local/airflow/include/dbt/logs', 'static_parser': 'True', 'send_anonymous_usage_stats': 'True'}
[0m20:40:09.166989 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'ef374092-4636-402e-a1e6-cd24451e4817', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff8de4ad10>]}
[0m20:40:09.178617 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'ef374092-4636-402e-a1e6-cd24451e4817', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff8de72410>]}
[0m20:40:09.179352 [info ] [MainThread]: Registered adapter: bigquery=1.5.3
[0m20:40:09.195930 [debug] [MainThread]: checksum: dd837546c89c9d03f3c2cb0ca6165266a30da6076d5d44e9991f7c5a8e5f5831, vars: {}, profile: , target: , version: 1.5.9
[0m20:40:09.311361 [debug] [MainThread]: Partial parsing enabled: 1 files deleted, 1 files added, 0 files changed.
[0m20:40:09.312227 [debug] [MainThread]: Partial parsing: added file: uber://models/transform/test_fact.sql
[0m20:40:09.312729 [debug] [MainThread]: Partial parsing: deleted file: uber://models/transform/test_fct.sql
[0m20:40:09.335958 [debug] [MainThread]: 1699: static parser successfully parsed transform/test_fact.sql
[0m20:40:09.362199 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'ef374092-4636-402e-a1e6-cd24451e4817', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff8dea1a10>]}
[0m20:40:09.384749 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'ef374092-4636-402e-a1e6-cd24451e4817', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff8ccbe150>]}
[0m20:40:09.385510 [info ] [MainThread]: Found 9 models, 0 tests, 0 snapshots, 0 analyses, 474 macros, 0 operations, 0 seed files, 1 source, 0 exposures, 0 metrics, 0 groups
[0m20:40:09.386490 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'ef374092-4636-402e-a1e6-cd24451e4817', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff92d6b4d0>]}
[0m20:40:09.388669 [info ] [MainThread]: 
[0m20:40:09.389749 [debug] [MainThread]: Acquiring new bigquery connection 'master'
[0m20:40:09.391964 [debug] [ThreadPool]: Acquiring new bigquery connection 'list_uber-data-engineering-407103'
[0m20:40:09.392711 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m20:40:11.931141 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_uber-data-engineering-407103, now list_uber-data-engineering-407103_uber)
[0m20:40:11.935733 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m20:40:15.615250 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'ef374092-4636-402e-a1e6-cd24451e4817', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff9097ec90>]}
[0m20:40:15.621517 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m20:40:15.623624 [info ] [MainThread]: 
[0m20:40:15.668097 [debug] [Thread-1 (]: Began running node model.uber.datetime_dim
[0m20:40:15.670034 [info ] [Thread-1 (]: 1 of 9 START sql table model uber.datetime_dim ................................. [RUN]
[0m20:40:15.671693 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_uber-data-engineering-407103_uber, now model.uber.datetime_dim)
[0m20:40:15.672633 [debug] [Thread-1 (]: Began compiling node model.uber.datetime_dim
[0m20:40:15.723824 [debug] [Thread-1 (]: Writing injected SQL for node "model.uber.datetime_dim"
[0m20:40:15.728566 [debug] [Thread-1 (]: Timing info for model.uber.datetime_dim (compile): 20:40:15.673532 => 20:40:15.728025
[0m20:40:15.729251 [debug] [Thread-1 (]: Began executing node model.uber.datetime_dim
[0m20:40:15.753081 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m20:40:17.790878 [debug] [Thread-1 (]: Writing runtime sql for node "model.uber.datetime_dim"
[0m20:40:17.794748 [debug] [Thread-1 (]: On model.uber.datetime_dim: /* {"app": "dbt", "dbt_version": "1.5.9", "profile_name": "uber", "target_name": "dev", "node_id": "model.uber.datetime_dim"} */

  
    

    create or replace table `uber-data-engineering-407103`.`uber`.`datetime_dim`
    
    

    OPTIONS()
    as (
      WITH datetime_cte AS (  
  SELECT DISTINCT 
    to_hex(md5(cast(coalesce(cast(tpep_pickup_datetime as STRING), '_dbt_utils_surrogate_key_null_') || '-' || coalesce(cast(tpep_dropoff_datetime as STRING), '_dbt_utils_surrogate_key_null_') as STRING))) AS datetime_id,
    CASE
      WHEN LENGTH(tpep_pickup_datetime) = 16 THEN
        -- Date format: "DD/MM/YYYY HH:MM"
        PARSE_DATETIME('%m/%d/%Y %H:%M', tpep_pickup_datetime)
      WHEN LENGTH(tpep_pickup_datetime) <= 14 THEN
        -- Date format: "MM/DD/YY HH:MM"
        PARSE_DATETIME('%m/%d/%y %H:%M', tpep_pickup_datetime)
      ELSE
        NULL
    END AS pick_date_part,
    tpep_dropoff_datetime AS drop_datetime_id,
    CASE
      WHEN LENGTH(tpep_dropoff_datetime) = 16 THEN
        -- Date format: "DD/MM/YYYY HH:MM"
        PARSE_DATETIME('%m/%d/%Y %H:%M', tpep_dropoff_datetime)
      WHEN LENGTH(tpep_dropoff_datetime) <= 14 THEN
        -- Date format: "MM/DD/YY HH:MM"
        PARSE_DATETIME('%m/%d/%y %H:%M', tpep_dropoff_datetime)
      ELSE
        NULL
    END AS drop_date_part
  FROM `uber-data-engineering-407103`.`uber`.`uber_tlc_trip_recrord_data`
  WHERE tpep_pickup_datetime IS NOT NULL
    AND tpep_dropoff_datetime IS NOT NULL
)
SELECT
  datetime_id,
  pick_date_part AS tpep_pickup_datetime,
  drop_date_part AS tpep_dropoff_datetime,
  EXTRACT(HOUR FROM pick_date_part) AS pick_hour,
  EXTRACT(DAY FROM pick_date_part) AS pick_day,
  EXTRACT(MONTH FROM pick_date_part) AS pick_month,
  EXTRACT(YEAR FROM pick_date_part) AS pick_year,
  EXTRACT(DAYOFWEEK FROM pick_date_part) AS pick_weekday,
  EXTRACT(HOUR FROM drop_date_part) AS drop_hour,
  EXTRACT(DAY FROM drop_date_part) AS drop_day,
  EXTRACT(MONTH FROM drop_date_part) AS drop_month,
  EXTRACT(YEAR FROM drop_date_part) AS drop_year,
  EXTRACT(DAYOFWEEK FROM drop_date_part) AS drop_weekday
FROM datetime_cte
    );
  
[0m20:40:22.178057 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=uber-data-engineering-407103&j=bq:US:b2d5eeb2-9b87-49bc-8308-701ebb34ed1b&page=queryresults
[0m20:40:22.230765 [debug] [Thread-1 (]: Timing info for model.uber.datetime_dim (execute): 20:40:15.729693 => 20:40:22.230125
[0m20:40:22.233268 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'ef374092-4636-402e-a1e6-cd24451e4817', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff8dc5c2d0>]}
[0m20:40:22.235178 [info ] [Thread-1 (]: 1 of 9 OK created sql table model uber.datetime_dim ............................ [[32mCREATE TABLE (99.9k rows, 4.0 MiB processed)[0m in 6.56s]
[0m20:40:22.237074 [debug] [Thread-1 (]: Finished running node model.uber.datetime_dim
[0m20:40:22.238266 [debug] [Thread-1 (]: Began running node model.uber.dropoff_location_dim
[0m20:40:22.239682 [info ] [Thread-1 (]: 2 of 9 START sql table model uber.dropoff_location_dim ......................... [RUN]
[0m20:40:22.240889 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.uber.datetime_dim, now model.uber.dropoff_location_dim)
[0m20:40:22.241506 [debug] [Thread-1 (]: Began compiling node model.uber.dropoff_location_dim
[0m20:40:22.248746 [debug] [Thread-1 (]: Writing injected SQL for node "model.uber.dropoff_location_dim"
[0m20:40:22.251208 [debug] [Thread-1 (]: Timing info for model.uber.dropoff_location_dim (compile): 20:40:22.241927 => 20:40:22.251039
[0m20:40:22.251809 [debug] [Thread-1 (]: Began executing node model.uber.dropoff_location_dim
[0m20:40:22.254813 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m20:40:23.977308 [debug] [Thread-1 (]: Writing runtime sql for node "model.uber.dropoff_location_dim"
[0m20:40:23.982739 [debug] [Thread-1 (]: On model.uber.dropoff_location_dim: /* {"app": "dbt", "dbt_version": "1.5.9", "profile_name": "uber", "target_name": "dev", "node_id": "model.uber.dropoff_location_dim"} */

  
    

    create or replace table `uber-data-engineering-407103`.`uber`.`dropoff_location_dim`
    
    

    OPTIONS()
    as (
      WITH numbered_rows AS (
  SELECT
    to_hex(md5(cast(coalesce(cast(dropoff_latitude as STRING), '_dbt_utils_surrogate_key_null_') || '-' || coalesce(cast(dropoff_longitude as STRING), '_dbt_utils_surrogate_key_null_') as STRING))) as dropoff_location_id,
    dropoff_latitude AS dropoff_latitude,
    dropoff_longitude AS dropoff_longitude,
    ROW_NUMBER() OVER (ORDER BY dropoff_latitude, dropoff_longitude) as row_num
  FROM `uber-data-engineering-407103`.`uber`.`uber_tlc_trip_recrord_data`
)
SELECT
  dropoff_location_id,
  dropoff_latitude,
  dropoff_longitude
FROM numbered_rows
    );
  
[0m20:40:28.698788 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=uber-data-engineering-407103&j=bq:US:172413f2-e10f-4fe3-8e19-0665c75f3848&page=queryresults
[0m20:40:28.709813 [debug] [Thread-1 (]: Timing info for model.uber.dropoff_location_dim (execute): 20:40:22.252222 => 20:40:28.709159
[0m20:40:28.712483 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'ef374092-4636-402e-a1e6-cd24451e4817', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff8dea00d0>]}
[0m20:40:28.714465 [info ] [Thread-1 (]: 2 of 9 OK created sql table model uber.dropoff_location_dim .................... [[32mCREATE TABLE (100.0k rows, 1.5 MiB processed)[0m in 6.47s]
[0m20:40:28.716780 [debug] [Thread-1 (]: Finished running node model.uber.dropoff_location_dim
[0m20:40:28.718074 [debug] [Thread-1 (]: Began running node model.uber.passenger_count_dim
[0m20:40:28.719531 [info ] [Thread-1 (]: 3 of 9 START sql table model uber.passenger_count_dim .......................... [RUN]
[0m20:40:28.720915 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.uber.dropoff_location_dim, now model.uber.passenger_count_dim)
[0m20:40:28.721768 [debug] [Thread-1 (]: Began compiling node model.uber.passenger_count_dim
[0m20:40:28.728351 [debug] [Thread-1 (]: Writing injected SQL for node "model.uber.passenger_count_dim"
[0m20:40:28.731447 [debug] [Thread-1 (]: Timing info for model.uber.passenger_count_dim (compile): 20:40:28.722338 => 20:40:28.731207
[0m20:40:28.732032 [debug] [Thread-1 (]: Began executing node model.uber.passenger_count_dim
[0m20:40:28.734930 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m20:40:31.940864 [debug] [Thread-1 (]: Writing runtime sql for node "model.uber.passenger_count_dim"
[0m20:40:31.951225 [debug] [Thread-1 (]: On model.uber.passenger_count_dim: /* {"app": "dbt", "dbt_version": "1.5.9", "profile_name": "uber", "target_name": "dev", "node_id": "model.uber.passenger_count_dim"} */

  
    

    create or replace table `uber-data-engineering-407103`.`uber`.`passenger_count_dim`
    
    

    OPTIONS()
    as (
      WITH numbered_rows AS (
  SELECT
    GENERATE_UUID() as passenger_count_id,
    passenger_count AS passenger_count,
    ROW_NUMBER() OVER () as row_num
  FROM `uber-data-engineering-407103`.`uber`.`uber_tlc_trip_recrord_data`
  WHERE passenger_count IS NOT NULL
)
SELECT
  passenger_count_id,
  passenger_count
FROM numbered_rows
    );
  
[0m20:40:34.984766 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=uber-data-engineering-407103&j=bq:US:5a2f3209-9fcf-4b13-b725-d356215ab0aa&page=queryresults
[0m20:40:34.997974 [debug] [Thread-1 (]: Timing info for model.uber.passenger_count_dim (execute): 20:40:28.732500 => 20:40:34.996909
[0m20:40:35.002575 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'ef374092-4636-402e-a1e6-cd24451e4817', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff8dd8d6d0>]}
[0m20:40:35.006254 [info ] [Thread-1 (]: 3 of 9 OK created sql table model uber.passenger_count_dim ..................... [[32mCREATE TABLE (100.0k rows, 781.2 KiB processed)[0m in 6.28s]
[0m20:40:35.009225 [debug] [Thread-1 (]: Finished running node model.uber.passenger_count_dim
[0m20:40:35.011018 [debug] [Thread-1 (]: Began running node model.uber.payment_type_dim
[0m20:40:35.013349 [info ] [Thread-1 (]: 4 of 9 START sql table model uber.payment_type_dim ............................. [RUN]
[0m20:40:35.015310 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.uber.passenger_count_dim, now model.uber.payment_type_dim)
[0m20:40:35.016290 [debug] [Thread-1 (]: Began compiling node model.uber.payment_type_dim
[0m20:40:35.027270 [debug] [Thread-1 (]: Writing injected SQL for node "model.uber.payment_type_dim"
[0m20:40:35.030119 [debug] [Thread-1 (]: Timing info for model.uber.payment_type_dim (compile): 20:40:35.016995 => 20:40:35.029835
[0m20:40:35.030790 [debug] [Thread-1 (]: Began executing node model.uber.payment_type_dim
[0m20:40:35.036036 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m20:40:36.557810 [debug] [Thread-1 (]: Writing runtime sql for node "model.uber.payment_type_dim"
[0m20:40:36.562782 [debug] [Thread-1 (]: On model.uber.payment_type_dim: /* {"app": "dbt", "dbt_version": "1.5.9", "profile_name": "uber", "target_name": "dev", "node_id": "model.uber.payment_type_dim"} */

  
    

    create or replace table `uber-data-engineering-407103`.`uber`.`payment_type_dim`
    
    

    OPTIONS()
    as (
      WITH numbered_rows AS (
  SELECT
    GENERATE_UUID() as payment_type_id,
    payment_type AS payment_type,
    ROW_NUMBER() OVER (ORDER BY payment_type) as row_num
  FROM `uber-data-engineering-407103`.`uber`.`uber_tlc_trip_recrord_data`
  WHERE payment_type IS NOT NULL
)
SELECT
  payment_type_id,
  payment_type
FROM numbered_rows
    );
  
[0m20:40:39.372643 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=uber-data-engineering-407103&j=bq:US:4ec37248-74ea-4fb9-8955-d7261341c6ea&page=queryresults
[0m20:40:39.383298 [debug] [Thread-1 (]: Timing info for model.uber.payment_type_dim (execute): 20:40:35.031314 => 20:40:39.382137
[0m20:40:39.387529 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'ef374092-4636-402e-a1e6-cd24451e4817', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff8de5c590>]}
[0m20:40:39.390515 [info ] [Thread-1 (]: 4 of 9 OK created sql table model uber.payment_type_dim ........................ [[32mCREATE TABLE (100.0k rows, 781.2 KiB processed)[0m in 4.37s]
[0m20:40:39.393790 [debug] [Thread-1 (]: Finished running node model.uber.payment_type_dim
[0m20:40:39.396638 [debug] [Thread-1 (]: Began running node model.uber.pickup_location_dim
[0m20:40:39.399958 [info ] [Thread-1 (]: 5 of 9 START sql table model uber.pickup_location_dim .......................... [RUN]
[0m20:40:39.402308 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.uber.payment_type_dim, now model.uber.pickup_location_dim)
[0m20:40:39.403667 [debug] [Thread-1 (]: Began compiling node model.uber.pickup_location_dim
[0m20:40:39.418077 [debug] [Thread-1 (]: Writing injected SQL for node "model.uber.pickup_location_dim"
[0m20:40:39.422883 [debug] [Thread-1 (]: Timing info for model.uber.pickup_location_dim (compile): 20:40:39.404662 => 20:40:39.422574
[0m20:40:39.423729 [debug] [Thread-1 (]: Began executing node model.uber.pickup_location_dim
[0m20:40:39.427523 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m20:40:40.640326 [debug] [Thread-1 (]: Writing runtime sql for node "model.uber.pickup_location_dim"
[0m20:40:40.651514 [debug] [Thread-1 (]: On model.uber.pickup_location_dim: /* {"app": "dbt", "dbt_version": "1.5.9", "profile_name": "uber", "target_name": "dev", "node_id": "model.uber.pickup_location_dim"} */

  
    

    create or replace table `uber-data-engineering-407103`.`uber`.`pickup_location_dim`
    
    

    OPTIONS()
    as (
      WITH numbered_rows AS (
  SELECT
    to_hex(md5(cast(coalesce(cast(pickup_latitude as STRING), '_dbt_utils_surrogate_key_null_') || '-' || coalesce(cast(pickup_longitude as STRING), '_dbt_utils_surrogate_key_null_') as STRING))) as pickup_location_id,
    pickup_latitude AS pickup_latitude,
    pickup_longitude AS pickup_longitude,
    ROW_NUMBER() OVER (ORDER BY pickup_latitude, pickup_longitude) as row_num
  FROM `uber-data-engineering-407103`.`uber`.`uber_tlc_trip_recrord_data`
)
SELECT
  pickup_location_id,
  pickup_latitude,
  pickup_longitude
FROM numbered_rows
    );
  
[0m20:40:45.005435 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=uber-data-engineering-407103&j=bq:US:ce012038-29e8-48a8-9623-96de749a8b7d&page=queryresults
[0m20:40:45.017708 [debug] [Thread-1 (]: Timing info for model.uber.pickup_location_dim (execute): 20:40:39.424256 => 20:40:45.016986
[0m20:40:45.020927 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'ef374092-4636-402e-a1e6-cd24451e4817', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff8dea00d0>]}
[0m20:40:45.023079 [info ] [Thread-1 (]: 5 of 9 OK created sql table model uber.pickup_location_dim ..................... [[32mCREATE TABLE (100.0k rows, 1.5 MiB processed)[0m in 5.62s]
[0m20:40:45.024932 [debug] [Thread-1 (]: Finished running node model.uber.pickup_location_dim
[0m20:40:45.026239 [debug] [Thread-1 (]: Began running node model.uber.rate_code_dim
[0m20:40:45.027899 [info ] [Thread-1 (]: 6 of 9 START sql table model uber.rate_code_dim ................................ [RUN]
[0m20:40:45.029271 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.uber.pickup_location_dim, now model.uber.rate_code_dim)
[0m20:40:45.030168 [debug] [Thread-1 (]: Began compiling node model.uber.rate_code_dim
[0m20:40:45.038661 [debug] [Thread-1 (]: Writing injected SQL for node "model.uber.rate_code_dim"
[0m20:40:45.056357 [debug] [Thread-1 (]: Timing info for model.uber.rate_code_dim (compile): 20:40:45.030831 => 20:40:45.056115
[0m20:40:45.057029 [debug] [Thread-1 (]: Began executing node model.uber.rate_code_dim
[0m20:40:45.059966 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m20:40:47.966758 [debug] [Thread-1 (]: Writing runtime sql for node "model.uber.rate_code_dim"
[0m20:40:47.974949 [debug] [Thread-1 (]: On model.uber.rate_code_dim: /* {"app": "dbt", "dbt_version": "1.5.9", "profile_name": "uber", "target_name": "dev", "node_id": "model.uber.rate_code_dim"} */

  
    

    create or replace table `uber-data-engineering-407103`.`uber`.`rate_code_dim`
    
    

    OPTIONS()
    as (
      WITH numbered_rows AS (
  SELECT
    GENERATE_UUID() as rate_code_id,
    RatecodeID AS RatecodeID,
    ROW_NUMBER() OVER (ORDER BY RatecodeID) as row_num
  FROM `uber-data-engineering-407103`.`uber`.`uber_tlc_trip_recrord_data`
  WHERE RatecodeID IS NOT NULL
)
SELECT
  rate_code_id,
  RatecodeID
FROM numbered_rows
    );
  
[0m20:40:50.718997 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=uber-data-engineering-407103&j=bq:US:4b077ef9-b81b-418b-9af1-780519d0a666&page=queryresults
[0m20:40:50.735683 [debug] [Thread-1 (]: Timing info for model.uber.rate_code_dim (execute): 20:40:45.057551 => 20:40:50.734432
[0m20:40:50.740274 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'ef374092-4636-402e-a1e6-cd24451e4817', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff8cd67890>]}
[0m20:40:50.743112 [info ] [Thread-1 (]: 6 of 9 OK created sql table model uber.rate_code_dim ........................... [[32mCREATE TABLE (100.0k rows, 781.2 KiB processed)[0m in 5.71s]
[0m20:40:50.746164 [debug] [Thread-1 (]: Finished running node model.uber.rate_code_dim
[0m20:40:50.748541 [debug] [Thread-1 (]: Began running node model.uber.trip_distance
[0m20:40:50.750854 [info ] [Thread-1 (]: 7 of 9 START sql table model uber.trip_distance ................................ [RUN]
[0m20:40:50.752973 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.uber.rate_code_dim, now model.uber.trip_distance)
[0m20:40:50.754133 [debug] [Thread-1 (]: Began compiling node model.uber.trip_distance
[0m20:40:50.773227 [debug] [Thread-1 (]: Writing injected SQL for node "model.uber.trip_distance"
[0m20:40:50.775389 [debug] [Thread-1 (]: Timing info for model.uber.trip_distance (compile): 20:40:50.754956 => 20:40:50.775102
[0m20:40:50.775950 [debug] [Thread-1 (]: Began executing node model.uber.trip_distance
[0m20:40:50.779064 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m20:40:51.824841 [debug] [Thread-1 (]: Writing runtime sql for node "model.uber.trip_distance"
[0m20:40:51.835757 [debug] [Thread-1 (]: On model.uber.trip_distance: /* {"app": "dbt", "dbt_version": "1.5.9", "profile_name": "uber", "target_name": "dev", "node_id": "model.uber.trip_distance"} */

  
    

    create or replace table `uber-data-engineering-407103`.`uber`.`trip_distance`
    
    

    OPTIONS()
    as (
      WITH numbered_rows AS (
  SELECT
    GENERATE_UUID() as trip_distance_id,
    trip_distance AS trip_distance,
    ROW_NUMBER() OVER (ORDER BY trip_distance) as row_num
  FROM `uber-data-engineering-407103`.`uber`.`uber_tlc_trip_recrord_data`
  WHERE trip_distance IS NOT NULL
)
SELECT
  trip_distance_id,
  trip_distance
FROM numbered_rows
    );
  
[0m20:41:03.537739 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=uber-data-engineering-407103&j=bq:US:3c8b4355-627e-4c51-829b-83ef51edce10&page=queryresults
[0m20:41:03.556959 [debug] [Thread-1 (]: Timing info for model.uber.trip_distance (execute): 20:40:50.776367 => 20:41:03.556078
[0m20:41:03.560629 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'ef374092-4636-402e-a1e6-cd24451e4817', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff8cd390d0>]}
[0m20:41:03.562714 [info ] [Thread-1 (]: 7 of 9 OK created sql table model uber.trip_distance ........................... [[32mCREATE TABLE (100.0k rows, 781.2 KiB processed)[0m in 12.81s]
[0m20:41:03.564840 [debug] [Thread-1 (]: Finished running node model.uber.trip_distance
[0m20:41:03.568913 [debug] [Thread-1 (]: Began running node model.uber.fact_trip
[0m20:41:03.569975 [info ] [Thread-1 (]: 8 of 9 START sql table model uber.fact_trip .................................... [RUN]
[0m20:41:03.571522 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.uber.trip_distance, now model.uber.fact_trip)
[0m20:41:03.572634 [debug] [Thread-1 (]: Began compiling node model.uber.fact_trip
[0m20:41:03.588391 [debug] [Thread-1 (]: Writing injected SQL for node "model.uber.fact_trip"
[0m20:41:03.592084 [debug] [Thread-1 (]: Timing info for model.uber.fact_trip (compile): 20:41:03.573333 => 20:41:03.591795
[0m20:41:03.592780 [debug] [Thread-1 (]: Began executing node model.uber.fact_trip
[0m20:41:03.599863 [debug] [Thread-1 (]: Writing runtime sql for node "model.uber.fact_trip"
[0m20:41:03.602268 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m20:41:03.614531 [debug] [Thread-1 (]: On model.uber.fact_trip: /* {"app": "dbt", "dbt_version": "1.5.9", "profile_name": "uber", "target_name": "dev", "node_id": "model.uber.fact_trip"} */

  
    

    create or replace table `uber-data-engineering-407103`.`uber`.`fact_trip`
    
    

    OPTIONS()
    as (
      WITH fct_invoices_cte AS (
    SELECT
        CAST(ROW_NUMBER() OVER () AS INT64) as trip_id,
        VendorID,
        to_hex(md5(cast(coalesce(cast(tpep_pickup_datetime as STRING), '_dbt_utils_surrogate_key_null_') || '-' || coalesce(cast(tpep_dropoff_datetime as STRING), '_dbt_utils_surrogate_key_null_') as STRING))) AS datetime_id,
        passenger_count_id,
        trip_distance_id,
        rate_code_id,
        store_and_fwd_flag,
        pickup_location_id,
        to_hex(md5(cast(coalesce(cast(dropoff_latitude as STRING), '_dbt_utils_surrogate_key_null_') || '-' || coalesce(cast(dropoff_longitude as STRING), '_dbt_utils_surrogate_key_null_') as STRING))) as dropoff_location_id,
        payment_type_id,
        fare_amount,
        extra,
        mta_tax,
        tip_amount,
        tolls_amount,
        improvement_surcharge,
        total_amount
    FROM `uber-data-engineering-407103`.`uber`.`uber_tlc_trip_recrord_data`
)
SELECT
    trip_id,
    VendorID,
    datetime_id,
    do.dropoff_location_id,
    pu.pickup_location_id,
    pc.passenger_count_id,
    pt.payment_type_id,
    rc.rate_code_id,
    store_and_fwd_flag,
    td.trip_distance_id,
    fare_amount,
    extra,
    mta_tax,
    tip_amount,
    tolls_amount,
    improvement_surcharge AS improvement_surcharge_amount,  -- Added alias
    total_amount
FROM fct_invoices_cte fi
INNER JOIN `uber-data-engineering-407103`.`uber`.`datetime_dim` dt ON fi.datetime_id = dt.datetime_id
INNER JOIN `uber-data-engineering-407103`.`uber`.`dropoff_location_dim` do ON fi.dropoff_location_id = do.dropoff_location_id
INNER JOIN `uber-data-engineering-407103`.`uber`.`pickup_location_dim` pu ON fi.pickup_location_id = pu.pickup_location_id
INNER JOIN `uber-data-engineering-407103`.`uber`.`passenger_count_dim` pc ON fi.passenger_count_id = pc.passenger_count_id
INNER JOIN `uber-data-engineering-407103`.`uber`.`payment_type_dim` pt ON fi.payment_type_id = pt.payment_type_id
INNER JOIN `uber-data-engineering-407103`.`uber`.`rate_code_dim` rc ON fi.rate_code_id = rc.rate_code_id
INNER JOIN `uber-data-engineering-407103`.`uber`.`trip_distance` td ON fi.trip_distance_id = td.trip_distance_id
    );
  
[0m20:41:06.614405 [debug] [Thread-1 (]: BigQuery adapter: Retry attempt 1 of 1 after error: BadRequest('Unrecognized name: passenger_count_id; Did you mean passenger_count? at [17:9]')
[0m20:41:07.497288 [error] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=uber-data-engineering-407103&j=bq:US:1fa2e190-a460-4785-8ef8-b440e9b325b6&page=queryresults
[0m20:41:07.508456 [debug] [Thread-1 (]: Timing info for model.uber.fact_trip (execute): 20:41:03.593271 => 20:41:07.505676
[0m20:41:07.540001 [debug] [Thread-1 (]: Database Error in model fact_trip (models/transform/fact_trip.sql)
  Unrecognized name: passenger_count_id; Did you mean passenger_count? at [17:9]
  compiled Code at target/run/uber/models/transform/fact_trip.sql
[0m20:41:07.542814 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'ef374092-4636-402e-a1e6-cd24451e4817', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff8cd2bd50>]}
[0m20:41:07.545525 [error] [Thread-1 (]: 8 of 9 ERROR creating sql table model uber.fact_trip ........................... [[31mERROR[0m in 3.97s]
[0m20:41:07.547306 [debug] [Thread-1 (]: Finished running node model.uber.fact_trip
[0m20:41:07.548672 [debug] [Thread-1 (]: Began running node model.uber.test_fact
[0m20:41:07.555232 [info ] [Thread-1 (]: 9 of 9 START sql table model uber.test_fact .................................... [RUN]
[0m20:41:07.560271 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.uber.fact_trip, now model.uber.test_fact)
[0m20:41:07.562223 [debug] [Thread-1 (]: Began compiling node model.uber.test_fact
[0m20:41:07.590884 [debug] [Thread-1 (]: Writing injected SQL for node "model.uber.test_fact"
[0m20:41:07.595682 [debug] [Thread-1 (]: Timing info for model.uber.test_fact (compile): 20:41:07.563002 => 20:41:07.595003
[0m20:41:07.596889 [debug] [Thread-1 (]: Began executing node model.uber.test_fact
[0m20:41:07.604949 [debug] [Thread-1 (]: Writing runtime sql for node "model.uber.test_fact"
[0m20:41:07.609271 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m20:41:07.613169 [debug] [Thread-1 (]: On model.uber.test_fact: /* {"app": "dbt", "dbt_version": "1.5.9", "profile_name": "uber", "target_name": "dev", "node_id": "model.uber.test_fact"} */

  
    

    create or replace table `uber-data-engineering-407103`.`uber`.`test_fact`
    
    

    OPTIONS()
    as (
      with datetime_cte as (

    select * from `uber-data-engineering-407103`.`uber`.`datetime_dim`

),
dropoff_location_cte as (

    select * from `uber-data-engineering-407103`.`uber`.`dropoff_location_dim`

),
pickup_location_cte as (

    select * from `uber-data-engineering-407103`.`uber`.`pickup_location_dim`

),
passenger_count_cte as (

    select * from `uber-data-engineering-407103`.`uber`.`passenger_count_dim`

),
payment_type_cte as (

    select * from `uber-data-engineering-407103`.`uber`.`payment_type_dim`

),
rate_code_cte as (

    select * from `uber-data-engineering-407103`.`uber`.`rate_code_dim`

),
trip_distance_cte as (

    select * from `uber-data-engineering-407103`.`uber`.`trip_distance`

),
ride_cte as (
    SELECT 
        CAST(ROW_NUMBER() OVER () AS INT64) as trip_id,
        VendorID,
        datetime_cte.datetime_id,
        passenger_count_cte.passenger_count_id,
        trip_distance_cte.trip_distance_id,
        rate_code_cte.rate_code_id,
        store_and_fwd_flag,
        pickup_location_cte.pickup_location_id,
        dropoff_location_cte.dropoff_location_id,
        payment_type_cte.payment_type_id,
        fare_amount,
        extra,
        mta_tax,
        tip_amount,
        tolls_amount,
        improvement_surcharge,
        total_amount
    FROM `uber-data-engineering-407103`.`uber`.`uber_tlc_trip_recrord_data`

)
select * from ride_cte
    );
  
[0m20:41:10.125888 [debug] [Thread-1 (]: BigQuery adapter: Retry attempt 1 of 1 after error: BadRequest('Unrecognized name: datetime_cte at [51:9]')
[0m20:41:11.693284 [error] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=uber-data-engineering-407103&j=bq:US:68334521-8f80-4437-a025-197be2ac7616&page=queryresults
[0m20:41:11.702905 [debug] [Thread-1 (]: Timing info for model.uber.test_fact (execute): 20:41:07.597914 => 20:41:11.700704
[0m20:41:11.718337 [debug] [Thread-1 (]: Database Error in model test_fact (models/transform/test_fact.sql)
  Unrecognized name: datetime_cte at [51:9]
  compiled Code at target/run/uber/models/transform/test_fact.sql
[0m20:41:11.722639 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'ef374092-4636-402e-a1e6-cd24451e4817', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff8dd38e50>]}
[0m20:41:11.726947 [error] [Thread-1 (]: 9 of 9 ERROR creating sql table model uber.test_fact ........................... [[31mERROR[0m in 4.16s]
[0m20:41:11.729731 [debug] [Thread-1 (]: Finished running node model.uber.test_fact
[0m20:41:11.747365 [debug] [MainThread]: Connection 'master' was properly closed.
[0m20:41:11.748394 [debug] [MainThread]: Connection 'model.uber.test_fact' was properly closed.
[0m20:41:11.750000 [info ] [MainThread]: 
[0m20:41:11.751903 [info ] [MainThread]: Finished running 9 table models in 0 hours 1 minutes and 2.36 seconds (62.36s).
[0m20:41:11.762182 [debug] [MainThread]: Command end result
[0m20:41:11.801193 [info ] [MainThread]: 
[0m20:41:11.802111 [info ] [MainThread]: [31mCompleted with 2 errors and 0 warnings:[0m
[0m20:41:11.802789 [info ] [MainThread]: 
[0m20:41:11.803408 [error] [MainThread]: [33mDatabase Error in model fact_trip (models/transform/fact_trip.sql)[0m
[0m20:41:11.804078 [error] [MainThread]:   Unrecognized name: passenger_count_id; Did you mean passenger_count? at [17:9]
[0m20:41:11.804802 [error] [MainThread]:   compiled Code at target/run/uber/models/transform/fact_trip.sql
[0m20:41:11.806447 [info ] [MainThread]: 
[0m20:41:11.807981 [error] [MainThread]: [33mDatabase Error in model test_fact (models/transform/test_fact.sql)[0m
[0m20:41:11.809655 [error] [MainThread]:   Unrecognized name: datetime_cte at [51:9]
[0m20:41:11.811213 [error] [MainThread]:   compiled Code at target/run/uber/models/transform/test_fact.sql
[0m20:41:11.812451 [info ] [MainThread]: 
[0m20:41:11.813359 [info ] [MainThread]: Done. PASS=7 WARN=0 ERROR=2 SKIP=0 TOTAL=9
[0m20:41:11.815443 [debug] [MainThread]: Command `dbt run` failed at 20:41:11.815216 after 63.47 seconds
[0m20:41:11.816393 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff901f54d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff902138d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff90210e90>]}
[0m20:41:11.817021 [debug] [MainThread]: Flushing usage events
[0m20:42:54.282417 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffba3e2ed0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffb9e6d590>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffba6d5610>]}


============================== 20:42:54.287696 | 9a511109-a501-4401-960a-25b61bcc6660 ==============================
[0m20:42:54.287696 [info ] [MainThread]: Running with dbt=1.5.9
[0m20:42:54.288888 [debug] [MainThread]: running dbt with arguments {'fail_fast': 'False', 'target_path': 'None', 'profiles_dir': '/usr/local/airflow/include/dbt/', 'partial_parse': 'True', 'warn_error': 'None', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'quiet': 'False', 'printer_width': '80', 'no_print': 'None', 'introspect': 'True', 'use_experimental_parser': 'False', 'version_check': 'True', 'send_anonymous_usage_stats': 'True', 'log_format': 'default', 'use_colors': 'True', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'static_parser': 'True', 'log_path': '/usr/local/airflow/include/dbt/logs', 'cache_selected_only': 'False', 'debug': 'False'}
[0m20:42:54.765743 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '9a511109-a501-4401-960a-25b61bcc6660', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffb830efd0>]}
[0m20:42:54.777689 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '9a511109-a501-4401-960a-25b61bcc6660', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffb830efd0>]}
[0m20:42:54.778506 [info ] [MainThread]: Registered adapter: bigquery=1.5.3
[0m20:42:54.800463 [debug] [MainThread]: checksum: dd837546c89c9d03f3c2cb0ca6165266a30da6076d5d44e9991f7c5a8e5f5831, vars: {}, profile: , target: , version: 1.5.9
[0m20:42:54.889642 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m20:42:54.891307 [debug] [MainThread]: Partial parsing: updated file: uber://models/transform/test_fact.sql
[0m20:42:54.920416 [debug] [MainThread]: 1699: static parser successfully parsed transform/test_fact.sql
[0m20:42:54.946781 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '9a511109-a501-4401-960a-25b61bcc6660', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffb8346550>]}
[0m20:42:54.961285 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '9a511109-a501-4401-960a-25b61bcc6660', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffb8186f90>]}
[0m20:42:54.961990 [info ] [MainThread]: Found 9 models, 0 tests, 0 snapshots, 0 analyses, 474 macros, 0 operations, 0 seed files, 1 source, 0 exposures, 0 metrics, 0 groups
[0m20:42:54.962855 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '9a511109-a501-4401-960a-25b61bcc6660', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffbd22f490>]}
[0m20:42:54.964812 [info ] [MainThread]: 
[0m20:42:54.965984 [debug] [MainThread]: Acquiring new bigquery connection 'master'
[0m20:42:54.967948 [debug] [ThreadPool]: Acquiring new bigquery connection 'list_uber-data-engineering-407103'
[0m20:42:54.968936 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m20:42:56.788366 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_uber-data-engineering-407103, now list_uber-data-engineering-407103_uber)
[0m20:42:56.791961 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m20:43:01.012925 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '9a511109-a501-4401-960a-25b61bcc6660', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffba3b2290>]}
[0m20:43:01.021308 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m20:43:01.024291 [info ] [MainThread]: 
[0m20:43:01.109944 [debug] [Thread-1 (]: Began running node model.uber.datetime_dim
[0m20:43:01.124539 [info ] [Thread-1 (]: 1 of 9 START sql table model uber.datetime_dim ................................. [RUN]
[0m20:43:01.128649 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_uber-data-engineering-407103_uber, now model.uber.datetime_dim)
[0m20:43:01.132854 [debug] [Thread-1 (]: Began compiling node model.uber.datetime_dim
[0m20:43:01.195044 [debug] [Thread-1 (]: Writing injected SQL for node "model.uber.datetime_dim"
[0m20:43:01.200984 [debug] [Thread-1 (]: Timing info for model.uber.datetime_dim (compile): 20:43:01.134521 => 20:43:01.199635
[0m20:43:01.206210 [debug] [Thread-1 (]: Began executing node model.uber.datetime_dim
[0m20:43:01.260804 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m20:43:04.124540 [debug] [Thread-1 (]: Writing runtime sql for node "model.uber.datetime_dim"
[0m20:43:04.130704 [debug] [Thread-1 (]: On model.uber.datetime_dim: /* {"app": "dbt", "dbt_version": "1.5.9", "profile_name": "uber", "target_name": "dev", "node_id": "model.uber.datetime_dim"} */

  
    

    create or replace table `uber-data-engineering-407103`.`uber`.`datetime_dim`
    
    

    OPTIONS()
    as (
      WITH datetime_cte AS (  
  SELECT DISTINCT 
    to_hex(md5(cast(coalesce(cast(tpep_pickup_datetime as STRING), '_dbt_utils_surrogate_key_null_') || '-' || coalesce(cast(tpep_dropoff_datetime as STRING), '_dbt_utils_surrogate_key_null_') as STRING))) AS datetime_id,
    CASE
      WHEN LENGTH(tpep_pickup_datetime) = 16 THEN
        -- Date format: "DD/MM/YYYY HH:MM"
        PARSE_DATETIME('%m/%d/%Y %H:%M', tpep_pickup_datetime)
      WHEN LENGTH(tpep_pickup_datetime) <= 14 THEN
        -- Date format: "MM/DD/YY HH:MM"
        PARSE_DATETIME('%m/%d/%y %H:%M', tpep_pickup_datetime)
      ELSE
        NULL
    END AS pick_date_part,
    tpep_dropoff_datetime AS drop_datetime_id,
    CASE
      WHEN LENGTH(tpep_dropoff_datetime) = 16 THEN
        -- Date format: "DD/MM/YYYY HH:MM"
        PARSE_DATETIME('%m/%d/%Y %H:%M', tpep_dropoff_datetime)
      WHEN LENGTH(tpep_dropoff_datetime) <= 14 THEN
        -- Date format: "MM/DD/YY HH:MM"
        PARSE_DATETIME('%m/%d/%y %H:%M', tpep_dropoff_datetime)
      ELSE
        NULL
    END AS drop_date_part
  FROM `uber-data-engineering-407103`.`uber`.`uber_tlc_trip_recrord_data`
  WHERE tpep_pickup_datetime IS NOT NULL
    AND tpep_dropoff_datetime IS NOT NULL
)
SELECT
  datetime_id,
  pick_date_part AS tpep_pickup_datetime,
  drop_date_part AS tpep_dropoff_datetime,
  EXTRACT(HOUR FROM pick_date_part) AS pick_hour,
  EXTRACT(DAY FROM pick_date_part) AS pick_day,
  EXTRACT(MONTH FROM pick_date_part) AS pick_month,
  EXTRACT(YEAR FROM pick_date_part) AS pick_year,
  EXTRACT(DAYOFWEEK FROM pick_date_part) AS pick_weekday,
  EXTRACT(HOUR FROM drop_date_part) AS drop_hour,
  EXTRACT(DAY FROM drop_date_part) AS drop_day,
  EXTRACT(MONTH FROM drop_date_part) AS drop_month,
  EXTRACT(YEAR FROM drop_date_part) AS drop_year,
  EXTRACT(DAYOFWEEK FROM drop_date_part) AS drop_weekday
FROM datetime_cte
    );
  
[0m20:43:08.881970 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=uber-data-engineering-407103&j=bq:US:ea5af69f-3c9b-4231-a030-ceee4ce204ef&page=queryresults
[0m20:43:08.915189 [debug] [Thread-1 (]: Timing info for model.uber.datetime_dim (execute): 20:43:01.213707 => 20:43:08.914731
[0m20:43:08.916996 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '9a511109-a501-4401-960a-25b61bcc6660', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffb81c6250>]}
[0m20:43:08.918427 [info ] [Thread-1 (]: 1 of 9 OK created sql table model uber.datetime_dim ............................ [[32mCREATE TABLE (99.9k rows, 4.0 MiB processed)[0m in 7.79s]
[0m20:43:08.920040 [debug] [Thread-1 (]: Finished running node model.uber.datetime_dim
[0m20:43:08.921128 [debug] [Thread-1 (]: Began running node model.uber.dropoff_location_dim
[0m20:43:08.922090 [info ] [Thread-1 (]: 2 of 9 START sql table model uber.dropoff_location_dim ......................... [RUN]
[0m20:43:08.923328 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.uber.datetime_dim, now model.uber.dropoff_location_dim)
[0m20:43:08.923953 [debug] [Thread-1 (]: Began compiling node model.uber.dropoff_location_dim
[0m20:43:08.929558 [debug] [Thread-1 (]: Writing injected SQL for node "model.uber.dropoff_location_dim"
[0m20:43:08.932430 [debug] [Thread-1 (]: Timing info for model.uber.dropoff_location_dim (compile): 20:43:08.924453 => 20:43:08.932271
[0m20:43:08.932969 [debug] [Thread-1 (]: Began executing node model.uber.dropoff_location_dim
[0m20:43:08.935524 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m20:43:12.473263 [debug] [Thread-1 (]: Writing runtime sql for node "model.uber.dropoff_location_dim"
[0m20:43:12.495377 [debug] [Thread-1 (]: On model.uber.dropoff_location_dim: /* {"app": "dbt", "dbt_version": "1.5.9", "profile_name": "uber", "target_name": "dev", "node_id": "model.uber.dropoff_location_dim"} */

  
    

    create or replace table `uber-data-engineering-407103`.`uber`.`dropoff_location_dim`
    
    

    OPTIONS()
    as (
      WITH numbered_rows AS (
  SELECT
    to_hex(md5(cast(coalesce(cast(dropoff_latitude as STRING), '_dbt_utils_surrogate_key_null_') || '-' || coalesce(cast(dropoff_longitude as STRING), '_dbt_utils_surrogate_key_null_') as STRING))) as dropoff_location_id,
    dropoff_latitude AS dropoff_latitude,
    dropoff_longitude AS dropoff_longitude,
    ROW_NUMBER() OVER (ORDER BY dropoff_latitude, dropoff_longitude) as row_num
  FROM `uber-data-engineering-407103`.`uber`.`uber_tlc_trip_recrord_data`
)
SELECT
  dropoff_location_id,
  dropoff_latitude,
  dropoff_longitude
FROM numbered_rows
    );
  
[0m20:43:16.307191 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=uber-data-engineering-407103&j=bq:US:c8439343-5c06-47d7-a817-28c6d87541b6&page=queryresults
[0m20:43:16.330530 [debug] [Thread-1 (]: Timing info for model.uber.dropoff_location_dim (execute): 20:43:08.933433 => 20:43:16.329568
[0m20:43:16.334319 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '9a511109-a501-4401-960a-25b61bcc6660', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffb81b88d0>]}
[0m20:43:16.337016 [info ] [Thread-1 (]: 2 of 9 OK created sql table model uber.dropoff_location_dim .................... [[32mCREATE TABLE (100.0k rows, 1.5 MiB processed)[0m in 7.41s]
[0m20:43:16.339572 [debug] [Thread-1 (]: Finished running node model.uber.dropoff_location_dim
[0m20:43:16.341203 [debug] [Thread-1 (]: Began running node model.uber.passenger_count_dim
[0m20:43:16.343439 [info ] [Thread-1 (]: 3 of 9 START sql table model uber.passenger_count_dim .......................... [RUN]
[0m20:43:16.345283 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.uber.dropoff_location_dim, now model.uber.passenger_count_dim)
[0m20:43:16.346167 [debug] [Thread-1 (]: Began compiling node model.uber.passenger_count_dim
[0m20:43:16.356021 [debug] [Thread-1 (]: Writing injected SQL for node "model.uber.passenger_count_dim"
[0m20:43:16.358843 [debug] [Thread-1 (]: Timing info for model.uber.passenger_count_dim (compile): 20:43:16.346822 => 20:43:16.358652
[0m20:43:16.359542 [debug] [Thread-1 (]: Began executing node model.uber.passenger_count_dim
[0m20:43:16.363395 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m20:43:17.381912 [debug] [Thread-1 (]: Writing runtime sql for node "model.uber.passenger_count_dim"
[0m20:43:17.386908 [debug] [Thread-1 (]: On model.uber.passenger_count_dim: /* {"app": "dbt", "dbt_version": "1.5.9", "profile_name": "uber", "target_name": "dev", "node_id": "model.uber.passenger_count_dim"} */

  
    

    create or replace table `uber-data-engineering-407103`.`uber`.`passenger_count_dim`
    
    

    OPTIONS()
    as (
      WITH numbered_rows AS (
  SELECT
    GENERATE_UUID() as passenger_count_id,
    passenger_count AS passenger_count,
    ROW_NUMBER() OVER () as row_num
  FROM `uber-data-engineering-407103`.`uber`.`uber_tlc_trip_recrord_data`
  WHERE passenger_count IS NOT NULL
)
SELECT
  passenger_count_id,
  passenger_count
FROM numbered_rows
    );
  
[0m20:43:20.381766 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=uber-data-engineering-407103&j=bq:US:912d85eb-7ef4-4bb6-b4a2-f5a6ae446685&page=queryresults
[0m20:43:20.393601 [debug] [Thread-1 (]: Timing info for model.uber.passenger_count_dim (execute): 20:43:16.360278 => 20:43:20.392922
[0m20:43:20.396589 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '9a511109-a501-4401-960a-25b61bcc6660', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffb8233090>]}
[0m20:43:20.398977 [info ] [Thread-1 (]: 3 of 9 OK created sql table model uber.passenger_count_dim ..................... [[32mCREATE TABLE (100.0k rows, 781.2 KiB processed)[0m in 4.05s]
[0m20:43:20.402789 [debug] [Thread-1 (]: Finished running node model.uber.passenger_count_dim
[0m20:43:20.404600 [debug] [Thread-1 (]: Began running node model.uber.payment_type_dim
[0m20:43:20.406524 [info ] [Thread-1 (]: 4 of 9 START sql table model uber.payment_type_dim ............................. [RUN]
[0m20:43:20.408539 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.uber.passenger_count_dim, now model.uber.payment_type_dim)
[0m20:43:20.409665 [debug] [Thread-1 (]: Began compiling node model.uber.payment_type_dim
[0m20:43:20.417582 [debug] [Thread-1 (]: Writing injected SQL for node "model.uber.payment_type_dim"
[0m20:43:20.421784 [debug] [Thread-1 (]: Timing info for model.uber.payment_type_dim (compile): 20:43:20.410548 => 20:43:20.421436
[0m20:43:20.422786 [debug] [Thread-1 (]: Began executing node model.uber.payment_type_dim
[0m20:43:20.426546 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m20:43:22.302008 [debug] [Thread-1 (]: Writing runtime sql for node "model.uber.payment_type_dim"
[0m20:43:22.306477 [debug] [Thread-1 (]: On model.uber.payment_type_dim: /* {"app": "dbt", "dbt_version": "1.5.9", "profile_name": "uber", "target_name": "dev", "node_id": "model.uber.payment_type_dim"} */

  
    

    create or replace table `uber-data-engineering-407103`.`uber`.`payment_type_dim`
    
    

    OPTIONS()
    as (
      WITH numbered_rows AS (
  SELECT
    GENERATE_UUID() as payment_type_id,
    payment_type AS payment_type,
    ROW_NUMBER() OVER (ORDER BY payment_type) as row_num
  FROM `uber-data-engineering-407103`.`uber`.`uber_tlc_trip_recrord_data`
  WHERE payment_type IS NOT NULL
)
SELECT
  payment_type_id,
  payment_type
FROM numbered_rows
    );
  
[0m20:43:27.833309 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=uber-data-engineering-407103&j=bq:US:f8d339ea-3038-4d7d-a434-bf68a8c7aaa5&page=queryresults
[0m20:43:27.851033 [debug] [Thread-1 (]: Timing info for model.uber.payment_type_dim (execute): 20:43:20.423461 => 20:43:27.850182
[0m20:43:27.854341 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '9a511109-a501-4401-960a-25b61bcc6660', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffb6f8ea90>]}
[0m20:43:27.856860 [info ] [Thread-1 (]: 4 of 9 OK created sql table model uber.payment_type_dim ........................ [[32mCREATE TABLE (100.0k rows, 781.2 KiB processed)[0m in 7.45s]
[0m20:43:27.859424 [debug] [Thread-1 (]: Finished running node model.uber.payment_type_dim
[0m20:43:27.860889 [debug] [Thread-1 (]: Began running node model.uber.pickup_location_dim
[0m20:43:27.862618 [info ] [Thread-1 (]: 5 of 9 START sql table model uber.pickup_location_dim .......................... [RUN]
[0m20:43:27.864210 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.uber.payment_type_dim, now model.uber.pickup_location_dim)
[0m20:43:27.864976 [debug] [Thread-1 (]: Began compiling node model.uber.pickup_location_dim
[0m20:43:27.876740 [debug] [Thread-1 (]: Writing injected SQL for node "model.uber.pickup_location_dim"
[0m20:43:27.879267 [debug] [Thread-1 (]: Timing info for model.uber.pickup_location_dim (compile): 20:43:27.865630 => 20:43:27.879070
[0m20:43:27.879805 [debug] [Thread-1 (]: Began executing node model.uber.pickup_location_dim
[0m20:43:27.882792 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m20:43:29.314642 [debug] [Thread-1 (]: Writing runtime sql for node "model.uber.pickup_location_dim"
[0m20:43:29.317274 [debug] [Thread-1 (]: On model.uber.pickup_location_dim: /* {"app": "dbt", "dbt_version": "1.5.9", "profile_name": "uber", "target_name": "dev", "node_id": "model.uber.pickup_location_dim"} */

  
    

    create or replace table `uber-data-engineering-407103`.`uber`.`pickup_location_dim`
    
    

    OPTIONS()
    as (
      WITH numbered_rows AS (
  SELECT
    to_hex(md5(cast(coalesce(cast(pickup_latitude as STRING), '_dbt_utils_surrogate_key_null_') || '-' || coalesce(cast(pickup_longitude as STRING), '_dbt_utils_surrogate_key_null_') as STRING))) as pickup_location_id,
    pickup_latitude AS pickup_latitude,
    pickup_longitude AS pickup_longitude,
    ROW_NUMBER() OVER (ORDER BY pickup_latitude, pickup_longitude) as row_num
  FROM `uber-data-engineering-407103`.`uber`.`uber_tlc_trip_recrord_data`
)
SELECT
  pickup_location_id,
  pickup_latitude,
  pickup_longitude
FROM numbered_rows
    );
  
[0m20:43:32.745687 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=uber-data-engineering-407103&j=bq:US:fff987ab-c396-438c-b00d-0f529702b873&page=queryresults
[0m20:43:32.777236 [debug] [Thread-1 (]: Timing info for model.uber.pickup_location_dim (execute): 20:43:27.880231 => 20:43:32.775282
[0m20:43:32.781706 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '9a511109-a501-4401-960a-25b61bcc6660', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffba3b2290>]}
[0m20:43:32.783772 [info ] [Thread-1 (]: 5 of 9 OK created sql table model uber.pickup_location_dim ..................... [[32mCREATE TABLE (100.0k rows, 1.5 MiB processed)[0m in 4.92s]
[0m20:43:32.786249 [debug] [Thread-1 (]: Finished running node model.uber.pickup_location_dim
[0m20:43:32.787592 [debug] [Thread-1 (]: Began running node model.uber.rate_code_dim
[0m20:43:32.789016 [info ] [Thread-1 (]: 6 of 9 START sql table model uber.rate_code_dim ................................ [RUN]
[0m20:43:32.790294 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.uber.pickup_location_dim, now model.uber.rate_code_dim)
[0m20:43:32.791010 [debug] [Thread-1 (]: Began compiling node model.uber.rate_code_dim
[0m20:43:32.798992 [debug] [Thread-1 (]: Writing injected SQL for node "model.uber.rate_code_dim"
[0m20:43:32.824082 [debug] [Thread-1 (]: Timing info for model.uber.rate_code_dim (compile): 20:43:32.791488 => 20:43:32.823794
[0m20:43:32.824844 [debug] [Thread-1 (]: Began executing node model.uber.rate_code_dim
[0m20:43:32.831745 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m20:43:34.542914 [debug] [Thread-1 (]: Writing runtime sql for node "model.uber.rate_code_dim"
[0m20:43:34.550563 [debug] [Thread-1 (]: On model.uber.rate_code_dim: /* {"app": "dbt", "dbt_version": "1.5.9", "profile_name": "uber", "target_name": "dev", "node_id": "model.uber.rate_code_dim"} */

  
    

    create or replace table `uber-data-engineering-407103`.`uber`.`rate_code_dim`
    
    

    OPTIONS()
    as (
      WITH numbered_rows AS (
  SELECT
    GENERATE_UUID() as rate_code_id,
    RatecodeID AS RatecodeID,
    ROW_NUMBER() OVER (ORDER BY RatecodeID) as row_num
  FROM `uber-data-engineering-407103`.`uber`.`uber_tlc_trip_recrord_data`
  WHERE RatecodeID IS NOT NULL
)
SELECT
  rate_code_id,
  RatecodeID
FROM numbered_rows
    );
  
[0m20:43:38.533477 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=uber-data-engineering-407103&j=bq:US:222c4239-0ea2-4270-9925-ca51d8d2e5d4&page=queryresults
[0m20:43:38.547563 [debug] [Thread-1 (]: Timing info for model.uber.rate_code_dim (execute): 20:43:32.825943 => 20:43:38.546847
[0m20:43:38.550816 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '9a511109-a501-4401-960a-25b61bcc6660', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffb701f450>]}
[0m20:43:38.552784 [info ] [Thread-1 (]: 6 of 9 OK created sql table model uber.rate_code_dim ........................... [[32mCREATE TABLE (100.0k rows, 781.2 KiB processed)[0m in 5.76s]
[0m20:43:38.554782 [debug] [Thread-1 (]: Finished running node model.uber.rate_code_dim
[0m20:43:38.556008 [debug] [Thread-1 (]: Began running node model.uber.trip_distance
[0m20:43:38.557467 [info ] [Thread-1 (]: 7 of 9 START sql table model uber.trip_distance ................................ [RUN]
[0m20:43:38.558867 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.uber.rate_code_dim, now model.uber.trip_distance)
[0m20:43:38.559584 [debug] [Thread-1 (]: Began compiling node model.uber.trip_distance
[0m20:43:38.573694 [debug] [Thread-1 (]: Writing injected SQL for node "model.uber.trip_distance"
[0m20:43:38.576589 [debug] [Thread-1 (]: Timing info for model.uber.trip_distance (compile): 20:43:38.560238 => 20:43:38.576412
[0m20:43:38.577207 [debug] [Thread-1 (]: Began executing node model.uber.trip_distance
[0m20:43:38.581908 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m20:43:41.673513 [debug] [Thread-1 (]: Writing runtime sql for node "model.uber.trip_distance"
[0m20:43:41.681531 [debug] [Thread-1 (]: On model.uber.trip_distance: /* {"app": "dbt", "dbt_version": "1.5.9", "profile_name": "uber", "target_name": "dev", "node_id": "model.uber.trip_distance"} */

  
    

    create or replace table `uber-data-engineering-407103`.`uber`.`trip_distance`
    
    

    OPTIONS()
    as (
      WITH numbered_rows AS (
  SELECT
    GENERATE_UUID() as trip_distance_id,
    trip_distance AS trip_distance,
    ROW_NUMBER() OVER (ORDER BY trip_distance) as row_num
  FROM `uber-data-engineering-407103`.`uber`.`uber_tlc_trip_recrord_data`
  WHERE trip_distance IS NOT NULL
)
SELECT
  trip_distance_id,
  trip_distance
FROM numbered_rows
    );
  
[0m20:43:44.997757 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=uber-data-engineering-407103&j=bq:US:0977c1c3-3b77-45af-ae9f-6fc6de6e3aec&page=queryresults
[0m20:43:45.021174 [debug] [Thread-1 (]: Timing info for model.uber.trip_distance (execute): 20:43:38.579421 => 20:43:45.017069
[0m20:43:45.034320 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '9a511109-a501-4401-960a-25b61bcc6660', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffb6ffa4d0>]}
[0m20:43:45.037620 [info ] [Thread-1 (]: 7 of 9 OK created sql table model uber.trip_distance ........................... [[32mCREATE TABLE (100.0k rows, 781.2 KiB processed)[0m in 6.47s]
[0m20:43:45.040611 [debug] [Thread-1 (]: Finished running node model.uber.trip_distance
[0m20:43:45.046018 [debug] [Thread-1 (]: Began running node model.uber.fact_trip
[0m20:43:45.047329 [info ] [Thread-1 (]: 8 of 9 START sql table model uber.fact_trip .................................... [RUN]
[0m20:43:45.049399 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.uber.trip_distance, now model.uber.fact_trip)
[0m20:43:45.050341 [debug] [Thread-1 (]: Began compiling node model.uber.fact_trip
[0m20:43:45.067053 [debug] [Thread-1 (]: Writing injected SQL for node "model.uber.fact_trip"
[0m20:43:45.070613 [debug] [Thread-1 (]: Timing info for model.uber.fact_trip (compile): 20:43:45.051128 => 20:43:45.070376
[0m20:43:45.071185 [debug] [Thread-1 (]: Began executing node model.uber.fact_trip
[0m20:43:45.075370 [debug] [Thread-1 (]: Writing runtime sql for node "model.uber.fact_trip"
[0m20:43:45.083494 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m20:43:45.104080 [debug] [Thread-1 (]: On model.uber.fact_trip: /* {"app": "dbt", "dbt_version": "1.5.9", "profile_name": "uber", "target_name": "dev", "node_id": "model.uber.fact_trip"} */

  
    

    create or replace table `uber-data-engineering-407103`.`uber`.`fact_trip`
    
    

    OPTIONS()
    as (
      WITH fct_invoices_cte AS (
    SELECT
        CAST(ROW_NUMBER() OVER () AS INT64) as trip_id,
        VendorID,
        to_hex(md5(cast(coalesce(cast(tpep_pickup_datetime as STRING), '_dbt_utils_surrogate_key_null_') || '-' || coalesce(cast(tpep_dropoff_datetime as STRING), '_dbt_utils_surrogate_key_null_') as STRING))) AS datetime_id,
        passenger_count_id,
        trip_distance_id,
        rate_code_id,
        store_and_fwd_flag,
        pickup_location_id,
        to_hex(md5(cast(coalesce(cast(dropoff_latitude as STRING), '_dbt_utils_surrogate_key_null_') || '-' || coalesce(cast(dropoff_longitude as STRING), '_dbt_utils_surrogate_key_null_') as STRING))) as dropoff_location_id,
        payment_type_id,
        fare_amount,
        extra,
        mta_tax,
        tip_amount,
        tolls_amount,
        improvement_surcharge,
        total_amount
    FROM `uber-data-engineering-407103`.`uber`.`uber_tlc_trip_recrord_data`
)
SELECT
    trip_id,
    VendorID,
    datetime_id,
    do.dropoff_location_id,
    pu.pickup_location_id,
    pc.passenger_count_id,
    pt.payment_type_id,
    rc.rate_code_id,
    store_and_fwd_flag,
    td.trip_distance_id,
    fare_amount,
    extra,
    mta_tax,
    tip_amount,
    tolls_amount,
    improvement_surcharge AS improvement_surcharge_amount,  -- Added alias
    total_amount
FROM fct_invoices_cte fi
INNER JOIN `uber-data-engineering-407103`.`uber`.`datetime_dim` dt ON fi.datetime_id = dt.datetime_id
INNER JOIN `uber-data-engineering-407103`.`uber`.`dropoff_location_dim` do ON fi.dropoff_location_id = do.dropoff_location_id
INNER JOIN `uber-data-engineering-407103`.`uber`.`pickup_location_dim` pu ON fi.pickup_location_id = pu.pickup_location_id
INNER JOIN `uber-data-engineering-407103`.`uber`.`passenger_count_dim` pc ON fi.passenger_count_id = pc.passenger_count_id
INNER JOIN `uber-data-engineering-407103`.`uber`.`payment_type_dim` pt ON fi.payment_type_id = pt.payment_type_id
INNER JOIN `uber-data-engineering-407103`.`uber`.`rate_code_dim` rc ON fi.rate_code_id = rc.rate_code_id
INNER JOIN `uber-data-engineering-407103`.`uber`.`trip_distance` td ON fi.trip_distance_id = td.trip_distance_id
    );
  
[0m20:43:47.439924 [debug] [Thread-1 (]: BigQuery adapter: Retry attempt 1 of 1 after error: BadRequest('Unrecognized name: passenger_count_id; Did you mean passenger_count? at [17:9]')
[0m20:43:48.875465 [error] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=uber-data-engineering-407103&j=bq:US:726c9d63-0b6c-47b2-af34-2020fdf81a23&page=queryresults
[0m20:43:48.882440 [debug] [Thread-1 (]: Timing info for model.uber.fact_trip (execute): 20:43:45.071606 => 20:43:48.881007
[0m20:43:48.906119 [debug] [Thread-1 (]: Database Error in model fact_trip (models/transform/fact_trip.sql)
  Unrecognized name: passenger_count_id; Did you mean passenger_count? at [17:9]
  compiled Code at target/run/uber/models/transform/fact_trip.sql
[0m20:43:48.908219 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '9a511109-a501-4401-960a-25b61bcc6660', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffb6fb34d0>]}
[0m20:43:48.910851 [error] [Thread-1 (]: 8 of 9 ERROR creating sql table model uber.fact_trip ........................... [[31mERROR[0m in 3.86s]
[0m20:43:48.913149 [debug] [Thread-1 (]: Finished running node model.uber.fact_trip
[0m20:43:48.916523 [debug] [Thread-1 (]: Began running node model.uber.test_fact
[0m20:43:48.923160 [info ] [Thread-1 (]: 9 of 9 START sql table model uber.test_fact .................................... [RUN]
[0m20:43:48.926199 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.uber.fact_trip, now model.uber.test_fact)
[0m20:43:48.927148 [debug] [Thread-1 (]: Began compiling node model.uber.test_fact
[0m20:43:48.948173 [debug] [Thread-1 (]: Writing injected SQL for node "model.uber.test_fact"
[0m20:43:48.951408 [debug] [Thread-1 (]: Timing info for model.uber.test_fact (compile): 20:43:48.927864 => 20:43:48.950994
[0m20:43:48.952168 [debug] [Thread-1 (]: Began executing node model.uber.test_fact
[0m20:43:48.956543 [debug] [Thread-1 (]: Writing runtime sql for node "model.uber.test_fact"
[0m20:43:48.958198 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m20:43:48.961239 [debug] [Thread-1 (]: On model.uber.test_fact: /* {"app": "dbt", "dbt_version": "1.5.9", "profile_name": "uber", "target_name": "dev", "node_id": "model.uber.test_fact"} */

  
    

    create or replace table `uber-data-engineering-407103`.`uber`.`test_fact`
    
    

    OPTIONS()
    as (
      dropoff_location_cte as (

    select * from `uber-data-engineering-407103`.`uber`.`dropoff_location_dim`

),
pickup_location_cte as (

    select * from `uber-data-engineering-407103`.`uber`.`pickup_location_dim`

),
passenger_count_cte as (

    select * from `uber-data-engineering-407103`.`uber`.`passenger_count_dim`

),
payment_type_cte as (

    select * from `uber-data-engineering-407103`.`uber`.`payment_type_dim`

),
rate_code_cte as (

    select * from `uber-data-engineering-407103`.`uber`.`rate_code_dim`

),
trip_distance_cte as (

    select * from `uber-data-engineering-407103`.`uber`.`trip_distance`

),
ride_cte as (
    SELECT 
        CAST(ROW_NUMBER() OVER () AS INT64) as trip_id,
        VendorID,
        passenger_count_cte.passenger_count_id,
        trip_distance_cte.trip_distance_id,
        rate_code_cte.rate_code_id,
        store_and_fwd_flag,
        pickup_location_cte.pickup_location_id,
        dropoff_location_cte.dropoff_location_id,
        payment_type_cte.payment_type_id,
        fare_amount,
        extra,
        mta_tax,
        tip_amount,
        tolls_amount,
        improvement_surcharge,
        total_amount
    FROM `uber-data-engineering-407103`.`uber`.`uber_tlc_trip_recrord_data`
)
select * from ride_cte
    );
  
[0m20:43:49.554295 [debug] [Thread-1 (]: BigQuery adapter: Retry attempt 1 of 1 after error: BadRequest('Syntax error: Unexpected identifier "dropoff_location_cte" at [12:7]')
[0m20:43:51.354041 [error] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=uber-data-engineering-407103&j=bq:US:4bf2cc54-a32b-4793-af1e-bf1af2cb2626&page=queryresults
[0m20:43:51.358588 [debug] [Thread-1 (]: Timing info for model.uber.test_fact (execute): 20:43:48.952613 => 20:43:51.358210
[0m20:43:51.365255 [debug] [Thread-1 (]: Database Error in model test_fact (models/transform/test_fact.sql)
  Syntax error: Unexpected identifier "dropoff_location_cte" at [12:7]
  compiled Code at target/run/uber/models/transform/test_fact.sql
[0m20:43:51.366399 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '9a511109-a501-4401-960a-25b61bcc6660', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffb8319d10>]}
[0m20:43:51.367755 [error] [Thread-1 (]: 9 of 9 ERROR creating sql table model uber.test_fact ........................... [[31mERROR[0m in 2.44s]
[0m20:43:51.368868 [debug] [Thread-1 (]: Finished running node model.uber.test_fact
[0m20:43:51.374535 [debug] [MainThread]: Connection 'master' was properly closed.
[0m20:43:51.375289 [debug] [MainThread]: Connection 'model.uber.test_fact' was properly closed.
[0m20:43:51.376356 [info ] [MainThread]: 
[0m20:43:51.377428 [info ] [MainThread]: Finished running 9 table models in 0 hours 0 minutes and 56.41 seconds (56.41s).
[0m20:43:51.381007 [debug] [MainThread]: Command end result
[0m20:43:51.419686 [info ] [MainThread]: 
[0m20:43:51.421429 [info ] [MainThread]: [31mCompleted with 2 errors and 0 warnings:[0m
[0m20:43:51.422622 [info ] [MainThread]: 
[0m20:43:51.423993 [error] [MainThread]: [33mDatabase Error in model fact_trip (models/transform/fact_trip.sql)[0m
[0m20:43:51.425171 [error] [MainThread]:   Unrecognized name: passenger_count_id; Did you mean passenger_count? at [17:9]
[0m20:43:51.425834 [error] [MainThread]:   compiled Code at target/run/uber/models/transform/fact_trip.sql
[0m20:43:51.429898 [info ] [MainThread]: 
[0m20:43:51.432206 [error] [MainThread]: [33mDatabase Error in model test_fact (models/transform/test_fact.sql)[0m
[0m20:43:51.436026 [error] [MainThread]:   Syntax error: Unexpected identifier "dropoff_location_cte" at [12:7]
[0m20:43:51.441599 [error] [MainThread]:   compiled Code at target/run/uber/models/transform/test_fact.sql
[0m20:43:51.444321 [info ] [MainThread]: 
[0m20:43:51.446169 [info ] [MainThread]: Done. PASS=7 WARN=0 ERROR=2 SKIP=0 TOTAL=9
[0m20:43:51.450950 [debug] [MainThread]: Command `dbt run` failed at 20:43:51.449781 after 57.18 seconds
[0m20:43:51.453383 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffba6b92d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffba3a5750>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffbb308950>]}
[0m20:43:51.454721 [debug] [MainThread]: Flushing usage events
[0m20:51:40.517124 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffaf57df10>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffaf8a1690>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffafa35210>]}


============================== 20:51:40.523701 | 46fbd8cb-c76a-4c54-b2e3-81506dd21150 ==============================
[0m20:51:40.523701 [info ] [MainThread]: Running with dbt=1.5.9
[0m20:51:40.524682 [debug] [MainThread]: running dbt with arguments {'indirect_selection': 'eager', 'debug': 'False', 'printer_width': '80', 'target_path': 'None', 'log_path': '/usr/local/airflow/include/dbt/logs', 'partial_parse': 'True', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'log_format': 'default', 'static_parser': 'True', 'no_print': 'None', 'cache_selected_only': 'False', 'warn_error': 'None', 'version_check': 'True', 'log_cache_events': 'False', 'profiles_dir': '/usr/local/airflow/include/dbt/', 'send_anonymous_usage_stats': 'True', 'quiet': 'False', 'use_colors': 'True', 'fail_fast': 'False', 'write_json': 'True', 'introspect': 'True', 'use_experimental_parser': 'False'}
[0m20:51:41.094944 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '46fbd8cb-c76a-4c54-b2e3-81506dd21150', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffad68c190>]}
[0m20:51:41.106300 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '46fbd8cb-c76a-4c54-b2e3-81506dd21150', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffad685290>]}
[0m20:51:41.107096 [info ] [MainThread]: Registered adapter: bigquery=1.5.3
[0m20:51:41.122826 [debug] [MainThread]: checksum: dd837546c89c9d03f3c2cb0ca6165266a30da6076d5d44e9991f7c5a8e5f5831, vars: {}, profile: , target: , version: 1.5.9
[0m20:51:41.224840 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m20:51:41.225739 [debug] [MainThread]: Partial parsing: updated file: uber://models/transform/test_fact.sql
[0m20:51:41.247818 [debug] [MainThread]: 1699: static parser successfully parsed transform/test_fact.sql
[0m20:51:41.273584 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '46fbd8cb-c76a-4c54-b2e3-81506dd21150', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffad510110>]}
[0m20:51:41.292574 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '46fbd8cb-c76a-4c54-b2e3-81506dd21150', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffac2f6050>]}
[0m20:51:41.293188 [info ] [MainThread]: Found 9 models, 0 tests, 0 snapshots, 0 analyses, 474 macros, 0 operations, 0 seed files, 1 source, 0 exposures, 0 metrics, 0 groups
[0m20:51:41.293849 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '46fbd8cb-c76a-4c54-b2e3-81506dd21150', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffb2577790>]}
[0m20:51:41.295786 [info ] [MainThread]: 
[0m20:51:41.296875 [debug] [MainThread]: Acquiring new bigquery connection 'master'
[0m20:51:41.298530 [debug] [ThreadPool]: Acquiring new bigquery connection 'list_uber-data-engineering-407103'
[0m20:51:41.299028 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m20:51:44.779705 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_uber-data-engineering-407103, now list_uber-data-engineering-407103_uber)
[0m20:51:44.784571 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m20:51:46.812495 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '46fbd8cb-c76a-4c54-b2e3-81506dd21150', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffb017a910>]}
[0m20:51:46.815671 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m20:51:46.816981 [info ] [MainThread]: 
[0m20:51:46.854706 [debug] [Thread-1 (]: Began running node model.uber.datetime_dim
[0m20:51:46.858082 [info ] [Thread-1 (]: 1 of 9 START sql table model uber.datetime_dim ................................. [RUN]
[0m20:51:46.861521 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_uber-data-engineering-407103_uber, now model.uber.datetime_dim)
[0m20:51:46.863340 [debug] [Thread-1 (]: Began compiling node model.uber.datetime_dim
[0m20:51:46.910966 [debug] [Thread-1 (]: Writing injected SQL for node "model.uber.datetime_dim"
[0m20:51:46.915420 [debug] [Thread-1 (]: Timing info for model.uber.datetime_dim (compile): 20:51:46.864424 => 20:51:46.914917
[0m20:51:46.916308 [debug] [Thread-1 (]: Began executing node model.uber.datetime_dim
[0m20:51:46.946584 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m20:51:48.960002 [debug] [Thread-1 (]: Writing runtime sql for node "model.uber.datetime_dim"
[0m20:51:48.963222 [debug] [Thread-1 (]: On model.uber.datetime_dim: /* {"app": "dbt", "dbt_version": "1.5.9", "profile_name": "uber", "target_name": "dev", "node_id": "model.uber.datetime_dim"} */

  
    

    create or replace table `uber-data-engineering-407103`.`uber`.`datetime_dim`
    
    

    OPTIONS()
    as (
      WITH datetime_cte AS (  
  SELECT DISTINCT 
    to_hex(md5(cast(coalesce(cast(tpep_pickup_datetime as STRING), '_dbt_utils_surrogate_key_null_') || '-' || coalesce(cast(tpep_dropoff_datetime as STRING), '_dbt_utils_surrogate_key_null_') as STRING))) AS datetime_id,
    CASE
      WHEN LENGTH(tpep_pickup_datetime) = 16 THEN
        -- Date format: "DD/MM/YYYY HH:MM"
        PARSE_DATETIME('%m/%d/%Y %H:%M', tpep_pickup_datetime)
      WHEN LENGTH(tpep_pickup_datetime) <= 14 THEN
        -- Date format: "MM/DD/YY HH:MM"
        PARSE_DATETIME('%m/%d/%y %H:%M', tpep_pickup_datetime)
      ELSE
        NULL
    END AS pick_date_part,
    tpep_dropoff_datetime AS drop_datetime_id,
    CASE
      WHEN LENGTH(tpep_dropoff_datetime) = 16 THEN
        -- Date format: "DD/MM/YYYY HH:MM"
        PARSE_DATETIME('%m/%d/%Y %H:%M', tpep_dropoff_datetime)
      WHEN LENGTH(tpep_dropoff_datetime) <= 14 THEN
        -- Date format: "MM/DD/YY HH:MM"
        PARSE_DATETIME('%m/%d/%y %H:%M', tpep_dropoff_datetime)
      ELSE
        NULL
    END AS drop_date_part
  FROM `uber-data-engineering-407103`.`uber`.`uber_tlc_trip_recrord_data`
  WHERE tpep_pickup_datetime IS NOT NULL
    AND tpep_dropoff_datetime IS NOT NULL
)
SELECT
  datetime_id,
  pick_date_part AS tpep_pickup_datetime,
  drop_date_part AS tpep_dropoff_datetime,
  EXTRACT(HOUR FROM pick_date_part) AS pick_hour,
  EXTRACT(DAY FROM pick_date_part) AS pick_day,
  EXTRACT(MONTH FROM pick_date_part) AS pick_month,
  EXTRACT(YEAR FROM pick_date_part) AS pick_year,
  EXTRACT(DAYOFWEEK FROM pick_date_part) AS pick_weekday,
  EXTRACT(HOUR FROM drop_date_part) AS drop_hour,
  EXTRACT(DAY FROM drop_date_part) AS drop_day,
  EXTRACT(MONTH FROM drop_date_part) AS drop_month,
  EXTRACT(YEAR FROM drop_date_part) AS drop_year,
  EXTRACT(DAYOFWEEK FROM drop_date_part) AS drop_weekday
FROM datetime_cte
    );
  
[0m20:51:52.621143 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=uber-data-engineering-407103&j=bq:US:1bab4f34-66a2-4b2c-be55-8e83c07637bb&page=queryresults
[0m20:51:52.676329 [debug] [Thread-1 (]: Timing info for model.uber.datetime_dim (execute): 20:51:46.916822 => 20:51:52.675705
[0m20:51:52.678608 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '46fbd8cb-c76a-4c54-b2e3-81506dd21150', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffac2d2150>]}
[0m20:51:52.680296 [info ] [Thread-1 (]: 1 of 9 OK created sql table model uber.datetime_dim ............................ [[32mCREATE TABLE (99.9k rows, 4.0 MiB processed)[0m in 5.82s]
[0m20:51:52.682108 [debug] [Thread-1 (]: Finished running node model.uber.datetime_dim
[0m20:51:52.683090 [debug] [Thread-1 (]: Began running node model.uber.dropoff_location_dim
[0m20:51:52.684233 [info ] [Thread-1 (]: 2 of 9 START sql table model uber.dropoff_location_dim ......................... [RUN]
[0m20:51:52.685322 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.uber.datetime_dim, now model.uber.dropoff_location_dim)
[0m20:51:52.685978 [debug] [Thread-1 (]: Began compiling node model.uber.dropoff_location_dim
[0m20:51:52.692623 [debug] [Thread-1 (]: Writing injected SQL for node "model.uber.dropoff_location_dim"
[0m20:51:52.695440 [debug] [Thread-1 (]: Timing info for model.uber.dropoff_location_dim (compile): 20:51:52.686494 => 20:51:52.695267
[0m20:51:52.695992 [debug] [Thread-1 (]: Began executing node model.uber.dropoff_location_dim
[0m20:51:52.698703 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m20:51:53.989919 [debug] [Thread-1 (]: Writing runtime sql for node "model.uber.dropoff_location_dim"
[0m20:51:53.996399 [debug] [Thread-1 (]: On model.uber.dropoff_location_dim: /* {"app": "dbt", "dbt_version": "1.5.9", "profile_name": "uber", "target_name": "dev", "node_id": "model.uber.dropoff_location_dim"} */

  
    

    create or replace table `uber-data-engineering-407103`.`uber`.`dropoff_location_dim`
    
    

    OPTIONS()
    as (
      WITH numbered_rows AS (
  SELECT
    to_hex(md5(cast(coalesce(cast(dropoff_latitude as STRING), '_dbt_utils_surrogate_key_null_') || '-' || coalesce(cast(dropoff_longitude as STRING), '_dbt_utils_surrogate_key_null_') as STRING))) as dropoff_location_id,
    dropoff_latitude AS dropoff_latitude,
    dropoff_longitude AS dropoff_longitude,
    ROW_NUMBER() OVER (ORDER BY dropoff_latitude, dropoff_longitude) as row_num
  FROM `uber-data-engineering-407103`.`uber`.`uber_tlc_trip_recrord_data`
)
SELECT
  dropoff_location_id,
  dropoff_latitude,
  dropoff_longitude
FROM numbered_rows
    );
  
[0m20:51:58.126333 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=uber-data-engineering-407103&j=bq:US:e2f6d930-87cd-462b-beb0-90751dfdb03b&page=queryresults
[0m20:51:58.140604 [debug] [Thread-1 (]: Timing info for model.uber.dropoff_location_dim (execute): 20:51:52.696429 => 20:51:58.139768
[0m20:51:58.143789 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '46fbd8cb-c76a-4c54-b2e3-81506dd21150', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffad5a2a50>]}
[0m20:51:58.146093 [info ] [Thread-1 (]: 2 of 9 OK created sql table model uber.dropoff_location_dim .................... [[32mCREATE TABLE (100.0k rows, 1.5 MiB processed)[0m in 5.46s]
[0m20:51:58.148054 [debug] [Thread-1 (]: Finished running node model.uber.dropoff_location_dim
[0m20:51:58.149219 [debug] [Thread-1 (]: Began running node model.uber.passenger_count_dim
[0m20:51:58.150748 [info ] [Thread-1 (]: 3 of 9 START sql table model uber.passenger_count_dim .......................... [RUN]
[0m20:51:58.152335 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.uber.dropoff_location_dim, now model.uber.passenger_count_dim)
[0m20:51:58.153089 [debug] [Thread-1 (]: Began compiling node model.uber.passenger_count_dim
[0m20:51:58.170488 [debug] [Thread-1 (]: Writing injected SQL for node "model.uber.passenger_count_dim"
[0m20:51:58.180203 [debug] [Thread-1 (]: Timing info for model.uber.passenger_count_dim (compile): 20:51:58.153704 => 20:51:58.179980
[0m20:51:58.183032 [debug] [Thread-1 (]: Began executing node model.uber.passenger_count_dim
[0m20:51:58.187850 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m20:52:03.021340 [debug] [Thread-1 (]: Writing runtime sql for node "model.uber.passenger_count_dim"
[0m20:52:03.030473 [debug] [Thread-1 (]: On model.uber.passenger_count_dim: /* {"app": "dbt", "dbt_version": "1.5.9", "profile_name": "uber", "target_name": "dev", "node_id": "model.uber.passenger_count_dim"} */

  
    

    create or replace table `uber-data-engineering-407103`.`uber`.`passenger_count_dim`
    
    

    OPTIONS()
    as (
      WITH numbered_rows AS (
  SELECT
    GENERATE_UUID() as passenger_count_id,
    passenger_count AS passenger_count,
    ROW_NUMBER() OVER () as row_num
  FROM `uber-data-engineering-407103`.`uber`.`uber_tlc_trip_recrord_data`
  WHERE passenger_count IS NOT NULL
)
SELECT
  passenger_count_id,
  passenger_count
FROM numbered_rows
    );
  
[0m20:52:06.051004 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=uber-data-engineering-407103&j=bq:US:d0b35cc0-02fb-443a-a700-a0c6b113cb0f&page=queryresults
[0m20:52:06.070181 [debug] [Thread-1 (]: Timing info for model.uber.passenger_count_dim (execute): 20:51:58.183516 => 20:52:06.069044
[0m20:52:06.076472 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '46fbd8cb-c76a-4c54-b2e3-81506dd21150', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffad576090>]}
[0m20:52:06.079775 [info ] [Thread-1 (]: 3 of 9 OK created sql table model uber.passenger_count_dim ..................... [[32mCREATE TABLE (100.0k rows, 781.2 KiB processed)[0m in 7.92s]
[0m20:52:06.083440 [debug] [Thread-1 (]: Finished running node model.uber.passenger_count_dim
[0m20:52:06.085170 [debug] [Thread-1 (]: Began running node model.uber.payment_type_dim
[0m20:52:06.087264 [info ] [Thread-1 (]: 4 of 9 START sql table model uber.payment_type_dim ............................. [RUN]
[0m20:52:06.089361 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.uber.passenger_count_dim, now model.uber.payment_type_dim)
[0m20:52:06.090516 [debug] [Thread-1 (]: Began compiling node model.uber.payment_type_dim
[0m20:52:06.100998 [debug] [Thread-1 (]: Writing injected SQL for node "model.uber.payment_type_dim"
[0m20:52:06.107389 [debug] [Thread-1 (]: Timing info for model.uber.payment_type_dim (compile): 20:52:06.091309 => 20:52:06.107043
[0m20:52:06.108330 [debug] [Thread-1 (]: Began executing node model.uber.payment_type_dim
[0m20:52:06.116043 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m20:52:07.539155 [debug] [Thread-1 (]: Writing runtime sql for node "model.uber.payment_type_dim"
[0m20:52:07.545966 [debug] [Thread-1 (]: On model.uber.payment_type_dim: /* {"app": "dbt", "dbt_version": "1.5.9", "profile_name": "uber", "target_name": "dev", "node_id": "model.uber.payment_type_dim"} */

  
    

    create or replace table `uber-data-engineering-407103`.`uber`.`payment_type_dim`
    
    

    OPTIONS()
    as (
      WITH numbered_rows AS (
  SELECT
    GENERATE_UUID() as payment_type_id,
    payment_type AS payment_type,
    ROW_NUMBER() OVER (ORDER BY payment_type) as row_num
  FROM `uber-data-engineering-407103`.`uber`.`uber_tlc_trip_recrord_data`
  WHERE payment_type IS NOT NULL
)
SELECT
  payment_type_id,
  payment_type
FROM numbered_rows
    );
  
[0m20:52:10.973977 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=uber-data-engineering-407103&j=bq:US:a4140770-fe80-4281-a64b-0ffa21ac24fe&page=queryresults
[0m20:52:10.990930 [debug] [Thread-1 (]: Timing info for model.uber.payment_type_dim (execute): 20:52:06.109087 => 20:52:10.989201
[0m20:52:10.995772 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '46fbd8cb-c76a-4c54-b2e3-81506dd21150', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffad54b690>]}
[0m20:52:10.998979 [info ] [Thread-1 (]: 4 of 9 OK created sql table model uber.payment_type_dim ........................ [[32mCREATE TABLE (100.0k rows, 781.2 KiB processed)[0m in 4.91s]
[0m20:52:11.001715 [debug] [Thread-1 (]: Finished running node model.uber.payment_type_dim
[0m20:52:11.003235 [debug] [Thread-1 (]: Began running node model.uber.pickup_location_dim
[0m20:52:11.005229 [info ] [Thread-1 (]: 5 of 9 START sql table model uber.pickup_location_dim .......................... [RUN]
[0m20:52:11.007244 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.uber.payment_type_dim, now model.uber.pickup_location_dim)
[0m20:52:11.008302 [debug] [Thread-1 (]: Began compiling node model.uber.pickup_location_dim
[0m20:52:11.019942 [debug] [Thread-1 (]: Writing injected SQL for node "model.uber.pickup_location_dim"
[0m20:52:11.022511 [debug] [Thread-1 (]: Timing info for model.uber.pickup_location_dim (compile): 20:52:11.009101 => 20:52:11.022317
[0m20:52:11.023172 [debug] [Thread-1 (]: Began executing node model.uber.pickup_location_dim
[0m20:52:11.026221 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m20:52:13.068622 [debug] [Thread-1 (]: Writing runtime sql for node "model.uber.pickup_location_dim"
[0m20:52:13.072624 [debug] [Thread-1 (]: On model.uber.pickup_location_dim: /* {"app": "dbt", "dbt_version": "1.5.9", "profile_name": "uber", "target_name": "dev", "node_id": "model.uber.pickup_location_dim"} */

  
    

    create or replace table `uber-data-engineering-407103`.`uber`.`pickup_location_dim`
    
    

    OPTIONS()
    as (
      WITH numbered_rows AS (
  SELECT
    to_hex(md5(cast(coalesce(cast(pickup_latitude as STRING), '_dbt_utils_surrogate_key_null_') || '-' || coalesce(cast(pickup_longitude as STRING), '_dbt_utils_surrogate_key_null_') as STRING))) as pickup_location_id,
    pickup_latitude AS pickup_latitude,
    pickup_longitude AS pickup_longitude,
    ROW_NUMBER() OVER (ORDER BY pickup_latitude, pickup_longitude) as row_num
  FROM `uber-data-engineering-407103`.`uber`.`uber_tlc_trip_recrord_data`
)
SELECT
  pickup_location_id,
  pickup_latitude,
  pickup_longitude
FROM numbered_rows
    );
  
[0m20:52:17.180799 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=uber-data-engineering-407103&j=bq:US:ec26e955-e3fb-45f7-872d-458e70c6182b&page=queryresults
[0m20:52:17.186431 [debug] [Thread-1 (]: Timing info for model.uber.pickup_location_dim (execute): 20:52:11.023707 => 20:52:17.186127
[0m20:52:17.187968 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '46fbd8cb-c76a-4c54-b2e3-81506dd21150', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffad510450>]}
[0m20:52:17.189158 [info ] [Thread-1 (]: 5 of 9 OK created sql table model uber.pickup_location_dim ..................... [[32mCREATE TABLE (100.0k rows, 1.5 MiB processed)[0m in 6.18s]
[0m20:52:17.190415 [debug] [Thread-1 (]: Finished running node model.uber.pickup_location_dim
[0m20:52:17.191227 [debug] [Thread-1 (]: Began running node model.uber.rate_code_dim
[0m20:52:17.192143 [info ] [Thread-1 (]: 6 of 9 START sql table model uber.rate_code_dim ................................ [RUN]
[0m20:52:17.193214 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.uber.pickup_location_dim, now model.uber.rate_code_dim)
[0m20:52:17.193791 [debug] [Thread-1 (]: Began compiling node model.uber.rate_code_dim
[0m20:52:17.198156 [debug] [Thread-1 (]: Writing injected SQL for node "model.uber.rate_code_dim"
[0m20:52:17.212112 [debug] [Thread-1 (]: Timing info for model.uber.rate_code_dim (compile): 20:52:17.194263 => 20:52:17.211896
[0m20:52:17.212652 [debug] [Thread-1 (]: Began executing node model.uber.rate_code_dim
[0m20:52:17.215023 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m20:52:19.288150 [debug] [Thread-1 (]: Writing runtime sql for node "model.uber.rate_code_dim"
[0m20:52:19.291804 [debug] [Thread-1 (]: On model.uber.rate_code_dim: /* {"app": "dbt", "dbt_version": "1.5.9", "profile_name": "uber", "target_name": "dev", "node_id": "model.uber.rate_code_dim"} */

  
    

    create or replace table `uber-data-engineering-407103`.`uber`.`rate_code_dim`
    
    

    OPTIONS()
    as (
      WITH numbered_rows AS (
  SELECT
    GENERATE_UUID() as rate_code_id,
    RatecodeID AS RatecodeID,
    ROW_NUMBER() OVER (ORDER BY RatecodeID) as row_num
  FROM `uber-data-engineering-407103`.`uber`.`uber_tlc_trip_recrord_data`
  WHERE RatecodeID IS NOT NULL
)
SELECT
  rate_code_id,
  RatecodeID
FROM numbered_rows
    );
  
[0m20:52:22.976552 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=uber-data-engineering-407103&j=bq:US:e0378837-5b42-460f-8e09-c3472a54656d&page=queryresults
[0m20:52:22.993734 [debug] [Thread-1 (]: Timing info for model.uber.rate_code_dim (execute): 20:52:17.213083 => 20:52:22.992877
[0m20:52:22.998003 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '46fbd8cb-c76a-4c54-b2e3-81506dd21150', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffad4f71d0>]}
[0m20:52:23.001712 [info ] [Thread-1 (]: 6 of 9 OK created sql table model uber.rate_code_dim ........................... [[32mCREATE TABLE (100.0k rows, 781.2 KiB processed)[0m in 5.80s]
[0m20:52:23.004810 [debug] [Thread-1 (]: Finished running node model.uber.rate_code_dim
[0m20:52:23.006792 [debug] [Thread-1 (]: Began running node model.uber.trip_distance
[0m20:52:23.009038 [info ] [Thread-1 (]: 7 of 9 START sql table model uber.trip_distance ................................ [RUN]
[0m20:52:23.011256 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.uber.rate_code_dim, now model.uber.trip_distance)
[0m20:52:23.012373 [debug] [Thread-1 (]: Began compiling node model.uber.trip_distance
[0m20:52:23.027322 [debug] [Thread-1 (]: Writing injected SQL for node "model.uber.trip_distance"
[0m20:52:23.030141 [debug] [Thread-1 (]: Timing info for model.uber.trip_distance (compile): 20:52:23.013385 => 20:52:23.029942
[0m20:52:23.030803 [debug] [Thread-1 (]: Began executing node model.uber.trip_distance
[0m20:52:23.034164 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m20:52:26.549934 [debug] [Thread-1 (]: Writing runtime sql for node "model.uber.trip_distance"
[0m20:52:26.555284 [debug] [Thread-1 (]: On model.uber.trip_distance: /* {"app": "dbt", "dbt_version": "1.5.9", "profile_name": "uber", "target_name": "dev", "node_id": "model.uber.trip_distance"} */

  
    

    create or replace table `uber-data-engineering-407103`.`uber`.`trip_distance`
    
    

    OPTIONS()
    as (
      WITH numbered_rows AS (
  SELECT
    GENERATE_UUID() as trip_distance_id,
    trip_distance AS trip_distance,
    ROW_NUMBER() OVER (ORDER BY trip_distance) as row_num
  FROM `uber-data-engineering-407103`.`uber`.`uber_tlc_trip_recrord_data`
  WHERE trip_distance IS NOT NULL
)
SELECT
  trip_distance_id,
  trip_distance
FROM numbered_rows
    );
  
[0m20:52:29.758696 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=uber-data-engineering-407103&j=bq:US:b666e989-b28b-4c55-b368-d037cd21a5e6&page=queryresults
[0m20:52:29.799663 [debug] [Thread-1 (]: Timing info for model.uber.trip_distance (execute): 20:52:23.031281 => 20:52:29.796767
[0m20:52:29.808177 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '46fbd8cb-c76a-4c54-b2e3-81506dd21150', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffad51ec10>]}
[0m20:52:29.816496 [info ] [Thread-1 (]: 7 of 9 OK created sql table model uber.trip_distance ........................... [[32mCREATE TABLE (100.0k rows, 781.2 KiB processed)[0m in 6.80s]
[0m20:52:29.823698 [debug] [Thread-1 (]: Finished running node model.uber.trip_distance
[0m20:52:29.839532 [debug] [Thread-1 (]: Began running node model.uber.fact_trip
[0m20:52:29.845782 [info ] [Thread-1 (]: 8 of 9 START sql table model uber.fact_trip .................................... [RUN]
[0m20:52:29.850438 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.uber.trip_distance, now model.uber.fact_trip)
[0m20:52:29.855144 [debug] [Thread-1 (]: Began compiling node model.uber.fact_trip
[0m20:52:29.932281 [debug] [Thread-1 (]: Writing injected SQL for node "model.uber.fact_trip"
[0m20:52:29.945465 [debug] [Thread-1 (]: Timing info for model.uber.fact_trip (compile): 20:52:29.857439 => 20:52:29.944674
[0m20:52:29.947629 [debug] [Thread-1 (]: Began executing node model.uber.fact_trip
[0m20:52:29.962556 [debug] [Thread-1 (]: Writing runtime sql for node "model.uber.fact_trip"
[0m20:52:29.973856 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m20:52:29.993969 [debug] [Thread-1 (]: On model.uber.fact_trip: /* {"app": "dbt", "dbt_version": "1.5.9", "profile_name": "uber", "target_name": "dev", "node_id": "model.uber.fact_trip"} */

  
    

    create or replace table `uber-data-engineering-407103`.`uber`.`fact_trip`
    
    

    OPTIONS()
    as (
      WITH fct_invoices_cte AS (
    SELECT
        CAST(ROW_NUMBER() OVER () AS INT64) as trip_id,
        VendorID,
        to_hex(md5(cast(coalesce(cast(tpep_pickup_datetime as STRING), '_dbt_utils_surrogate_key_null_') || '-' || coalesce(cast(tpep_dropoff_datetime as STRING), '_dbt_utils_surrogate_key_null_') as STRING))) AS datetime_id,
        passenger_count_id,
        trip_distance_id,
        rate_code_id,
        store_and_fwd_flag,
        pickup_location_id,
        to_hex(md5(cast(coalesce(cast(dropoff_latitude as STRING), '_dbt_utils_surrogate_key_null_') || '-' || coalesce(cast(dropoff_longitude as STRING), '_dbt_utils_surrogate_key_null_') as STRING))) as dropoff_location_id,
        payment_type_id,
        fare_amount,
        extra,
        mta_tax,
        tip_amount,
        tolls_amount,
        improvement_surcharge,
        total_amount
    FROM `uber-data-engineering-407103`.`uber`.`uber_tlc_trip_recrord_data`
)
SELECT
    trip_id,
    VendorID,
    datetime_id,
    do.dropoff_location_id,
    pu.pickup_location_id,
    pc.passenger_count_id,
    pt.payment_type_id,
    rc.rate_code_id,
    store_and_fwd_flag,
    td.trip_distance_id,
    fare_amount,
    extra,
    mta_tax,
    tip_amount,
    tolls_amount,
    improvement_surcharge AS improvement_surcharge_amount,  -- Added alias
    total_amount
FROM fct_invoices_cte fi
INNER JOIN `uber-data-engineering-407103`.`uber`.`datetime_dim` dt ON fi.datetime_id = dt.datetime_id
INNER JOIN `uber-data-engineering-407103`.`uber`.`dropoff_location_dim` do ON fi.dropoff_location_id = do.dropoff_location_id
INNER JOIN `uber-data-engineering-407103`.`uber`.`pickup_location_dim` pu ON fi.pickup_location_id = pu.pickup_location_id
INNER JOIN `uber-data-engineering-407103`.`uber`.`passenger_count_dim` pc ON fi.passenger_count_id = pc.passenger_count_id
INNER JOIN `uber-data-engineering-407103`.`uber`.`payment_type_dim` pt ON fi.payment_type_id = pt.payment_type_id
INNER JOIN `uber-data-engineering-407103`.`uber`.`rate_code_dim` rc ON fi.rate_code_id = rc.rate_code_id
INNER JOIN `uber-data-engineering-407103`.`uber`.`trip_distance` td ON fi.trip_distance_id = td.trip_distance_id
    );
  
[0m20:52:34.128176 [debug] [Thread-1 (]: BigQuery adapter: Retry attempt 1 of 1 after error: BadRequest('Unrecognized name: passenger_count_id; Did you mean passenger_count? at [17:9]')
[0m20:52:35.130767 [error] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=uber-data-engineering-407103&j=bq:US:9132cba0-e084-4515-8cba-35e9d4e5e516&page=queryresults
[0m20:52:35.142993 [debug] [Thread-1 (]: Timing info for model.uber.fact_trip (execute): 20:52:29.953064 => 20:52:35.141046
[0m20:52:35.183646 [debug] [Thread-1 (]: Database Error in model fact_trip (models/transform/fact_trip.sql)
  Unrecognized name: passenger_count_id; Did you mean passenger_count? at [17:9]
  compiled Code at target/run/uber/models/transform/fact_trip.sql
[0m20:52:35.204301 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '46fbd8cb-c76a-4c54-b2e3-81506dd21150', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffac35cb10>]}
[0m20:52:35.214855 [error] [Thread-1 (]: 8 of 9 ERROR creating sql table model uber.fact_trip ........................... [[31mERROR[0m in 5.34s]
[0m20:52:35.218096 [debug] [Thread-1 (]: Finished running node model.uber.fact_trip
[0m20:52:35.219887 [debug] [Thread-1 (]: Began running node model.uber.test_fact
[0m20:52:35.223474 [info ] [Thread-1 (]: 9 of 9 START sql table model uber.test_fact .................................... [RUN]
[0m20:52:35.226858 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.uber.fact_trip, now model.uber.test_fact)
[0m20:52:35.228018 [debug] [Thread-1 (]: Began compiling node model.uber.test_fact
[0m20:52:35.246741 [debug] [Thread-1 (]: Writing injected SQL for node "model.uber.test_fact"
[0m20:52:35.250505 [debug] [Thread-1 (]: Timing info for model.uber.test_fact (compile): 20:52:35.229126 => 20:52:35.250155
[0m20:52:35.251250 [debug] [Thread-1 (]: Began executing node model.uber.test_fact
[0m20:52:35.255922 [debug] [Thread-1 (]: Writing runtime sql for node "model.uber.test_fact"
[0m20:52:35.259179 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m20:52:35.265615 [debug] [Thread-1 (]: On model.uber.test_fact: /* {"app": "dbt", "dbt_version": "1.5.9", "profile_name": "uber", "target_name": "dev", "node_id": "model.uber.test_fact"} */

  
    

    create or replace table `uber-data-engineering-407103`.`uber`.`test_fact`
    
    

    OPTIONS()
    as (
      with datetime_cte as (

    select * from `uber-data-engineering-407103`.`uber`.`datetime_dim`

),
dropoff_location_cte as (

    select * from `uber-data-engineering-407103`.`uber`.`dropoff_location_dim`

),
pickup_location_cte as (

    select * from `uber-data-engineering-407103`.`uber`.`pickup_location_dim`

),
passenger_count_cte as (

    select * from `uber-data-engineering-407103`.`uber`.`passenger_count_dim`

),
payment_type_cte as (

    select * from `uber-data-engineering-407103`.`uber`.`payment_type_dim`

),
rate_code_cte as (

    select * from `uber-data-engineering-407103`.`uber`.`rate_code_dim`

),
trip_distance_cte as (

    select * from `uber-data-engineering-407103`.`uber`.`trip_distance`

),
ride_cte as (
    SELECT 
        CAST(ROW_NUMBER() OVER () AS INT64) as trip_id,
        VendorID,
        datetime_cte.datetime_id,
        passenger_count_cte.passenger_count_id,
        trip_distance_cte.trip_distance_id,
        rate_code_cte.rate_code_id,
        store_and_fwd_flag,
        pickup_location_cte.pickup_location_id,
        dropoff_location_cte.dropoff_location_id,
        payment_type_cte.payment_type_id,
        fare_amount,
        extra,
        mta_tax,
        tip_amount,
        tolls_amount,
        improvement_surcharge,
        total_amount
    FROM `uber-data-engineering-407103`.`uber`.`uber_tlc_trip_recrord_data`
    JOIN datetime_cte ON ride_cte.datetime_id = datetime_cte.datetime_id
    JOIN dropoff_location_cte ON ride_cte.dropoff_location_id = dropoff_location_cte.dropoff_location_id
    JOIN pickup_location_cte ON ride_cte.pickup_location_id = pickup_location_cte.pickup_location_id
    JOIN passenger_count_cte ON ride_cte.passenger_count_id = passenger_count_cte.passenger_count_id
    JOIN payment_type_cte ON ride_cte.payment_type_id = payment_type_cte.payment_type_id
    JOIN rate_code_cte ON ride_cte.rate_code_id = rate_code_cte.rate_code_id
    JOIN trip_distance_cte ON ride_cte.trip_distance_id = trip_distance_cte.trip_distance_id
)
select * from ride_cte
    );
  
[0m20:52:37.430584 [debug] [Thread-1 (]: BigQuery adapter: Retry attempt 1 of 1 after error: BadRequest('Unrecognized name: ride_cte at [67:26]')
[0m20:52:39.149896 [error] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=uber-data-engineering-407103&j=bq:US:f4fa8b82-217b-48ea-8968-280c5470d797&page=queryresults
[0m20:52:39.155270 [debug] [Thread-1 (]: Timing info for model.uber.test_fact (execute): 20:52:35.251723 => 20:52:39.154562
[0m20:52:39.164136 [debug] [Thread-1 (]: Database Error in model test_fact (models/transform/test_fact.sql)
  Unrecognized name: ride_cte at [67:26]
  compiled Code at target/run/uber/models/transform/test_fact.sql
[0m20:52:39.166073 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '46fbd8cb-c76a-4c54-b2e3-81506dd21150', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffad52b510>]}
[0m20:52:39.168106 [error] [Thread-1 (]: 9 of 9 ERROR creating sql table model uber.test_fact ........................... [[31mERROR[0m in 3.94s]
[0m20:52:39.169542 [debug] [Thread-1 (]: Finished running node model.uber.test_fact
[0m20:52:39.176080 [debug] [MainThread]: Connection 'master' was properly closed.
[0m20:52:39.176963 [debug] [MainThread]: Connection 'model.uber.test_fact' was properly closed.
[0m20:52:39.179480 [info ] [MainThread]: 
[0m20:52:39.181296 [info ] [MainThread]: Finished running 9 table models in 0 hours 0 minutes and 57.88 seconds (57.88s).
[0m20:52:39.185134 [debug] [MainThread]: Command end result
[0m20:52:39.216770 [info ] [MainThread]: 
[0m20:52:39.218070 [info ] [MainThread]: [31mCompleted with 2 errors and 0 warnings:[0m
[0m20:52:39.219243 [info ] [MainThread]: 
[0m20:52:39.220018 [error] [MainThread]: [33mDatabase Error in model fact_trip (models/transform/fact_trip.sql)[0m
[0m20:52:39.221188 [error] [MainThread]:   Unrecognized name: passenger_count_id; Did you mean passenger_count? at [17:9]
[0m20:52:39.222238 [error] [MainThread]:   compiled Code at target/run/uber/models/transform/fact_trip.sql
[0m20:52:39.222817 [info ] [MainThread]: 
[0m20:52:39.224353 [error] [MainThread]: [33mDatabase Error in model test_fact (models/transform/test_fact.sql)[0m
[0m20:52:39.225932 [error] [MainThread]:   Unrecognized name: ride_cte at [67:26]
[0m20:52:39.229836 [error] [MainThread]:   compiled Code at target/run/uber/models/transform/test_fact.sql
[0m20:52:39.233106 [info ] [MainThread]: 
[0m20:52:39.238517 [info ] [MainThread]: Done. PASS=7 WARN=0 ERROR=2 SKIP=0 TOTAL=9
[0m20:52:39.246516 [debug] [MainThread]: Command `dbt run` failed at 20:52:39.245648 after 58.74 seconds
[0m20:52:39.249713 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffb36d4a50>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffb36d46d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffaf57ff90>]}
[0m20:52:39.251119 [debug] [MainThread]: Flushing usage events
